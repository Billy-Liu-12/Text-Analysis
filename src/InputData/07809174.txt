Unraveling the Rank-One Solution Mystery of Robust MISO Downlink Transmit Optimization: A Verifiable

Abstract?This paper concentrates on a robust transmit op- timization problem for the multiuser multi-input single-output (MISO) downlink scenario and under inaccurate channel state information (CSI). This robust problem deals with a general-rank transmit covariance design and follows a safe rate-constrained for- mulation under spherically bounded CSI uncertainties. Curiously, simulation results in previous works suggested that the robust problem admits rank-one optimal transmit covariances in most cases. Such a numerical finding is appealing because transmission with rank-one covariances can be easily realized by single-stream transmit beamforming. This gives rise to a fundamentally impor- tant question, namely, whether we can theoretically identify condi- tions under which the robust problem admits a rank-one solution.

In this paper, we identify one such condition. Simply speaking, we show that the robust problem is guaranteed to admit a rank-one solution if the CSI uncertainties are not too large and the multiuser channel is not too poorly conditioned. To establish the aforemen- tioned condition, we develop a novel duality framework, through which an intimate relationship between the robust problem and a related maximin problem is revealed. Our condition involves only a simple expression with respect to the multiuser channel and other system parameters. In particular, unlike other sufficient rank-one conditions that have appeared in the literature, ours is verifiable.

The application of our analysis framework to several other CSI uncertainty models is also discussed.

Index Terms?Multiuser MIMO, transmit optimization, robust optimization, semidefinite program, rank-one solution.

Manuscript received January 20, 2016; revised July 11, 2016; accepted September 27, 2016. Date of publication January 9, 2017; date of current ver- sion February 3, 2017. The associate editor coordinating the review of this manuscript and approving it for publication was Dr. Gesualdo Scutari. This work was supported in part by a Direct Grant of The Chinese University of Hong Kong under Project 4055009.

W.-K. Ma is with the Department of Electronic Engineering, The Chinese University of Hong Kong, Hong Kong (e-mail: wkma@ee.cuhk.edu.hk).

J. Pan is with MediaTek, Inc., Hsinchu 30078, Taiwan (e-mail: jxpan@ee.

cuhk.edu.hk).

A. M.-C. So is with the Department of Systems Engineering and Engineering Management, The Chinese University of Hong Kong, Hong Kong (e-mail: manchoso@se.cuhk.edu.hk).

T.-H. Chang is with the School of Science and Engineering, The Chinese University of Hong Kong, Shenzhen, and the Shenzhen Research Institute of Big Data, Shenzhen 518172, China (e-mail: tsunghui.chang@ieee.org).

This paper has supplementary downloadable multimedia material available at http://ieeexplore.ieee.org provided by the authors. This includes a pdf, which contains the supplementary technical report of the main manuscript. This mate- rial is 87 KB in size.

Color versions of one or more of the figures in this paper are available online at http://ieeexplore.ieee.org.



I. INTRODUCTION  IN THE multiuser multi-input multi-output (MIMO) down-link scenario, linear precoding has played a key role in greatly enhancing system throughput and efficiency [1]?[7]. In simple terms, the idea is to share the channel among multiple users simultaneously by leveraging on the MIMO degrees of freedom. Linear precoding achieves this by transmitting linearly superimposed multiuser signals whose mutual interference, or multiuser interference, at the user side has been pre-managed by the base station. However, linear precoding also requires the base station to have access to the channel state informa- tion (CSI) of the users, most preferably perfect, for otherwise it would be difficult to perform precise interference control. While it has been demonstrated in the literature (e.g., the above refer- enced articles) that linear precoding can boost the per-user and overall achievable rates drastically in the perfect CSI regime, it is also well known that existing systems often do not acquire CSI perfectly owing to a variety of practical and operational reasons [8]. This practical constraint has stimulated a branch of research that aims to establish linear precoder design, or transmit optimization, frameworks that are robust against CSI uncertainties [9]?[12].

It would not be easy to have a complete overview on the present developments of robust multiuser MIMO transmit op- timization. The reason is that existing works may use different system settings, and their technical developments usually have much dependence on the latter. Particularly, a study can differ in terms of i) the chosen quality-of-service (QoS) measure for the users, e.g., achievable rate, signal-to-interference-and-noise ra- tio, or symbol mean squared error; ii) structural assumptions on the linear precoder, e.g., general linear precoding with arbitrary- rank transmit covariances, or transmit beamforming with a fixed number of data streams; iii) the design criterion, e.g., the QoS- constrained formulation, or the sum-rate maximizing formu- lation. Despite such diversity, we can classify existing works into three types according to the robust performance metric.

The first is the worst-case approach, wherein the CSI uncertain- ties are seen as bounded deterministic unknowns (e.g., within a sphere), and the robust performance metric is the worst-case QoS with respect to (w.r.t.) the CSI uncertainties. This leads to a transmit solution that is ?safe? in the worst-case sense. In this context the design criteria usually give rise to robust op- timization problems with semi-infinite constraints. The current state of the art focuses mainly on the conic optimization frame- work, where techniques originated from robust optimization are  See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

applied to convert those semi-infinite constraints into (convex) linear matrix inequalities. Note that the conversion is sometimes equivalent [12], and sometimes approximate as a restriction [9], [13], [14] or a relaxation [10], [11]; that generally depends on the chosen QoS.

The second type of robust techniques is the average approach, wherein the CSI uncertainties are modeled as random variables, and the average QoS w.r.t. the CSI uncertainties is used as the robust performance metric. This average approach may lead to higher throughput than the worst-case approach in an average sense, although one should also note that average robust per- formance measures may not be as desirable for real-time or delay-sensitive traffic. The corresponding design criteria lead to stochastic optimization problems, which present a different challenge; some recent results can be found in [15], [16]. The third type is the outage-based approach, wherein the perfor- mance metric is a QoS level under which the actual QoS will be satisfied with high probability (again assuming that the CSI uncertainties are random). It is a safe approach, but in a prob- abilistic sense and with the level of pessimism being tunable.

Outage-based designs deal with chance-constrained optimiza- tion problems that are intrinsically very hard to solve. Recent developments tackle this issue through efficiently computable approximations [17]?[22]. It is interesting to note that the worst- case approach, upon appropriate modifications, can also be used to handle the outage-based designs; see, e.g., [20].

A. Focus of this Paper and Contribution  In this paper we focus on a particular robust transmit op- timization problem in the multiuser multi-input single-output (MISO) downlink scenario. Specifically, the performance met- ric is the worst-case achievable rate under a spherically bounded CSI uncertainty model, and under general linear precoding. The design criterion is that of minimizing the total transmission power, subject to the constraint that the worst-case achievable rate of each user is better than or equal to a pre-specified rate value. The same problem was first studied in [10] in the context of semidefinite relaxation (SDR)-based transmit beamforming and extended later to other scenarios such as cognitive radio net- works [11], distributed multicell coordination [23], and outage- based robust designs [20]. In particular, the problem can be converted to a semidefinite program (SDP), which can be ef- ficiently solved by conic optimization algorithms. Empirically, it has been observed that this robust problem exhibits a very desirable behavior, namely, the optimal transmit covariances of the multiuser signals were found to be of rank one in most of the instances [10], [11], [20]. We should stress that the design criterion does not impose any rank constraints on the transmit covariances, and numerical results suggested that rank-one opti- mal transmit covariances is generally the case. This phenomenon is practically important, since in rank-one instances the physical- layer transmit strategy reduces to (per-user) single-stream trans- mit beamforming, which is simple to deploy in practice.

The contribution of this paper is fundamental. We set out to prove when the robust transmit optimization problem described above admits a rank-one solution. From a communication the- ory viewpoint, our motivation is similar to that in some classi- cal MIMO study, such as the single-user average robust study in [24], where the objective is to understand when the sim- ple single-stream transmit beamforming scheme is the optimal  physical-layer transmit scheme. Moreover, from a mathematical optimization perspective, this rank-one solution analysis prob- lem is closely related to the study of rank reduction theory in SDP, which is important as evidenced in recent works [25]?[29].

Before we describe our approach, let us mention some related work. Under the same system setting, rank-one solution analyses in the perfect CSI case have been considered, and in fact solved, in [1], [30]. The provable rank-one results therein are strong and requires little assumption. However, the main tools used in the perfect CSI case, such as the SDP rank reduction technique [30], turn out to be not too useful in the inaccurate CSI case; this will be discussed in the next section. In that regard, we are faced with a new analysis challenge. Recently, several independent studies have attempted to solve the robust rank-one solution analysis problem [31]?[33] by identifying various sufficient conditions for the robust problem to admit a rank-one solution. Unfortu- nately, these sufficient conditions are not verifiable in the sense that they either depend on some quantity that cannot be deter- mined in closed form or require certain assumptions whose satis- fiability has not been further proven. Thus, it is not easy to extract physical meanings from those results. As an additional minor note, the robust problem is shown to have strong rank-one solu- tion guarantees in certain restrictive cases, namely, when there is only one user [23], [34], or when there are at most two transmit antennas [31].

In this work, we prove a verifiable sufficient condition for the robust rank-one solution analysis problem. Roughly speaking, we show that if the magnitudes of the CSI uncertainties are small compared to those of the corresponding channels, and if the channels of different users are not too similar in terms of direc- tion, then the robust problem will admit a rank-one solution. The aforementioned condition sounds practically reasonable, since large CSI uncertainties and similar channel directions tend to result in infeasibility of the robust problem or a poor solution in terms of power efficiency. Our analysis is based on a novel dual- ity result, proven herein specifically for the robust problem. This duality result allows us to tackle the robust rank-one solution analysis question by studying the rank-one solution conditions of the same problem under perfect CSI, which is an arguably easier task. The duality result also provides fundamentally new insights into the robust problem, as we will explain in the paper.

B. Organization and Notations  In Section II we give the background of the robust transmit optimization problem of interest. This will also include sim- ulation results and a concise review of some known rank-one solution results. In Section III we describe our main rank-one result. This is followed by Section IV, which provides the proof of the main result. Section V discusses how the main result can be applied to several other CSI uncertainty models. Section VI concludes the paper.

The notations used in this paper are mostly standard, and some specific notations are defined as follows: Hn is the set of all complex-valued Hermitian n ? n matrices; X ? 0 and X ? 0 mean that X is positive semidefinite and positive definite, re- spectively; x ? 0 means that x is elementwise nonnegative; ?x?2 =  ? xH x and ?x?? = maxi=1,...,n |xi | are the 2-norm  and infinity-norm, respectively; E[?] denotes expectation; the superscript ? means the pseudo-inverse.

MA et al.: UNRAVELING THE RANK-ONE SOLUTION MYSTERY OF ROBUST MISO DOWNLINK TRANSMIT OPTIMIZATION 1911

II. BACKGROUND REVIEW  A. System Model  Consider a unicast multiuser MISO downlink scenario, in which the base station transmits information signals, one for each user, simultaneously. The signal transmitted by the base station is given by x(t) =  ?K i=1 xi(t), where xi(t) ? CN is  the vector information signal for user i, K is the number of users, and N is the number of antennas at the base station.

Also, each xi(t) is generated independently from one another.

Every channel from the base station to a user is assumed to be frequency-flat and static within the transmission time block.

Correspondingly, the received signal of user i, i = 1, . . . , K, is yi(t) = hHi x(t) + vi(t), where hi ? CN is the channel from the base station to user i, and vi(t) is complex circular Gaus- sian noise with mean zero and variance ?2i . By denoting the transmit covariance of xi(t) as W i = E[xi(t)xHi (t)] ? HN and assuming vector-Gaussian signaling for every xi(t), the achievable rate of user i can be modeled as  Ri(W ,hi) = log2  ?  ? ?1 +  hHi W ihi?  j 	=i hHi W jhi + ?2i  ?  ? ? ,  where, for conciseness, we denote W = (W 1 , . . . ,W K ).

We deal with transmit optimization, or the design of W for  enhancing system performance. In this context, a crucial as- sumption is that the base station has acquired the CSI (hi)Ki=1 .

How the CSI is acquired is system-dependent. For instance, in frequency-division duplex (FDD) systems we use quantized channel feedback, while in time-division duplex (TDD) systems we use uplink channel estimation. In general, we can write  hi = h?i + ei , i = 1, . . . ,K,  where h?i is the presumed or estimated channel of user i at the base station, and ei represents the corresponding channel error.

The channel errors capture uncertainties caused by a combi- nation of several effects, such as time variations of the chan- nels before and after channel acquisition, channel quantization errors in FDD, and channel estimation errors (which depend on a number of factors in the underlying physical-layer struc- tures; e.g., in LTE, those factors include the OFDM resource block structures, the corresponding pilot assignment scheme, and the channel estimation algorithm employed). An accurate model for such a channel error process can be complicated and system-dependent. For this reason, simple but effective models are usually preferred. One such model is the spherically bounded model, where ei?s are treated as deterministic unknowns with  ?ei?2 ? ?i, i = 1, . . . , K, where ?i > 0 represents a known worst-case error magnitude bound.

B. The Robust Rate-Constrained Problem  Under the above system setup, the transmit optimization prob- lem of interest is to minimize the total transmission power and make sure every user will achieve a rate that is no less than a pre-specified value under any spherically bounded channel  uncertainties. Mathematically, this is formulated as  min W 1 ,...,W K ?HN  K?  i=1 Tr(W i)  s.t. Ri(W ,hi) ? ri for all hi ? Ui , i = 1, . . . ,K, W 1 , . . . ,W K ? 0, (1)  where ri > 0 is the pre-specified rate value of user i, and  Ui = {hi ? CN | ?hi ? h?i?2 ? ?i} denotes the admissible channel set for user i. Problem (1) is a robust transmit covariance design following the worst-case approach. For convenience, Problem (1) will be called the robust rate-constrained problem in the sequel.

The robust rate-constrained problem is a ?good? transmit optimization problem in the sense that it can be solved using conic optimization machinery. To see this, let  ?i(W ,hi) = ?2i + hHi  ?  ? ?  j 	=i W j ? 1  ?i W i  ?  ?hi ,  ?i = 2ri ? 1 > 0 for i = 1, . . . , K, and observe that the rate constraint Ri(W ,hi) ? ri can be rewritten as ?i(W ,hi) ? 0. Thus, Problem (1) can be expressed as  min W  K?  i=1 Tr(W i) (2a)  s.t. max hi ?Ui  ?i(W ,hi) ? 0, i = 1, . . . ,K, (2b)  W 1 , . . . ,W K ? 0. (2c) Note that we leave the assumption W i ? HN , i = 1, . . . ,K, implicit for notational conciseness, and the same convention will be applied hereafter. Since ?i is affine in W , Problem (2) is convex. However, the constraints in (2b) are semi-infinite.

Fortunately, in this particular case such constraints can be easily tackled. The idea is to apply the S-lemma [25]: Since Ui and ?i(W ,hi) are quadratically dependent on hi , the S-lemma im- plies that the constraints in (2b) can be equivalently transformed into the linear matrix inequalities (LMIs)  ?ti ? 0 such that [  Qi + tiI ri rHi si ? ti?2i  ]  ? 0, i = 1, . . . ,K,  where Qi = ?i  W i ? ?  j 	=i W j , ri = Qih?i , si = h? H i Qih?i ?  ?2i ; see [10]. Plugging the above LMIs into Problem (2), we can reformulate Problem (2) as  min W ,Z,t  K?  i=1 Tr(W i) (3a)  s.t. Zi = [  Qi + tiI ri rHi si ? ti?2i  ]  , i = 1, . . . , K, (3b)  W i ? 0,Zi ? 0, ti ? 0, i = 1, . . . , K. (3c) The above problem is an SDP and can be efficiently solved by available conic optimization software [35], [36]. Note that the aforementioned SDP formulation was first proposed in [10].

TABLE I OCCURRENCE OF RANK-ONE SOLUTION TO THE ROBUST RATE-CONSTRAINED PROBLEM IN (2)  The test was conducted on 2,000 randomly generated channel instances, and we set r1 = ? ? ? = rK = r and ? 2i = 0.1.

C. The Rank-One Solution Mystery  There is an interesting phenomenon, and also a mystery, con- cerning the robust rate-constrained problem. It has been ob- served by numerical means that the optimal solution W? to Problem (2) is almost always of rank one (i.e., rank(W ?i ) = 1 for all i), and this was consistently reported in several indepen- dent studies such as [10], [20], [31], [32]. Such a result is very meaningful, since in the rank-one case we can easily realize the achievable rates in physical layer via single-stream beam- forming; specifically, xi(t) = wisi(t), where wi ? CN is a beamforming vector and si(t) is a zero-mean unit-power data stream for user i (note also the equivalence W i = wiwHi ?? rank(W i) ? 1,W i ? 0). As an additional remark, one can also find physical-layer transceiver schemes that are designed to handle higher-rank W ?i (see, e.g., [37]?[41]), but single-stream beamforming is simpler to implement than those schemes. Read- ers are referred to [10], [20] for further descriptions concerning the SDR interpretation of Problem (2) for single-stream beam- forming design.

To give readers some insight, we produce a set of test results in Table I. We see that except for some very occasional instances, Problem (2) has a rank-one solution whenever it is feasible. We should note that higher-rank instances were also spotted in the ellipsoidal channel error model; see the examples shown in [11], [31]. Nevertheless, those instances are arguably rare.

It is also interesting to benchmark some existing state-of-the- art methods, particularly those that consider (per-user) single- stream beamforming under the same formulation as Problem (2).

We use the max-min-fair (MMF) rate  r?MMF = max {  r  ? ? ? ? minhi ?Ui  Ri(W ,hi) ? r ?i, W i ? 0?i,  K?  i=1 Tr(W i) ? Ptot  }  as the performance metric for comparison, where Ptot is given and describes the total transmission power limit. The MMF rate can be computed by using Problem (2); see the bisection search in [42] for details. Also, if the MMF rate with single-stream beamforming is desired, one can replace Problem (2) with its  Fig. 1. Rate performance of various robust transmit optimization methods.

N = 4, K = 3, ?2i = 0.1, ?  i = 0.1, 2,000 simulation trials. The presumed  channels are randomly generated at each trial, following a complex circular Gaussian distribution with mean 0 and covariance I.

single-stream beamforming version; i.e.,  min w1 ,...,wK ?CN  K?  i=1 ?wi?22  s.t. max hi ?Ui  ?i((wiwHi ) K i=1 ,hi) ? 0, i = 1, . . . ,K,  (4) which is obtained by substituting W i = wiwHi into Prob- lem (2). We illustrate in Fig. 1 the MMF rates of various meth- ods and in Table II the running times. In particular, ?RSDP? refers to the application of Problem (2), ?RMMSE? the ro- bust minimum-mean-square-error method in [12], ?RSOCP1? the robust second-order cone programming (SOCP) method in [9, Algorithm 3], ?RSOCP2? the robust SOCP method in [13, Th. 4], and ?RSOCP3? the robust SOCP method in [14]. Note that other than ?RSDP?, all the benchmarked meth- ods are convex restrictive approximations of the single-stream beamforming problem in (4). Moreover, in this numerical ex- periment, we found that ?RSDP? gives rank-one solutions all    MA et al.: UNRAVELING THE RANK-ONE SOLUTION MYSTERY OF ROBUST MISO DOWNLINK TRANSMIT OPTIMIZATION 1913  TABLE II AVERAGE RUNTIME PERFORMANCE OF THE VARIOUS METHODS FOR HANDLING  PROBLEM (2) OR THE SINGLE-STREAM BEAMFORMING VERSION OF (2)  N = 4, K = 3, ? 2i = 0.1, ? i = 0.1, r1 = ? ? ? = rK = 1.8122, 2,000 simulation tri-  als. CVX [36] was used to implement the various methods, and the experiment was run on a PC with a CPU speed of 3.40 GHz.

the time. From Fig. 1 and Table II, we observe that ?RSDP?, or Problem (2), is most competitive in both MMF rate and runtime performance.

D. Problem Statement and Known Results  The aforementioned numerical finding is very interesting and has motivated the following question:  Question: Under what conditions on the problem instance {h?i , ?2i , ?i}Ki=1 will the robust rate-constrained problem (2) ad- mit a rank-one solution? In addition, what are the subsequent implications from a practical viewpoint; e.g., requirements on the presumed channels h?i?s, limits on the uncertainty bounds ?i?s, etc.?

To better understand this analysis challenge, we start by reviewing the perfect CSI case. From Problem (2), the rate- constrained problem under perfect CSI (or ?i = 0 for all i) is  min W  K?  i=1 Tr(W i)  s.t. Tr ( H i  ( ?i  W i ? ?  j 	=i W j  )) ? ?2i , i = 1, . . . , K,  W 1 , . . . ,W K ? 0, (5) where H i = hihHi . The above problem is a complex-valued separable SDP with K separable decision variables and K linear constraints. For such a problem, it is well known that a rank- one solution exists; e.g., by the Bengtsson-Ottersten uplink- downlink duality result (the first reported rank-one result in unicast transmit optimization) [1], or by the SDP rank reduction technique [30], [43]. Let us briefly review the latter approach by recalling a popularly used result.

Fact 1 (SDP Rank Reduction [30]): Consider the com- plex-valued separable SDP  min X1 ,...,Xk ?Hn  k?  i=1 Tr(CiX i) (6a)  s.t.

k?  l=1 Tr(Ai,lX l) ?i bi , i = 1, . . . , m, (6b)  X1 , . . . ,Xk ? 0, (6c) where Ai,l ,Ci ? Hn , bi ? R for all i, l, and the notation ?i can be either ??? or ?=? for each i. Suppose that Problem (6) has an optimal solution.1 Then, there exists a solution (X?1 , . . . ,X  ? k )  1As a subtle point, in the literature SDP rank reduction results are usually proved under the assumption that Problem (6) and its dual both have optimal solutions and attain zero duality gap. This assumption may be relaxed to that of only requiring Problem (6) to have an optimal solution, through a variation of the existing proof; see [44, Th. 5.4 and Corollary 5.5].

to Problem (6) such that  k?  i=1  rank(X?i ) 2 ? m.

In particular, if X?i 	= 0 for all i and m ? k + 2, then every X?i has rank(X  ? i ) = 1.

Armed with Fact 1, one can easily conclude that Problem (5) has a rank-one solution.

Thus, one would be tempted to see whether SDP rank reduc- tion can also be applied to the robust rate-constrained problem.

Unfortunately, this approach appears to have fundamental limi- tations. In the accompanying supplementary material (or [45]), we prove that a direct application of Fact 1 leads to the following result: If Problem (3) has an optimal solution, then there exists an optimal solution (W ?i ,Z  ? i , t  ? i )  K i=1 to Problem (3) such that  K?  i=1  rank(W ?i ) 2 ? K(N 2 + 2N) ?  K?  i=1  rank(Z?i ) 2 .

Furthermore, every Z?i must satisfy rank(Z ? i ) ? N . Let us  assume for the sake of argument that rank(Z?i ) = N for all i, which is the best case one can hope for. The above bound then becomes  K?  i=1  rank(W ?i ) 2 ? 2NK,  which is still too loose to provide a meaningful result for rank(W ?i ) = 1 for all i.

Song et al. [31] have recently proven some rank-one results for the robust rate-constrained problem. Rather than using SDP rank reduction, they studied the Karush-Kuhn-Tucker (KKT) conditions of the SDP formulation (3). In particular, they proved the following result: Suppose that Problem (3) is feasible, and let v? denote the optimal objective value of Problem (3). If  ?2i < ?i?  i  v? , i = 1, . . . ,K, (7)  then any solution W? to Problem (3) must have rank(W ?i ) = 1 for all i. Physically, this implies that the robust rate-constrained problem should have a rank-one solution for sufficiently small uncertainty bounds ?i?s. While insightful, the above result has a fundamental drawback?the optimal value v? also depends on the problem instance {h?i , ?2i , ?i}Ki=1 . It is not clear how v? would scale with these parameters.



III. MAIN RESULT  In this section we present our main result. Let F? = [ h?1 , . . . , h?K ] be the presumed multiuser channel matrix, F??i be a submatrix of F? obtained by removing the ith column of F? , and ??i = I ? F??i(F? H?iF??i)?F? H?i be the orthogonal complement projector of F??i . The following theorem summarizes the result.

Theorem 1: Suppose that Problem (2) has an optimal solu- tion, and that ?2i > 0 for all i. If  ???k h?k?22 ?2k  > 1 + K + (  K ? 1 K  )  ?k , k = 1, . . . ,K (8)  holds, then the optimal solution W? to Problem (2) must have rank(W ?i ) = 1 for all i.

Fig. 2. The satisfaction probability of the sufficient rank-one condition in Theorem 1. ?2i = 0.1, ?  i = 0.1, r1 = ? ? ? = rK = r, 2,000 simulation tri-  als. The presumed channels are randomly generated at each trial, following a complex circular Gaussian distribution with mean 0 and covariance I.

Note that Theorem 1 is a sufficient condition, and as dis- cussed previously empirical experience indicates a much better situation. A numerical result is shown in Fig. 2 to give more insights. There, we randomly generated many instances of h?i?s and evaluated the empirical satisfaction probability of (8). As seen, there is generally a gap between the satisfaction probabil- ity of (8) and the probability that the robust problem is feasible.

That said, for (N,K) = (12, 3), the gap is almost zero when the rate requirement is below 3 bits/s/Hz. As a reference, Fig. 2 also shows the satisfaction probability of the sufficient rank-one condition (7) by Song et al. [31].

The proof of Theorem 1 will be the focus in the next section.

Here, we are interested in extracting physical meanings from Theorem 1. It is easy to verify that for N ? K, we have  ???k h?k?2 ? ?h?k?2 ? ?min(F? ), (9) where  F? = [ h?1/?h?1?2 , . . . , h?K /?h?K ?2 ] is the presumed multiuser channel direction matrix, and ?min(?) denotes the smallest singular value of its argument; see Appendix A for the proof of (9). We see that, as a direct corollary of Theorem 1, if N ? K and ?h?k?22  ?2k ?min(F? )2 > 1 + K +  (  K ? 1 K  )  ?k , k = 1, . . . , K  (10) holds, then the optimal solution to Problem (2) must be of rank one. The inequality (10) has several implications. First, fixing K and ?k ?s, the rank-one condition can be guaranteed if the channel-to-uncertainty ratios ?h?k?22/?2k are sufficiently large and the presumed multiuser channel direction matrix F? is sufficiently well-conditioned. Second, the rank-one condi- tion becomes harder to satisfy if the number of users K is larger and/or if the rate requirements ri?s are higher (recall ?i = 2ri ? 1). Third, the rank-one condition does not depend on the noise powers ?2i ?s.

We also have the following result:  Proposition 1: Suppose that h?1 , . . . , h?K are independent circularly symmetric complex Gaussian random vectors, where h?i has mean 0 and covariance ?iI for some ?i > 0. Let  CURi = E[?h?i?22 ]  ?2i =  ?iN  ?2i  be the ratio of the ith presumed channel?s average magni- tude to the worst-case channel magnitude, or the channel-to- uncertainty ratio (CUR) for short. Furthermore, let  ?i = N  N ? K + 1 [  1 + K + (  K ? 1 K  )  ?i  ]  , i = 1, . . . ,K.

If CURi > ?i for i = 1, . . . ,K, then the sufficient rank-one condition (8) in Theorem 1 holds with probability at least  1 ? K?  k=1  ( ?ke  CURk  )N ?K +1 ,  where e ? 2.71828 is the Euler number.

We relegate the proof of Proposition 1 to Appendix B. Propo-  sition 1 not only shows that the probability of admitting a rank- one robust solution is guaranteed to increase if the CURs in- crease but also indicates that such probability increases rapidly to 1 as we make N ? K larger. In fact, the latter is in good agreement with the numerical result in Fig. 2.

Remark 1: The condition in (8) can be improved in some cases. In the proof of Theorem 1, we also show that if ???k h?k?22/ ?2k ? (K + 1)2 for some k, the corresponding bound in (8) may be replaced by  ???k h?k?22 ?2k  > (1 + ?  (K ? 1)?k )2 . (11)

IV. PROOF OF THEOREM 1  The proof of Theorem 1 contains two parts. In the first part, we develop a duality-based analysis framework for the robust rate-constrained problem (2). Our analysis framework is quite different from those of Song et al. [31] and our previous pre- liminary work [32], in the sense that we do not rely on the S-lemma-based SDP formulation (3). The duality result also provides some interesting implications, which we will discuss.

In the second part, we prove a specific rank-one solution condi- tion for the non-robust rate-constrained problem, which, when applied to our duality framework, leads to the robust rank-one solution condition in Theorem 1.

A. Preliminaries  Let us describe the two basic ingredients in our proof. The first is about properties of the fixed-channel, or perfect-CSI, rate-constrained problem. From (5), consider  min W  K?  i=1 Tr(W i)  s.t. Tr ( H i  ( ?i  W i ? ?  j 	=i W j  )) ? ?2i , i = 1, . . . ,K,  W 1 , . . . ,W K ? 0, (12)    MA et al.: UNRAVELING THE RANK-ONE SOLUTION MYSTERY OF ROBUST MISO DOWNLINK TRANSMIT OPTIMIZATION 1915  where every H i is a general Hermitian matrix, as opposed to H i = hihHi in the previous study. The dual of Problem (12) is  max ?  K?  i=1 ?2i ?i  s.t. I + ?  j 	=i ?jHj ? ?i?i H i ? 0, i = 1, . . . ,K,  ?1 , . . . , ?K ? 0, (13) where ?1 , . . . , ?K ? R are the dual variables. For convex prob- lems such as the above, strong duality and existence of optimal solutions should not be an issue in practice, though their valid- ity requires a proof. A result arising from one such proof is as follows:  Fact 2: Consider Problem (12) with ?2i > 0 for all i. Sup- pose that Problem (12) is feasible. Then, Problem (12) is also strictly feasible. Moreover, its dual problem (13) is strictly fea- sible regardless of the feasibility of Problem (12). Consequently, by the strong duality theorem (e.g., [46]), Problems (12)?(13) both have optimal solutions, and they attain zero duality gap.

Fact 2 can be easily proven.2 Another result is the following:  Fact 3: Consider Problem (12) with ?i > 0 and  H i = hihHi + ?i , hi 	= 0, ?i ? 0, for all i. Suppose that Problem (12) is feasible. If the optimal solution ?? to the dual problem (13) satisfies  1 ? ??i ?i  Tr(?i) > 0, i = 1, . . . , K,  then the optimal solution W? to Problem (12) must be of rank one; i.e., rank(W? i) = 1 for all i.

Fact 3 is essentially a reduction of the robust rank-one result by Song et al. [31] to the fixed-channel case; see also [28], [47] for similar results that arise in different contexts. Fact 3 gives a sufficient condition on when the solution to the fixed-channel rate-constrained problem must have rank one. In comparison, SDP rank reduction results, such as Fact 1, usually tell when a rank-one solution to the problem exists and may not rule out the existence of higher-rank solutions. Given its importance, we show its proof below.

Proof of Fact 3: Notice that the conditions in Fact 2 hold.

Thus, the KKT conditions for Problems (12) and (13), which are given by  ?2i ? Tr ( H i  ( ?i  W i ? ?  j 	=i W j  )) , (14)  Zi = I + ?  j 	=i ?jHj ? ?i?i H i , (15)  W i ? 0,Zi ? 0, ?i ? 0, (16) W iZi = 0, (17)  0 = ?i [ ?2i ? Tr  ( H i  ( ?i  W i ? ?  j 	=i W j  )] , (18)  2Concisely, if W ? is feasible to (12), then W ??i = ?W ?i + I, i = 1, . . . , K , is strictly feasible for some sufficiently large ? > 1. Moreover, we can always find sufficient small ?i > 0, i = 1, . . . , K , such that I +  ? j 	= i ?j Hj ?  ? i ? i  Hi ? 0 for all i.

for 1 = 1, . . . , K, are necessary and sufficient for optimality.

For convenience, we use (W ,?) to denote a primal-dual pair of optimal solutions to Problems (12) and (13). Let us expand the ith constraint in (15) as  Zi = ( I ? ?i?i ?i  ) + ?  j 	=i ?jHj ? ?i?i hih  H i  for i = 1, . . . , K, and recall that H i ? 0. Observe that if I ? ?i?i ?i ? 0, then at least N ? 1 of the eigenval- ues of Zi must be positive. Consequently, we have rank(Zi) ? N ? 1. This, together with (16)?(17), im- ply that rank(W i) ? 1. Also, since W i = 0 violates (14) for ?2i > 0, we are left with rank(W i) = 1.

Moreover, the condition for I ? ?i?i ?i ? 0 is satisfied if 1 > ?i ?i  Tr(?i). The proof is therefore complete. ? The second ingredient is an alternative representation of the  robust constraints in (2b). To describe it, consider a generic quadratically constrained quadratic program (QCQP)  max h?Cn  hH A0h + 2Re(bH0 h) + c0  s.t. hH Aih + 2Re(bHi h) + ci ?i 0, i = 1, . . . ,m, (19)  where Ai ? Hn , bi ? Cn , ci ? R for i = 0, . . . ,m. We see that the problems in (2b) are instances of Problem (19) with m = 1.

Problem (19) is generally non-convex; e.g., when A0 is indef- inite (which is the case in (2b)). However, it can be tackled by the SDR technique [48]. Concisely, SDR works by letting H = hhH , relaxing it to H ? hhH , and putting it into (19) to obtain  max H?Hn ,h?Cn  Tr(A0H) + 2Re(bH0 h) + c0  s.t. Tr(AiH) + 2Re(bHi h) + ci ?i 0, i = 1, . . . , m,  H ? hhH . (20) Problem (20) is convex. Let ?? and ?? denote the optimal values of Problems (19) and (20), respectively. As a relaxation, we have  ?? ? ??.

However, if m ? 2, then we can have ?? = ?? under some fairly mild conditions [49], [50]. Here we describe one such condition.

Fact 4: Suppose that both Problems (19) and (20) have op- timal solutions. Then, for m ? 2, the optimal value of Prob- lem (19) is equal to that of Problem (20).

Fact 4 can be easily deduced by applying the SDP rank reduction result in Fact 1 to Problem (20); see, e.g., [50] for the proof.

For our problem in (2b), Fact 4 holds. Specifically, it can be verified that the corresponding problems in (19) and (20) have compact feasible sets. Thus, they both have optimal solutions.

B. Proof of Theorem 1: Part One  Consider Problem (2), and suppose that it has an optimal solution. As mentioned in the previous subsection, we can use the tight SDR result in Fact 4 to derive the following equivalent representation of the constraint functions in (2b):  max hi ?Ui  ?i(W ,hi) = max H i ?Vi  ?i(W ,H i), i = 1, . . . , K,     where  ?i(W ,H i) = ?2i +Tr(H i( ?  j 	=i W j ? 1?i W i)),  Vi = {H i ? HN | ?hi ? CN s.t. H i ? hihHi , ?h?i?22?2Re(h?Hi hi)+Tr(H i)? ?2i}. (21)  This leads to a new formulation of Problem (2) as follows:  v? = min W?S  K?  i=1 Tr(W i)  s.t. max H i ?Vi  ?i(W ,H i) ? 0, i = 1, . . . ,K, (22)  where  S = {(W 1 , . . . ,W K) ? HN ?? ? ??HN |W i ? 0?i}. (23) We should emphasize a key difference in the new formulation (22): Every constraint function ?i(W ,H i) in (22) is affine in H i , given any W ? S. In comparison, the related constraint function ?i(W ,hi) in (2) is indefinite quadratic in hi , given a general W ? S.

Let W? denote the optimal solution to (22) (throughout the proof we will assume this without further mentioning). Then, it can be seen from Problem (22) that W? is a feasible solution to  min W?S  K?  i=1 Tr(W i)  s.t. ?i(W ,H i) ? 0, i = 1, . . . ,K (24) for any given H = (H1 , . . . ,HK ) ? V ? V1 ? ? ? ? ? VK .

Furthermore, given an H ? V , Problem (24) is an instance of the fixed-channel problem in (12). Subsequently, by Fact 2, for any given H ? V , Problem (24) has an optimal solution. In particular, we can define  p(H) = min W?S  K?  i=1 Tr(W i)  s.t. ?i(W ,H i) ? 0, i = 1, . . . , K.

Since p(H) ??Ki=1 Tr(W ?i ) = v? for any H ? V , we have  v? ? p? ? sup H?V  p(H).

We now develop the following key result:  Proposition 2: Suppose that Problem (22) has an optimal solution, and that ?2i > 0 for all i. The following two properties hold:  1) The optimal value p? is attained; i.e., there exists an H? ? V such that p? = p(H?).

2) Suppose that v? = p? holds, and let H? be an optimal so- lution to supH?V p(H). Then, the optimal solution W? to Problem (22) must be an optimal solution to Problem (24) for H = H? .

Proof of Proposition 2: We will show that p(H) is upper semicontinuous on V . Let us assume this for the time being.

By noting that V is compact, we see that p? = supH?V p(H) is attained by some H ? V . This establishes the first property.

For the second property, suppose that v? = p? , but W? is not optimal for Problem (24) when H = H? . Then, we have p? = p(H?) < ?i Tr(W ?i ) = v? = p? , a contradiction.

It remains to establish the upper semicontinuity of p(H) on V . The main tools we need are summarized as follows:  Fact 5: Let E ,F be finite-dimensional Euclidean spaces.

(a) (cf. [51, Proposition 1.20]) Let I be an arbitrary in-  dex set and X ? E be arbitrary. Suppose that fi : X ? [??,?) is upper semicontinuous at x? ? X for all i ? I .

Then, f = inf i?I fi is upper semicontinuous at x?.

(b) (cf. [51, Corollary 1.23]) Let X ? E be arbitrary and Y ? F be compact. Suppose that f : X ? Y ? [??,?) is upper semicontinuous at all points in {x?} ? Y . Then, the function g : X ? [??,?) defined by g(x) = supy?Y f(x,y) is upper semicontinuous at x?.

Since Fact 2 implies that Problem (24) attains zero duality gap for any H ? V (note also the feasibility of Problem (24) for any H ? V and ?2i > 0 for all i), we can use the dual form in (13) to equivalently express p(H) as  p(H) = sup ??0  inf Z?S  g(H,?,Z), for any H ? V , (25)  where Z = (Z1 , . . . ,ZK ) ? HN ? ? ? ? ? HN , S is given in (23), and  g(H,?,Z) = K?  i=1  ?2i ?i + K?  i=1  Tr ( Zi  ( I+  ?  j 	=i ?jHj ? ?i?i H i  )) .

Additionally, since p(H) ? v? < ? and ?2i > 0 for all i, it can be readily verified from (13) that any optimal solution ? to the outer problem in (25) is bounded. Thus, without loss of generality, we may assume the existence of an M > 0 such that  p(H) = sup 0???M 1  inf Z?S  g(H,?,Z), for any H ? V ,  where 1 denotes an all-one vector. We are now ready to apply Fact 5. Let Rn+ denote the set of nonnegative num- bers in Rn . Since g is continuous, and hence upper semi- continuous, at any (H,?) ? V ? RK+ , Fact 5(a) implies that g?(H,?) = infZ?S g(H,?,Z) is upper semicontinuous at any (H,?) ? V ? RK+ . Subsequently, by applying Fact 5(b), p(H) = sup0???M 1 g?(H,?) is upper semicontinuous at any H ? V . The proof is therefore complete. ?  Proposition 3: Suppose that Problem (22) has an optimal solution, and that ?2i > 0 for all i. It holds that v  ? = p? .

The proof of Proposition 3 is similar to that of a duality result in robust optimization [52, Th. 4.1]3 and is given as follows:  Proof of Proposition 3: Proposition 3 is a consequence of the following simplified version of Sion?s minimax theorem.

Fact 6 (Sion?s Minimax Theorem [53], [54]): Let X , Y be subsets of a finite-dimensional Euclidean space and f(?, ?) be a real-valued function on X ? Y . If  1) X is convex and compact, Y is convex, 2) f(?,y) is lower semicontinuous and convex for each y ?  Y , and 3) f(x, ?) is upper semicontinuous and concave for each  x ? X , 3The result in [52, Th. 4.1] shows a relation called ?primal worst equals  dual best.? Simply speaking, it shows that for a certain class of robust convex optimization problems, the optimal value is equivalent to that of another problem for optimistic dual maximization.

MA et al.: UNRAVELING THE RANK-ONE SOLUTION MYSTERY OF ROBUST MISO DOWNLINK TRANSMIT OPTIMIZATION 1917  then  min x?X  sup y?Y  f(x,y) = sup y?Y  min x?X  f(x,y).

Now, define  f(W ,?,H) = K?  i=1  Tr(W i) + K?  i=1  ?i?i(W ,H i),  where W ? S, ? ? 0, and H ? V . Observe that f is affine (and thus continuous and both convex and concave) either in W , in ?, or in H. Using the above function, the Lagrangian function of Problem (22) can be written as  L(W ,?) = sup H?V  f(W ,?,H).

Note that L is convex lower semicontinuous in W and affine in ?, respectively (cf. Fact 5(a) for the lower semicontinuity of L). Let S? = {W ? S | ?i Tr(W i) ? R} for some R > v? , and replace S in Problems (22) and (24) by S?, which is without loss of generality. From the fact that the optimal values of Problems (22) and (24) equal  v? = min W?S?  sup ??0  L(W ,?), p(H) = min W?S?  sup ??0  f(W ,?,H),  respectively, we have the following chain of equalities:  v? = sup ??0  min W?S?  L(W ,?) (26a)  = sup ??0  sup H?V  min W?S?  f(W ,?,H) (26b)  = sup H?V  sup ??0  min W?S?  f(W ,?,H) (26c)  = sup H?V  min W?S?  sup ??0  f(W ,?,H) (26d)  = sup H?V  p(H) = p? , (26e)  where (26a), (26b), and (26d) are all due to Sion?s minimax theorem.4 Note that in achieving the above equalities, we have also used the fact that S? is convex compact and V is convex. ?  C. Discussion: A Duality Relationship Revealed in the Part-One Proof  Before we move to the second part of the proof, let us discuss a relationship revealed in the proof in the last subsection. For convenience, we summarize the main points as a theorem.

Theorem 2: Suppose that Problem (2) has an optimal solu- tion, and that ?2i > 0 for all i. The following equality holds for the equivalent representation of Problem (2) in (22):  min W?S  ?  i  Tr(W i) = maxH?V min W?S  ?  i  Tr(W i)  s.t. max H i ?Vi  ?i(W ,H i) ? 0, s.t. ?i(W ,H i) ? 0, for all i for all i  (27)  4One can also obtain (26a) and (26d) by strong duality in convex optimization, say, under Slater?s condition. However, (26b) requires Sion?s result.

Moreover, an optimal solution W? to the problem on the left- hand side (LHS) of (27) corresponds to an optimal maximin solution to the problem on the right-hand side (RHS) of (27); i.e., there exists an H? such that (H? ,W?) is a maximin solution to the problem on the RHS of (27).

Note that Theorem 2 is a consequence of Propositions 2 and 3. The equality in (27) shows strong physical meaning?the robust rate-constrained problem is equivalent, in terms of the optimal value, to a problem where we solve the fixed-channel rate-constrained problems for all (semidefinite-relaxed) channel possibilities H ? V , and then select the one whose minimal total transmit power (w.r.t. W) is the worst (w.r.t. H).

It is worth noting that in proving the duality result (27), we require each channel region Vi to be convex compact only. The specific structures of Vi have not been used yet. As we will see, this will give us advantages when we extend our result.

While appealing in implications, the duality result (27) still does not lead to the desired rank-one result. Let us discuss this issue by listing the following facts:  1) Given an optimal solution W? to the problem on the LHS of (27), there exists an H? such that (H? ,W?) is a maximin solution to the problem on the RHS of (27).

2) By SDP rank reduction (e.g., Fact 1), every inner problem on the RHS of (27) has a rank-one solution. Thus, there exists a maximin solution (H?,W ?) to the problem on the RHS of (27) such that W ? has rank-one.

From the above facts, one would be tempted to think that the rank-one result should be within grasp. Unfortunately, there is a gap. While the inner problem on the RHS of (27) admits a rank-one solution W ?, it may have more than one solution.

Indeed, it is possible that a higher-rank W ? exists and is also a solution to the inner problem. Consequently, we are unable to tell whether the solution W? to the problem on the LHS of (27) is a rank-one solution W ? to the inner problem on the RHS of (27). The only exception is when every solution to the inner problem on the RHS of (27) is of rank one? that is the direction we will pursue in the second part of the proof.

Remark 2: As a more technical question, one may wonder why we use the equivalent SDR representation of the robust problem, Problem (22), to perform analysis. Instead, why not use the original problem (2), which is more direct? In fact, we can also do that, and except for one specific point, all the arguments in the last subsection apply. Let us summarize the result.

Corollary 1: Suppose that Problem (2) has an optimal so- lution, and that ?i > 0 for all i. Then, the following inequality holds:  min W?S  ?  i  Tr(W i) ? max hi ?Ui ?i  min W?S  ?  i  Tr(W i)  s.t. max hi ?Ui  ?i(W ,hi) ? 0, s.t. ?i(W ,hi) ? 0, for all i for all i  (28)  Furthermore, for instances where equality in (28) holds, any optimal solution to Problem (2) must be of rank one.

Proof of Corollary 1: Since the proof is similar to that in the last subsection, we only describe the key steps. Let F = [h1 , . . . ,hK ]. By replacing p(H) with  p(F ) = min W?S  K?  i=1 Tr(W i)  s.t. ?i(W ,hi) ? 0, i = 1, . . . ,K and V with U = U1 ? ? ? ? ? UK , it can be shown that v? ? p? ? supF?U p(F ). Proposition 2 can also be shown to be applicable?i.e., 1) p? is attained; 2) if v? = p?, then an optimal solution W? to the problem on the LHS of (28) corresponds an optimal maximin solution to the problem on the RHS of (28).

Moreover, by Fact 3, any optimal solution to the inner problem on the RHS of (28) must be of rank one. Thus, if v? = p?, then W? must be of rank one. The proof is complete. ?  Note that in the proof above, the zero duality gap result in Proposition 2 is not applicable. The reason is that ?i(W ,hi) is non-concave in hi , which forbids us from using Sion?s minimax theorem at one specific point (cf. (26b)).

Corollary 1 leads to a curious question: Does equality in (28) hold for all problem instances? A positive answer to this question would imply a strong rank-one result. Unfortunately, we have the following negative result:  Proposition 4: There exist problem instances for which (28) holds with strict inequality.

The proof of Proposition 4 is relegated to Appendix C. Al- though we disprove the equality in (28) in general, Corollary 1 may be useful in that it enables one to tackle the rank-one analy- sis problem by studying conditions under which equality in (28) holds. We leave this as an open direction.

D. Proof of Theorem 1: Part Two  As discussed above, if we can prove that given any H ? V , the inner problem on the RHS of (27), recapitulated here as  min W  K?  i=1 Tr(W i)  s.t. Tr ( H i  ( ?i  W i ? ?  j 	=i W j  )) ? ?2i , i = 1, . . . ,K,  W 1 , . . . ,W K ? 0, (29) only admits rank-one solutions, then any solution to our main problem (2) must be of rank one. To study when this can happen, consider the channel set Vi in (21). Let  ?i = H i ? hihHi , i = 1, . . . ,K.

By a change of variable, we can equivalently characterize Vi as  Vi = {H i = hihHi + ?i ? HN |?i ? 0, hi ? CN , ?hi ? h?i?22 + Tr(?i) ? ?2i }.

Let us assume that  hi 	= 0, i = 1, . . . , K. (30)  With the above setting, we can apply the rank-one result in Fact 3: The solution to Problem (29) must be of rank one if  ??k ?k  Tr(?k ) < 1, k = 1, . . . ,K, (31)  where (??1 , . . . , ??K ) denotes the optimal solution to the dual of Problem (29), which appears in (13).

Since ??k does not have a closed-form solution, we wish to prove an analytically tractable bound on ??k . To this end, let us denote  ?i = ???ih?i?2 , ?i = ?  ?2i ? Tr(?i)  (recall that ??i is the orthogonal complement projector of [ h?1 , . . . , h?i?1 , h?i+1 , . . . , h?K ]). We have the following result:  Proposition 5: Consider Problem (29), where H i ? Vi , i = 1, . . . ,K. Let k ? {1, . . . , K} be given, and suppose that  ?i ? ?i ? ?i ?  ?i(K ? 1), for all i 	= k, (32a) ?k ? ?k > ?k  ? ?k (K ? 1). (32b)  Then, any feasible solution ? to the dual of Problem (29) (or any feasible solution to Problem (13)) satisfies  ?k ? K1 ?k  (?k ? ?k )2 ? (K ? 1)?2k . (33)  Proof of Proposition 5: First, consider the problem  max ?  ?k  s.t. I + ?  j 	=i ?jHj ? ?i?i H i ? 0, i = 1, . . . , K,  ?1 , . . . , ?K ? 0. (34)  Observe that the feasible set of Problem (34) is exactly the same as that of Problem (13). The dual of Problem (34) is  min W  K?  i=1 Tr(W i)  s.t. Tr ( H i  ( ?i  W i ? ?  j 	=i W j  )) ? 0, ?i 	= k,  Tr ( Hk  ( ?k  W k ? ?  j 	=k W j  )) ? 1,  W 1 , . . . ,W K ? 0. (35)  By SDP weak duality, given any feasible solutions ? and W to Problems (34) and (35), respectively, we have  ? i Tr(W i) ?  ?k .

Second, we construct a feasible solution to Problem (35) and  use its objective value to bound ?k . To be specific, choose  W i = ?uiuHi , ui = ??ih?i  ???ih?i?2 , i = 1, . . . , K,    MA et al.: UNRAVELING THE RANK-ONE SOLUTION MYSTERY OF ROBUST MISO DOWNLINK TRANSMIT OPTIMIZATION 1919  where ? > 0 is to be determined. Substituting the above W i?s into the linear constraints in (35), we get  Tr ( H i  ( ?i  W i ? ?  j 	=i W j  ))  = ? ? [  ?i  (? ????ih?i?2 + uHi ei  ? ?2 + uHi ?iui  )  ? ? j 	=i  (|uHj ei |2 + uHj ?iuj ) ]  , (36)  where ei = hi ? h?i . By noting that |uHj ei |2 ? ?uj?22?ei?22 ? ?2i ? Tr(?i) = ?2i and assuming ?i = ???ih?i?2 ? ?i , which is satisfied under (32), we have  |???ih?i?2 + uHi ei | ? ?i ? |uHi ei | ? ?i ? ?i, |uHj ei |2 + uHj ?iuj ? ?2i + Tr(?i) = ?2i .

By plugging the above inequalities and the inequality uHi ?iui ? 0 into (36), we further get  Tr ( H i  ( ?i  W i ? ?  j 	=i W j  ))  ? ? ? [  ?i  (?i ? ?i)2 ? (K ? 1)?2i ] .

From the above inequality and by the assumptions in (32), one can verify that W is feasible for Problem (35) if  ? = 1/ (  ?k  (?k ? ?k )2 ? (K ? 1)?2k )  .

Finally, by observing that ?  i Tr(W i) = ?K, we obtain (33).

The proof is complete. ?  Let us return to the sufficient condition in (31). Assume that (32) holds for all k. By Proposition 5, the LHS of (31) is bounded by  ??k ?k  Tr(?k ) ? K(? k ? ?2k )  (?k ? ?k )2 ? (K ? 1)?k?2k .

It follows that if  K(?2k ? ?2k ) (?k ? ?k )2 ? (K ? 1)?k?2k  < 1 (37)  for all 0 ? ?k ? ?k and k = 1, . . . ,K, then (31) will be satisfied for all H ? V and the desired rank-one result will be achieved.

Before we further analyze (37), we should mention that (37) implies (30) and (32). Hence, we no longer require (30) and (32) as far as satisfying (37) is concerned. The condition in (37) can be reorganized as  min 0??k ??k  [ (?k ? ?k )2 + K?2k  ] > K?2k + (K ? 1)?k?2k . (38)  It is easy to show that  min 0??k ??k  [ (?k ? ?k )2 + K?2k  ] ? min ?k ?R  [ (?k ? ?k )2 + K?2k  ]  = ?2kK  K + 1 .

From the above, we see that (38) is satisfied if  ?2k ? K + 1  K (K?2k + (K ? 1)?k?2k ). (39)  The above inequality is condition (8) in Theorem 1. Thus, we have completed the proof of Theorem 1. We should also mention a refined version of (38). It can be verified that  min 0??k ??k  [ (?k ? ?k )2 + K?2k  ]  =  { (?k ? ?k )2 + K?2k , ?k?k > K + 1, ? 2k K  K +1 , ?k ?k  ? K + 1.

Hence, if ?k/?k > K + 1, then we can replace (39) by  (?k ? ?k )2 ? (K ? 1)?k?2k .

The above condition leads to (11) in Remark 1.



V. APPLICATION TO OTHER CHANNEL ERROR MODELS  Our study in the previous sections has focused on the robust rate-constrained problem under spherically bounded channel errors. In this section we discuss how the main result can be applied to some other channel error models.

A. The Ellipsoidally Bounded Model  As a variant of the spherically bounded model, one can also consider the ellipsoidally bounded model [10], [11]  Ui = { hi ? CN | ?C?   i (hi ? h?i)?2 ? 1 }  , (40)  where Ci ? HN is given and positive definite, and C i denotes  the positive semidefinite square root of Ci . The ellipsoidally bounded model is useful when the base station has some prior knowledge of how the channel errors are spread in the correla- tion sense. Note that the ellipsoidally bounded model reduces to the spherically bounded model when Ci = ?2i I , and that the eigenvalues of Ci are the semi-axis lengths of the ellipsoidal region Ui . It has been shown that the corresponding robust rate- constrained problem can also be reformulated as an SDP by using the S-lemma; cf. (3) and see [10], [11] for details. More- over, we have the following result:  Corollary 2: Consider Problem (2) under the channel sets in (40). The rank-one result in Theorem 1 holds if (8) is replaced by  ???k h?k?22 ?max(Ck )  > 1 + K + (  K ? 1 K  )  ?k , k = 1, . . . ,K,  (41) where ?max(Ck ) denotes the largest eigenvalue of Ck .

The above corollary suggests that the impact of the ellipsoidally bounded model on the rank-one condition lies in the largest semi-axis length ?max(Ci) of the ellipsoids.

Proof of Corollary 2: The part-one proof of Theorem 1 in Section IV-B directly applies. The reason is that the semidefinite-relaxed channel sets Vi of Ui , given in this case as  Vi = {H i = hihHi + ?i |?i ? 0, hi ? CN ,  ?C? 12i (hi ? h?i)?22 + Tr(C?  i ?iC ? 12 i ) ? 1},  are only required to be convex and compact in the part-one proof.

For the part-two proof in Section IV-D, recall that Problem (2) is     guaranteed to admit a rank-one solution if the optimal solution to the fixed-channel rate-constrained problem in (29) must be of rank one for any H ? V . Let  V?i = {H i = hihHi + ?i |?i ? 0, hi ? CN , ?hi ? h?i?22 + Tr(?i) ? ?max(Ci)}.

It is easy to see that Vi ? V?i . Furthermore, from the part-two proof, it is immediate that (41) implies that the optimal solution to Problem (29) must be of rank one for any H ? V?1 ? ? ? ? ? V?K . Consequently, (41) also implies the same rank-one result for any H ? V , and the proof is complete. ?  B. A Modified Spherically Bounded Model for FDD  Consider a specialized model for limited channel feedback in the FDD system [55]. In this context, each user i is pre- assigned a channel direction codebook Ci = {vi,1 , . . . ,vi,L}, where every codebook element vi,l satisfies ?vi,l?2 = 1 and L is the codebook size. The user estimates the channel hi and feeds back two quantities to the base station, namely, the chan- nel norm ?hi?2 and the codebook-quantized channel direction v?i = arg maxv?Ci |hHi v|/?hi?2 . Consequently, the presumed channel is h?i = ?hi?2 ? v?i . If we assume that the channel di- rection quantization is the dominant source of error, then we may model the channel error ei = hi ? h?i as  ?h?i + ei?2 = ?h?i?2 , ?ei?2?h?i?2 ? ?,  where ? > 0 describes a bound on the channel direction quanti- zation error. The corresponding channel set Ui is Ui = {hi ? CN | ?hi ? h?i?2 ? ??h?i?2 , ?hi?2 = ?h?i?2}.

(42) For the above model, an extended form of the S-lemma can be established to deal with the corresponding robust rate- constrained problem [55]. With the extended S-lemma, we have the same development as in Section II-B. Again, our interest here lies in the rank-one condition.

Corollary 3: Consider Problem (2) under the channel sets in (42). The rank-one result in Theorem 1 holds if (8) is replaced by  ???k h?k?22 ?2  > 1 + K + (  K ? 1 K  )  ?k , k = 1, . . . ,K,  (43) where h?i = h?i/?h?i?2 , and ??i is the orthogonal complement projector of [ h?1 , . . . , h?i?1 , h?i+1 , . . . , h?K ].

We should note that h?i in the above corollary is the channel direction, and following the aforementioned system model h?i lies in the codebook; viz. h?i = v?i ? Ci . Corollary 3 suggests that if the chosen codebook elements v?i among different users are not too similar, and if the codebook resolution is high so that ? is small, then the rank-one condition can be achieved. Also, unlike the result for the spherically bounded model, the rank- one condition in (43) does not depend on the channel magnitude ?h?i?22 .

The proof of Corollary 3 is omitted for brevity, since it is similar to, and in fact fundamentally no different from, the proof  of Theorem 1. Simply speaking, we utilize the fact that the channel set Ui in (42) is spherically bounded and apply the same argument as in our previous proof to obtain the rank-one result. In the proof, the only point that needs some attention is to show that the SDR representation of the robust constraints in Problem (22) is tight; i.e.,  max hi ?Ui  ?i(W ,hi) = max H i ?Vi  ?i(W ,H i),  where Vi is the semidefinite-relaxed counterpart of Ui in (42).

Since Ui in (42) is defined by two quadratic constraints, it can be verified using Fact 4 that the above equality holds.

C. The Box Bounded Model  Now, let us consider the box bounded model  Ui = {hi ? CN | |?hi ? h?i?? ? ?i}, (44) where the channel error is modeled as being elementwise- bounded by some given ?i > 0. This model may be useful when the channel is scalar-quantized and fed back to the base station.

In this case the SDR representation of the robust constraints is no longer tight; i.e., we only have  max hi ?Ui  ?i(W ,hi) ? max H i ?Vi  ?i(W ,H i),  where Vi = {H i ? HN |H i ? hihHi ,hi ? CN , [H i ]jj ? 2Re ([h?i ]?j [hi ]j ) + |[h?i ]j |2 ? ?2i , j = 1, . . . , N}, in general. How- ever, Problem (22), recapitulated here as  min W?S  K?  i=1 Tr(W i) (45a)  s.t. max H i ?Vi  ?i(W ,H i) ? 0, i = 1, . . . , K, (45b)  is still useful as a safe approximation; i.e., any feasible solution to Problem (45) is also feasible for the original problem (2).

Like the previous cases, Problem (45) can be efficiently solved.

By considering the dual of the problem on the LHS of (45b) and exploiting zero duality gap, it can be shown that the constraints in (45b) are equivalent to  ti ? 0, [  Qi + Diag(ti) ri rHi si ? ?2i 1T ti  ]  ? 0, i = 1, . . . ,K,  where, as before, we have Qi = ?i  W i ? ?  j 	=i W j , ri =  Qih?i , si = h? H i Qih?i ? ?2i . Hence, Problem (45) can be rewrit-  ten as an SDP, and once again, its solution can be efficiently computed via conic optimization software.

The rank-one result for the box bounded model is as follows:  Corollary 4: Consider Problem (45), which is a safe ap- proximation of Problem (2) under the channel sets in (44). The rank-one result in Theorem 1 holds if (8) is replaced by  ???k h?k?22 N?2  > 1 + K + (  K ? 1 K  )  ?k , k = 1, . . . ,K.

Again, we shall omit the proof of Corollary 4 for brevity. The intuitive idea behind the proof is nothing more than applying the implication ?hi ? h?i?? ? ?i =? ?hi ? h?i?2 ?  ? N?i .

MA et al.: UNRAVELING THE RANK-ONE SOLUTION MYSTERY OF ROBUST MISO DOWNLINK TRANSMIT OPTIMIZATION 1921

VI. CONCLUSION  In this paper we provided a rank-one solution analysis for a robust multiuser MISO transmit optimization problem. Our re- sult suggested that under some practically reasonable condition, the robust problem is guaranteed to admit a rank-one solution.

Our analysis is based on a novel duality framework developed in this paper. The duality result reveals that the robust problem has a strong connection to another problem that takes a max- imin form, and through that connection we identified a sufficient condition under which the robust problem must have rank-one solutions. We also discussed how the duality result can be ap- plied to several other robust problems that use different channel error models. As a future direction, it would be interesting to investigate how the duality result can be extended to deal with a wider class of robust transmit optimization problems, such as the outage-based robust problems [20] and the multicell prob- lems [23].

APPENDIX  A. Proof of (9)  Let h?i = h?i/?h?i?2 . We have ???k h?k?2 = ?h?k?2 ? ???k h?k?2  = ?h?k?2 ? min x?CK ?1  ?F??kx ? h?k?2  ? ?h?k?2 ? min y?CK , yK =?1  ?F? y?2  ? ?h?k?2 ? min?y?2 =1 ?F? y?2 .

Since min?y?2 =1 ?F? y?2 = ?min(F? ) for tall or square F? , we obtain (9).

B. Proof of Proposition 1  Let Ek denote the event that the kth inequality of (8) is vio- lated; i.e.,  ???k h?k?22 ?2k  ? 1 + K + (  K ? 1 K  )  ?k .

Also, let E = ?Kk=1Ek , which is the event that the sufficient rank-one condition (8) in Theorem 1 is violated. Our problem is to prove an upper bound on Pr(E). By the union bound, we have  Pr(E) ? K?  k=1  Pr(Ek ). (46)  Let us focus on Pr(Ek ). Under the Gaussian distribution as- sumption in Proposition 1, it can be shown that  ???k h?k?22 = ?k  U2(N ?K +1) ,  where Ud denotes a standard chi-square random variable with d degrees of freedom; see [56, Ch. 8.3.1]. Moreover, it is known that  Pr(Ud ? ?d) ? ( ?e1??  ) d 2 , for any ? ? (0, 1);  see, e.g., [27, Proposition A.4]. Using the above two results, we get  Pr(Ek ) = Pr (  U2(N ?K +1) ? 2? k  ?k  [ 1 + K + (K ? 1K )?k  ] )  = Pr (  U2(N ?K +1) ? 2(N ? K + 1) ?kCURk  )  ? (  ?k CURk  e 1? ? kCURk  )N ?K +1 , for  ?k CURk  < 1.

By plugging the above inequality into (46) and using e1?? ? e for any ? ? (0, 1), we obtain the desired result.

C. Proof of Proposition 4  The proof is by construction. Recall the notation F? = [ h?1 , . . . , h?K ]. Throughout the proof, we shall assume that  F? H  F? = I, N ? K, (47a) ?21 = ? ? ? = ?2K ? ?2 , ?1 = ? ? ? = ?K ? ?, (47b) ?1 = ? ? ? = ?K ? ? < 1. (47c)  The proof is divided into four steps. In Step 1, we determine a condition on ?, ? under which Problem (2) has an optimal solution. In Steps 2?3, we prove bounds on the LHS and RHS of (28), respectively. In Step 4, we combine the results in the previous steps and identify a case where (28) has strict inequality for a particular setting of N,K, ?, ?.

Step 1: We show that Problem (2) has an optimal solution if  ? <  K ? 1 (  ? ? 1  )2 . (48)  Suppose that Problem (2) has a feasible solution W? . Since the optimal value v? of Problem (2) satisfies v? ??i Tr(W? i) < ?, we can write  v? = inf W?S  ?  i  Tr(W i)  s.t. (2b)-(2c), ?  i  Tr(W i) ? R,  where R < ? satisfies?i Tr(W? i) < R. Since the above prob- lem has a continuous objective function and a compact constraint set, the optimal value v? is attained.

Our next question is when Problem (2) is feasible. Let  W i = ?h?ih? H i , i = 1, . . . ,K,     where ? > 0 is to be determined. Putting the above W into the LHS of (2b), we see that  max hi ?Ui  ?i(W ,hi) = max?ei ?2 ?? ?i(W , h?i + ei) (49a)  = max ?ei ?2 ??  ?2 + ?  ?  ? ?  j 	=i |eHi h?j |2 ?  ? |1 + eHi h?i |2  ?  ? (49b)  ? ?2 + ? [  (K ? 1)?2 ? 1 ? |1 ? ?|2  ]  , (49c)  where (49b) is owing to (47a), and (49c) is obtained via standard vector inequalities. Suppose that (K ? 1)?2 ? 1? |1 ? ?|2 < 0, which can be easily verified to be equivalent to (48). Then, from (49c), we observe that the constraints in (2b) is satisfied if ? is sufficiently large. This implies that Problem (2) has a feasible solution if (48) holds.

Step 2: We show that the optimal value v? of Problem (2), or the problem on the LHS of (28), has a lower bound  v? ? K?  ?  ( 1 + ?2N  ) ? (K ? 1) ?2N  (50)  if 1? (1 + ?2  N ) ? (K ? 1) ?  N > 0. By the tight SDR representa- tion of the robust constraints in (21) and (22), we have  max hi ?Ui  ?i(W ,hi) = max H i ?Vi  ?i(W ,H i)  ? ?i(W , H? i) for any H? i ? Vi . (51) Let us choose H? i = h?ih?  H i +  ?2  N I , which can be verified to satisfy H i ? Vi . By letting ?i = Tr(W i) ? 0, we have  ?i(W , H? i) ? ?2 ? 1 ?  h? H i W ih?i +  ?2  N  ?  ? ?  j 	=i ?j ? 1  ? ?i  ?  ?  ? ?2 ? 1 ?  ?i + ?2  N  ?  ? ?  j 	=i ?j ? 1  ? ?i  ?  ? , (52)  where (52) is due to h? H i W ih?i ? ?h?i?22 ? Tr(W i) = Tr(W i).

Applying (51)?(52) to Problem (2) leads to the relaxation  v? ? min ??0  ?  i  ?i (53a)  s.t. ?2 + ?  N  ?  j 	=i ?j ? 1+  ? 2 N  ? ?i ? 0, i = 1, . . . ,K.

(53b)  It is easy to show that for 1? (1 + ?2  N ) ? (K ? 1) ?  N > 0, the optimal solution ?? to Problem (53) is5  ??i = ?2  ?  ( 1 + ?2N  ) ? (K ? 1) ?2N  , i = 1, . . . , K.

5Concisely, we have ??1 = ? ? ? = ??K because (53a) is Schur-convex and the constraints in (53b) do not depend on the ordering permutations of ?.

Consequently, we can reduce the problem to a single-variable problem, whose solution can be easily verified.

Substituting the above solution into (53), we obtain the lower bound in (50).

Step 3: Let d? denote the optimal value of the problem on the RHS of (28). We show that  d? ? K??  (1 ??K?)2 (54)  if 1 ??K? > 0. Let F = [h1 , . . . ,hK ] and d(F ) = min  W?S ?  i  Tr(W i)  s.t. ?i(W ,hi) ? 0, for all i (55)  be the optimal value of the inner problem on the RHS of (28).

Let  W i = ?uiuHi , ui = ?ihi  ??ihi?2 , i = 1, . . . , K, (56)  for some ? > 0, where ?i denotes the orthogonal comple- ment projector of F?i . It will be seen that ??ihi?2 > 0 if 1 ??K? > 0. Substituting (56) into (55) yields  d(F ) ? min ??0  K?  s.t. ?2 ? ?? ??ihi?22 ? 0, for all i.

(57)  Using the result in Appendix A, we have  ??ihi?2 ? ?min(F ). (58) Also, by writing F = F? + E with E = [e1 , . . . ,eK ] and ?ei?2 ? ? for all i, and denoting ?max(?) as the largest singular value of its argument, we obtain  ?min(F ) ? ?min(F? ) ? ?max(E) ? 1 ? ?  K?, (59)  where we have used the fact that ?max(E)2 ? Tr(EH E) and ?min(F? ) = 1 (see (47a)). Eqs. (58)?(59) imply that ??ihi?2 > 0 if 1 ??K? > 0. Furthermore, applying (58)?(59) to (57) and assuming 1 ??K? > 0 lead to  d(F ) ? min ??0  K?  s.t. ?2 ? ?? (1 ? ?  K?)2  = K??2  (1 ??K?)2 .

Thus, we have (54).

Step 4: We combine the results in the previous steps to obtain  the final result. Steps 2?3 reveal that if  K?2  ?  ( 1 + ?2N  ) ? (K ? 1) ?2N  > K??2  (1 ??K?)2 (60)  holds for some (N,K, ?, ?) such that 1? (1 + ?2  N ) ? (K ? 1) ?2  N > 0 and 1 ? ?  K? > 0, then v? > d? holds. Thus, our task is to construct such instances. Assume N ? K ? 5,  ? =  2N ?  K + 1 , ? ? 4NK   K ? 1 . (61)    MA et al.: UNRAVELING THE RANK-ONE SOLUTION MYSTERY OF ROBUST MISO DOWNLINK TRANSMIT OPTIMIZATION 1923  It can be verified that 1? (1 + ?2  N ) ? (K ? 1) ?  N > 0 and 1 ?? K? > 0. Also, the condition in (60) can be rewritten as  ? >  K ? 1(4N 2K ? C), (62)  where C = NK ? 2N?K ? 1; note that C > 0 for N ? K ? 5. Now, by choosing  ? =  K ? 1(4N 2K ? ?), (63)  for any 0 < ? < C, we see that (62) is satisfied. Hence, we have identified instances of (N,K, ?, ?) for which v? > d? .

We should also verify that the instances constructed above satisfy v? < ?. In Step 1, we showed that Problem (2) has an optimal solution, or v? < ?, if (48) holds. For the choice of ? in (61), it can be verified that (48) becomes  ? <  K ? 14N 2K.

As seen, the above condition is satisfied by the choice of ? in (63). The proof is complete.

