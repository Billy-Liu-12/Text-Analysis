FUZZY ASSOCIATION RULES FOR HANDLING CONTINUOUS ATTRIBUTES

ABSTRACT Association rules are frequently used for describing association (i.e., co-occurrence) among attribute values in the field of data mining. When an attribute is continuous (i.e., real-valued) such as height, length and weight, its domain is usually discretized into several intervals. Fuzzy rules are recognized as a convenient tool for handling continuous attributes in a human understandable manner.

When we use fuzzy rules, the domain of each continuous attribute is discretized into several fuzzy sets. A linguistic label is usually associated with each fuzzy set especially when linguistic interpretations of fuzzy rules are required.

In this paper, we first fuzzify the concept of association rules. That is, we show fuzzy versions of two measures (i.e., confidence and support) that are used for evaluating each association rule in the field of data mining. Then we illustrate these two measures of fuzzy rules for function approximation and pattem classification problems. Finally we examine the relation between the classification performance of fuzzy rules and the definition of their certainty grades through computer simulations. Simulation results show that the direct use of confidence as a certainty grade is not always appropriate from the viewpoint of classification performance.

1. INTRODUCTION  In the use of association rules [l], the domain of a continuous attribute is usually discretized into several intervals. As a result, such an attribute is handled as a discrete attribute. Fuzzy rules, which can be viewed as a kind of association rules, are recognized as a convenient tool for handling continuous attributes in a human understandable manner. When we use fuzzy rules, the domain of a continuous attribute is discretized into several fuzzy sets. A linguistic label (e.g., small, medium, and large) is usually associated with each fuzzy set especially when linguistic interpretations of fuzzy rules are required.

0-7803-7090-2/01/$10.00 0 2001 IEEE. . 118  In this paper, we first fuzzify the concept of association rules by extending the definitions of two measures (i.e., confidence and support) to the case of fuzzy rules. The number of samples (i.e., cases) in the original definitions is replaced with the sum of compatibility grades in the case of fuzzy rules. Our definitions are reduced to the original definitions when compatibility grades are non- fuzzy (i.e., 0 or 1). Then we illustrate these two measures of fuzzy rules for function approximation and pattem classification problems. Finally we examine the relation between the classification performance of fuzzy rules and the definition of their certainty grades through computer simulations on a real-world pattem classification problem.

Simulation results show that the direct use of confidence as a certainty grade is not always appropriate from the viewpoint of classification performance of fuzzy rules.

2. FUZZY ASSOCIATION RULES  2.1 Basic Definitions Let us assume that we have m cases XI, x2, ..., x,, each of which is described by n continuous attributes a1 , a2 , ..., a, as x p  = ( x p l , x p 2 ,  ..., x p n )  where x p i  is an attribute value (i.e., a real number) of the i-th attribute ai in the p-th case x p  , For simplicity of explanation, we assume that the domain of each attribute a i  has already been discretized into K intervals I i l  , I Q ,  ..., I i ~  .

We denote the set of the given m cases by D: D = {xl, x2, ..., x,} . Subsets of D can be defined based on the K intervals given for each attribute. Let D(I ik )  be the set of cases whose i-th attribute values are included in the k-th interval Iik for the i-th attribute ai :  D(Iik) = { x p  : xpi E I,, p = 1,2, ..., m }  . (1) When the domain of the i-th attribute ai is completely covered by the K disjoint intervals, the following relation holds:  ISIE 2001, Pusan, KOREA  mailto:ie.osakafu-u.ac.jp   where 1 . 1  denotes the cardinality (i.e., the number of elements in the set).

Let us consider a simple association rule: x i  E l i k a x j  E IJ,, where x, and xi are attribute values of the i-th and j-th attributes, respectively. The confidence c and the support s of this rule are defined as follows [ 11:  (3)  (4)  When the domain of each attribute is discretized into several fuzzy sets, we can extend the above definitions to the case of fuzzy association rules. Let us assume that K fuzzy sets Fil , 42, ..., & .are given for each attribute a i .  In this case, fuzzy subsets of D can be defined based on the K fuzzy sets given for each attribute. Let D ( 4 k ) be the fuzzy set of cases whose i-th attribute values are included in the k-th fuzzy set &k for the i-th attribute ai :  where p ~ , ~  (.) is the membership function of Ck .

As a natural extension of (3) and (4), the confidence c  and the support s of the fuzzy associahon rule x ,  E F,, x E FJh are defined as  (7)  In these definitions, the cardinality of a fuzzy set is defined by the sum of membership values as  and the intersection of two fuzzy sets is defined by the minimum operator A as  D ( F i k )  n D ( F ~ h ) (9)  = l ( j l ~ , ~ ( ~ p i ) ~ ~ ~ , ~  ( x p i ) ) / x p  : P = U ? . . . , ~ } .

It is also possible to define the intersechon of two fuzzy  sets by the product operator as  2.2 Function Approximation Problems Conventional fuzzy rules for approximation problems of n-input and single-output functions are written as  Rule R, : If x ,  is A,, and ... and x, is A,, then y is B,, (1 1)  where q is a rule index, A,, is an antecedent fuzzy set, and B, is a consequent fuzzy set. This fuzzy rule shows the association between the fuzzy input subspace A, = A,, x ... x A,, and the fuzzy output subspace B, .

Let us assume that we have m input-output pairs ( x , ,  y , )  , p=1,2 ,..., m where x, is an n-dimensional input vector (i.e., x ,  = ( x p l  ,..., x,,) ) and y, is the corresponding output value. In this case, the data set D consists of the m input-output pairs. In the same manner as in the previous subsection, the confidence c and the support s of the fuzzy rule in (1 1) are defined as  ID(AqI )  n ... n D(Aqn) n D(B, )I ID(AqI I n ... n D(Aqn )I  ID(A,, ) n ... n D(Aqn n w, )I ID1  C(A, * B , )  = > (12)  s(Aq 2 B , )  = 9 (13)  where D ( A , , )  and D(B,) are defined in the same manner as (9, and the intersection of multiple fuzzy sets is defined by the minimum operator or the product operator as in (9)-( 10).

2.3 Pattern Classification Problems Conventional fuzzy rules for n-dimensional pattern classification problems can be written as  Rule R, : If x1 is A,1 and ... and x, is A,, then Class C, , (14)  where C, is a non-fuzzy class label. This fuzzy rule shows the association between the fuzzy input subspace A,, x ... x A,, and the class C, .

Let us assume that we have m labeled pattems x ,  = (xpl ,..., x,,), p = 1,2 ,..., m . That is, a class label is associated with each of the m patterns. The data set D consists of the m labeled pattems. In the same manner as  119 ISIE 2001, Pusan, KOREA    in the previous subsection, the confidence c and the support s of the fuzzy rule in (14) are defined as  ID(Aq1 n ... n D(Aq, 1 n w, )I ID(AqI n ... n D(Aqn)I  . ID(Aq1 1 n ... n D(Aqn) n w, 11 ID1  C(A, = C,) = 9 (15)  S(A, 3 C,) = 1 (16)  where D(C,) is a non-fuzzy set defined as  D ( C q ) , = { x p  : x p  is Class C,, p=1,2 ,..., m}. (17)  3. PERFORMANCE OF FUZZY RULES  3.1 Pattern Classification using Fuzzy Rules As in our former studies [2-41, we use fuzzy rules of the following form for n-dimensional pattem classification problems:  Rule R,  : If is Aql and ... and x, is A,, then Class C, with CF, , (18)  where CF, is the certainty grade of the fuzzy rule R,  .

The antecedent part of each fuzzy rule is generated by  assigning a single antecedent fuzzy set to each attribute.

The corresponding consequent class is determined by calculating the confidence for each possible class. The class with the maximum confidence is chosen as the consequent class.

The confidence c(A,  z C,) can be used as the certainty grade of the corresponding fuzzy rule:  CF, = c(A, C,) . (19)  On the other hand, we used the following definition of the certainty grade in our former studies [2-41:  CF, = c ( A ,  *C,) - C, (20)  where  M  t=I t#Cq  C = C c ( A ,  s Class t)l(M - 1) . (21)  In this definition, M is the total number of classes. The definition in (20)-(21) can be easily understood if we consider a two-class pattem classification problem. In this case (i.e., M = 2  in (21)), the certainty grade CF, is calculated from (20)-(21) as  CF, = c(A, z Class 1) - c(Aq 3 Class 2) ,  CF, = c(A,  3 Class 2) - c(A, 3 Class 1) .

(22)  (23)  Let us denote a set of generated fuzzy rules by S. The rule set S is a fuzzy rule-based classification system. We employ a single winner method for classifying a new pattem x = (xl ,..., x,) by S. For each rule in S, we calculate the product of the compatibility and the certainty as pA (x ) .CF,  where pA (x) is defined as  or   PAq (X I  = PAg, (XI) A ...A PAq,, ( x , )  > (24)  or  The fuzzy rule with the maximum product is chosen as the winner rule for classifying the new pattem x .

3.2 Computer Simulations Through computer simulations, we compared two definitions of the certainty grade. One definition is the direct use of the confidence of each fuzzy rule as its certainty grade (see (19)). The other definition is based on  In our computer simulations, we used wine data, which are available from the UC Irvine database. The wine data set is a three-class pattem classification problem with 13 continuous attributes. For using the same antecedent fuzzy sets for all attributes, we normalized each attribute value into a real number in the unit interval [0, I]. Thus the wine data set was handled as a three-class pattem classification problem in the 13-dimensional unit hypercube [0, l f 3 .

The domain of each attribute (i.e., the unit interval [0, I]) was discretized into five triangular fuzzy sets as shown in Fig. 1. These fuzzy sets were used as antecedent fuzzy sets for generating fuzzy rules from numerical data. We only generated fuzzy rules with two conditions of the following form:  Rule R, : If xi is Agi and xi is Ad  (20)-(21).

then Class C, with CF, . (26) In addition to the case of five fuzzy sets in Fig. 1, we  also examined other situations where the domain of each attribute was divided into two, three, and four triangular fuzzy sets.

120 ISIE 2001, Pusan, KOREA    Membership m  Direct use of confidence  Definition in (2014211  Table 4. Classification rates on test data (min).

90.5 93.3 93.3 89.9  92.7 95.5 I 94.9 93.3  l . o ~  ~  0.0 0.0 1.0 -  Fig. 1. Discretization of the unit interval using five triangular fuzzy sets. Each fuzzy set can be interpreted as S: small, MS: medium small, M: medium, ML: medium  large, and L: large.

Simulation results are summarized in Table 1 and Table 2 where the product operation in (10) and (25) was used for calculating the compatibility grade of each pattem to the antecedent part of each fuzzy rule. In Table 1, all the given patterns in the wine data were used for generating fuzzy rules and calculating the classification rate on training data. On the other hand, the leaving-one- out (LV1) technique was used for calculating the classification rate on test data in Table 2. We also examined the minimum operation in (9) and (24).

Simulation results are summarized in Table 3 and Table 4.

Simulation results in Table 1 - Table 4 suggest that the direct use of the confidence is not always appropriate from the viewpoint of classification performance.

Table 1. Classification rates on training data (product).

1 Numberoffuzzysets I 2 I 3 I 4 I 5 I I Direct use of confidence1 90.4 I 94.9 I 96.6 I 94.4 I I Definition in (20)-(21) I 94.9 I 96.6 I 97.2 I 97.2 I  Table 2. Classification rates on test data (product).

I Numberoffuzzysets I 2 I 3 I 4 I 5 I  Table 3. Classification rates on training data (min).

Number of fuzzy sets  Direct use of confidence  Definition in (20)-(21)   86.5  77.5 - -  - 3 1 4 1 5 1  4. CONCLUSION  In this paper, we first fuzzified the concept of association rules that are frequently used in the field of data mining.

That is, we extended the definitions of two measures (i.e., confidence and support) to the case where the domain of each continuous attribute is discretized into several fuzzy sets. Then the two measures were illustrated for fuzzy rules used in function approximation problems and pattem classification problems. Finally we examined the relation between the classification performance of fuzzy rules and the specification of their certainty grades through computer simulations. Simulation results suggested that the direct use of the confidence as the certainty grade is not always appropriate from the viewpoint of classification performance of fuzzy rules.

