An Efficient Framework For Intrusion Detection Based on Data Mining

Abstract-A multi-layer intrusion detection framework is are many essential requirements of IDS such as accuracy, proposed in this paper. Comparing to the traditional system, the adaptability, extensibility, efficiency, etc. Accuracy means that framework has sourcesfrom all the respects of host computer and IDS doesn't issue false alarms when there are changes in the network, and calculates connecting volume for each active normal system behavior and doesn't mistake the normal connection, thus only the suspicious connections would be * * * * * -- analyzed, more than 80% packets are normal, and don't need behavior fretsio behavior etc.aIsnextensibilit n processing, influence to the system speed is very littlea All the aptility aewasoec rit y network compution information of the host computer is combined to a union, and the environment. New system security holes and imtrusion properties are expanded and enhancedfor the data mining engine, methods are continuously being discovered, so it's imperative so the mining process is efficient and accurate. Fuzzy mining also that IDSs be update frequently and timely. IDS relied on the be used in intrusion detecting and rule sets comparing. The system builder's hand code, intuition and experience are out of framework provides abilities of detection, report and response. fashion, and their updates are expensive and slow. Speed is Experimental results show the rapidness and accuracy of the another standard of IDS; it runs the faster the better.

proposedframework. By amending the algorithm of data mining is not the best  way to improve the speed and accuracy of IDS system. The more appreciate thing is how to find suspicious connection  I. INTRODUCTION immediately and make a quick evaluation.

In order to meet these requirements, a new framework is  Intrusion detection can be defined as identifying designed.

unauthorized use, misuse, and abuse of computer system by both inside and outside intruders. Intrusion detection System II. SYSTEM ARCHITECTURE (IDS) can be categorized into anomaly detection and misuse detection [1]. Anomaly detection systems assume that an A Introduction of The Main Layers intrusion should deviate the system behavior from its normal The framework consists of 5 main layers as bellow: pattern. Misuse detection systems assume that an intrusion can Data source layer: In other IDS, data mining uses only the be detected by matching the current activity with a set of basic properties of traffic packets such as timestamp, source intrusion patterns. and destination IP, service type, packet size, etc. In fact, this  After decades of development, data mining technology is kind of mining neglected the relationship between the net successfully used in intrusion detection system. traffic packets and the state ofhost computer, it can't find rulesAssociation rule mining is very important data min'nmg between host state and net links no matter how many effortstechnique. A typical example of an association rule mined had been made, some other properties should be expanded into from audit data can be ftp->get [0.4,0. 1], witch implies 40% of the mining process.

the time when the user use ftp command, get command is also Misuse detecting layer: this layer can detect known invoked and doing so constitutes 10% of the command issued intrusion by comparing the activities with the intrusion by the user. Rakesh Agrawal and Ramakrishnan Srikant [2] patters in knowledge database with high speed and accuracy.

use apriori algorithm to mine association rules. It needs a regularly updated pattern database very much. The  W. Lee, SJ Stolfo andKW Mok [3] utilized association rule layer consists of system log miner, protocol analyzer and mining and frequent episode mining to mine rules from system corresponding knowledge database, the knowledge database is audit data to form a normal profile. partly the trained result with DARPA2000 data sets, and it canPartitioning quantitative audit data into intervals may cause be maintained by the IDC too. The biggest data source of sharp boundary problem during mining. Tow adjacent data values may be mined as two different types (normal/abnormal)inrsodectnisetpkt,tomrveheeangpe,protocol analyzer can decode the traffic packets in different for having different support values. Consequently, an intrusive depth, such as no decoding, head decoding, middle decoding pattern with a small variance may remain undetected. To over a c dcIng. t dcI wa ne differen come this problem, fuzzy data mining was employed fortieadgtifrntnomto,i'sctoldbyheIC intrusion detection in [4] where quantitative features are categorized into categories having fuzzy membership values.

After studying the existing work repeatedly, we found, there  1-4244-0020-1/05/$20.OO a2005 IEEE 1 of 4    Connecting volume can be designed to describe the degree of threaten. Fig.2 can be used to explain the model.

DU Eng-ine 1 The structure of the tree is explained as following: When a new connection is found, with the help ofkeyboard  Data  _ 1 :0& mouse monitor, it's easy to know whether the connection '_warehouse, cojlce:flrateen being started by user or not, if a automatic connection without  interface window makes system changes or send packets by stealth. it may be started by virus, spy ware or Trojan, it's very dangerous. But an automatic connection with an active window is usually such content as auto-updating, software  L 9-P-o=--c--| registration, etc. there isn't too much threat.

Mining patr PatteruJ)B anlyer No  .oftIC t lull  ititelctkavI keyboaxAd & [viia~yj [mnai sys~~~~~~~~~~~~~~rternlg|IhrCprocelss mNous pac'age  extmctor monitor moitor capur  Fig. 1. Main structure ofthe framework Nntce N\w proEss No procsl  Data combining layer: It is responsible for combining all Chango Change Senfding Sierundinrg the related information from different data sources to a data yS % S k ige Pka=gs warehouse, which has more describing, more accurate and more properties. This layer also do a good job of data preprocessing, so the data can easily be organized with such A user started connection can start a new process too, if the themes as time, connecting, the host computer, machine process revises the systematic sensitive range and hasn't abehavior, etc. it is very convenient to the data mining engme. visible interface, It may be that hostile websites are Anomaly detecting layer: It's in charge of detecting  apropagating spy ware or virus. If the process has a visiblecomplex or unknown intrusion. It's the core of the adaptive i. .-.- .- ..^1 . . . , ~mterface and don't change systematic range, it may be aIDS, the ability lies on the work of data mining engme, several advertise window, threaten not big.

types of algorithms are particularly relevant to intrusion The leafnode can be treated as an 8 bits binary number, thedetection, such as classification, Link analysis, sequence low 4 bits stand for the thresholds of the basic properties ofanalysis, etc. The layer also manages the knowledge database traffic packets, and the high 4 bits stand for the activities oftheby adding, updating and deleting the recorders of patterns. It connection.

also remember the user's treatment to the incidents, thus, the With the true or false ofthe leafnodes, the corresponding bit system can accumulate the ability to general intrusions. It's should be 1 or 0. The result is just the connecting volume of impossible to do a real-time mining when the amount of the connection. The IDC use the connecting volume to classifyrecorders in the data warehouse grows too large, so the layer the connections and control the sub layers to give an must be responsible for compressing and classifying the data according to certain rule and combine the result to a aporaetetetaccording ,certain rule and combine the resulttoa In fact, 95%0 of user-started connections have very lowconcentrated database, and then the concentrated database and connecting volume; IDS shouldn't pay much attention to them.the reduced data warehouse act as better data source ofthe DM SasSo the IDS has abundant resource to deal with the 5?/ engme.

Intrusion Detection Control Center: It is the commander of IDS, namely IDC. It runs with the reports from alert C Dat Mini generator, misuse detecting layer, anomaly detecting layer and Daa mining, , . . . ' , . ,, ,deermin Data minig iS a process to find the relationships in data,judge the systematic situation synthetically, about forty properties can be extract from a TCP packet, andwhether to produce a alert or not. It also adjusts the working we begin by extracting the following fields from each TCPparameter of the sub layer, making them work at the balance header.

point of speed and accuracy. Source IP address (src).

B. Connecting Volume Destination IP address (dest).Source port number (Sport).A computer may have many connections at the same time, De port number (Dport).usually~~~~~~~~~~~~~aninruiodeeto'ytmms elwt vre Destination port number (Dport).usually an intrusion detection system must deal with every net TCP Control bits (tcp flag. E.g. SYN, ACK, Push, FIN, traffic packets, with the limitation of the resource of hardware Rest) and bandwidth, and IDS can't consume too much resource of Dt egh the host computer. System speed and accuracy are great Tedt n ietepce a et contradictions of the couple. So it'S better for IDS to deal with h aacmiiglyrcmie h olwn the connections of higher threaten at first.

2 of 4    information with the basic properties to form a new record: discharged directly to maximum the bandwidth of network Process name. and maximum the ability of detecting intrusion of IDS.

Have a active interface or not Started by (user or other process) III. IMPLEMENTAL RESULTS Start other link or process Make system changes or not We partly use the DARPA 1999-2000 intrusion detection Data and time evaluation data set to train our program and generate a mode  We then apply a simple mining technology to create an database. It provided a standard corpus for evaluating aggregate key composed of src, dest and dport; this new field intrusion detection systems. It also introduced more stealthy is called SDP. The SDP is improved to be one of the most attacks, insider attacks, and attacks against the Windows NT important information extracted from TCP packet. operating system. Any one can download it from  Till now, the data preprocessing is succeeded. The mining http://www.1lmitedu/IST/ideval/data/data index. html. Four engine makes association mining, sequence analysis or main categories of attacks were simulated, they are: characteristic string analysis with them, For example: a rule DOS, denial-of-service, for example, ping-of-death, for detecting spy ware is: teardrop, smurf, syn flood, etc.,  If (started automatically and start other links or processes R2L, unauthorized access from a remote machine, for and make system changes) then AD Ware=high. example, guessing password,  U2R, unauthorized access to local super user privileges D. Patterns Comparing and Maintenance ofthe Knowledge by a local unprivileged user, for example, various of Database buffer overflow attacks,  Connections with big connecting volume need to be PROBING, surveillance and probing, for example, analyzed, at the end of data mining process; the result should port-scan, ping-sweep, etc.

be compared with the intrusion models in the knowledge A sanitizing program, downloaded from http:// database. The new mined rule set may be not the same with the ita.ee.lbl.gov/html/contrib/sanitize.html, was modified to patterns in the knowledge database, we can get some hints to extract the TCPDump binary packet. Net Tracker also proved avoid the sharp boundary problem in ref. [5], we can judge to be a useful program for analyzing attack signatures in whether they are intrusion or not by the following formulas. network traffic. Net Tracker takes, as input, a TCPDump file Given the association rules: RI : X -X Y, C,S , and reassembles the data into transcripts. The transcripts are ]?2 :X->YI,c',sv ,where X,Y,X'and Y' are fuzzy item ASCII text records of what occurred during each TCP session.

sets, the similarity of these rules is given in(1). Each connection record includes these "intrinsic" features: its  0 RI R time, duration, service, src host, dsthost, src port, wrong similarity(RI,R2) =, 2 fragment (fragmentation error, e.g., fragment size is notLmax[O,I - dsitl2] R1 - R2 multiple of 8 bytes or the offsets are overlapped, etc.), flag  (1) (how the connection is established and terminated). Table 1 is dist =max Ic-c' |s-sl- 1 part of the data sets describing table, it shows when and who12 Lmax(c,c')' max(s, s') was trying to intrude the victim machine. By analyzing the  packets during the period, models of the attacking can be setGiventwo rule sets SI and S21 wecan define Sim as (2). up.

In order to see the effects of connecting volume, we setup 2  Sim E si milarity(R1,R2) (2) kinds of program at 2 groups of computers, group A uses VR2E SI connecting volume but group B doesn't. let the 2 groups  The toal simlarit is_ given in (3)establish the same connections to the LAN and Internet suchThe totl smiariyigvenin3as: downloading, web browsing, file transferring, e-mail similarity(S S  Sim *Sim (3) sending, chatting, etc. we also run some hacker tools at othersiilriy(1,S2)= *___ISI S21 computers to simulate the intrusion, Figure 3 shows the lSI , lS2 are the total number of rules inSand S2. amount of packets processed by group A and group B in one If the similarity goes below the threshold, the activities of hour, we can see clearly that with the help of connecting  the connection will be considered as normal otherwise will be volume, the IDS needs only to deal with the packets of considered as an intrusion. Suspicious connection. Table 2 shows the false alarm rate and If there is not a similar intrusion in the knowledge database accuracy rate of group A and B. we can see the result of group  and the connection has strong characters of intrusion such as A is much better than that of group B open new connection, make changes to the systematic range, TABLE 1 etc, a new type of intrusion should be added to the knowledge PART OF THE DATA SETS DESCRIBING TABLE database.

The URL of hostile web sites and excellent web sites are  recorded into a database, for the later rapid decision making process. Traffic packets of some credible web site should be  3 of 4    XD Date Start Time Destination Sa N IV Conclusion In this paper, we outline a data mining framework for  1 03 U8 1999 08:101 hume.eyrie.af.mi 1 NTinfoscan constructing intrusion detection system. The key idea is to 2 03 U8/1999 08:50:15 zeno.eyrie.at.mil 1 pod expand host state information to the basic properties of the  connections, and use the state describing fields to compute the3 Fo~U8I1999 69:39:16~max.yre.fm~ 1 bakconnecting volume of each connection. Depending on this 4 03 U8/1999 712:09:18 1pascaI.eyrie.amil 1 httptunnel parameter, suspicious connections are easily picked out, thus  much of the unnecessary calculation is omitted, and the IDS can work faster and with a high accuracy rate.

80 Experiments on DARPA 1999-2000 evaluation data show 160 that the framework works well, our future work includes 1ht40 researching some new algorithms and refining the existing 1t20 < ~ system.

100 - --Group A  Ao 80 |-e-I-grtoup Eill ACKNOWLEDGEMENT A 60  40 This paper is supported by national science and technology bureau of 20 China. (No. 2003EC000001)  1 2 3 4 5 6 REFERENCES processing time (Minute)  Fig.3. the amount of packets processed by group A and B with in 1 hour. [1] W. Lee, S.J. Stolfo, P.K. Chan et al, "Real time data mining-based intrusion detection," DARPA Information Survivability Conference &  TABLE 2 Exposition II, 2001. DISCEX '01. Proceedings, Vol: 1, pp. 89 - 100,  THE FALSE ALARM RATE AND ACCURACY RATE OF GROUP AAND GROUP B. June 2001.

Group A Group B [2] R. Agrawal, R. Srikant, "Fast Algorithms for Mining Association  Accuracy False Accuracy False Rules,"proc. VLDB'94, pp. 487-499, September 1994.

|DOS 96.3% 0.25% 90.1% 3.1% [3] W. Lee, S. J. Stolfo, K. W. Mok, "Mining Audit Data to Build.

R2L 94.7% 09.3%2 92.7% 1.2%1 Intrusion Detection Models," in Proc. KDD'98, pp. 66-72, AugustR2L 94.700 9.300 92.700 11.200 ~~~~~1998.

U2R 89.2%0 8.7%0 79.5%0 10.4%0 [4] J. X. Luo, S. M. Bridges, "Mining Fuzzy Association Rules and Fuzzy PROBING 83.2%0 13.1%0 76.2%0 31.2%0 Frequency Episodes For Intrusion Detection," International Journal of  Intelligent Systems, Vol. 15, No.8, pp. 687-730, 2000 [5] M. Hossain, S. M. Bridges, R. B. Vaughn, "Adaptive intrusion  Systems, Man and Cybernetics, Vol. 4, pp. 3097-3103, Oct. 2003.

