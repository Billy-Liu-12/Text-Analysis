Statistical Association Rules and Relevance Feedback: Powerful Allies  to Improve the Retrieval of Medical Images

Abstract This work aims at developing an efficient support to  improve the precision of medical image retrieval by content, introducing an approach that combines techniques of statistical association rule mining and relevance feedback. Low level features of shape and texture are extracted from images. Statistical association rules are used to select the most relevant features to discriminate the images, reducing the size of the feature vectors and eliminating noisy features that influence negatively the query results, making the whole process more efficient. Additionally, our approach uses a new relevance feedback technique to overcome the semantic gap that exists between low level features and the high level user interpretation of images. Experiments show that the combination of statistical association rule mining and the relevance feedback technique proposed here improve the precision of the query results up to 100%.

1. Introduction Content-based image retrieval (CBIR) techniques  and similarity search queries have been intensively researched in the last years [3]. CBIR techniques work on the whole information embodied into an image and are not restricted to a textual description of it. The reservation about textual descriptions is their inherent subjectivity, because the specialist can be, at the moment, concerned about specific aspects of the image under analysis and other important aspects may be left unreported.

CBIR uses image processing algorithms to extract relevant characteristics (features) from the images, organizing them in feature vectors. The feature vectors are employed in place of the images allowing fast and efficient indexing and retrieval. Features quantify the intrinsic visual characteristics of images, such as color, shape and texture [13], leading to vectors with hundreds or even thousands of elements. Contrarily to what one would think, having a large number of features can be a problem. As the number of the extracted features grows, indexing, retrieving, comparing and analyzing the images become much more time consuming [1, 8]. In many situations, a large number of features are correlated, so they do not bring new information about the images and do not improve the ability to discriminate them. A large number of features leads CBIR-based systems to face the  "dimensionality curse" problem [1]. Beyer in [7] proved that increasing the number of features (and consequently the dimensionality of the data) leads to losing the significance of each feature. Thus, to avoid decreasing the discrimination accuracy, it is important to keep the number of features as low as possible, establishing a tradeoff between the discrimination power and the feature vector size.

Users of CBIR systems have different perceptions of image similarity, frequently feeling unsatisfied with query results. This is due to an inconsistence between low level features and the high level user interpretation, which is called semantic gap. One of the major challenges of CBIR is the development of image representation methods that complies with the human perception subjectivity. An essential approach to overcome the semantic gap is introducing the users in the process, having them interacting and telling what is really relevant from the images being retrieved and analyzed. The relevance feedback (RF) approach asks the user to quantify the relevance of the images retrieved by a query, allowing automatic adjust of future queries. It has been proven that RF is quite effective in bridging the semantic gap [10].

In this paper, we propose a method that deals with two critical problems of CBIR systems: (a) the large number of features that leads to the "dimensionality curse" problem, and (b) the semantic gap existing between the user interpretation and low level features.

The first problem is handled applying statistical association rule mining to the feature vectors to find the most relevant features to discriminate images. The second problem is handled using an efficient technique of relevance feedback that chooses the most relevant features to change the similarity function and the query placement. Experiments performed show that the proposed method improves the query precision up to 100%. Moreover, the method is efficient, since the complexity of the query processing decreases along the dimensionality reduction of the feature vector.

The remainder of this paper is structured as follows.

Section 2 summarizes the concepts and related works needed to understand our method. Section 3 presents the proposed method, and Section 4 discusses the experiments and results achieved with the developed method. Finally, Section 5 presents the conclusions of this work.

Proceedings of the 19th IEEE Symposium on Computer-Based Medical Systems (CBMS'06)    2. Background and Techniques  2.1 Feature Selection through Statistical Association Rule Mining  Image mining and CBIR are closely related as both of them rely on features extracted from images.

Association rule mining [2] is one of the most investigated areas in data mining and knowledge discovery. It was initially motivated by business applications, such as catalog design, store layout, and customer categorization [5]. However, finding associations has also been widely used in many other applications, such as data classification and summarization [4, 14].

The main image features regarding a specific criterion are organized in feature vectors, which describe the images quantitatively. Thus, a suitable approach to find association rules should consider quantitative data, instead of nominal data, as performed by the main association rule algorithms. In this work we broaden the applicability of the StARMiner algorithm [11], which extends the statistical rule mining techniques presented in [6] to find patterns on images. The goal of StARMiner is to find statistical rules involving attributes that best discriminate images into categorical classes. A rule has the format x Ai and it is identified only if the following conditions are satisfied:  ? The behavior of attribute Ai in images of category x must be different from its behavior in images of other categories.

? The attribute Ai must present a uniform behavior in images of category x.

The previous conditions are implemented in the StARMiner algorithm incorporating interesting restrictions in the mining process. Let T be a database of medical images, x an image category, Tx T the subset of images of category x and Ai a feature. The restrictions of interest implemented in StARMiner algorithm are:  1) |AvgAi(Tx) ? AvgAi(T-Tx)| mindif , where: AvgAi(Z) is the average of Ai values in the Z  subset of images; mindif is the input parameter that indicates the  minimum allowed difference between the average of Ai in images of category x and the average of Ai in the remaining images of the database.

2) Hypothesis test. H0 should be rejected with a confidence equal or greater than minconf, with:  H0: AvgAi(Tx) = AvgAi(T-Tx) H1: AvgAi(Tx) AvgAi(T-Tx)  where: minconf is the input parameter that indicates the minimum confidence to reject the H0 hypothesis.

3) Ai(Tx) maxstd, where: Ai(Tx) is the standard deviation of feature Ai  values in the subset of images Tx; maxstd is the input parameter that indicates the  maximum standard deviation of Ai values allowed in images of category x.

The StARMiner algorithm identifies the features with the highest discrimination power, since they have a particular and uniform behavior in images of a given category. This is important, because the features presenting uniform behavior to every image in the dataset, independently of the image category, do not contribute to categorize them, and should be eliminated.

2.2 Relevance Feedback techniques  Relevance feedback (RF) aims at learning from the users what they understand as relevant/irrelevant, considering their perceptual notion of similarity. By including the human subjectivity in the retrieval process, RF can take advantage of the domain specialist knowledge to increase the applicability of CBIR systems, while dealing with the semantic gap.

During the RF interaction cycles, users are asked to grade the retrieved images by their relevance to a given query. Such grades are translated in weights, that increase/decrease the contribution of the most/least influential attributes concerning the users? view. The weights are updated during RF iterations.

The results ?correct? by the user?s view are set as positive examples (and weighed accordingly), and the same happens with incorrect results, which are set as negative examples. The weighing given by the positive images improves the precision of the query answer, but unfortunately it has a limited contribution, as after a number of iterations the maximum gain is reached (saturates), and the results cannot be further improved by the sole use of this technique. The negative images have a great potential of improving the results and reducing the semantic gap. This is due to the fact that the irrelevant images returned show the ones to be discharged from the image result set.

In this paper, we take advantage of a new RF technique called Multiple Point Projection, which allies the assurance of increasing the precision for a CBIR query given by the positive images, with the power of changing the query given by the negative ones. In addition, this technique is benefited by the query center relocation and the use of multiple query centers, considering the relevant objects returned by the original query, as we will explain following.

Proceedings of the 19th IEEE Symposium on Computer-Based Medical Systems (CBMS'06)    Multiple Point Projection RF (MPP-RF) When the user poses a similarity query q, this  technique gets the initial results from q and process a query centered at each object (image) selected as relevant (Ri) by the user. An additional object (phantom) is generated, using weights regarding relevant and irrelevant objects, which are set by the user at the first interaction. The phantom object is generated by the RF Projection technique (see [12]).

A query is posed considering the phantom as the center of it. Thus, if there are r objects selected as relevant, there will be r+1 query centers.

After obtaining the r+1 new query centers, the original query is re-executed for these new centers.

Each query i obtains the results Oi. Let O be the union of Oi, where i = 1?r+1. A new combined distance is computed based on the distance between the resulting set and the corresponding query center, which are the selected relevant images Ri and the phantom. In addition, the new distance considering the relevance weights defined by the user during the RF iteration and the original distances from each relevant object (Ri) to the initial query center Q is calculated. The objects with the smallest new distance values are returned as the result of the query. Equation (1) shows the new distance.

i  i i  i i  i  dist  distd  weight weightdd         (1)  where d is the distance from object Oij to the query center of Oi; weighti refers to the weight of the relevant object Ri given by the user, disti is the original distance between the relevant object Ri to the original query center, and d? is the combined distance between each resulting object Oij Oi to the original query center.

Figure 1 summarizes this technique.

Figure 1. The steps of the technique MPP-RF  3. A New Method to Improve the Retrieval of Medical Images  Our new method deals with two inherent drawbacks of a CBIR system, the high dimensionality of feature vectors, and the semantic gap. We amend the first  restriction by selecting the most relevant image features through association rule mining, and the second one by employing the new relevance feedback technique  MPP-RF.

The proposed method is illustrated in Figure 2 and is applied in three steps, as follows.

Step 1: Feature Extraction: In Step 1, low level features of texture, shape and  color are automatic extracted from the images. The feature vectors are indexed in place of the images to allow efficient indexing and image retrieval.

Step 2: Feature Selection: Image features are high dimensional vectors, what  make the process of indexing and retrieval of images much time consuming and decrease the precision of the query results. Thus, selecting the most relevant features to discriminate images and eliminating the irrelevant ones speeds up and improves the results.

The StARMiner algorithm is applied in Step 2, to process the set of feature vectors obtained in Step 1, using the previously known class of each image.

StARMiner finds statistical association rules in the image features. The features most relevant to discriminate the images take part in the most confident rules mined by StARMiner algorithm. These features are used to reconstruct the feature vector.

Step 3: Improving the user satisfaction with Relevance Feedback  Step 3 uses the proposed Multiple Point Projection RF (MPP-RF) technique to improve the precision in image retrieval. When a user asks a query, the RF cycle starts. During a RF interaction cycle, the user is asked to grade the retrieved images by their relevance to answer the given query. Such grades are translated in weights. The user feedback information will increase/decrease the contribution of the most/least influential attributes concerning the users? view. Such  Figure 2. Method to improve the retrieval of medical images  Proceedings of the 19th IEEE Symposium on Computer-Based Medical Systems (CBMS'06)    information is also employed to define new query centers and to discard irrelevant images from the result set.

4. Datasets and Experiments  To evaluate the proposed method, we have employed the well-known approach based on the precision and recall (P&R) graphs obtained from the CBIR query results. Precision and recall are defined as:  TS TRSprecision  TR TRSrecall  where, TR = total of relevant images in the database; TRS = total of relevant images in the query result; TS = total of images in the query result.

Considering the size of the dataset, k-nearest neighbor (k-NN) queries were applied to the indexed image database. A k-NN query is a similarity search performed comparing the feature vectors using a distance function to quantify how close (or similar) is each pair of vectors. An example of a k-nearest neighbor query is: ?given the Thorax-XRay of John Doe (query center), find the 10 images most similar to it?.

As a rule of thumb on analyzing P&R curves, the closer is the curve to the top of the graph, the better is the retrieval technique. In the experiments, we have asked k-NN queries, considering k as the image base size and taking the queries centers randomly. The images in the query result were ordered by their similarity to the query center. We have firstly computed the graph without RF, using the original feature vector obtained in Step 1, and secondly using the reduced feature vector obtained in Step 2. The same process was repeated, but using the proposed RF technique. The dissimilarity function used in the experiments to measure the similarity between two images is a weighted Euclidean distance.

Experiment 1 ? The Mammography dataset The Mammography dataset consists of 89 images of  ROIs (Regions of Interest) comprising tumoral masses, taken from mammographies collected in a clinical hospital. The images are classified either as benign or malignant. The kinds of tumors are strongly related to the image shape: benign masses have well-defined smooth contours, while the malignant ones have the contours spread over the mammary parenchyma.

Setp 1 extracts the Zernike moments [9] from the Mammography dataset, which provide a precise mathematical model that captures the global shape of images. From each image the first 255 Zernike  moments were extracted, generating feature vectors with 255 elements.

In Step 2, the values from the feature vectors obtained in Step 1 were normalized and the StARMiner algorithm was applied selecting a set of 38 relevant features. StARMiner reached a reduction of 85% of the features used to represent the images. An example of rule obtained by StARMiner:  malign tumor  7th Zernike moment, indicating the importance of 7th Zernike moment in discriminating malign tumors.

To evaluate the impact of the number of feedback iterations and the evaluation given by the user in the query precision, Step 3 was executed in several configurations. The three more representative ones are shown in Figure 3. Analyzing the graphs of Figure 3, we can conclude that:  The dimensionality reduction of Step 2 provides an important gain in precision. With and without RF iteration, the precision obtained using the set of 38 StARMiner selected features are higher than the precision obtained using the initial set of 255 features.

These results testify that the dimensionality curse really damages the query results: irrelevant features impairs the clear tendency of the relevant ones;  The precision obtained using the MPP-RF technique improves up to 70%, (Figure 3 (a,d)). These results show that the proposed MPP-RF technique is efficient in enhancing query results;  The higher values of precision were obtained using the proposed method that combines StARMiner algorithm and MPP-RF technique. These results confirm that the proposed method is effective in improving accuracy of CBIR systems.

Experiment 2 ?The Heterogeneous Images dataset The Heterogeneous Image dataset consists of 210  medical images classified in eight categories: angiogram, MR Axial Pelvis, MR Axial, MR Sagittal Head, MR Coronal Abdomen, MR Sagittal Spine, MR Axial Abdomen and MR Coronal Head. The steps done on this dataset are detailed as follows.

Step 1 was performed extracting texture features from the images previously segmented in 5 regions by a variation of EM/MPM method. This generated a very compact feature vector of 30 features per image.

In Step 2, the StARMiner algorithm was applied to Heterogeneous Image dataset selecting a set of 21 features, reducing 30% on the feature vector size.

Step 3 was executed using three and five RF iterations, asking the user to select 5 images as relevant (positive) and 5 images as irrelevant (negative).

Proceedings of the 19th IEEE Symposium on Computer-Based Medical Systems (CBMS'06)    Figure 4 shows the obtained P&R graphs using the initial set of 255 features (original) and the set of 38 features selected by StARMiner. For 5 RF iterations the gain in precision is up to 100% when the recall is 80%.

Figure 5 shows the results of processing a k-NN (k=10) query, over the query center showed at the top left from the screenshots. Figure 5(a) shows the results when using the 30 original features before a cycle of RF, while Figure 5(b) presents the results of using the 21 features selected by StARMiner before a cycle of RF. Figure 5(c) shows the results on the 30 original features after a cycle of RF, while Figure 5(d) shows the results on the 21 selected features after a cycle of RF. The major precision was obtained using the proposed method (Figure 5(d)), where all returned images are of the same category of the query center.

5. Conclusions In this paper we proposed a new approach to  improve the precision in medical image retrieval, helping to amend two critical problems of image retrieval systems: the high dimensionality of feature vectors and the semantic gap. The first problem was tackled by using statistical association rules to select the most relevant image features, consequently achieving expressive dimensionality reduction of the feature vectors. The second problem was dealt with using a new relevance feedback technique (MPP-RF).

The experiments showed that the proposed method is effective in improving the query precision, contributing  to lessen the semantic gap and achieving an improvement in the query results of up to 100%.

Figure 4. Precision and Recall graphs obtained using the initial set of 30 features (original) and the set of 21 features selected by StARMiner, using 3 RF iterations (top) and using 5 RF iterations (bottom).

Figure 3. Precision and Recall graphs obtained using the initial set of 255 features (original) and the set of 38 features selected by StARMiner for different settings. (a) Using 1 RF iteration, asking the user to select 10 positive (relevant) and 5 negative (irrelevant) examples (b) Using 1 RF iteration, asking the user to select 5 positive examples and 5 negative ones. (c) Using 3 RF iterations, asking the user to select 5 positive examples and 5 negative ones. (d) Using 5 RF iterations, asking the user to select 5 positive examples and 5 negatives.

