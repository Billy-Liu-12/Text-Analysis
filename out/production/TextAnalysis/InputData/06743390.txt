Large-scale network security situational awareness based on association rule  research

Abstract?Association Rule is one of the main technologies of Data Mining, this paper combining with the particularity of network security, applying the association rule to large scale networks of situational awareness. Against the limitation of the classical algorithm for mining association rules Apriori algorithm, proposes an efficient algorithm to save time consumption. According to the three levels of reducing the number of non-frequent sets, avoiding calculating the items that is not existed and reducing the database redundancy items to improve the Apriori algorithm, saving lots of time and space in the algorithm process. Experiments results show that this algorithm can quickly and effectively mining association rules, and help to identify potential, malicious attacks,   safeguard the overall network security situation.

Keywords-component; network security situation; data mining; association rules; apriori algorithm

I.  INTRODUCTION With the expanding of the network and the improving of  concealment of aggressive behavior, the traditional and single defense equipment or testing equipment has been unable to satisfy the requirement of security problem which resulting enormous challenges in network security. Network Security Situation Awareness also known as NSSA[1] proposed as a new technology can be able to integrate all aspects of the security factors and predict the future development trends of network situation by obtaining, understanding, and showing these security factors. However, the large-scale network has some characteristics that is multi- node, large volumes of data and complexity branches, and there must be many useless warning information so that the system can hardly analyze and evaluate the security of network situation accurately with the tendency of complication of the network intrusion and aggressive behaviors. In order to monitoring of network security in time and keeping the security of network situation, there is an efficiently data mining techniques can be used to identify the malicious aggressive behaviors through gathering, integrating and analyzing the complexity warning information. There is a efficiently algorithm proposed in this paper which is mainly dealing with the section of processing association rules in data mining through researching on Apriori algorithm. It can keep the NSSA in real time and also make the network safety.



II. RELATED CONCEPTIONS  A. Network Security Situation Awareness NSSA originated from the situational awareness of air  traffic supervisory. In the nineties of last century, Tim Bass firstly put forward the concept of NSSA in the literature [2], and introduced it into the field of information technology security, which is used for the study of the next generation of intrusion detection system. NSSA means obtaining, understanding and displaying security elements that can cause change of the network situation in the large-scale network environments, and it also could predict the development trend of the future.

manager  Situation visualization display  Response and Early Warning  Threat evaluation  Situation evaluation  Event Correlation Target identification  Data preprocessing  Process optimization control and  management  Netflow IDS Firewall Figure 1. NSSA framework map.

As shown in figure 1, it is a typical frame structure of NSSA, which divides the realization of the NSSA into eight parts:1. Data collection; 2. Data preprocessing; 3. Events association and target recognition; 4. Situation assessment[3]; 5. Threat Assessment; 6. Process optimization control and management; 7. Response and warning; 8. Situation visualization display.

In 2004, James Llinas and someone else had put forward to a new model which combines data mining with data fusing by revising JDL data fusing model[4]. This model mainly mine historical data to find new mode and rule of attack, which will be output to the system for assessing, it makes technique of data mining more widely used in NSSA system  2013 2nd International Symposium on Instrumentation and Measurement, Sensor Network and Automation (IMSNA)     B. Association Rules As one of the main techniques of data mining,  association rule mainly discovers the relationship that maybe exists among things from the back of data, and reveals the unknown dependence between data items. What?s more, association rule is the earliest technique used in intrusion detection and some other fields in network security. The association rule can be got by finding the association among the data items so that it can implement a function that inferring one data object from another, just as  [ , ,..., ]1 2 1 associatea a a an n?????? + . That is to say the trend or the  behaviors in future can be predicted by the data mining, and make decisions that based on the known knowledge, so it could be used in the field of the situation awareness.

In order to ensure the real-time, the large-scale network always directly read unified events from the buffer, then makes a real-time association and inputs the unified events, outputs the alarming message. But for the complex events, the association rule must to be used as an auxiliary input. In a word, the implementation of the modules of the associated events can be more flexible and scalable by the detection which based on the extracted association rule of NSSA, so the potential and malicious attacks can be able to identify quickly and effectively, then ensures the overall NSSA.

C. Progress of Mining Association Rules The core task of data mining is how to extract the  association rule of NSSA from a large number of data which generated by the network[5]. Then, an impeccable rule base will be established by taking advantage of the technique of the data mining of the association analysis which can be used to analysis the formatting data and generate the rules and input to the rule base in the intrusion detection.

As shown in Figure 2, it is the main structure of rule base in the data mining, and it details the Figure 1 about the data preprocessing and event correlation and target recognition.

All kinds of the information that collected by the data preprocessing should be standardized and normalized, and a record without redundant data in a specific format can be generated, then it can be used by the data mining. In addition, the quality of the processing results will have a direct effect on the extracted feature of the users and the accuracy of the rules which have been deduced. Classification means getting the character of user? behavior and rules that extracted by data processing, and matches it with the rules or patterns which is exist in the knowledge base, so it can judge whether the administrator should be informed, and achieves the dynamic prevention[6]. The rule base need to be updated when faced with new rules or patterns[7], and the rules in the base need to be merged as well, then the automatic learning and updating of the rule base will be come true.

Normal data  Data Collection  Data preprocessing  Data Classification  Matching rules  Administrator Judge decisions  Data processing  Production rules  Abnormal data  Storage rules  Self- rule   Figure 2. Data mining structure based intrusion detection.

As a means of decision support, the rules that new added to the data base could timely detect the attacks in the network. The sample space of correlation analysis will be decreased by merging the events and rules so that the event that the same thing be alarmed repeatedly can be avoided, and makes the association rule mining technique more practical in the NSSA system.



III. DEFICIENCY IN APRIORI ALGORITHM  A. Association Analysis and Definitions Association analysis could detect various intrusion  correlations of intruders, which will be able to export some unknown coordinated attack mode, thus constructing a new collaborative intrusion rules to ensure the large-scale network security. Taking TCP packets captured as an example, formatting it as a service type, source IP address, destination IP address, source port number, destination port number and other attributes, there must be relevance between each other, so, we can use association analysis to mine the attributes and find their correlation, moreover, we need to establish association rules and retain the rules that meet minimum support and minimum confidence. Assuming  ( ) ( ) ( ){ }_ 1,  _ 2, .. _ ,I i i i n= ?  is a collection of items containing n elements. Given a transaction database that is ( ) ( ) ( )_ 1,  _ 2, .. _ ,{ }D t t t n= ? , where each transaction t is a non-empty subset belonging to I , i.e., t I?  and there is a unique identifier ID (Transaction ID ) corresponding with it.

Implication form is as follows that is about association rules to be mined:  ( ), ,X Y X I Y I X Y? ? ? =?                       (1) Where X  is called the premise of association rules, Y  is  called the conclusion of association rules. The support and confidence of them are defined as follows:  ( ) ( ), , sup ( ) sup ( ) T X YX Y X I Y I X Y port X Y port X Y T ?  ? ? ? =? = ? =    (2)  sup ( )( ) sup ( )  port X Yconfidence X Y port X  ?=             (3)  2013 2nd International Symposium on Instrumentation and Measurement, Sensor Network and Automation (IMSNA)     ( )T X Y?  indicates the number of records about X Y? contained in the database, T represents the total number of records. The statistical significance of association rules in the entire data set is measured by support, and the degree of credibility about association rules is measured by the degree of confidence.

B. Defects of Apriori Algorithm Apriori algorithm based on frequent item sets take the  iterative approach of searching layer by layer, this algorithm is simple and easy to realize, but there are some insurmountable drawbacks. Firstly, there are too many times to scan the database: each system generates a candidate set, the database must be scanned once, that is to say generation of length N frequent items, you need to scan N times. But usually there is a large number of transaction data in the database, and there is little memory capacity, which will certainly lead to overload of system I/O, so that each scan of the database longer, inefficient.

Secondly, calculation will produce a large number of intermediate itemsets: Apriori algorithm produce candidate sets Ck through 1Lk? , Ck consist of 1  kCLk? k-itemsets, when k  increases, the number of candidate k itemsets generated increases exponentially, In particular, calculating some Ck that do not meet the requirements will spend a lot of time and system resources.

Thirdly ,with the increasing of the sample mined, some rules of the original rule base may have not meet the definition of the frequent item sets , and they won?t be used in future ,if we don?t take some measures to deal with, the efficiency of system will gradually decrease for the affection of redundant items.



IV. THE IMPROVEMENT OF APRIORI ALGORITHM To deal with the deficiency in Apriori algorithm, there is  a lot of improvement methods have been proposed by other scholars[8-11]. Most of them have been improved the system efficiency through reducing the times of scanning the database. Aiming at the deficiency of the second and third part in Apriori algorithm talked above, there is a better algorithm represent as follows:  1. The superset of non-frequent itemsets is a non-frequent as well due to the characteristics of downward closure in Apriori algorithm. That means if there is a sub-itemsets not exist in 1Lk? , it is a non-frequent itemsets and we should remove it. This can reduce the scale of the potential frequent itemsets and accelerate the process of generating frequent itemsets.

2. If frequent k-itemsets could produce k+1 itemsets, then the number of itemsets of the frequent k-itemsets will be greater than k . According to this definition, we should scan the number of itemsets in 1Lk+ at first, and if there exist  a 1L kk <? , so that means can?t produce frequent Lk+1 itemsets, we mark it as Ck , and we can return Ck =? directly.

That is, when connection of the two itemsets and generated  Ck , for the each item t in it, we need to determine whether  1L kk <? , it is no longer need to calculate Ck if it?s true for it, and save the time for calculate Ck . After this, the item t would not exist in Ck , so we could know C tk ? =? , and delete t  from Ck , reduce the size of Ck , and so does the Ck+1 . Thus, this can improve efficiency of the execution of the Apriori algorithm.

3. It can produce Lk through using Lk-1 in this paper.

According to the knowledge of mining process, when calculate the support degree of the k-itemsets which length is greater than the k . All those transactions in database have already exist in Lk , so it turns to be redundant. Thus, after calculating the k-itemsets, we should remove the transactions which length is k . Therefore, we could reducing the number of data in database, the time of scanning database and improving the efficiency in this algorithm.

Algorithm is described as follows:  ( )  INPUT: Transaction Database ; The Minimum Support Threshold OUTPUT: The Frequent Itemset  In APRIORI BEGIN: //All Frequent Itemsets 1-Itemsets   //Cycling Iterat  i  D minsup L D  find_frequent_1_itemset D ;L =1 on Until No k-Itemsets Can Be Found  //Usin  g  To Produce  //The Returned  Is The Set Of All  Frequent Itemsets  for k =2;  ; k++ L Lk-1 k  = apriori_gen ,minsup  ;  ( L )k-1  { L (L L D  return  ) }k k  L=  -1  Ui=1  ??  L ,k-1 S   Function apriori_gen( minsup) BEGIN: //The Effect Of The Function Is Using to trive For    end;  Ck apriori_gen( minsup){  for each itemset do  k L ;k  Lk-1 L ,k-1  L L  1 k-1 for ea  ?             ch item L L  2 k-1 (L  set do [1]=L [1]) (L [2]=L [2]) ... (L [k-1]=Lif  c= has_infrequent  [k-1])then{1 2 1 2 1 2 L  _subset c UL ;1 2  if( ( L ))[t , D]thenk-1  ? ? ? ?  ? //When  Is Not In , The Itemset Must Be Non-frequently  //The Calculation Can Reduce After The  Is Deleted Directly.

c c  delete c;  Lk-1  ( )     Return An Empty Directly,  Is Not Need         //   Calculat   ed     esle for each tr  if( L t <k)then{k-1  ansaction Ck  ?           return delete t;}  }esle{ subset , t ;  for e  C = ;k   C ach cand  = i  (C )t k date  ?     Delete All The Transactions Which Have   Length       //   Of ?    c Ct delete C ; t  count++;} L = (c C | );k k c.count >= mins  while( e  p  l  u k  t.

?  ?     Function apriori_gen( minsup) END Function  has_infreque    nt_subset c,   BEGIN: To Judge Whet    / / L ,k-1 (  her  In  L )k-1 //  ngth()=k)  L ;k }  dele  Lk-1  te t; return  c ha  ( )     / /Function has_infrequent_subset c,  EN     ( L )k D APRIOR  -1 I  s_infrequent_subset c, or each k-1 -subset s of  c  if( )then return TRUE;  return FALS  ( L ){k-1 f  c Lk-  E }   ;  ?  END    In order to verify the improvement of the efficiency of this algorithm, we contrast the original Apriori algorithm and  2013 2nd International Symposium on Instrumentation and Measurement, Sensor Network and Automation (IMSNA)     the improved algorithm through the experiment simulation.

We compares the number of the association rule in data mining and the rest event in database between these two algorithms under a fixed number of database transactions  , the results is showing in the figure 3 and figure 4.

Figure 3. The number of association rules of mining along with the  change of time.

Figure 4. The change of transaction number in database.

The result represents that the improved association rule mining algorithm for mining association rules can be more efficient, and deleting the database of redundant events in real-time in the process of mining in the same time. It is also reducing the time of scanning transactions, improving the execution efficiency of the algorithm, and most importantly, saving the time and the space required in this algorithm.

Then, it also enhanced the rule base of self-learning and the ability to automatically update, and ensured the completeness and effectiveness of the rule base. This can make the system more efficient identify potential, malicious attacks, the security of the whole network security situation.



V. CONCLUSIONS The application of the association rule data mining  techniques in the large-scale network situational awareness, especially in the intrusion detection have been introduced in  this paper. It is mainly detailed the connection between the network security situational and the association rules, and proposed an efficient algorithm which based on the deficiency of the Apriori algorithm and reduced the time consumption. This algorithm is improved from three levels, it is reducing the number of the non-frequent itemset and avoiding to calculate the itemset that don?t exist and decreasing the database redundancy. It greatly reduces the time of association rule data mining, and it is dependable and easy to implement and significantly better than that of the Apriori algorithm in efficiency. Although, we have made many progresses, to be a perfect NSSA system, it is difficult to implement the automatic learning and defense of the system and extend dimension of the data in the association rules. Thus, we still need to make more research on dealing with these problems.

