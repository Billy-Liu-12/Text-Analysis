A Prediction Method of Fuzzy Association Rules*

Abstract  Quantitative attributes are partitioned into several fuzzy sets by fuzzy c-means algorithni, and search technology of Apriori algorithm is improved to discover interesting fuzzy association rules. The first prediction method of fuzzy association rules is presented, and shortcoming of this prediction method is analyzed. Then, the second prediction method of fuzzy association rules with the variable threshold is presented. In the second prediction method, a little error between prediction value and actual value is allowed. When the error is less than a given threshold, prediction value is regarded as acceptable or rational. The secondprediction method can obtain the different prediction precision corresponding to the different error threshold chosen by the users, so it is more flexible and effective than the first prediction method.

Keywords: data mining; fuzzy association rules; genetic algorithm; prediction; fuzzy clustering  1. Introduction  The mining of association rules is one of the most important issues in the field of data mining. The problem of mining Boolean association rules is introduced in [I,Z].

Parallel mining and weighted mining of Boolean association rules have also been studied in [3,4]. Srikant and Agrawal first introduce the problem of mining quantitative association rules[s1. The algorithm in [5] finds association rules by partitioning the attribute domain, combining adjacent partitions, and then transforming the problem into binary one. Although this mining algorithm for quantitative association rule can solve problems introduced by quantitative attributes, it introduces some other problems. The first problem is that equi-depth partitioning cannot embody the actual distribution of the data. On the one hand, it may not work very well on highly skewed data and tends to split adjacent values with  high support into separate intervals though their behavior would typically he similar. On the other hand, it is not easy to distinguish the degree of membership. For instance, age of 50 and age of 7 0  will both be classified into the old. However, we intuitively h o w  that age of 70 is much older than age of 50. The second problem is caused by the sharp boundary between intervals. The algorithm either ignores or over-emphasizes the elements near the boundaly of the intervals in the mining process.

M.K. Chan uses fuzzy set to soften the partition boundary of domains, and presents the concept of fuzzy association mled6], but it does not present partitioning algorithm which can embody the actual distribution of the data and does not present the mining algorithm for fuzzy association rules which fits for large databases. Ref. [7] use linguistic clouds to soften partition boundary of the domains, and presents mining algorithm for association rules with linguistic cloud models. Ref. [8] uses the relational fuzzy c-means algorithm to partition the quantitative attributes into several fuzzy sets, then the problem of mining fuzzy association rules is introduced by combining fuzzy sets. The relational fuzzy c-means algorithm can embody the actual distribution of the data.

Furthermore, fuzzy sets can soften partition boundary.

But combining fuzzy sets can obtain excessive fuzzy association rules, so the mining algorithm in [8] cannot fit for large database.

Recently, applying association rules to solve classification problem have been studied and discussed in some papers. Lent, Swami proposes association rule clustering system (ARCS)[91. This system mines association rules based on clustering, and then uses these rules to classify, but this system is only fit for the case, which there are only two attributes in a rule. Liu, Hsu and Ma[''] propose classification based on associations (CBA), which uses iterative method to find the frequent and accurate possible rule set and then uses method of elicitation to build classification system. But it is important to note that the intervals involved in quantitative association rules may not be concise and  + This work was supporled in pan by the National Natural Science Foundation of China (NSFC) (60073012), National Grand Fundamenlal Research 973 Program of China (2002CB3l2000), National Research Foundation for the Doctoral Program of Higher Education of China. Natvral Science Foundation of Jiangsu Province, China (BK2001004), Opening Foundation of State Key Laboratory of Soflware Engineering in Wuhan University, and Opening Foundation of Jiangsu Key Laboratory of Computer Information Processing Technology in Soochow University.

0-7803-8242-0/03/ $17.00 0 2003 IEEE 98  mailto:jjlu@seu,edu.cn   meaningful. A method for constructing fuzzy decision trees (FID) and a number of inference procedures based on conflict resolution in tule-based systems and efficient approximate reasoning methods have been presented in [I I]. Given a database, this approach can be used to build a fuzzy decision tree and the resulting tree can be used for inference in [ I l l .  A approach that can be used for mining interesting rules for classification with degree of membership in [12,13]. These approaches represent the revealed regularities and exceptions using fuzzy sets. The use of fuzzy sets allows human users to better understand the discovered rules because of the affinity with the human knowledge representation. Furthermore, these approaches are capable of finding interesting relationships among attributes without any subjective input required of the users. Some results show that the classification methods in [12,13] have good precision and interpretability than C4.5 and CBA.

In this paper, quantitative attributes are partitioned into several fuzzy sets by fuzzy c-means algorithm, and search technology of Apriori algorithm is improved to discover interesting fuzzy association rules. Then, two prediction methods of fuzzy association rules are presented. In these prediction methods, the parameters of triangular fuzzy numbers are adjusted to improve the prediction precision by genetic algorithm. Last, we compare the precision of two prediction methods. The results of experiment show that the second prediction method can obtain the different prediction precision corresponding to the different enor threshold chosen by the users, so it is more flexible and effective than the first prediction method.

The rest of this paper is organized as follows. In section 2, Apriori algorithm is improved for mining fuzzy association rules. In section 3, the first prediction method of fizzy association tules is presented. In section 4, the second prediction method of fuzzy association rules with the variable threshold is presented. In section 5, we compare the precision of two prediction methods and give an experiment. The conclusions are briefed in section 6.

2. Mining fuzzy association rules  Let T = { r , , r ,  ,..., 1 , )  be a relational database, fj represents the j-th record in T, let I = ( i , , i2 ,  . . . , im)  be the attribute set where ii denotes a Boolean, categorical or quantitative attribute, r j [ i * ]  represents value of the j-th record in atkibute i,. Valued of ;he r e d i d  in attribute need to be partitioned into several fuzzy sets for mining fuzzy association tules.

Let A, and A, be two values of the record in Boolean attribute, then two values can be partitioned into two fuzzy sets A, and A, , where  . . ~ ~  Categorical attribute with fewer values can be partitioned into several fuzzy sets with the same method. Each quantitative attribute is partitioned into several fuzzy sets represented with triangular fuzzy numbers by fuzzy c- means (FCM) Comparing with [8], there are two differences. One is that FCM algorithm can cost less time than the relational fuzzy c-means algorithm, another is that fuzzy sets are not expressed with normal fuzzy numbers as in [SI but expressed with triangular fuzzy numbers in this paper.

For example, the process of using FCM algorithm to partition quantitative amibute i4 into c fuzzy sets is given below. Put the values taken by attribute ik together as a set of samples X Let d ,  = (x, - v i ( ,  m=2, matrix norm 1 U is the maximum element of the matrix. After clustering with FCM algorithm, partition matrix U and c centers U, are obtained. The elements of the row corresponding to the maximal center are interpreted as the membership degree of the samples in the maximal fuzzy set grade.

The method of representing fuzzy sets in triangular fuzzy numbers is as follows. Let pi(xj) be membership degree of x, in the fuzzy set with center v k  , let  A" = {x, : pi ( x , )  z pi (xi ), vj E {I,z,. . . ,c)  ) We first find the samples with minimum membership degree at both sides of the center v k  in Xi u ( v , ) ,  let the left sample with minimum membership degree be x' , its membership degree be p k ( x ' ) ,  and let the right sample  with minimum membership degree be X' , its membership degree be pk(x ' ) ,  then the expression of triangular fuzzy numbersf(x) with center vk is  In order to mine fuzzy association tules, we construct a new database through original database T. In this new database, attributes are fuzzy sets; values of the record in attributes are obtained as follows: Let i: be a fuzzy set of     attribute i k ,  i: is an attribute in new database. Value of the  j-tb record in attribute i: is i l ( f i [ i i ] )  , i l ( t i [ i k ] )  is membership degree of tj[ii] with respect to fuzzy set i: .

In this new database, because attributes are fuzzy sets, we call attributes fuzzy attributes next. Let I still be the fuzzy attribute set, let t i ( y k )  represent value of the j-th record in fuzzy attribute y,, t i ( yk )  falls in [O,l]. Let  X = l Y , , Y , , . . . , Y p ) c ~  Y = ( y l + , , Y , * , , . . . , Y p t l ) = I X n Y = 0  An association rule is an implication of the form X j Y , Because attributes in Xand Yare fuzzy attributes, X Y is called fuzzy association rule. The support and confidence of fuzzy association rule are defined as follows.

Definition 1 The support ofXis  defined as follows  f R l j ( Y , )  sUp(x) = i = l  m=l n  Fuzzy attribute sets with at least a minimum support are called frequent fuzzy attribute sets.

Definition 2 The support of X = Y is defined as follows  Definition 3 The confidence of X Y is defined as follows  Because t , ( y k )  falls in [O,l], we can know that all subsets of a frequent fuzzy attribute set must also be frequent according to definition 1. With the above finding, it is easy to modify Apriori algorithmiz1 to mine fuzzy association rules.

3. Prediction method of fuzzy association rules  Suppose we have obtained I rules as follows by the improved algorithm for mining fuzzy association rules  If i ,  isf,',and i,isf: ,...,and i,,-,isfi-, then im isf,', j= 1,2;..,1  where f,' are triangular fuzzy numbers. To these fuzzy association rules, we can use inference method of standard additive model"'] to make prediction. When input values of antecedents i 1 , i 2 ; . . , i m - ,  are x,.x2,.".x,_, respectively, based on these fuzzy association rules, we  can obtain the prediction result of consequent i, as follows:  I, XfL ( x ) h ' I J L W vi = L f L ( x ) h  c .  =  Because triangular fuzzy numbers only approximately represent the fuzzy partition, we usually cannot obtain perfect prediction precision. So genetic algorithm is applied to improve the prediction precision. The optimizing process of genetic algorithm is to minimize the  value of objective function E =--C:=,lyaj - y , \  by  adjusting triangular fuzzy numbers in antecedent and consequent of fuzzy association rules, where y,  is the actual output value, y, is the prediction result of consequent i ,  , n is the total number of samples. The whole process of the algorithm is described as follows  ( I )  Load the initial data and set the parameters required for genetic algorithm  Load training dataset, initial triangular fuzzy numbers of each attribute, and fuzzy association rules obtained. Set the size of population L, maximum number of generations T, and set crossover probability P,, individual mutation probability Pm, parameter of crossover U ,  parameter of mutation b. Use t count current generation.

I n  (2) Generate initial generation Po Each individual forming the genetic population will  consists of triangular fuzzy numbers of all attributes that have been encoded by real values. Each triangular fuzzy number is represented by three real parameters. The triangular fuzzy numbers of all attributes are joined into an individual C, with the length H = C;,3.rj , which is shown as follows  C,, = ( u j , , b  , , ,c , , , . . . .aj , ,~b~, , ,c , , , ) c, = c,,c,,'''c,m  where C,, codes the fuzzy partition of the i-th attribute, Ii denotes the number of fuzzy sets that the i-th attribute is partitioned, and m denotes the number of attributes.

The encoded initial fuzzy partition is taken as the first individual of initial generation, denoted as Cp , and other initial individuals are generated randomly according to the variable range of each gene. Each gene c, , ,h=1,2, . . . ,H is the parameters of fuzzy numbers, and their variable     ranges [cL,c;] are identified by Cp, The variable ranges of three parameters (C,,C,+,,C,+~) of a fuzzy number are the following  Since the size of population is L, initial generation can be denotedas Po =(Cp,C: ,..., C,").

(3) Evaluate individuals To each individual of current generation population P' .

we use function E to evaluate its degree of adaptation.

Smaller the value of error function is, higher the individual adaptation is.

(4) Generate a new generation P"' through genetic  (A) Selection Applying the selection schemes of stochastic universal  sampling and keeping the elitist, we generate parent individuals from current generation for other genetic operators.

operators  (B) Crossover The Max-Min-Arithmetic crossover is  applied to the selected individuals according to the crossover probability P,. If two individuals to he crossed are C, = (c ,,..., c ',.... cH) and C, = (c; ,..., c; ,..., c;i) , then four offsprings are generated as follows  C, =a. (C , )+( I -a ) .C , C, = a ,  (C,) + (I  - a )  .C, C, with C,, =min{c,,c;)  C, with C,, =max(c,,c;)  Select the two best of them as the results of the crossover operator, where a is a constant that is set beforehand.

(C) Mutation The nonuniform mutation operator"6' is applied to the  selected individuals according to the mutation probability P,. Suppose that mutation is happened on the gene ck E[c: , c ; ]  of an individual C,, = (c ,,.._, c ,,.... c,,) , and generate new individual C : = ( c  ,,..., c; ,..., c , ) , k ~ l ,  ..., H .

The process of mutation operator is as follows  ck+A(l,cL-ck), ,5=0 i ck -A(f,ct - C L ) ,  p = I c; = where p is a random integer of {O, l} ,  function A(r,y) retums a value of [Oy] such that the function value tends to zero with the augment of I. Here we choose  A(r,y) = y ( l -  r " $ " ) ,  where r is a random value of [O,l], Tis  the maximum number of generation, t denotes current generation, and parameter b determines the degree of dependence to the iterative number.

( 5 )  Check the condition of termination The iteration terminated until to the maximum number  of generation T, otherwise retum to the third step and begin a new iteration.

4. Prediction method of fuzzy association rules with the variable threshold  In section 3, the optimizing process of genetic algorithm is to minimize the value of objective function  E = ; ~ ~ = , I y o j  - y , l ,  and obtains one and only parameters  of triangular fuzzy numbers and prediction precision last.

In practice, it is usually allowed that there is a little error between prediction value and actual value. When the error is less than a given threshold, prediction value is regarded as acceptable or rational. For example, we use some attributes to predict the economy-growing rate of 2002 year. Suppose the prediction value of the economy- growing rate is about 7.3 %, the actual economy-growing rate of 2002 year is 7.8 %. Although there is a little emor 0.5% between prediction value and actual value, the prediction value is regarded as acceptable or rational.

Let input antecedents be i,,i2,...,i m-, , output consequents be i, . The users choose an allowed error threshold Ae according to the actual need. When the error between prediction value yoj and actual value y, is less than Ae, prediction value is regarded as acceptable or rational. Let m be the total number of rational samples, n be the total number of samples, then the prediction  precision is defined as . The optimizing process of genetic algorithm is to maximize the prediction precision by adjusting triangular fuzzy numbers in antecedent and consequent of fuzzy association rules. The adjusting process is similar to section 3.

In the prediction method of fuzzy association rules with variable threshold, the users can choose a different error threshold Ae according to actual need, and can obtain different parameters of triangular fuzzy numbers and prediction precision at the same time. So this prediction method is more flexible and effective than the prediction method given in section 3.

5. Experimental analysis  I  n  Experimental database Abalone is taken from UCI Machine Learning Repository, which has nine attributes     and 4177 records. Each attribute is quantitative except for the attribute sex. Attribute sex is denoted as io , the quantitative attributes including length, diameter, height, whole weight, shucked weight, viscera weight, shell weight and rings are respectively denoted as i , ; . . , i , .  Nine attributes are partitioned into three fuzzy sets: large, middle and small, these fuzzy sets are denoted as im(l),im(2),im(3),m =0,1, ..., 8 .  Table 1 shows some original parameters of triangular fuzzy numbers.

Table 1. Some original parameters attributes large middle  length (0.50,0.63,1.2) (0.34,0.50,0.63) diameter (0.39,0.5,0.97) (0.25,0.39,0.5) height (0.13,O. 18,1.67) (0.09,O. l4,O. 18)  whole weight (0.96,1.56,4.622) (0.36,0.93,1.52) shucked weight (0.42,0.69,2.38) (0.16,0.41,0.67) viscera weight (0.21,0.34,1.22) (0.08,0.22,0.34)  shell weight (0.28,0.45,1.59) (0.1 1,0.27,0.44) rings (9.8,16.29,44.67) (6.84,10.52,16.33)  We use the former eight attributes i , , . . . , i ,  to predict the attribute i, (rings), which denotes the age of abalone.

In order to make prediction, it is required to mine fuzzy association rules with such as  If io is io ( / , ) . . .  , and i, is i,(I,) then i, is i s & ) ,  / , = 1 , 2 , 3 ,  m=0,1,..,,8  We randomly select 2784 records in database as the training samples, the rest as the testing samples. We first apply 300 fuzzy association rules to make prediction directly, and get the mean linear error 3.634351 on the training samples and mean linear error 3.771415 on the testing samples. Let T=lOOO, L=61, P,=0.6, P,=O.I, a=0.35, b=5, using the prediction method in section.3, we get mean linear error 1.659679 on the training samples and mean linear error 1.770291 on the testing samples.

Table 2 shows some new parameters of triangular fuzzy numbers.

Table 2. Some new parameters attributes large middle  length (0.54,0.8,0.99) (0.34,0.55,0.68) diameter (0.4,O.S 1,1.01) (0.23,0.33,0.51)  height (0.1 1,0.17,1.49) (0.07,0.13,0.19) whole weight (1.02,2.65,4.15) (0.2,0.71,1.62)  shucked weight (0.39,0.59,2.08) (0.23,0.40,0.64) viscera weight (0.19,0.54,1.03) (0.02,0.16,0.3)  shell weight (0.27,0.37,1.322) (0.09,0.26,0.5 1) rings (10.08,17.33,38.7) (8.39,13.1,18.9)  The experimental results show that it is effective to improve prediction precision by adjusting triangular fuzzy numbers of fuzzy partition with genetic algorithm, which makes it possible to make an effective prediction of the mined fuzzy association rules. Table 3 shows the prediction precisions at the different number of fuzzy association rules. Although the prediction precision is not perfect and should be improved farther, we claim that the prediction precision is acceptable in this high-dimensional system with nine attributes.

Table 3. The prediction precisions Number of fuzzy Training mean Testing mean association rules linear error linear error  300 1.659679 1.770291 100 1.752211 1.840357 60 1.814739 1.915229 40 1.952426 2.048995  We mine 300 fuzzy association rules and let T=lOOO, L=61, Pc=0.6, P,=O.I, a=0.35, b=5, A e = 2  , using the prediction method in section 4, we get prediction precision 72.5575% on the training samples and testing precision 71.0696% on the testing samples. At the same time, we use the results obtained from the prediction method in section 3, we get prediction precision 72.1624% on the training samples and testing precision 70.5671% on the testing samples. This shows that if we allow a little error between prediction value and actual value, the prediction method in section 4 is more flexible and effective than the prediction method in section 3.

6. Conclusions  Quantitative attributes are partitioned into several fuzzy sets by fuzzy e-means algorithm, and search technology of Apriori algorithm is improved to discover interesting fuzzy association rules. We present the first prediction method of fuzzy association rules and analyze the shortcoming of this prediction method. Last, we present the second prediction method of fuzzy association rules with the variable threshold and compare the two prediction methods. In the second prediction method, a little error between prediction value and actual value is allowed. When the error is less than a given threshold, prediction value is regarded as acceptable or rational. The results of experiment show that the second prediction method can obtain the different prediction precision corresponding to the different error threshold chosen by the users, so it is more flexible and effective than the first prediction method.

