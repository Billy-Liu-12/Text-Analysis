

Abstract? Sending messages securely to protect confi- dentiality in Mobile Ad Hoc Networks is a challenging issue due to the open wireless media, the spacial constraints and the difficulty in establishing strict security mechanisms. To tackle the problem, we have presented a scheme where a source node sends shares of a message at different times.

Due to node mobility, the shares will be routed through different intermediate nodes. It is highly unlikely that a particular intermediate node (an eavesdropper) is able to be on (or around) many of these routes and collect enough shares to reconstruct the original message. The scheme is particular suitable for applications that can tolerate long message delays, as those studied in Delay Tolerant Networks. The paper focuses on analyzing the strategies that a node can use in determining the intervals between two shares, and in tuning to applications? requirements on delay bounds. The results provide a guideline for the configuration and the security of the scheme. We further investigate the influence from various mobility models on the security property. The results show big differences among the models and the practical aspect of the scheme. In all, our proposed scheme provides a valuable alternative for delay tolerant applications to enhance message confidentiality.



I. INTRODUCTION  Mobile Ad Hoc Networks are vulnerable to many attacks due to the open wireless media and the difficulty in establishing strict security mechanisms in a highly dynamic network with changing members and mobility.

For the purpose of sending messages securely for con- fidentiality, several approaches can be used, e.g, mes- sage encryption, spatial multi-path routing and temporal multi-path routing.

Encrypting messages before transmitting requires the distribution of cryptography keys. Both symmetric key and public key schemes face challenges due to the dynamic nature of mobile ad hoc networks. In a mobile  * Dr Qunwei Zheng is now with Cerqa, 1309 Rutherford Ln., Austin, TX 78753.

ad hoc network, the security and accessability of Key Distribution Center (KDC) for establishing symmetric keys cannot be guaranteed. In addition, KDC is a single point of failure. Some early work [5], [8], [9], [24] require physical contacts or key pre-distribution which are not all practical in MANETs. An alternative approach is to use public keys, which requires the existence of distributed and online Certificate Authorities (CAs) for verifications. Various schemes have been proposed for the purpose [6], [7], [11], [14], [27]. They either require initialization before deployment or provide only probabilistic guarantees. Cryptographic approaches usu- ally require additional computation time and bandwidth, which could be expensive for nodes that are resource constrained. Nodes can be compromised and a compro- mised node gives away all keys stored in its memory, making communication not secure. Cryptography cannot defend against adversaries that simply drop messages.

The multi-path approach splits a message into multiple shares and spreads them through multiple spacial disjoint paths to the destination. Several related secure data transmission schemes have been proposed following the idea, e.g., using node-disjoint paths [13], [16]. Multi- path routing in MANET is used to select these paths [1], [12], [20], [21]. These schemes fit well for scenarios where the space is large enough for the multiple paths to spread apart. But they are not appropriate when a network is sparse or deployed in a restricted geographic area, where not enough node-disjoint multiple paths can be found.

In our recent work [18], a temporal multi-path routing has been proposed for secure transmission for appli- cations that tolerate delay (such as applications that suitable for delay-tolerant networks). The scheme does not require encryption. In the scheme, a message is split into many shares and each share is sent one after another with a certain interval of delay. The protocol assumes that underlying MANET routing protocol will find a path for delivering a share. In this scheme, mobility helps to protect the confidentiality in data transmission. When     sender or forwarders move in the network, they?ll have different neighbor nodes. This will decrease the chances that a series of shares will be eavesdropped by the same node over time who will be able to recover the original message.

In this paper we study one of the key design issues for the temporal multi-path based routing scheme, namely, how the source node decides when to send a share or multiple shares and what the associated risks are.

We focus on strategies that take into considerations of mobility and the application?s requirement on the total delay in receiving enough shares and reconstructing the original message. Our analysis is based on a uniform dis- tribution and random walk (direction) type of mobility.

Further we investigate through simulation how different mobility models affect the proposed temporal multi-path based routing scheme. The results show useful insights on the practical aspect of the scheme, and suggest that the strategies have analytical and practical significance for the configuration and the security of the scheme.

These results distinguish this work from the early work significantly. In all, our proposed scheme provides a valuable alternative for delay tolerant applications to enhance message confidentiality.

The paper is organized as follows. Section II intro- duces the related work on security and mobility analysis.

An overview of the Time-Based Message Dissemination Scheme (TBDS) is given in Section III. Analysis and strategies are presented in Section IV. Simulation results are reported in Section V. Section VI concludes the paper.



II. RELATED WORK  In recently years, several schemes have been pro- posed which use the principle of multiple shares to achieve security in mobile ad hoc networks. A secure data transmission scheme based on Rabin?s Information Dispersal Algorithm (IDA) [19] was proposed in [16].

In this scheme, dispersed message pieces are routed simultaneously through a set of node-disjoint paths. The destination node reconstructs the message after receiving sufficient pieces. The authors discussed how the source can adjust the path set based on feedback from the destination so that the protocol can remain effective in an ever changing network.

A similar scheme that is based on Shamir?s secret sharing technique [23] was proposed in [13]. Message is divided into multiple shares and sent simultaneously through multiple independent paths. The authors dis- cussed how to split message so that maximum security can be obtained and how to design an effective multi- path routing algorithm. The SMT routing protocol [17]  makes use of the redundancy and low-cost encoding of the available multi-pathes. In [25], the authors propose a secure routing scheme in an untrustworthy environment which can detect the threat of malicious behavior and resist the attack of colluding malicious nodes.

Our scheme is different from the above work. These schemes utilize spatial redundancy. They can be used in scenarios where multi-path exists. On the other hand, our work uses temporal multi-path to secure data trans- mission. It can be used in scenarios where delay can be tolerated, or where multi-path does not exist or hard to find, as in a sparse network, or in a restricted geo- graphical area. In addition, the scheme of [13] requires link encryption between neighboring nodes, the cost of which is high. If there is no link layer encryption, it will be easy for an adversary to compromise a message since it can hear all shares when it approaches the source. Our scheme does not make such an assumption. In addition, this paper studies the strategies of sending the shares, it can work with the early work for secure route discover.

Several early work have analyzed various mobility models to understand their spatial, graph properties and relation to radio interferences. These results help to demonstrate mobility?s impact on MANET performance and to improve protocol design. In [15], a mobility assisted information diffusion protocol is proposed where historical records of encountered nodes are analyzed and used in the protocol. The paper analyzes how the expected number of encountered nodes changes over time. The statistic properties of link lifetime, link change interarrival time, path duration, etc., are ana- lyzed in [4][22][26]. The results are helpful for design- ing efficient proactive routing protocols. The analysis on multi-path routing has been discussed in [2] [3].

Under the conditions of several available paths and corresponding probabilities of successful transmissions, the paper provides analytical framework that finds the packet allocation policy to maximize the probability of reconstructing the original information at receiver.



III. OVERVIEW OF TIME-BASED MESSAGE DISSEMINATION SCHEME  The Time-Based Message Dissemination Scheme (TBDS) works for networks where adversary eavesdrops wireless transmissions passively [18]. The attackers do not collude to monitor all the network traffic. They can not follow an active transmitting node continuously due to the lack of localization techniques and visual assistance, and its own motion intension. That means the adversary?s path is not correlated with any other node at a particular transmission interval.

An original message is divided into multiple shares using threshold secret sharing scheme before transmis- sion. Then each share is sent at different time instances through different paths. Any MANET routing protocol works here to obtain the routing path for the specific time instance. To divide a message, a (k, n) threshold secret sharing scheme [23] can be used, which divides a secret into n shares. The secret can be reconstructed from k or more shares, but with less than k shares, absolutely no information about the secret is disclosed. We also call it (k,n) or k out of n secret share scheme. Readers are referred to Shamir?s original paper [23]. In this paper, we also use the term a ?packet? to mean a ?share?.

Thus, the promise of the scheme is that when an attacker hears less then k shares, the message is safe.

Figure 1 shows that the source node S sends three shares at different times to the receiver R. The trajectories of both the source and the destination nodes are shown, as well as the three possible different routing paths when S sends the three shares. The success of the scheme relies on the assumption that intermediate nodes are different along the paths and in the surroundings of the inter- mediate nodes. If the time interval between the shares is carefully configured - the nodes relaying/overhearing shares are different with high probability - such a scheme is secure and realistic. Given the adversary model, for any other node to acquire enough shares, it must happen to be around or on enough relaying paths. Since the node lacks the ability of persistent tracking, its chance of hearing enough shares is very low.

This scheme does not specifically require crypto- graphic operations on message transmissions. When a mobile network has built some security mechanisms, it can co-exist with them and strengthen the security of message delivery. The security of the time-based message dissemination scheme is analyzed based on nodes? occurrences in geographic areas that surrounds the routing path using the radio transmission range.

Based on isotropic random walk mobility model, the probabilities that a node can hear enough (k out of n) shares are negligible.



IV. SENDER STRATEGY ANALYSIS  In the time-based message dissemination scheme (TBDS), the key design issue is the selections of the time interval between sending two shares consecutively and the number of shares sending at each time instant. The TBDS scheme makes use of paths at different times to transmit shares when the sender moves. In other words, one share or a few shares will be sent from the sender at different times until all the shares are sent.

Fig. 1. TBDS transmission scheme. The blue and red rectangles respectively represent the receiver and sender. At each transmission period, the sender will transmit a part of the shares to receiver.

The challenge is that the legitimate nodes can not detect eavesdroppers due to their passive attacking be- havior. Thus the sender will simply treat all the nodes other than the receiver as potential attackers. Such an assumption makes the decision making at the sender extremely hard. In this paper, we explore intuitive hints and global knowledge to help design guidance to senders.

For example, the sender could try to avoid a particular node to appear in its neighborhood too many times when it sends shares. Such information can be obtained from its neighbor list. More over, without the knowledge about who is an adversary, the sender will use the status of link changes, which is an indication of network dynamics, as a hint for security.

The probability of link change in a neighborhood will help us to infer the chance of being continuously eaves- dropped, and to construct a secure transmission scheme.

When there is a higher probability of link change during a certain time period, there is a lower probability of being continuously eavesdropped, and the sender could dispatch more packets. Whereas, less (or no) packet would be sent in the period. There are two parameters in the scheme: transmission interval T between two consecutive transmissions and the total delay Z. The total delay Z is the time elapsed at the sender in sending all the shares from the first to the last. It will be divided into several transmission intervals, each with a length of T . At the beginning of each interval a number of packets are sent depending on the strategies we discuss here.

We study two situations in this section: (1) application has no demand on the upper bound of the total delay Z, and (2) application has a demand on the bound of the total delay Z. In the paper, we assume that the nodes are uniformly distributed in the network and they follow the same mobility pattern. We denote R to be the transmission range and ? as the density of nodes in the network.

A. Without delay bound  Without a time limit on how long it should take to send all these shares, the sender will choose to dispatch shares at times that it believes to be safe. When the sender initiates a transmission, it is reasonable to follow the rule that the more frequently the link changes, the lower the probability of being eavesdropped by a certain adversary.

A few early work has studied the distribution of the link-change interarrival time and reported the result as approximate exponential expression with the mean link change rate ? [22]. Thus, the probability of x link changes in time t is px(t) =  (?t)xe?(?t)  x! . The parameter ? can be obtained based on speed, transmission radius and average density of nodes according to the paper [22].

Thus, the number of link change increases as the trans- mission interval extends.

As mentioned earlier, the sender uses x, the number of link changes in its neighborhood, as an indicator for the probability of secure transmission. When such changes exceed a desired threshold set up by the sender, it is relatively safe to send packets. Let X be the threshold: X = ??R2?, where ? is the node density, and ? is the invariant ratio of the threshold, i.e., sender sends one (or a few) share each time after ? percentage of the link change. So the probability of being safe, ps(t), is defined below when the number of link changes is not less than the threshold X .

ps(t) = 1 ? px?X(t) = 1 ? X?  i=0  (?t)ie?(?t)  i!

(1)  In other words, a longer interval brings more link changes and lower unsafe probabilities. Given the num- ber of link change threshold X , and assume P is the threshold for the probability of secure transmission, we calculate the average transmission interval T below. Set ps(t) ? P , we have,  1 ? X?  i=0  (?t)ie?(?t)  i!

? P (2)  Then the approximate result of t that satisfies the equation will be regarded as the transmission interval T . At the beginning of each interval T , the sender will send one packet until all the shares are sent. The sender can choose to send a few packets, but since total delay is not a concern, sending one packet a time is safer.

According to the simulation of Random Waypoint Mo- bility model (see Section V), the estimated link change rate is around 0.25. We plot the calculated transmission intervals with relation to the rate, the threshold of link  0 0.2 0.4 0.6 0.8 1        Secure Probability  In te  rv al  Link change rate at 0.25      1 link change 2 link change 3 link change  Fig. 2. Intervals at rate 0.25  0 0.2 0.4 0.6 0.8 1       Three Link Change  Secure Probability  In te  rv al      Link Change Rate at 0.1 Link Change Rate at 0.2 Link Change Rate at 0.3  Fig. 3. Intervals at three changes  change X and the security probability P in the Figures 2 and 3.

In fact, we can calculate link change rate ? based on the instant velocity of the sender using the equations listed in [22]. Thus, when a node changes its speed, its ? will be different too. In turn, a new transmission interval T can be calculated for the next packet. This interval dynamics is very useful for the sender to adjust the interval according to its own speed, rather than estimating. We have used our simulation configuration to generate a similar curve ? as those in [22]. The figure is not included due to space limit.

We further validate our expectation on the relationship of transmission interval vs the security through a simple simulation. The simulation investigates the ability of an arbitrary node hearing enough shares. We set threshold secret sharing as (k, n) = (3, 5), i.e., a message is divided into 5 shares and hearing 3 or more shares will be able to recover the original message. So here ?enough? shares means 3 or more shares. Three intervals and various mobility are tested. Figure 4 shows that when transmission interval increases, the percentage of hearing at least 3 shares drops. It also shows that when node      0.01  0.02  0.03  0.04  0.05  0.06  0.07  0  10  20  30  40  50  60  70  pe rc  en ta  ge o  f n od  es h  ea rin  g en  ou gh  s ha  re s  speed  interval=10 s interval=30 s interval=60 s  Fig. 4. percentage of nodes hearing enough (3 or more) shares drops as node speed increases and as sending interval increases.

speed increases, the percentage of nodes what hear at least 3 shares drops too. In practice, a larger n (and k) should be used, when we increase n (and k), the hearing probability further decreases.

B. Trade-off with delay bound  Although applications using the time-based message dissemination scheme can tolerate long message total delay in collecting the intermittently received shares, it is often the case that an application still wants an early reconstruction of the original message. The tradeoff is the delay requirement and the achievable security level.

We study the case that a user will try to balance the total delay and the security risk. Two issues are: First, how to adjust the transmission interval T such that it will reach a certain security level while the sender can still delay as long as the application can tolerate; and second, given a delay bound, what security level can be reached. Our work are based on average case analysis.

The security risk is quantified by link change rate. Let N link-changes be the desired security level. For the link change event, the density function of interarrival time can be approximated in high accuracy ([22]) as fchange(t) = ?e??t, where ? is the mean link change rate, which depends on speed range, transmission range, node density. Set a random variable TN for the event of N link changes, the interarrival time density function can be calculated as,  f(tN ) = ?N  (N ? 1)! tN N?1e??tN (3)  To address the first issue, we assume the total delay is bounded by Z? on average, so the allowable transmission interval Tmax is Z?/n, where n is the number of shares created by the (k,n) scheme. On the other hand, the average time for N link-changes will be E(TN ). Thus, according to the security requirement, the transmission  interval must at least be E(TN ) for average cases, denoted as Tmin. Since Tmax is determined by Z?, we assume Z? is configured reasonably so that the condition Tmin ? Tmax holds. This result also suggests that we can obtain the minimum total delay Z?min for average cases given the security level N . According to Equation (3), E(TN ) is N/?, thus, Z?min = n ? N/?.

For the second issue, when Z? and n are given, we can calculate the achievable security level measured in terms of the number of link changes Na. Specifically, Na = ??Z?/n. Na can be used to instruct the sender to dispatch packets. In a mobile network where moving speed and node density may change, this result is especially useful because ? can be a variable in reflecting the network condition and the sender can measure its risk.



V. SIMULATION  we use NS2 as the simulation platform to validate our schemes. In the simulation we adopt AODV routing protocol. There are 100 nodes in the network, from which we randomly select senders and receivers. CBR flow is used to mimic the message shares. For each CBR flow, the sender dispatchs 10 packets as if the original message is divided into 10 secrete shares. CBR sending rate varies to reflect the different transmission intervals as a parameter in our simulation. The sim- ulation time is configured based on time needed to send 10 packets. CBR starts from 60s to allow warm up. We investigate three representative mobility models, they include Random Waypoint Mobility model (RWP), Manhattan Mobility model (MHT) and Reference Point Group Mobility model (RPGM) [4][10]. For MHT and PRGM, we use the reviews in the paper that studied their properties [4] and the NS2 package provided. The default area 1000m ? 1000m in the NS2 package is used and transmission range is set to 200m. The sample speeds are used as well. For RWP, the network area is 1500m ? 1500m, with transmission range 250m. The motion speed for RWP is randomly picked from [1, 20]m/s.

Except the sender and the receiver of a particular CBR session, the rest are regarded as eavesdroppers. During the simulation, we collect the number of packets each node overhears. The frequency (percentage) of the nodes hearing different numbers of packets are calculated.

Figure 5 shows, for the RWP model, that the per- centage of nodes decrease as the number of packets increases, especially, only very few nodes can hear majority packets sent by the dispatcher. In addition, the figure illustrates an interesting phenomenon that is caused by the closed-space simulated network field.

Comparing the cases of intervals equal to 10s and 60s, a rapid decreasing trend and a flattened trend are reported      0.1  0.2  0.3  0.4  0.5  0  1  2  3  4  5  6  7  8  9  10  p e r c e n t a g e  o f  n o d e s  number of packets  Distribution for RWP model interval=10s interval=30s interval=60s  Fig. 5. Histogram of Random Waypoint Model   0.1  0.2  0.3  0.4  0.5  0  1  2  3  4  5  6  7  8  9  10  p e r c e n t a g e  o f  n o d e s  number of packets  Distribution for Manhattan model interval=10s interval=30s interval=60s  Fig. 6. Histogram of Manhattan Model  respectively. For the former case, the total time for the sender to move around is 100s. Such a time may result in a small area that is involved in forwarding (hence overhearing), and overlapping of path footprints exists as well. Thus, the curve of 10s shows a higher percentage of nodes hearing nothing, also a higher percentage of nodes who hear many packets. For the case of 60s, the total time for the sender to move around is 600s. This allows a larger area and more nodes to be involved in the footprints of the paths. The chance for overlapping reduces too. So there are less nodes hearing nothing, and less nodes hearing many.

For MHT model, two by two lanes with four inter- sections are configured. The two lanes in each direction are more than 300m apart, preventing overhearing across lanes. Figure 6 shows the frequency distribution of the nodes overhearing the packets. Typically, the model created a uniform distributions in that a large portion of nodes can hear around two to four shares.

Figure 7 and 8 show the frequency and deviation for RPGM group mobility model. We configured 10 groups. Each CBR flow picks the sender and the receiver randomly from different groups. Since the geographic area of a group is 50m with a margin in radius, all the nodes in the same group can hear each other. For a single CBR pair, it is easy to see that most nodes in the source and the destination groups can overhear the packets. Also   0.1  0.2  0.3  0.4  0.5  0  1  2  3  4  5  6  7  8  9  10  p e r c e n t a g e  o f  n o d e s  number of packets  Distribution for RPGM model interval=10s interval=30s interval=60s  Fig. 7. Histogram of Reference Point Group Model  the group motion feature leads to high likelihood of correlated overhearing, i.e., when different nodes from the same group are on the paths, most nodes of the group will overhear the transmissions. These effects can be seen from Figure 7, where the curves are flattened, or say, showing higher percentages compared to the other mobility models at the right end of the x-axis. Figure 8 shows large deviations for the most packets cases of 9 and 10. This suggests that a sender needs to know the risk from its own group and the destination group.

We then performed a new calculation that counts a zero packet for the nodes that overhear transmissions from the source or the receiver of the same group. Figure 9 shows the results after recounting the packets: more nodes hear no packets, less nodes hear 9 or 10 packets and the deviations are reduced.

Figure 7 also shows that when the interval increases, the probabilities of hearing most packets reduce. The reason is that when time goes by, the formation of a group is lost, more nodes move far apart than those in the initial state. Thus, the correlated overhearing feature is mitigated. Figure 8 of deviations also validates this observation by showing smaller deviations when the number of packets increases.



VI. CONCLUSION  We present and analyze the strategies for a time- based secure message dissemination scheme (TBDS) for mobile ad hoc networks. In TBDS, a message is split into many shares and each share is sent one after another with a certain interval of delay. In the paper, we analyze the strategies for selecting the intervals in two cases, namely, the application has no constraint on the total delay and the application has a delay bound. We also study the influence on the security of TBDS from different mobility models using simulations. The results show the differences among the models and the practical aspect of the scheme. For example, sending more shares helps more in Random Waypoint Mobility mode; but it     -0.1   0.1  0.2  0.3  0.4  0.5  0.6  0.7  0 1 2 3 4 5 6 7 8 9 10  p e r c e n t a g e  o f  n o d e s  number of packets  Distribution and deviation for RPGM model interval=10s interval=30s interval=60s  Fig. 8. Deviations of Reference Point Group Model   0.1  0.2  0.3  0.4  0.5  0.6  0.7  0 1 2 3 4 5 6 7 8 9 10  p e r c e n t a g e  o f  n o d e s  number of packets  Distribution and Deviation for RPGM model interval=10s interval=30s interval=60s  Fig. 9. RPGM not Counting Source and Destination Groups  is not the case for the Reference Point Group Mobility model if group members could be suspicious. In all, the analysis and evaluation validate that our scheme is a valuable alternative to enhance message confidentiality.

