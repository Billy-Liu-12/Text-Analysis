Craniofacial Model Reconstruction From Skull Data Based on Feature Points

Abstract   3D craniofacial model reconstruction from skull data has been a challenging research topic for many years. In this paper we develop a craniofacial reconstruction system based on feature points, and our approach only requires the skull model from a standard 3D scanner and feature points superimposed on the skull data. Our method consists of three stages: hole repairing for the 3D skull model, facial reconstruction with Radial Basis Function(RBF) deformation and texture mapping. A new advancing layer-wise solution algorithm and a template matching method are proposed for repairing big and particular holes on the skull model. The reference face model is then transformed to reconstruct the face model base on marked feature points on the skull model , and we improve the RBF deformation.. The experiments demonstrate the high efficiency and visual realism achieved in our approach.

1. Introduction   3D Cranio-Facial Reconstruction (CFR) is a simulation technology that employs computer graphics to reconstruct facial models and it is founded on the sciences of forensic medicine, anthropology and anatomy. 3D CFR is a hot researching topic due to its broad applicability, for example, criminal cases require CFR technology for victim authentication. Numerous research groups in universities and research institutes have pursued CFR research, e.g. University of Washington, Sheffield University, and Waseda University. However one of the major problems in reconstructing facial models is to do so with high efficiency for achieving a high level of realism[1][2][3].

This paper proposes a novel CFR approach applicable to Chinese people based on feature points.

Firstly, we scan a skull model and the model holes - typically generated by noisy scans - are repaired by building the implicit surface of holes and smoothing the mesh[4]. Secondly, a radial basis function (RBF) deformation method based on feature points is  proposed to reconstruct the facial model quickly with a high degree of realism. This is essentially a mapping process from a reference facial model to a source skull model, deforming the reference facial model appropriately to generate a face to furnish the skull.

Thirdly, we use an algorithm for constrained texture mapping to strengthen the visual realism of the reconstruction. Section 2 gives an overview of our approach including the algorithm outline. The key steps in our algorithm are described in Section 3. Some experiments and relevant discussion are presented in Section 4. Finally Section 5 presents conclusions and outlines possibilities for future developments.

2. System Description  2.1. System Overview   Our 3D CFR contains three stages. In the preliminary step, a reference facial model is extracted by iso-surfacing[5] from a set of Computer Tomography (CT) scans, and the source 3D skull mesh model is obtained with a 3D laser scanner. Typically the skull mesh model contains holes due to e.g. noisy scans or standard long-term damage (especially in the soft-bone area around the nose), so we repair such holes using standard four-step repairing technology, but we present novel advancing layer-wise solution for big holes and template model matching for specific hole e.g. nose.

Secondly, feature points are marked on the skull model in order to reconstruct the face surface model and we use a global and a local deformation for the reconstruction. The former guarantees consistency among the reference facial model and the source skull mode. The latter allows us to obtain detailed facial model information. Finally, texture mapping is employed to strengthen visual realism. The details of our approachs, e.g. hole repairing, facial reconstruction based on feature points would be introduced in the following sections  2.2. Hole repairing   _____________________________    The holes are repaired to guarantee the consistency of resource model and reference model. Figure 1 shows our algorithm process. For the standard hole, we employ the standard Four-stage Hole-Repairing Algorithm(FHRA). For holes in 3D Human skull are various, however, it is hard for us to apply this standard approach to repair some special holes(big hole or specific area). An improved algorithm advancing layer-wise solution (ALS) based on the standard FHRA method is presented for repairing the big holes , and a novel Template Matching Algorithm (TMA) is introduced for repairing the particular holes suitable for specific areas e.g. nose.

Figure 1. The hole-repairing algorithm   (1) Standard Four-stage Hole-Repairing Algorithm  The holes are identified by extracting and sorting points along their boundaries. Then generate all the necessary points for covering the hole area in its entirety. To guarantee the connectivity of the source skull mesh and the insertion points, we then build an implicit surface to represent the hole using a Radial Basis Function (RBF) [6][7] and the position of insertion points is adjusted by using the Newton Iteration Method [8].Finally a Laplacian operator is applied to smooth the triangular mesh surface[9].

(2) ALS method for the big holes  With the above method the insertion points are directly adjusted to implicit surface, however, if the holes are big, it is usually impossible to control the shape with the points around the hole for the implicit surface is usually flat. Therefore, we first use these points around the hole to get the shape of the adjacent area and generate the implicit surface, we then adjust the insertion points in this implicit surface to generate the new points, finally we repeat these two steps and repair the holes. The method, call Advancing Layer- wise Solution (ALS), is to improve the standard FHRA for large size holes, and guarantee that all the insertion points and the points around the hole lie in the same implicit surface. The result is shown in Figure 2(b).

(3) TMA for repairing specific areas  In our experiment, we also find both the standard FHRA repairing and its improved algorithm ALS are not suitable for some specific areas, e.g. around the nose, as the relevant anatomical structures exhibit  complex shapes that are not fully taken into consideration. We thus propose a novel Template Matching Algorithm (TMA), using a template model in order to repair the holes. The algorithm consists of two steps: model matching and mesh fusion. The model matching employs RBF deformation. The template nose model and the hole in the nose area are marked with some control points in pairs. By using these corresponding points as constrained points, the RBF deformation makes the the boundary of template nose model match the hole. In mesh fusion, we first take the vertices of the template nose model after model matching as constraint points, and the RBF implicit surface of the template nose model is then generated. We then adjust the vertices around the hole of nose area to the implicit surface. Finally, the vertices of the implicit surface and the vertices around the hole of nose are triangulated using Delaunay Triangulation. The result is shown in Figure 2(c).

(a)   FHRA            (b)    ALS            (c)   TMA  Figure 2.Hole-repairing results using different methods: (a) is the result using FHRA, (b) is the result of large hole repairing using ALS, (c) is result of nose repairing using TMA   2.3. Facial reconstruction with RBF deformation   The CFR is a deformation process from the reference facial model to the source skull model. The reference facial model is deformed to generate the primary features of the source skull model after defining and extracting the feature points under a uniform coordinate system.

According to standard anatomy, an individual skull feature point is by default matched with a facial feature point. The line connecting a skull and its corresponding facial feature point can be viewed as the normal on a surface mesh; the length of this line represents the soft tissue depth. The facial feature points can be calculated from the marked skull feature points using the rules developed in Lan[10] for Chinese people.

The problem can be represented as a spatial deformation, the algorithm contains two steps:  Firstly, the reference facial model is deformed globally to register the reference facial model and the    source skull model. Secondly, the improved RBF[11][12] deformation is implemented according to the network characteristic of RBF.

(1) Global Deformation  The Oriented Bounding Box(OBB) is applied to global deformation between the reference face model and the resource skull model. Then the method of global coordinate scaling is used to make the registrations in facial features between the both models accurately, consequently, lay the foundation for the local deformation.

(2) Local Deformation  We improved the RBF formulation from  )()( ? ?  ?? N  i ii xxhcxF  to  )()(  i  n  i i ppcpf ??? ?  ?  (1)  where ipp ?  is the Euclidean distance between P  and Pi, and )( ipp ?? is the radial basis function.

We add low-order polynomial to the transformation function to represent the global deformation, such as affine transformation, and the transformation function is then changed as the following form,  tMpppcpf i n  i i ??????  ?  )()(  (2)  where n is the number of feature points, ci 3*1R? is  the weights associated with feature points,  is the radio symmetric function, ip  3*1R? is the control point, 3*3RM ? and 3*1Rt? are the affine transformation, respectively.

Our CFR approach consists of the following three steps by using the above improved RBF.

) For each feature point i, the position on the reference facial model is marked by Pi , and the position of facial feature point associated with skull feature point on the source skull model is marked by qi (qi is calculated by qi=si+di, where si is the position of source skull feature point, di is the depth of soft tissue associated with si), f(p) is a function that maps the pi to qi: qi=f(pi), the non-feature points position of the reference model can be obtained from f(pi).

)  qi=f(pi) is the transformation function and f is denoted by a radial basis function which is chosen as formulation (4).

) To remove the contribution of affine transformation from the weighted sum of the RBF, we have the additional constraints:  ?? ??  ?? n  i  T ii  n  i i pcc   0,0                                  (3)  Let )(, iij ppa ??? ? 	nij  ,1  and we can get the matrix equations:  ? ? ? ? ? ? ? ?  ?    ? ? ? ? ? ? ? ?  ?  ?  ?  ? ? ? ? ? ? ? ?  ?    ? ? ? ? ? ? ? ?  ?  ?  ? ? ? ? ? ? ? ?  ?    ? ? ? ? ? ? ? ?  ?  ?     '  '  '        nn  T n  T  nnnn  n  n  p  p p  t M c  c c  pp  paa  paa paa  ??  ? ?  ? ?????  ? ?  (4)  After getting the coefficient ic  ( )0 ni  of RBF and affine components of M and t, the source facial model is generated by transforming each mesh vertex of the reference facial model in the volume spanned by the feature points according to formulation (2). There are some functions that can be chosen for RBF, such as  the Gauss function 2)(  )( c r  er ?  ?? , the reverse square-  root function 2  22 )()( ?  ??? crr , and the thin-plate spline rrr k ln)( 2?? . In our experiments, we have used the Gauss function as the RBF and c = 64.

3. Experiments Results and Discussion   Our algorithms have been implemented under VC++ and the Visualization toolkit, and source skull data obtained from a hospital. The experimental environment is Pentium IV with 1.83 GHz main frequency of CPU and 1.5GB memory.

According to the shape characteristics of the skull and the structure of facial model, we use RBF deformation to reconstruct the face model. After marking 36 feature points on the source skull model and the reference facial model, the reference facial model is deformed to get a realistic facial model which matches the source skull model under the control of these feature points.

The result is shown in Figure 3(a). To improve the efficiency of the algorithm, we use another 3D skull model to transform the same reference facial model, see Figure 3(b), and the result is also realistic. Finally, we use the constrained texture mapping method to improve the visual realism of the reconstructed facial models. This method is to find a mapping function that maps each (x,y,z) point on the mesh to the point (u,v) of the texture image, We first mark the constrained points on the texture image, then employ an interpolating Radial Basis Function (RBF)[7][8] to get the texture coordinate of non-constrained points    according to the constrained points. See the final result Figure 3(c) and (d).

Figure 3.The results of our facial reconstruction   4. Conclusions and Future Work   Computer-aided CFR can be used in a variety of fields, such as criminal cases, face-lifting surgery, archeology, and realistic facial animation. This paper presents a novel craniofacial reconstruction system based on feature points. It consists of three stages: hole repairing for the 3D skull model, facial reconstruction with RBF deformation and finally texture mapping. In the stage of hole repairing, new repairing methods for complex holes of the skull data are proposed ?ALS for big holes and TMA for particular area; In the phase of facial reconstruction, we improve the RBF deformation for face model reconstruction from the skull meshes; Finally we optimize the constrained texture mapping for the realistic face model. Our approach is validated for Chinese people and this depends on the relationship between the facial feature points of the source skull model and the skull. The experimental results demonstrate the high realism of the method.

In the future, we will reduce the error propagation by introducing an extra processing stage in our method, and also work on adapting our techniques so that for specific areas (e.g. eye and mouth) are treated differently by the matching algorithm.

Acknowledgements   This work was partly supported by the National Natural Foundation of China (NSFC) project under grant No. 60703002, Zhejiang Provincial National Natural Foundation project under grant No. Y1080383 and Y106371, and key project from Science and Technology Department of Zhejiang Province under grant No.2007C11022.

