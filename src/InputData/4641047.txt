Inference Optimization Approach in Fuzzy Inference Systems

Abstract  This paper tries on the representation of Mamdani kind fuzzy inference systems by means of fuzzy association equa- tions. The methodology is described to represent the control system modeled on fuzzy rules, in a system outlined by equa- tions and inequations. Once represented the system here- with the described methodology, these same equations are used to validate the system fuzzy rules. Later a linear pro- gramming software is used to solve the equations system and this way to carry out the fuzzy inference. The objective function of the equations system is also optimized through a learning algorithm based on upward search. This approach is demonstrated with an application example.

1. Introduction  The fuzzy inference systems is a computing framework based on the concepts of fuzzy set theory, fuzzy if-then rules, and fuzzy reasoning. It has found numerous success- ful applications in a great variety of fields, such as auto- matic control, data classification, decision analysis, expert systems, robotics and pattern recognition. It is also known by other names as: fuzzy-rule-based system, fuzzy expert system, fuzzy logic controller, or simply as fuzzy system.

The basic structure of a fuzzy inference system consist of three conceptual components: a rule base, which con- tains a selection of fuzzy rules; a database (or dictionary), which defines the membership functions used in the fuzzy rules; and a reasoning mechanism, which performs the in- ference procedure upon the rules and given facts to derive a reasonable output or conclusion.

This last concept it is also called approximate reasoning, fuzzy reasoning, or generalized modus ponens, since it has modus ponens as a special case. In this work the fuzzy rules will be converted to equations and inequations set. Then the inference is made by the optimization of the equations by means of Lineal Programming (LP ).

The structure of the paper is as follows: next section consists of the art state. In the section 3 the basic con-  cepts and definitions are introduced. In the section 4 the proposed fuzzy inference system is exposed. In the section 5 the methodology is explained to transform the fuzzy rules into a equations system. The section 6 introduces a learn- ing algorithm of the J index . In the section 7 a validation technique for a fuzzy rules system is introduced. In the last section an application example is discussed as a test of this approach.

2. State of the Art  Regarding the optimization in fuzzy rules inference, there are contributions as [9, 6]. Although in them, the fuzzy rules were for the failure diagnose inference in in- dustrial systems. In [8] it becomes a system based on fuzzy rules to a system of equations and inequations for their val- idation, but it is not for inference optimization.

Others as [3] they use binary logic instead of equations and inequations, although the position is similar (they use LP for inference optimization). In [5] they are based on fuzzy relations for the inference, but they do not optimize with LP . In approaches as [2, 4], they use fuzzy relations to solve LP problems, but they do not inference optimization.

The approach in the present paper is mostly parallel to [9, 6] for optimizing the fuzzy inference through LP .

3. Basic definitions  Fuzzy knowledge. The two-valued logic deals with op- erators defined in the values set {0,1} ({false, true}). In fuzzy logic the values are really in the interval [0,1]. The conjunction operations, disjunction and negation are trian- gular norms, conorms and 1-complement, respectively. In the representation of the knowledge in the systems based on fuzzy rules the implication (?) and double implication (?) operators are fundamental in the rules representation.

Fuzzy sets. Given a universe set U and a set A ? U , ? x it is A?-true it is defined equivalent to x ? A. Concepts that admit quantification of meaning can be represented by fuzzy sets [11], defined by membership functions (MFs).

Electronics, Robotics and Automotive Mechanics Conference 2008  DOI 10.1109/CERMA.2008.42     The grade of membership to a fuzzy set F ? U it is de- scribed by the function ?F : U ? [0, 1]. The fuzzy sets op- erations intersection, union and complementation are gener- alized with the appropriate fuzzy logic operators over their MF?s. The generalization of subsethood fuzzy sets it is an inequality: given two fuzzy sets A and B, where A ? B if ?A(x) ? ?B(x), ?x ? U .

Membership functions. Denotes the degree of mem- bership of the variable value with regard to given set. For discreet values the usual forms of the MFs they are the tri- angular and the trapezoidal. For continuous values they are the gaussian or bell. In this paper the trapezoidal form was used.

Inference. Formulated some premises, one can to in- fer additional knowledge when really proving the values of a set of conclusions, in such a way that no contradictions arises.

4. Fuzzy inference system proposed  In this paper the fuzzy inference system will be treated from the point of view of the Mamdani fuzzy logic con- trollers, although the approach here proposed it can also be applied to the Sugeno class inference system.

The fuzzy inference system to which I will refer is de- scribed in a blocks diagram depicted in the figure 1 where from up to down X is the entrance signal. Xj it corresponds to the antecedent of the inference rule ?if X is Aj? and Yi, it is equal to the consequent of the same rule, this is: ? then Y is Bi?. The block exit Xj , it is equal to ?Aj (x). The block exit Yi it is equal to ?B?i(y) where B  ? ? B clipped by ?Aj (x).

The Aggregator it is where the operation of Mamdani fuzzy implication is done, that involve the max-min compo- sition. For the system exit, it is the Defuzzifier that belongs to centroid kind in this applications (COA). It generates a crisp output.

Now, reference is made to the existent fuzzy associations among the blocks Xi and Yj that constitute the main dis- cussion topic of this contribution. The auxiliary variable Sji it denotes the existent relationship between the antecedents and the consequents of the rules. In the concrete case ob- served in the figure 1 the continuous arrow of S11 , it cor- responds to a direct association. This is, an equivalence relationship among the MFs directly associated (where ?Aj (x) = ?Bi(y) for any value of x). In the case of the figure 2 for the rule ?iff X is Small then Y is Small? the de- notation could be SSmallSmall .

The doted arrows denote a fuzzy association (?uncer- tain?) among the antecedents and consequents. In this sit- uation we would have at S21 and S  2 where with regard to  the figure 2, you can represent S21 as S Medium Small that is the  association among the MF Small, when Y is in the in-  terval [1.5, 2.5] and the MF Medium, when X is in the interval [?6,?3]. In the same way , you can represent S12 as SSmallMedium in the same values interval of Y and X , that it has been defined in the previous case. The fuzzy inference rule for this uncertain association may be ?if X is Small then Y is Medium?.

Figure 1. Inference system of fuzzy associa- tions  5. Fuzzy Inference Equivalent Equations  An equation image of fuzzy rulebase may be formed starting from the implication equation that meets binary generalization requirements. For various reasons the Luka- siewicz bounded sum where ?A ? B is true? equivalent to ?min(1, 1 ? A + B) = 1?, is advantageous over other choices [7]. The former is equivalent to a simpler inequal- ity, used as the basic definition for the implication.

Implication. The equivalent inequality that replaces fuzzy implication ?A ? B it is true? it is defined as  A ? B (1)  Double implication. This is ? A ? B is true,? repre- sented as A ? B and B ? A will be equivalent to  A = B (2)  This way, the inference is transformed into solving a set of equalities and inequalities. It is good to clarify that the fuzziness is alone existent in the premises. It is assumed     that the rules are proposed in the way ?A ? B is true?.

The truth of the rules in the interval (0, 1) may lead to the effects of presumption, prejudice and paradoxes [10]. Inter- mediate cases will be treated with the confidence functions (inference error), as reported in section 7.

5.1. Antecedent-consequent association  The association or relationship among an antecedent Xj and a consequent Yi will be expressed by an auxiliary ?as- sociation variable?, denoted as Sji fulfilling the following constraints:  ? If the antecedent Xj is directly related with the conse- quent Yi, it is a direct association between the involved MFs in such a way that Sji will fulfill by definition, the equality constraints:  Sji = Yi (3)  ? If the association between the antecedent Xj and the consequent Yi is nonexistent, then  Sji = 0 (4)  ? If the association among the antecedent Xj and the consequent Yi is ?uncertain? (this is, it can be an equality or an inequality depending on the value of X), the following restriction on Sji will be added:  Sji ? Yi (5)  The expression constraint (5) it will be given preferably when the MFs antecedents of the rules Xj , they are su- perposed among them. If they are not overlapped, a fuzzy association will not exist between the rules premises.

5.2. Superposition  Once restrictions on the relationship coefficients Sji have been set up, the inferred state of the relationship of the an- tecedent Xj with regard to the coefficients S  j i , will be given  by the disjunction [6] over all the possible consequent Yi, with which it is related (a given node Xj). It may be ex- pressed as:  Xj = min(1, k?  i=1  Sji ) (6)  However, (6) is not lineal. In order to preserve the linear- ity, the following inequalities should be added to the knowl- edge base instead of (6):  Sji ? Xj ?i (7)  Xj ? ?  i  Sji (8)  The first equation indicates that the fuzzy value to the exit of the antecedent Xj is bigger or equal as the exit of the consequent with which is related. The second equation indicates, that at least one relationship with the consequent should be true, so that the exit Xj is not zero. In this con- text, the interpretation of Sji = 1 is ?Yi it relates with full- ness certainty to Xj?. The equations (7) and (8), they were proposed first in [7] and adapted here for their application.

5.3. Inference as a constrain satisfaction problem  Given the control signal X and the restrictions specified in (3)-(8), the inference problem in the fuzzy logic con- troller can be formulated as a constrain satisfaction prob- lem. As all the argued restrictions they are linear with re- gard to the unknown variables, the linear programming (LP) it can be used as a solution tool. In this paper it is used for this effect software like GNU Octave 3.0, MATLAB 6.0 and Mathematica 6.0, having similar results in each one of them.

The elementary theory of the LP shows that a set of feasible decision variables will be a convex polytope.

LP optimization. Enumerating polytope vertices is overly impractical. The problem must then be converted to a LP optimization one in order to get a unique solution, for that, it is proposed the implementation of the following technique:  First , we add the following equation to the knowledge base  Xj = xj + ?j ? ?j , ?j ? 0, ?j ? 0 (9) where ?j and ?j they are artificial variables and xj ? Xj  (then now xj = ?Aj (x)). This way, it is feasible to have an unique solution.

Second, the objective function J is built to be ?mini- mized?. The index J consists of three terms:  ? The sum of all the certain variables with a certainty possibility ?c, which are weighted with ?c ? 0, this is J1 = [?cS11 + ? ? ? ].

? The sum of the association coefficients Sji for those which i 6= j. This is, all the coefficients of uncertain fuzzy relations.

J2 = ? i 6=j  ?ji S j i (10)  where ?ji should be learned in such a way that the exit of the proposed fuzzy inference system follows to the control function f(x). The learning algorithm for this will be seen in the section 6.

? The sum of the weighted auxiliary variables J3 =? (?j?j + ?j?j). In order to achieving that Xj ? xj ,  the variables ?j and ?j should be weighted in signifi- cant form (?j ??).

In the optimization framework, the lower J is the more ?possible? it can be considered, according to the ideas in [1]. This way, the marginal possibility of some variable can be denoted by the following function:  ?margi (x) = e ?min Ji(x) (11)  In this context, all the certain variables (without includ- ing those of (9)) have a ? = 1, then, if we want to in- clude those in the J costs index, they should be weighted with a very small value (?i ? 0). For the above ideas the only variables whose weight should be learned, are the vari- ables of those that we do not have a clear idea as we should ponder. This is, the uncertain fuzzy association coefficients (10).

Uncertain associations as those of (5), they can also be defined as ?softened? equalities:  Sji = Yi ? ? j i , ?  j i ? 0 (12)  where ?ji should be added weighted appropriately in the J index of the objective function. This is, if it is weighted with a big value, (12) becomes in (3). If it is weighted with a small value, (12) becomes in (5). With the above ideas we can model the fuzzy relations expressed by the variables Sji in a different way.

6. Learning algorithm of J index  In the section 5 has been mentioned, that we need to learn the uncertain fuzzy relations (10). If one, does not want to have a very optimized system, then we must set up a ? = 0.999 to all the certain variables (? = 0.001) and a ? = 0.900 to all the uncertain variables (Jui), in order to facilitate the optimization for LP. With these J index val- ues in most of the simple systems, the exit Y will follow to the control function f(x). In case it is wanted to have an optimized index, it is the following algorithm.

Considering the fact that the system has been converted to a system of equations and inequations, and that we also have the linear optimization functions as they are: glpk from Octave R?, linprog from MATLAB R?, or Minimize from Mathematica R?. We propose a objective function E(x) (er- ror function), that let us to know when the control func- tion has been learned by the proposed fuzzy relacional sys- tem (E(x) ? 0). E(x) is the difference among the de- fuzzifier exit Y m(x) of the classic Mamdani fuzzy system (f(x) = Y m(x)) and the defuzzifier exit Y p(x) of the pro- posed system.

E(x) = Y m(x)? Y p(x) (13)  where x is the control function domain and it increases according to kT , this is, x = kT where k can be two- dimensional (?k) and T is the step or increment period  of k that grows until n. The kT iterations run until nT is reached. Fuzzification of each kT value is made with the system antecedent MFs. The obtained fuzzy values (Xj = ?Aj (x)), they feed the ?minimisation? function, which previously is passed all the system equations and in- equations, together with all the constraints and the J objec- tive function definition.

The fuzzy exits Yi(kT )(5) that are obtained from the ?minimisation? function, they are those ?B?i(y) that are ap- plied to the consequent MFs of the Mamdani fuzzy sys- tem. These values are good to develop the Mamdani kind fuzzy implication and the classic composition max?min.

As soon as obtaining the function sum after the previous op- eration, the centroid Y p(kT ) is obtained from the resulting MF . With this centroid and with the one that we already know apriori, this is, Y m(kT ) we apply (13) to obtain the corresponding E(kT ).

If E(kT ) > threshold, this is, the error is even big, for example E(kT ) > 0.0001 then, the following expression is applied for the costs index  Jui_next = Jui_now + ?E(kT ) (14)  where ? is a factor that graduates the increment of Jui and it could has a small value that give us a fine adjustment, for example ? = 0.001. Also J = [Jui + ? ? ?+Jun +Jci + ? ? ? ] where, Jui are uncertain association variables indexes and Jci are certain association variables indexes. Due to the nature of the problem that is optimization for minimisation, when being increased the Jui then diminishes the E(kT ).

When k it increases until n, it is said that we complete the first epoch. The numbers of necessary epochs it will depend on the total error ET defined by the following expression  ET = n? k  E(kT ) (15)  This is, if ET < threshold (for example ET < 0.001) then we will say that the proposed fuzzy associations sys- tem, it learned the J objective function weights appropri- ately, in such way that follows to the control function f(x) that we use for training the system.

7. Fuzzy systems validation  The proposed framework allows to validate the rulebased fuzzy inference system, for this in [7, 8] it is introduced the ?inference error?. A function ? : [0, 1]? [0, 1] ? <+ called rule inference error (IE) it is defined, such that ?x, y ? [0, 1] the IE ?(x, y) ? 0 and where ?(x, y) = 0 ? x is a solution of the rule equation. In the binary case, IE is a function {0, 1} ? {0, 1} ? <+. When a conclusion is inconsistent it is defined as 1 to denote that one rule is con- tradicted.

Once the inference error for each rule has been defined, the costs index formed by adding all the individual error functions will be called global inference error of the rule- base. IE will be null only at the solution of the equations.

Thus, inference consists on finding the zeros of the global IE. The inference error function ? : [0, 1] ? [0, 1] ? [0, 1] for fuzzy IIF and IF rules are  ?IIF (A,B) = |B ?A| (16)  ?IF (A,B) = {0 A ? B  A?B A > B (17)  The functions IE are a contradiction gradation: a con- clusion B it can be coherent with regard to the premise A (? = 0) and a rule , it may be totally contradictory (? = 1) or it could be in some intermediate place of ?. Now this IE could be used to validate a fuzzy rulebase. Given a fuzzy rulebase, the function encoded in it is recovered by finding the f that makes IE as low as it is possible.

8. Application example  Given the MFs (Small, Medium, Large) of the figure 2, the rules try to model the function identity y = x and those will be  X Small ? Y Small, X Medium ? Y Medium, X Large ? Y Large  In accordance with the methodology proposed in the sec- tion 5 (depicted on figure 1) the MF Small, it is equivalent to the subindexes 1, the MF Medium to the subindexes 2, and the MF Large to the subindexes 3.

The Xj(x) identify the MF of the antecedent Aj such that xj(x) = ?Aj (x), in the same way we have that Yi(y) = ?B?i(y). As we can see in the figure 1 the association vari- ables Sji they relate the antecedent Xj with the consequent Yi.

Certain associations. As previously has been defined the certain associations with regard to the variable Sji they are the following equations  S11 = Y1, S 2 = Y2, S  3 = Y3  Uncertain associations. The uncertain associations take place in the fuzzy gradual parts of the Xj MFs and it is uncertain because the relationship of Sji with regard to Yi it depends on the values of X in the gradual interval (X ? {[?6,?3] ? [3, 6]} in this case). For what is con- sidered that Sji ? Yi for ? i 6= j. This is, S  j i it could be  smaller to Yi and when much same. The following ones are the equations and inequations of uncertain associations.

S21 = Y1 ? ?21 , S12 ? Y2, S32 ? Y2, S23 ? Y3 (18)   0.2  0.4  0.6  0.8   1.2  -10 -8 -6 -4 -2 0 2 4 6 8 10  M e m b e r s h i p  G r a d e s  X  Small Medium Large   0.2  0.4  0.6  0.8   1.2  1 2 3 4 5 6 7 8 9 10  M e m b e r s h i p  G r a d e s  Y  Small Medium Large  Figure 2. Single-input single-output Mandani fuzzy model for the example  Softened equalities. The first equation in (18) it is a softened equality and with the weights adapted in the J in- dex for ?21 (w?21 ? 0) it is equivalent to S  1 ? Y1.

Superposition equations. These assert the truth of the entrances Xj with regard to S  j i and the possible existence  of several true degrees of Xj with regard to the consequent ones with those that is related. The following ones are the superposition equations.

S11 ? X1, S12 ? X1, S11 + S12 ? X1, S21 ? X2, S22 ? X2, S23 ? X2, S21 + S22 + S23 ? X2,  S32 ? X3, S33 ? X3, S32 + S33 ? X3  Auxiliary variables. All the Xj were relaxed adding the variables ?j and ?j to allow an unique solution. For what the following equations will be had.

X1 = x1 + ?1 ? ?1, X2 = x2 + ?2 ? ?2, X3 = x3 + ?3 ? ?3  Now xj = ?Aj (x) and the auxiliary variables ?j and ?j they should be weighted significantly to achieve that Xj ? xj .

Objective function J. In this index all the variables are included (except the xj that are the entrances to our system), each one of which it is pondered with a weight. As it was suggested previously the certain associations are pondered with ?c = 0.999, this is ?c = 0.001. The weights of the uncertain associations (10) (?ji ) and the auxiliary variables weights of the (9) (?j), they will be learned according to the algorithm of the section 6. The particular index of this     example, it turn out in the following way  J1 = [?cX1 + ? ? ?+ ?cY1 + ? ? ?+ ?cS11 + ? ? ?+ ?c?21 ], J2 = [0.0038S21 + 0.0038S  2 + 0.0075S  2 + 0.0075S  3 ],  J3 = [0.0038?1 + 0.0038?1 + 0.0075?2 + 0.0075?2+ 0.0077?3 + 0.0077?3]  J = J1 + J2 + J3  We will notice that the softened equality variable of (18), ?21 has been weighted with ?c, due that with this value the required inequality is achieved. After executing the learning algorithm the weights in J2 and J3, they were shown. In the figure 3 the function is observed without the adjusted weight (star plotting) and after being learned (continuous line).

Other restrictions. In this last stage, it is necessary to assure that all the variables in the optimization should be positive or zero.

-10 -8 -6 -4 -2 0 2 4 6 8 10  Y  X  Figure 3. Learned control function f(x)  Summary. After having learned the weight of the un- certain variables it is possible to use the fuzzy inference sys- tem at least in open loop as we have been suggested in this paper. The optimization command in a PC of common use (AMD Sempron 3000 R?) for this example in particular, it is executed in 0.099 seg. For this reason, most of the process that have regular dynamic behavior, it is possible to control with the proposal methodology. Also it is possible to add rules in an environment of optimization that in traditional inference could not be added. For example, if for some rea- son we modify the MF of Yi in such a way, that they do not conserve the property of mutually exclusive, we could introduce the following rule (without necessity of modify- ing any weight or variable)  Y1 + Y2 + Y3 ? 1  With the above ideas the control function f(x) it was modified satisfying the user?s necessities (f(x)?) and the in- ference system conserves the property of mutually exclusive  without a significant deviation of f(x)?. Others advantages of this approach is the possible validation of our fuzzy infer- ence system, thanks to its equations and inequations struc- ture that for brevity in this paper is not analyzed.

9. Conclusions  In this approach it was presented a new outline for an inference system based on fuzzy associations. it has been presented as converting a system of traditional fuzzy infer- ence to an inference system with equivalent equations, for later executing the inference mechanism by means of LP , obtaining satisfactory results in the application example. In the one which also the J costs index learning algorithm was proven that was able to learn each involved weight. This proposal besides conserving all the characteristics of the classic fuzzy inference systems, it can add new rules in an optimization environment what contributes to a better oper- ation.

