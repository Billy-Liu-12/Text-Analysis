Multi-agent system for early prediction of urinary bladder inflammation disease

AbstractThis paper presents an efficient real-time knowledge  base architecture for multi-agent based patient diagnostic  system for chronic disease management, basically, the early  detection of Inflammation of urinary bladder and Nephritis of  renal pelvis origin diseases. The model integrates information  stored heterogeneous and geographically distributed  healthcare centers. The paper presents two main contributions.

First, a proposed multi-agent based system for mining frequent  itemsets in distributed databases. Second, the implementation  of this model on distributed medical databases in order to  generate hidden medical rules. The proposed model can gather  information from each department or from different hospitals,  and using the cooperative agents it analyzes the data using  association rules as a data mining technique. The proposed  model improves the diagnostic knowledge and discovers the  diseases based on the minimum number of effective tests, thus,  providing accurate medical decisions based on cost effective  treatments. It can also predict the existence or the absence of  the diseases, thus improving the medical service for the  patients. The proposed multi-agent system constitute an effort  toward the design of intelligent, flexible, and integrated large-  scale distributed data mining system.

KeywordsMulti-Agent System, Distributed Data Mining,  Association Rules

I. INTRODUCTION  The increasing trends in the occurrence of diseases  present serious problems in providing suitable healthcare  within the existing medical structure. Medical experts and  doctors can provide health-care diagnosis and address these  anticipated problems. However, the large number of patients  and their related data cannot be efficiently processed with  existing systems especially if the patient medical records are  distributed in many hospitals and an efficient processing  approach is needed for real-time response requirements for  critical health situations.

Many researchers have adopted different data mining  techniques for mining association rules in large medical  databases, for instance skin cancer [1]. In most of these    cases, association rule mining was implemented on a single  centralized database. The medical databases are usually  distributed in different hospitals. This has motivated many  researchers to investigate various distributed association  rules techniques for mining distributed medical databases,  for example, mining protein data [2] and diabetic patients [3]  distributed in different sites. The problem with these  techniques is the lack the scalability and the flexibility  especially when the number of distributed sites is high.

Moreover, these techniques lack the ability to deal with  heterogeneous data bases.  In this context, multi agent  systems for medical domain have been proposed by many  researchers [4]. Agents have proven to have a lot of  advantages in the medical domain. Initially, some  researchers used agents for monitoring patients data obtained  through Body Area Network (BAN) tools [5, 6] or based on  patients feedback [7]. Consequently, researchers have tried  to develop these techniques and use the data gathered for  building a decision support systems for helping doctors  enquiry for breast cancer. An example of such applications is  presented in [8]. Recently, data mining and agents  integration techniques have been proposed [9], some  researchers used some data mining techniques like clustering  for Schizophrenia disease [10]. The agent negotiation in such  techniques however, do not comply to a global standard like  Foundation for Intelligent Physical Agents (FIPA) [11] to be  able to cooperate with other agents.

This paper proposes the application of the multi agent  systems for mining association rules as a data mining  technique for medical databases that are distributed in  decentralized hospitals, following the standard FIPA.  We  present two main contributions. First, we develop a  collaborative multi-agent system based platform and added a  rule agent to be able to mine the hidden association rules  patterns concerning the distributed databases. The rule agent  can communicate with the previously discussed main and  local agents using global FIPA standards. Second, the whole  extended model is applied to a medical database for the  Inflammation of urinary bladder disease and the Nephritis of  renal pelvis origin for mining the medical association rules.

The medical databases are distributed in two different  hospitals. The proposed platform can mine data from    different hospitals or from different departments at the same  hospital. Due to the autonomous and cooperative behavior of  the multi-agent platform, the main agent sends a message for  the newly implemented rule agent which extracts the medical  rules and stores them in the medical knowledge base. This  knowledge base can provide many advantages for the  medical staff. For instance, the medical rules extracted can  help doctors in identifying the minimum number of the  effective tests needed to specify the existence and the  absence of the diseases. It can also help doctors to identify  the existence or the non existence of the diseases for the  incoming patients thus can be used in prediction.  The  proposed system can help to improve the diagnostic  knowledge for the doctors. The rest of the paper is organized  as follows. The next section presents a brief background  about the Foundation for Intelligent Physical Agents  standard (FIPA) and a background of this work. Section 3  presents the proposed multi-agent model with the rule agent  for mining association rules from the generated frequent  itemsets. It also describes the message negotiation between  the model agents. The application of the proposed model to  539978-1-4244-8136-1/10/$26.00 c2010 IEEE  distributed medical databases for the Inflamm  bladder disease and the Nephritis of ren  disease and the rules generated by the  discussed in Section 4. Section 5 descri  explanation for the generated rules and th  the results. The last section evaluates the  technical and the medical point of views.



II. PROPOSED MULTI-AGENT BASED S  A. FIPA agent management reference mo  FIPA is an IEEE Computer So  organization that promotes agent-based tec  interoperability of its standards with oth  moreover, it was officially accepted by  eleventh standards committee on 8 June 200  FIPA agent management reference  framework in which FIPA agents exist a  main components of this framework are the  (AP), the Directory Facilitator (DF), the Ag  System (AMS) and the Message Transport S  Agent Communication Languages (A    proposed based on the speech-act theory w  from the linguistic analysis of human comm  this theory, "performative" means pur  performed during conversations between th  communication. Sending a performative in  partner results is an intention of an action.

"request" performative means that the sen  receiver to execute some actions. Two  declarative agent languages are KQML (K  and Manipulation Language) and FIPA AC  conceived both as a message format and a m  protocol to support run-time knowledge  agents but the support for KQML has been  favor of FIPA ACL [13].

B. Collaborative Multi-agent based system  In our previous work we have develope  multi-agent based system for mining assoc  distributed databases. The previously prop  based on cooperative agents and was c  Foundation for Intelligent Physical Agents  The model combined different type of tech  the association rules as a data mining te  multi-agent systems to build a model that  distributed databases rather than working  database only. The autonomous and the soci  model agents provided the ability to opera  with each other and with other different exte  offering a generic platform and a basic infra  deal with other data mining techniques  algorithm is described as follows:  1. The Interface Agent accepts the requir  the user and sends it to the Main Age  FIPA message with a "Propose perf  Local Agents in all hospitals to start m  2. Local Agents reply with an "Agree  the Main Agent and counts the local su  ation of urinary  al pelvis origin  experiment are  bes the medical  e significance of  model from the    YSTEM MODEL  del  ciety standards  hnology and the  er technologies;  the IEEE as its  5 [11].

model is the  nd operate. The  Agent Platform  ent Management  ervice (MTS).

CL) has been  hich is derived  unication[12]. In  poseful actions  e participants of  a message to the  For example, the  der requests the  most popular  nowledge Query  L.  KQML was  essage handling  sharing among  discontinued in  d a collaborative  iation rules from  osed model was  ompliant to the  standard (FIPA).

nologies, namely  chnique and the  can operate on  on a centralized  al abilities of the  te cooperatively  rnal agents, thus  structure that can  . The proposed  ed support from  nt which sends a    ormative" to all  ining.

performative" to  pports for all 1-  candidate itemsets in their loca  3. When Local Agents finish co  Inform performative" to the  all counts received and compa  4. The Main Agent finds the 1-  them in the database in the l  then sends a FIPA mess  performative" to each of the Lo  5. The Main Agent generates the  sends them to all Local Agent  performative" FIPA message  count the support of the candid  6. Local Agents calculate the su  itemsets in their local databas  "Inform performative" messag  7. The Main Agent considers a  frequent if the summation of a  all Local Agents is greater than  these itemsets are saved in th  small itemsets are not consider  8. Steps (10) to (15) are iterativ  are no more k+1 candidate item  9. The Main Agent sends an  message to all Local Agents  generation process is finish  frequent itemsets to the Interfa  The platform has been compa  association rules algorithms withou  proved to be more efficient and m  shows how the proposed mul  outperformed the traditional associa  Figure 1. Time comparison between  From the above Figure we ca  needed for mining frequent items  multi-agent based algorithm is less  traditional association rules algorith  difference between the two implem  the number of database records incre    Our goal at that time was to ad  to extract interesting rules from rea  medical domain in order to dem  capabilities of the proposed mode  been proposed in this paper.

l database.

unting, they reply with  Main Agent which sum  res it with min support.

large itemsets and save  ist of frequent itemsets,  age with an "Inform  cal Agents.

k-candidate itemsets and  s, then sends a "Request  to each Local Agent to  ate k-itemsets.

pport of the k-candidate  es then send them in an  e to the Main Agent.

k-candidate itemset as  ll its local supports from  the min global support,  e central database while  ed in the next iteration.

e and finish when there  sets.

"Inform performative"  informing them that the  ed, and sends all the  ce Agent.

red with the traditional  t multi-agents and was  ore scalable.  Figure 1  ti-agent based system  tion rules algorithms.

the two implementations  n deduce that the time  ets using the proposed  than that needed using  ms. Moreover, the time  entations increases when    ases.

d a rule generation agent  l data specifically in the  onstrate the merits and  l further. This goal has   C. Rule agent  The proposed model is based on a cooperative multi-  agent based association rules algorithm which is used to  discover frequent itemsets from distributed databases and a  rule agent. All agents (main agent, local agents and the rule  agent) in the whole platform operated as a unit [14]. This  rule agent is  basically based on Apriori Algorithm for  discovering association rules from large databases [15]  although we had to modify some parts of this algorithm to be  able to work in a distributed and multi-agent environment.

Moreover, the rule agent algorithm is modified also to deal  with the itemsets discovered by the main agent. A detailed  description for the rule agent algorithm and the message  negotiations between the main and the rule agents will be  described in this section. Figure 2 illustrates the solution  architecture of the proposed multi-agent based model.

Procedure RuleAgent()  // This is the main algorithm for the Rule Agent  1) For all large k-itemsets (lk) generated by the main  and the local agents, where k>= 2 do begin  2) Call GenRules (lk, lk);  Procedure GenRules (lk: large k-itemset , am: large m-  itemset) // This function generates all valid rules in the  //form:  a => (lk  - a), where a ? lk  1) Generate (A) which is the set of m-1 itemsets (am -1)  subsets of the itemset (lk);  2) For all (am -1) ? A do begin  3) The rule agent sends a message to the main agent  to calculate the support of (lk);  4) The rule agent sends a message to the main agent  to calculate the support of ((am -1));  5) When the rule agent receives the support values,  it calculates the rule confidence as follows:  Itemset_conf = support(lk) / support((am -1));  6) If (Itemset_conf)>= Minconf  then begin  7) Output the rule (am -1) => (lk  - am -1 )    With confidence = Itemset_conf  And support = support(lk);  8) If (m - 1 > 1) then Call GenRules (lk  , am -1);  9)  End;  End GenRule;  Figure 2. Solution architecture for the proposed model  The proposed sequence of the data mining process for the  distributed medical data base is described as follows:  1. The Interface Agent accepts the required support and  the confidence from the user and sends them to the  main agent which in turn sends them to the local agent  in each of the local hospitals.

2. The local Agent together with the Main Agent start the  distributed mining process through some negotiation  FIPA messages, and finally generates the global large  frequent itemsets.

3. When the global large itemsets are generated, the Main  Agent sends a "propose performative" FIPA message  to the newly implemented Rule Agent as follows:  (Propose  :sender (agent-identifier :name main_agent)  :receiver (set (agent-identifier :name rule_agent))  :content "Start mining with confidence = 80%"  :reply-with rule_generation_proposal )  4. The Rule Agent replies with an "agree performative" to  the Main Agent as follows:  (Agree  :sender (agent-identifier :name rule_agent)  :receiver (set (agent-identifier :name main_agent))  :content "proposal approved for rule generation"  :in-reply-to rule_generation_proposal)  5. The Rule Agent starts generation of the rules according  to the required support and confidence.

6. Rule Agent loops on the list of frequent itemsets  generated by the Main and the Local Agents.

7. For each frequent itemset, the Rule Agent starts finding  all non-empty subsets of this frequent itemset (we need  to consider all subsets of the itemset since the Rule  Agent generates all rules with multiple consequents).

8. Loop for every subset (a) for the itemset (L)  9. The Rule Agent sends a "Request performative" FIPA  message to the Main Agent to get the support of the    itemset (a) as follows:  (Request  :sender (agent-identifier :name rule_agent)  :receiver (set (agent-identifier :name main_agent))  :content "get itemset support for itemset (a)"  :reply-with itemset_a ).

10. The  Main Agent sends the support value for the  itemset (a) to the Rule Agent using a FIPA message  with an "Inform performative" as follows:  (Inform  :sender (agent-identifier :name main_agent)  :receiver (set (agent-identifier :name rule_agent))  :content "The support value for itemset (a)"  :in-reply-to itemset_a )  11. The Rule Agent sends a "Request performative" FIPA  message to the Main Agent to get the support of the  itemset (L) as follows:   (Request  :sender (agent-identifier :name rule_agent)  :receiver (set (agent-identifier :name main_agent))  :content "get itemset support for itemset (L)"  :reply-with itemset_L ).

12. The  Main Agent sends the support value for the  itemset (L) to the Rule Agent using a FIPA message  with an "Inform performative" as follows:  (Inform  :sender (agent-identifier :name main_agent)  :receiver (set (agent-identifier :name rule_agent))  :content "The support value for itemset (L)"  :in-reply-to itemset_L ).

13. The Rule Agent calculates the ratio of the support (L)  to the support (a), if this value is greater than or equal  to the minimum confidence supplied by the Interface  Agent, the Rule Agent generates a rule in the form of a  ? (L  a).

14. If there are more non-empty subsets of the itemset (L),  then go to step 8.

15. If there are more frequent itemsets, then go to step 7.

16. After the medical rules are generated, the Rule Agent  sends a FIPA message with an "Inform performative"  to the Main Agent  and the Interface Agent as follows:    (Inform  :sender (agent-identifier :name rule_agent)  :receiver (set (agent-identifier :name main_agent))  :content "rules are successfully generated"  :in-reply-to rule_generation_proposal)  D. Agent cooperation and message negotiation  Table 1 describes the interaction and the messages  sequence between the proposed multi-agent based agents.

TABLE I. AGENTS INTERACTION AND NEGOTIATION  Main Agent Rule Agent  Sends a proposal for the  rule agent with the  required confidence.

Sends an Agree FIPA  message accepting the  proposal  The Rule Agent loops on  the list of frequent  itemsets, and for every  non-empty subset (a) of  the frequent itemset (L):  1. Sends a Request  message asking for  the support of the  itemset (a)  2. Sends an Inform  message containing  the support of the  itemset (a)  3. Sends a Request  message asking for  the support of the  itemset (L)  4. Sends an Inform  FIPA message  containing the support  value of itemset (L)  5. The Rule Agent  calculates the ratio of  the support (L) to the  support (a).

6. If this value is greater    than or equal to the  minimum confidence,  a rule in the form of  a? (L  a)  is generated.

The previous steps are iterative until there are no more  frequent itemsets.

When rules are generated  an inform FIPA  message is sent.



III. APPLYING THE PROPOSED MODEL ON MEDICAL  DATABASE  Inflammatory lesions of urinary bladder and kidneys  exist in 3 - 5% of the population. Women suffer more often  due to anatomic peculiarities of their urogenital system.

There are conditions to transfer adjacently the bacterial  contamination from vagina. Pregnancy is also a factor due to  compression of urethra by the fetus and retention of urine.

By advancing of age and appearance of prostate adenoma in  some males, infections of urinary bladder and kidney  become more frequent in them. Nephrolithiasis is also the  reason for development of inflammatory of urinary bladder  and kidneys.  When the inflammatory process has covered  the kidneys, the status of patients is significantly damaged,  and it is possible to develop more severe complications like  inflammation of adjacent tissues or acute renal failure [16]. It  is necessary to carry out many examinations for the patients  under investigation. These examinations may be costly and  time consuming. Our goal is to construct a model that can  discover the effective minimum number of tests to identify  the previously mentioned diseases. Moreover, the model  should use the constructed knowledge base to help doctors in  future prediction thus saving time and effort which is very  critical for the patients.

A. Data structure and data variables  The medical data used by the proposed multi-agent based  model contains instances for patients symptoms related to  the diseases Inflammation of urinary bladder and Nephritis  of renal pelvis origin. These symptoms are Burn or itch of  urethra and swell for its outlet, Lumbar pain, Micturition  pains, Occurrence of nausea and Urine pushing (continuous  need for urination). The columns of Table 2 represent these    symptoms and diseases in the same order. We should note  that although the model was implemented on specific   parameters of the medical data for the previously mentioned  disease, but it can be applied on different other items  representing other symptoms or tests for the patient medical  records. Data was distributed in two hospitals as follows.

One hospital has 99960 medical records while the other has  71400 medical records, with total of medical records to be  mined 171,360 medical records. Data of each hospital was  loaded into a data warehouse. After ensuring that data is not  volatile, missing values which was about 8% of the total  amount of data were removed from the data warehouse.

Figure 2 describes the distributed structure of the medical  records in the hospitals. There was some data preprocessing  for the initial data before the implementation of the proposed  model. Table 2 describes data samples for the medical data  after being preprocessed to the Apriori like format.

TABLE II. DATA SAMPLES FOR THE MEDICAL DATA AFTER BEING  PREPROCESSED TO THE APRIORI LIKE FORMAT  TID BURN LUMB MICT NAUSEA PUSH INF NEPH  1 No Yes No No No No No  2 Yes No Yes No Yes Yes No  3 No Yes No No No No No  4 Yes No Yes No Yes Yes No  5 No Yes No No No No No  B. Rules generated  The model was implemented many times on the same  data using different values for the support and the  confidence. Increasing the value of the confidence led to a  small number of generated rules. On the other side,  decreasing the value of the confidence lead to a huge number  of rules, some of them were not relevant and were not  interesting. Many researches were done to eliminate the huge  number of redundant [17] and non interesting [18]  association rules. Although we did not tackle this problem as  it is out of our scope in this paper, yet we have found that the  best confidence for our medical data was 80%. Table 3  describes some of the medical rules generated by rule agent  in the proposed multi-agent based system at confidence =  80%  TABLE III. SAMPLE OF THE GENERATED MEDICAL RULES (AT    CONFIDENCE=80%  Ant. ? Cons. Confidence  A-D-E ? X 100  D-E-L ? W 100  L-U ? Z 100  M-U ? Y 100  C-X ? Y 80  C-E-X ? Y 80

IV. SIGNIFICANCE IMPORTANCE OF THE MODEL AND  JUSTIFICATION OF THE GENERATED RULES  Association rules generated by the Rule agent are stored  in the knowledge base in the form:  Antecedent Itemset ? Consequent Itemset  With Confidence = c  We have selected some of the generated rules in the  knowledge base for illustration as follows:  1. L-U ? Z  IF Lumbar pain  AND Urine pushing (continuous need for urination)  THEN Nephritis of renal pelvis origin  WITH CONFIDENCE 100%  2. M-U ? Y  IF Micturition pains  AND Urine pushing (continuous need for urination)  THEN Inflammation of urinary bladder  WITH CONFIDENCE 100%  3. D-E-L ? W  IF No Micturition pains  AND No Occurrence of nausea  AND Lumbar pain  THEN No Inflammation of urinary bladder  WITH CONFIDENCE 100%  4. A-D-E? X  IF No Burn /itch of urethra  AND No swell for its outlet  AND No Micturition pains  AND No Occurrence of nausea  THEN No Nephritis of renal pelvis origin  WITH CONFIDENCE 100%

V. SYSTEM EVALUATION  The system is evaluated from the technical and the  medical point of views.

A. From the technical point of view:  1) The model is compliant To FIPA:  The model complies with the Foundation for Intelligent  Physical Agents (FIPA) global standards described in the  next section. It also combines different techniques, like  multi-agent systems, association rules as a data mining and  the distributed medical databases.

2) The model agents satisfy the MAS properties:  During the implementation of the multi-agent based  model on the distributed medical databases, the model agents  achieved the agent properties in which each agent in the  model individually exhibited the autonomous behavior. On  the other side all agents have presented a coherent behavior  when communicating with each other.

B. From the medical point of view:  From the medical point of view, the model presented a  generic platform for multi-agent systems and provides many  contributions for the medical data distributed over different  departments in a hospital or different hospital branches  located in separate areas. These contributions can be listed as  follows:   1) The model is an accumulating knowledge base  association rule:  The model has constructed a knowledge base containing  many interesting rules that can be very useful for medical  experts. This knowledge base architecture can improve the  system real time response by identifying some basic features  that indicated the presence or the absence of the disease, for  instance, rule (1) and (2)) can help to identify the presence of  the Inflammation of urinary bladder AND Nephritis of renal  pelvis origin respectively based on the minimal number of  symptoms/tests for the patient, thus reducing time to identify  the disease and reducing cost for doing other tests.

On the other side, rules (3) and (4) identify some basic  features that indicate the absence of the disease, which  means that if these symptoms do not exist, there is no need  for further patient examinations for other symptoms or tests.

2) The model as a medical diagnostic platform:  The model has presented a diagnostic platform that can  help in investigating patients diagnosis based on symptoms  or tests done in different hospitals or within the hospital    departments.

3) The model can be used for disease predication:  Based on the rules generated, the model can help doctors  in the early prediction for the existence or the absence of the  disease based on the previously discovered association rules.

4) The model is a cost effective method:  Due to the early prediction feature of the model described  above. This led to minimize the number of tests needed by  the doctors, thus minimizing the effort, the cost and the time  needed for the patients to do other tests or to be checked for  other symptoms.



VI. CONCLUSION  The paper has presented two main contributions. First, a  multi-agent based platform with a rule agent for mining  association rules in distributed medical databases. This agent  modifies the Apriori like algorithm to work in a multi-agent  environment and uses the Foundation for Intelligent Physical  Agents (FIPA) as a global standard to communicate with  other agents in the platform. This agent is responsible for  mining medical rules from the frequent itemsets generated  by the main and the local agents. The second contribution is  the application of the whole proposed model on two  distributed medical databases for the Inflammation of urinary  bladder and the Nephritis of renal pelvis origin diseases. The  implementation can provide many benefits from the medical  point of views; these benefits are the extraction of medical  rules that helps in identifying the minimum effective number  of tests and the prediction of the existence or the absence of  the diseases for patients. The proposed system also improves  the diagnostic knowledge for the doctors. Due to the  qualitative nature of the medical data used in this  experiment, the proposed model is not tested against  quantitative attributes. If the data to be mined was  quantitative, additional stages may be required to preprocess  the data and convert it into crisp values. The other limitation  is the overwhelming number of generated rules which is  conflicting. This is a well known problem. Much research is  done in this area. Our future work is to find solutions to these  limitations and to find the best possible solutions for these  problems.

