WP1 -5:15  1904 IEEE lnlemalional Symposium on

Abstract  A fuzzy system can be constructed to interpolate be- tween input-output data to provide an approzimation for the function that is implicitly defined by the input-output data pair associations. In this paper we begin by explain- ing how function approzimation techniques can be used to solve nonlinear estimation and system identification prob- lems. Nezt, we discuss several fundamental issues related to how to choose the input-output data pairs so that ac- curate function approximation can be achieved with fuzzy systems. Our main result is a new technique for function approzimation via fuzzy systems where we specify mem- bership functions and add rules to try to achieve a pm- specified function approzimation accuracy. We illustrate the new technique on an actuator failure detection and identification problem for the F-16 aircraft.

cia1 cases of this problem. Next we examine some theoretical issues associated with how to choose the input-output data so that good function approxima- tion can be achieved. The main result of the paper provides a new technique for function approximation with fuzzy systems. In this technique we use ideas from the approaches in [ l ,  2, 31 and utilize a unique and novel way to position membership functions and add rules to a fuzzy system to try to achieve a pre- specified function approximation accuracy. While the approaches in [l, 2, 31 and related ones in [4, 5, 6, 71 have been used successfully for a variety of highly nonlinear identification and estimation problems, the problems studied to date have been of relatively low complexity. In this paper we evaluate our new func- tion approximation approach by showing how it can be used to construct complex nonlinear estimators for aileron and differential elevator failures on an F-16 aircraft.



I. Introduction  11. Background Fuzzy systems have been successfully applied in  several areas within engineering including control, signal processing, and pattern recognition. Some re- cent work has focused on the idea of constructing fuzzy systems from a finite set of input-output train- ing data in order to perform function approximation.

This new focus is particularly important due to the fact that many problems in estimation and identifi- cation can be formulated as function approximation problems. For instance, in conventional system iden- tification input-output data is gathered from a phys- ical system and a least squares approach can be used to provide the best approximation for the linear func- tion that maps the system inputs to its outputs. Sim- ilarly, in parameter estimation if one is given data that associates measurable system variables with an internal system parameter, a functional mapping may be constructed that approximates the process of es- timation of the internal system parameter. In this paper we begin by precisely defining the function ap- proximation problem and showing how nonlinear sys- tem identification and nonlinear estimation are spe-  tThis work was supported in part by an Ohio State Univer- sity Interdisciplinsry Seed Grant and by National Science Foundation Grant IRI 9210332.

$Address all correspondence to Kevin Passino ((614)292- 5716; email: passino6ee.eng.ohiestate.edu).

0-7803-1 990-7/94/$4.00 01 994 IEEE 184  Given some function f : X C LR? -+ Y C LR where y is a bounded set, we wish to construct a fuzzy sys- tem g : X c X + Y c y ,  where X and Y are some domain and range of interest, by choosing a parame- ter vector e E 0 so that  f(z) = g(z; S )  + e(a) (1) for all g E X where e(g), the error in approxima- tion, is as small as possible. We assume that all that is available to choose the parameters of the fuzzy system g(g;O) is some part of the function f in the form of a finite set of input-output data pairs. The ith input-output data pair for the system f is denoted by (3, yi) where 4 E X I  yi E Y and yi = f(3). We call the set of input-output data pairs the fruining data set and denote it by  F = { ( 4 ~ l y ~ ) l ? ? , ( ~ F l y ~ F ) }  c x  x y  (2) where m F  denotes the number of 1/0 data pairs con- tained in F. Therefore, the problem we consider here is how to construct a fuzzy system g(g;g) so that f(4) = g(g;&) for all 4 E X when we have only lim- ited information about f in the form of the training set F.

Many applications exist in the control and signal processing areas which may utilize nonlinear function approximation. One such application is system iden- tification. System identification is the process of con- structing a mathematical model of a dynamical sys- tem using experimental data from that system. Let f denote the physical system that we wish to iden- tify. The training set F is defined by the experimen- tal input-output data. In linear system identification an Autoregressive Moving Average (ARMA) model is often used where  0 0  and u(k) and y(k) are the system input and output at  time k. In this case g(z;e), which is not a fuzzy system, is defined by (3) where  [y(k - 1 ) .  . . y(k - q)u(k) * * u(k - p)]T (4) [ea, * * * ea, @bo * * * 8b,IT. (5)  - z = - e =  System identification amounts to adjusting e using information from F so that g ( 2 ;  e) m f (2) for all z E

X. Clearly, restricting g(g;e )  to be linear may often make it difficult to achieve accurate identification (i.e.

function approximation), especially if f (2) is highly nonlinear.

Parameter estimation is the process of estimating the value of some system quantity based on measur- able data from that system. In this case it is assumed that the parameter we wish to estimate is ( where  ? = f (z) Many techniques currently exist for parameter esti- mation which utilize model-based approaches. We utilize a parameterized fuzzy system g(g; e) developed using a training set F to estimate the quantity of in- terest (. In this case g and F become,  - x =  [Y(k) * * .  Y(k - Q) u(k) . * *  u(k - P)lT (7) F = k, ?l), . . . I (%?IF , ?mI? )I. (8)  Techniques which detect and isolate failures within complex systems in real time have been implemented in several applications [8, 91. Although many of these model based techniques perform adequate fault detec- tion in both failed and unfailed conditions if the real process acts as a known linear model and the neces- sary signal processing and decision logic is tractable, we consider the case where the model may be nonlin- ear and unknown. Therefore, we treat the fault esti- mation problem as a special case of parameter estima- tion where 1/0 data F (8) from the process is known and f(3) is the associated fault value. Therefore, the FDI problem we consider is equivalent to param- eter estimation where a fuzzy system is constructed so that &(k) = g(g,@) represents a fault value.

In this paper we will investigate the possibility of  constructing a fuzzy system g(g;e) by choosing e  based on available training data F so that e ( k )  is small for all k. Similar to conventional system iden- tification we will utilize an appropriately defined ?re- gression vector? g as specified in (4). Our hope is that since the fuzzy system g ( 2 ;  e) has more functional ca- pabilities than the linear map defined in (3), we will be able to achieve more accurate identification for highly nonlinear systems by appropriate adjustment of its parameters 8.

A system which exhibits universal approximation is capable of approximating any real continuous func- tion on a compact set to any arbitrary accuracy. Cer- tain classea of fuzzy systems have the property of uni- versal appmzimation.  One common class of fuzzy sys- tems we consider with singleton fuzzification, product inference, Gaussian membership functions, and cen- troid defuzzification is governed by the parameter set  and has,  (see [lo] for an interpretation of (10) and a fuller ex- planation of fuzzy systems). The size of & is governed by the number of fuzzy rules N and the number of inputs to the fuzzy system n. For the fuzzy system (10) the output membership function for the i*h rule is represented by the scalar point bi (a ?singleton?), the input membership function for the ith rule and j t h  inpct is a Gaussian type input membership func- tion with a point of maximum 4 and a relative width term 4 > 0. This form for a fuzzy system has the property of universal approximation [I I], is continu- ously differentiable, and has nonzero input member- ship values over the domain of interest X.

111. Technique for Function Approximation with Fuzzy Systems  In this section we utilize some of the insight from the analysis performed in the previous section to pro- pose a simple method for constructing a fuzzy sys- tem for nonlinear function approximation based on a training data set F defined by (2). The method we propose is an extension of other techniques pro- posed for nonlinear function approximation via fuzzy systems. Namely, we utilize a technique given in [3] entitled ?learning by examples? and some ideas from [2] and [l] to develop a new method to construct a fuzzy system for nonlinear function approximation.

We first develop the methodology and then present the function approximation algorithm.

A .  Function Approximation Algorithm  Given the parameterized fuzzy system (10) we choose the parameters in & and the number of rules N so that we approximate a nonlinear function f : X c LR" + Y c LR based on input-output data pairs generated via experiment or simulation.

The first question we address in the construction of a fuzzy system is the choice of the number of fuzzy rules N. More fuzzy rules means increased computa- tional complexity in implementation. Therefore spe- cific applications may limit the number of rules which may be utilized in implementation. On the other hand, the use of many fuzzy rules may produce a fuzzy system with more functional capability avail- able for approximation. Therefore, a tradeoff exists between computational complexity and functional ca- pability based on the number of fuzzy rules N.

We first define the quantity ?1 which character- izes the desired accuracy with which the fuzzy sys- tem performs function approximation. Specifically, the output of the current fuzzy system is compared to the output portion of the input-output training data point yi. If this comparison is greater then c j then we choose to augment the current fuzzy system with an additional rule so that:  IS(%; e) - yi I > c j  * modify Ig(gi; e) - yi I 5 c j  (11) do not modify.

The choice for c j  determines the number of fuzzy rules where a smaller value for E/ generally means more fuzzy rules for a given training data set, and vice versa. Employment of c j  in the function approx- imation algorithm is outlined below.

Algorithm To Construct Fuzzy System  1. Construct An Initial Fuzzy System We assume that we have input-output train- ing data pairs given by ( 3 , y i )  E F where i = 1, . . . , M. We also choose an initial value for the input membership associated with the first fuzzy rule given by 4 = uo for all j = 1, . . . , n.

The initial choice uo often has little effect on the resulting fuzzy system as training progresses, but it is necessary to initialize the fuzzy sys- tem. The first step in the algorithm is to form a fuzzy rule according to the first input-output training data pair (gl, y1) and the initial fuzzy system by  S.--d bl n;=, e x P [ - ( y ) 2 1 n;=, eXP[-($321 . .  (12) z ,-e1 s(z;B) =  where 4 = 4 ,  bl = yl, and 4 = uo for j = 1,. . . , n. Once the initial fuzzy system is constructed, the function approximation algo- rithm forms additional fuzzy rules and chooses  parameters 0 for the fuzzy system based on the remaining input-output training data pairs and the desired approximation accuracy c j  in Steps 2 and 3.

Evaluate New Training Data Point For each additional training data point (a, yi) E F, for i = 2, . . . , M we evaluate (11) with the current fuzzy system. If an additional rule is necessary then we go to Step 3, otherwise we return to the start of to Step 2 to evaluate the next training data point according to (11).

Augment Current Fuzzy System We modify some of the parameters of the orig- inal fuzzy system, namely 4 ,  to account for the new information contained in (3, yi) that passed the test in (11). A new rule is added to the fuzzy system so that the new fuzzy param- eter set e is given by  N := N + l  (13) bN := ?/i (14) .'N := 4 ,  j =  1, ..., n (15) dN := 60, j = l ,  ..., (16)  Moreover, we modify .I' for i = 1 , .  . ., N, j = 1 , .  . ., n to adjust spacing between the membership function for the rules in the aug- mented fuzzy system so that ( i )  the added rule does not distort what has already been learned, and (ii) we achieve a smooth interpolation be- tween training points. Modification of 4 is car- ried out by determining for each rule a nearest neighbor. We modify 4 for the i th rule accord- ing to the computed nearest neighbor which we denote by the index i'  i+ = argmin(ll5, --i l lz : i' = 1,. . . , iV,i' + i } (17)  where 4 = [cr, . . . , .PIT. We update 5 = [U:, . . . , @ I T  according to the equation ( j  = 1,. . .,n):  1 . .

(18) -, a! = - &-d.I  where W is a weighting term which governs the input membership function overlap between nearest neighbor rules. A larger W means less overlap of membership functions and vice versa.

This is done for all rules i = 1, . . . , N. Once Step 3 is complete we go to Step 2 for the next training data point until the number of training data points are exhausted.



IV. Function Approximation Example: F-16 Aircraft  In this example, the function approximation algo- rithm is used to construct an estimator that can de- tect and identify actuator failures by using measur- able F-16 aircraft data. The presence of an actuator     failure is detected by comparing the actuator?s com- manded position and the estimated position. A fail- ure is detected if the commanded position and the estimated position differ by more than some thresh- old for some window of time.

A. F-16 Aircraft Model and Failure Modes  The F-16 aircraft model used in this example is based on a set of five linear perturbation models (that are extracted from a non-linear model at the five op- erating conditions) (Ai, Bil Cil Di), i E { 1,2,3,4,5}:  kfl6 = A i Z f l 6  + Biu y = Cizfl6+Diu (19)  where the variables are defined as follows: 0 Inputs U = 6de 6, 6, lT:  - 6, = elevator deflection (degrees) - 6de = differential elevator deflection (de-  - 6, = aileron deflection (degrees) - 6, = rudder deflection (degrees)  grees)  System State Z f l 6  = [a q 4 p p rlT: - a = angle of attack (degrees) - q = body axis pitch rate (degrees/sec) - = Euler roll angle (degrees) - /.? = sideslip angle (degrees) - p = body axis roll rate (degees/sec) - r = body axis yaw rate (degrees/sec)  Outputs y = [ ~ 7 1 6  &IT: - A, = normal acceleration (g?s)  0 System Matrices (Ai, Bil Ci, Di): Provided by  The nominal control laws for the F-16 aircraft that were provided by the Wright Laboratories consist of two parts, one for the longitudinal channel and the other for the lateral channel. The inputs to the con- troller are the pilot commands and the F-16 system feedback signals. For the longitudinal channel, the pilot command is the desired pitch A,d, and the s y e tem feedback signals are normal acceleration A, , an- gle of attack a, and pitch rate Q. Likewise, for the lateral channel, the pilot commands are the desired roll rate p d  as well as the desired yaw p d ,  and the system feedback signals are the roll rate p, yaw angle r, and sideslip p. The controller gains for the lon- gitudinal and for the lateral channels are scheduled as a function of different dynamic pressures. The dy- namic pressure at all five perturbation models is fixed at  499.24 psf, which is based on an assumption that  Wright Laboratories  All information about the F-16 &craft modela WM provided by Wright Laboratories.

I87  the F-16 aircraft will operate with constant speed and altitude. Hence, a gain schedule table, which is pro- vided by Wright Laboratories, is used to determine the controller gains.

is used to represent the actuator dynamics for each of the aircraft control sur- faces, and the actuators have physical saturation lim- its SO that: -21? 5 6, 5 21?, -21? 5 6de 5 21?, -23? 5 6, 5 20?, and -30? 5 6, 5 30?. The actu- ator rate saturation is f60?/s for all the actuators.

To simulate the closed-loop system we interpolate be- tween the five perturbation models based on the value of a. For all the simulations, a special ?loaded roll command sequence? , provided by Wright Laborato- ries, is used. For this command sequence: at time t = 0.0, a 6Oo/s roll rate command (pd)  is held for 1 second; at time t = 1.0, a 3g pitch command (&) is held for 9 seconds; at time t = 4.5, a -6Oo/s roll rate command ( p d )  is held for 1.8 seconds; and at time t = 11.5, a 6Oo/s roll rate command (pd) command is held for 1 second. The sideslip command /.?d is held at  zero throughout the sequence.

While many different failures can occur on a high performance aircraft such as the F-16 (e.g., perfor- mance degradation or structural damage), in this study we will focus on FDI for aileron and differential elevator stuck failures.

The transfer function  B. Failure Models and naining  In order to implement a fuzzy estimator for FDI on the F-16 aircraft it is necessary to determine those signals from the aircraft which enable us to deduce the position of the aileron and differential elevator.

Specifically, we need to first determine the inputs 3 ( i  = 1 , .  . . , n) so that a fuzzy system (10) may pro- duce accurate estimates (&, and i d e )  for the aileron and differential elevator positions (Sa and ad,). We do this by examining the structure of the F-16 air- craft model and understanding the effect of the con- troller on the actuator positions. Specifically, we rec- ognize that if a failure in the aileron actuator occurs, the controller compensates via the differential eleva- tor actuator and vice versa. We also recognize that the roll command input p d  affects both the aileron and differential elevator positions. Therefore we uti- lize these signals as inputs to the fuzzy estimator to deduce the position of the aileron and differential ele- vator. In particular, we sample the aircraft responses and choose  where 6: and 6% are the signals commanded by the controller. The vector I (n = 3) is used in the esti- mation of both the aileron position and the position of the differential elevator. Next, we let fa and f d e denote the unknown functional mapping between the aircraft variables and the estimates of the actuator positions so that we let  I = [a:, 6:ey PdIT, (20)  L ( k )  = f O ( I ) l  (21)    and  Note that the choice of the inputs in (20) intuitively represents signals which may contribute to the func- tional mapping fa or f d e  in order to construct the fuzzy estimator. For instance, during no fault opera- tion the aileron and differential elevator positions are related linearly to the roll command P d .  Basically, the estimator construction problem involves training the fuzzy system to approximate fa and another to approximate f d e .  With this we will have one fuzzy system to estimate the position of the aileron and one to estimate the position of the differential elevator.

We train the fuzzy systems for estimation by ob- taining input-output training data developed through simulation with a sampling time of T = 0.02 sec. We alternately fail the aileron and differential elevator ac- tuators at various positions (no failure, 1 sec., 3 sec., 5 sec., 7 sec.) and collect sampled data for c. We then construct the fuzzy systems for estimation by means of the training algorithm which chooses values for N, b i ,  4 ,  and 4 to achieve an accuracy of f l  de- gree on both the aileron and the differential elevator estimators during training (i.e. = 1). The width scaling term W is 3. The resulting fuzzy system for estimation of aileron position contains 108 rules, and the resulting fuzzy system for estimation of differen- tial elevator position contains 224 rules.

C. Results The fuzzy estimator provides a simple FDI system  to detect and isolate failures for the aileron and dif- ferential elevator actuators. We simply form the ab- solute value of the difference between the estimated value with the value commanded for the actuator. If one differs above some threshold for some period of time we may guess that a failure has occurred and in this situation one may want to reconfigure the control laws (see [12]). In our case we evaluate the median of the residual over 21 samples. If the resulting median exceeds a threshold of 3 degrees for the aileron and 1 degree for the differential elevator, then we flag the system that a specific actuator failure has occurred (we choose these thresholds via a simulation-based analysis of the no fault residuals). Once a residual exceeds a threshold the failure flag is set for the en- tire test. The results are given in Figures 1-3. Notice that in Figure 1 if there is no actuator failure then the failure estimators for both the aileron and differ- ential elevator provide an estimate of the actuator po- sitions that is reasonably close to the actual position.

Clearly if we choose a detection threshold of 3 degrees for the aileron residual and a detection threshold of 1 degree for the differential elevator no failure will be indicated. Using the median filter described above, failures are correctly detected and determined for an aileron failure at 1 second (Figure 2) into the loaded roll command sequence with the filtered aileron resid- uals exceeding the threshold and the filtered differen-  tial elevator residual remaining below the threshold.

Moreover, failures are correctly detected and deter- mined for a differential elevator failure at 1 second into the loaded roll command sequence with the fil- tered differential elevator residuals exceeding the l degree threshold and the filtered aileron residuals re- maining below the threshold (see Figure 3). We see that the estimators provide an adequate estimate of the position at which the aileron and differential ele- vator are stuck and also properly indicate which ac- tuator has not failed. Our simulation results actually show that the fuzzy estimator can accurately discrim- inate between and aileron and differential elevator failures for the training data set we utilize. If fail- ures occur other than the ones we have trained for, or if a different aircraft maneuver is initiated, accu- rate estimation may not be achieved.



V. Conclusions  In this paper we ( i )  concisely stated the func- tion approximation problem in the context of fuzzy systems where input-output training data was avail- able, ( i i )  illustrated possible applications for nonlin- ear function approximation in the system identifica- tion and signal processing fields, ( i i i )  discussed the functional capability of fuzzy systems in terms of the universal approximation property and discussed con- traints associated with the input-output training data set. In addition, we introduced a new method to per- form function approximation that builds on the ap- proaches in [l, 31 and uses some ideas from [2]. Fi- nally, we used the function approximation algorithm to design failure estimators for one class of failures in the ailerons and differential elevator on an F-16 aircraft.

