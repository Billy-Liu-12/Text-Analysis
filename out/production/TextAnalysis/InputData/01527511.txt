GENETIC ALGORITHM FOR ITEM SELECTION WITH CROSS-SELLING  CONSIDERATIONS

Abstract: A fundamental problem in chain convenience store is  selecting items with respect to notion of "cross-selling effect".

Recent works have proven the problem is NP-hard. In this paper, Genetic algorithm is applied to this problem. Based on the features of Genetic algorithm, a method of defining imprecise fitness function is proposed which is suited for solving item selection with imprecision cross-selling effect.

Quantitative analysis method on "cross-selling effect" is also presented in this paper, which employs the ideas of quantitative association rules, a recent data mining technique to discover quantitative affinities in large transaction databases.

Keywords: Genetic Algorithm; Data Mining; Quantitative  Association Rule; Cross-selling  1. Introduction  The increase of electronic data gathering devices, such as point-of-sale technologies, has made it easier for retailers to collect data. Furthermore, having concentrated so much attention on the accumulation of data, the problem was what to do with this valuable resource. It was recognized that information is at the heart of business operations and that decision-makers could make use of the data stored to gain valuable insight into the business. Recent research in the retailing market have shown a winning edge for customer-oriented business, which is based on decision making from better knowledge about the customer behavior.

Furthermore, the behavior in terms of sales transactions is considered significantly [1]. This is also called market basket analysis. At about the same time, association rule mining [2] has been proposed by computer scientists, which aims at understanding the relationships among items in transactions or market baskets.

The business room of a convenience store is commonly small, so the variety offered by retailer can?t be wide. In order to accommodate the rapid movement of  market, retailers often make a fundamental decision, namely, what items should be offered in his limited business space. For making the best of business room, sometimes, retailers need to abandon some low-profit items in business and transfer shelves to high-profit items. What items should be discarded is a difficult decision problem.

The difficulty is that the profit of one item not only comes from its own sales, but also from its influence on the sales of other items, i.e., the "cross-selling effect". Recent works have proven the items selection problem is NP-hard[3].

Association rule can be used to analysis cross-selling effect. However, it is not clear how association rules can be used to solve the selection problems considered here.

Recently, Brijs et al. [4] made a move in this direction.

They proposed a model celled PROFSET which factors in the cross-selling effect by identifying "purchase intentions" in each transaction, in the form of disjoint "maximal frequent item-sets". The approach of PROFSET has several drawbacks. First, PROFSET does not consider the strength of the relationship between items, i.e., the notion of confidence, since it only handles frequent itemsets, i.e. the notion of support. Second, PROFSET provides no relative ranking of selected items, which is very useful in many situations.

In this paper, genetic algorithm is applied to this problem. The primary difficulty for the application of genetic algorithm is that the "cross-selling effect" can?t be a precise number, but an imprecision one. Based on the features of Genetic algorithm, a method of defining imprecise fitness function is proposed which is suited for solving item selection with imprecision cross-selling effect.

Quantitative analysis on "cross-selling effect" is also presented in this paper, which employs the ideas of quantitative association rules, a recent data mining technique to discover quantitative affinities in large transaction databases. In our experiment, we apply the proposed approach to a set of simulation data and the approach is found to be effective and efficient.

2.  Problem Definition  Given a items set I with n different items, I1, I2, ?, In, let I={I1, I2, ??, In}. We refer to the profit of an item coming from its own sales as direct profit, the profit coming from "cross-selling effect" as indirect profit. Supposed that m different low-profit items should be selected from I. Let  ID ?  be the set of selected items, and be the set of reserved items. Let be the direct profit of D, and  denote indirect profit of D from V due to items in D have cross-selling effect on items in V. Then the total profit of D is given by:  DIV ?= )(DR  ),( VDR  ),()( VDRDRR +=                ?1? Let  denote unit profit of x, and S)(xprof x denote  the sale quantity of x. The direct profit of D, , is given by:  )(DR  ? ? ?= Dx x xprofSDR )()(            ?2? Definition 1: Given two items x, y ? I, cross-selling  effect coefficient, ),( yx? , means that selling one unit of x results in selling ? units of y due to the cross-selling effect of item x on y.

According to the definition 1, the indirect profit of items in D , , can be given by: ),( VDR  ? ?? ? ??= Dx Vy x yprofyxSVDR )(),((),( ? )?3? In practical application, the cross-selling effect can?t  be a precise number, but an imprecision one. We can only make a rough estimation of what number range ),( yx? fluctuate in. Thereby, we use range number  [ ),( yxS? ?  ),( yxL? ]  to scale cross-selling effect coefficient, and we can make a estimation of the probability that ),( yx? fluctuate in [ ),( yxS? ? ),( yxL? ] . Let denote the probability when  1% << c0  ),( yxS),( yx),( yxL ??? ?? .

Due to the imprecise cross-selling effect coefficient,  the total profit of D is also a range value [RS,RL] , which is given by:  ? ?? ? ?? ??+?= Dx Vy SxDx xS yprofyxSxprofSR ))(),(())(( ? ?4?      Definition 2: a quantitative association rule is an implication of the form  , where x , y?I?  ?  are numerical range of selling quantity for x and y, respectively. The rule has support s% in the transaction set T if s% of transactions in T contain x and y and these transactions should satisfy:  and, where Q(x,t) and Q(y,t) denotes the selling quantity of item x,y in certain transaction t?T. The rule holds with confidence c% if c% of transactions in T that contain x also contain y, and these transactions should satisfy: V and .

%)%)(](,[],[ csVVyVVx yL y  S x  L x  S ?  ],[ xL x  S VV ],[ y  L y  S VV  x L  x S VtxQV ?? ),(  y S QV ? (  S y  LS VtyQ ?? ),(  y LVty ?),  x txQ? ),( xLV?  ? ?? ? ?? ??+?= Dx Vy LxDx xL yprofyxSxprofSR ))(),(())(( ? ?5?  yV  Suppose retailer determines to abandon m different low-profit items from set I for the sake of making the best of business room. The problem researched in this paper is  how to partition set I into two subsets D and V. The goal of partition is that profit from set D should be as low as possible.

3.  Analysis on cross-selling effect  In order to calculate cross-selling effect coefficient, association rules should be extracted from historical transaction data. Association rules reflect that one item being selected would result in another item being selected by customer in one transaction. Let T be a set of transactions, an association rule is an implication of the form x ? y  (s%) (c%), where x? I, y? I. The rule x ? y holds with confidence c% if c% of transactions in T that contain x also contain y. The rule x ? y has support s% in the transaction set T if s% of transactions in T contain x and y. Given a set of transactions T, the problem of mining association rules is to generate all association rules that have support and confidence greater than the user-specified minimum support and minimum confidence.

The association rule depicted above just shows association relation among items qualitatively, not from quantitative aspect. So, we call these rules as qualitative association rules. In fact, there exist not only qualitative relations but also quantitative relations among items. In order to calculate cross-selling effect precisely, we should analyze the association relation from quantitative aspect.

The concept of quantitative association rules was presented by Srikant[5], and the mining algorithm is also given in[5] .

In their mining algorithm, the quantity of a item in one transaction should be map into a discrete numerical range.

By the definition of association rule, the confidence c% reflects the probability that one item?s selling result in another item?s selling. Thereby, the cross-selling effect can be calculated through quantitative association rule.

Definition 3: Given quantitative association rule R: , the rule?s maximal  contribution on cross-selling effect , and its?  minimal contribution on cross-selling effect can be given by:  %)%)(](,[],[ csVVyVVx yL y  S x  L x  S ?  ),( yxLR? ),( yxSR?  %),( c V Vyx x  S  y LL  R ?=?                   ?6?  %),( c V V  yx x L  y SS  R ?=?                    ?7?  Obviously,  is an optimal estimation, and  the  is the worst one. There maybe multifold quantitative relations between tow items, so cross-selling effect contribution between two items should be sum up.

But the amount of transactions covered by different rule is different. Thereby, the contribution weight on cross-selling effect of different rule is different.

),( yxLR? ),( yxSR?  Definition4: Given quantitative association rule R: , if a certain  transaction t?T contain items x and y, and its? purchase quantity satisfy: V  and  , then t is covered by rule R.

%)%)(](,[],[ csVVyVVx yL y  S x  L x  S ?  x S xQ? ,(  y L  y S VtyQV ?? ),(  x LVt ?)  Given some quantitative association rules: R1?R2??? Rm  , the antecedents of these rules are all item x, and the consequents of these rules are all item y, but the numerical ranges in different rule are different from each other. Let Sx denote the total sale quantity of x in the transaction set T, Sx(Ri) denote the sale quantity of x from all the transactions which are covered by rule Ri, the cross-selling effect contribution weight of Ri can be given by:  x  ix i S  RS )( =?                    ?8?  By summing up every rule?s cross-sell effect contribution, the maximum cross-selling effect coefficient  ),( yxL? and minimum cross-selling effect coefficient ),( yxS? of item x playing on y can be calculated as  follow:  ? =  ?= m  i  L RiiL yx  ),( ???            ?9?  ? =  ?= m  i  S RiiS yx  ),( ???           ?10?  4.  Genetic algorithm for items selection  Cross-selling effect also exists among items in set D, and the indirect profits derived from it should not be counted into the total lost profit. What we need to study is the cross-selling effect between items in set D and items in set V. Obviously, what is studied in this paper is an optimal partition problem. Genetic Algorithm is adopted to solve this problem. Genetic Algorithm calculates the corresponding fitness function of each solution of an optimization problem. The optimization process is to find the solution that maximizes or minimizes its corresponding fitness function.

4.1.  Graph theory based description of items selection problem  For discussion convenience, we use graph theory to describe the items selection problem as following: in graph G(I,A), I denotes the vertex set, I={I1 , I2 , ?? In }. Each vertex Ii denotes a kind of item. For each vertex in graph G, there exists a corresponding number prof (Ii) that denotes the direct profit of item Ii. For each directed edge?Ii ? Ij?, there exists a corresponding numerical range  )],(),,([ jiLjiS IIII ?? that denotes the cross-selling effect from item Ii on item Ij. If cross- selling effect does not exist, the number of the directed edge is 0.

Whether there is edge between two vertices is determined by adjacency matrix A. Adjacency matrix A=[aij] is an  matrix. If the antecedent of a quantitative association rule is item I  NN ? i, and the consequent is Ij, then  aij=1. Otherwise, aij=0. If i=j, aij=0. If aij=0, there is no edge that links Ii and Ij.

Items selection problem is to partition graph G(V,A) into two sub-graph, GD(D,AD) and GV (V, AV), The vertex set D in graph GD contains m items, and satisfy D ? V= ?? D ?V= I?  4.2.  Encoding  For the encoding, we take a string of 0's and 1's like a classical GA as in [6,7]. This string is called a chromosome.

For any given graphical model, set index for each vertex in graph G, and the bit position of a chromosome string is the index of each vertex. The length of the chromosome equals the number of vertices in graph G. If the value of a bit is 1, it means that the corresponding vertex is selected in sub-graph GD. If the value of a bit is 0, the vertex is selected into sub-graph GR. e.g. if the coding of a certain chromosome is 001100?.., the implication of the encoding      is that item #3 and #4 are selected into GD and item #1, #2, #5, #6 are selected into GR.

4.3.  Fitness function  When items in set D are selected to be abandoned in business, the total lost profit can be counted by formula(4), (5) , and the result is a range number [RS , RL]. We define the total lost profit as fitness function. As the value of the fitness function is a range number [RS , RL], the principle of comparing two range number should be introduced. First, we do some symbolic normalization as follow: Let ?>? denote relation ?strict superior to?, ?<? denote relation ?strict inferior to? , ? ? denote relation ?weak superior to? and ? ? denote relation ?weak inferior to? . Let X, Y denote two chromosomes respectively. The physical implication of a chromosome is a partition on set I. Let R  ?  S (X)( or RL (X)) denote the most(or least) total lost profit when the partition is X. We can compare X and Y by the following 4 rules:  Rule1: if RS (X)> RL (Y), then  X< Y Rule2: if RL (X)< RS (Y), then  X > Y But the situation satisfying the rule 1 and rule 2 occurs  infrequently. For example, the fitness value of X is [$300,$800] and the fitness value of Y is [$400,$600]. In such situation, we rank the items based on the minimum regret principle. Supposed Z(X,Y) represents the regret degree when we regard item X superior to Y. Z(X,Y) can be calculated by the following formula:  )Y()X()Y,X( SL RRZ ?=          ?11? By Z(X,Y), we can compare X and Y by the following  2 rules: Rule3: if Z(X,Y)< Z(Y,X), then  X Y Rule4: if Z(X,Y)> Z(Y,X), then  X Y ?  4.4.  Initial population  At first, we work out the profit of each item (including direct profit and indirect profit). Because the indirect profit is a range number, the total profit of item x is also a range number from RS (x) to RL(x). We can get them from the following formulae:  ? ? ??+?= Vy SxxS yprofyxSxprofSxR )(),()()( ? ?12?      3. After crossover procedure, we get some offspring chromosomes from previous generation chromosomes.

Selecting one chromosome from the offspring chromosomes with a low probability (for example the probability 0.5%) to run mutation process. In order to ensure that there are just m bits with value 1 in a chromosome after mutation, we do the following mutation operation to the chromosome: ? ? ??+?= Vy LxxL yprofyxSxprofSxR )(),()()( ?  ?13? Using the ranking method introduced in 4.3, we rank  items by their total profit, from low to high, and set different selected probability accordingly for them: setting  higher selected probability for the item with lower profit, setting lower selecting probability for the item with higher profit. We select the items stochastically according to their selected probability. If a item is selected, its? bit value in a chromosome is marked as ?1?, otherwise, marked as ?0?.

When we have selected m items, one chromosome is formed. After a chromosome is formed, we can repeat this step from the beginning until k initial chromosomes are formed.

4.5.  Crossover and Mutation  1. The genetic algorithm works by randomly selecting pairs of individual chromosomes to reproduce for the next generation. The probability of a chromosome being selected is inverse proportional to its fitness function value, precisely, namely inverse proportional to its ranking order in 4.3.

2. Comparing the bit value of parent chromosomes, and entail the bit with same position value to offspring chromosomes. Now there are still some bits without value in the offspring chromosomes, this means that these bits have not inherited value from parent chromosomes. In order to ensure that there are just m bits with value 1 in offspring chromosomes, crossover operator should continue steps as follow:  a) Working out the number of bits with value 1 on the offspring chromosome. Suppose there are r bits with value ?1?, then there will be m-r bits to get value 1 in those bits without value.

b) Getting out all the bit position index of bits without value. According to these position indexes, scan all the bit values at the same position in parent chromosomes. If there is a bit with value 1 at the same position in either of the parent chromosomes, then set the bit in offspring chromosome with value 1 .

c) Repeat b) until the number of bits with value 1 become m. Set value 0 for other empty bits.

a) Select one bit from bits with value 0 stochastically, and change the value to 1.

b) Select one bit from bits with value 1 stochastically, and change the value to 0.

5.  Empirical Study  5.1.  Experimental process  From the observation on transaction records in a certain chain convenience store in Shanghai, we obtained a set transaction samples of 100 kinds of items in fifteen days.

Having calculated the probability distribution of each item or item portfolio purchased in this sample, we then designed a simulation program to produce transaction data during a period of time. The data can be simulated as follows:  1) The time duration is set to a constant T, that is, we generate the transaction data during time period T from the simulation program.

2) Quantitative association rules can be discovered from this data set by the algorithm proposed by Srikant in 1996[5].

3) Calculate cross-selling effect coefficient upon those quantitative association rules.

4) m items with the lowest profit capability are then selected by genetic algorithm. In order to observe the effective of genetic algorithm, we also select items by direct profit( In this paper, we refer this method as direct profit ranking method). As a result, the respective selection results turn to be D1, D2 , and the rest of items to be V ,   11 DI ?=  22 DIV ?= 5) Then we use item sets and  to generate  another two sets of transaction data from the simulation program, also on the basis of time duration T.

1V 2V  6) Compare the effect between these two items selection methods.

5.2.  Experimental result analysis  In the process of mining quantitative association rules, the optimal threshold of support and confidence should be determined. If the threshold is too large, it will end up with few rules. As a result, many rules will not be found. If the threshold is too small, although much more rules will be found, however, the rules precision will be decreased.

Therefore, we carried out 12 times calculation with different threshold parameters portfolio, and then conducted data mining and item selection through genetic algorithm by different mining results. In our experiments, 8 items with lowest profit are eliminated after selection. The experimental results are shown in Table 1.From Table 1 , we note that:  Table1 profit from set V under different parameters portfolio  parameters portfolio Profit after abandon m items ?$?  Support threshold  Confidence threshod  Genetic algorithm  Direct profit ranking  1% 80% 840 1% 85% 960 1% 90% 1,010 3% 80% 1,250 3% 85% 1,510 3% 90% 1,340 5% 80% 1,370 5% 85% 1,220 5% 90% 1,110 7% 80% 1,090 7% 85% 1,070 7% 90% 1,050        1,040         1. The result is obviously optimal when using the  parameter portfolio of support threshold as 3% and confidence threshold as 85%.

2. When the parameter value becomes low, the item profit declines fast. As the cross-selling effect decreased because of low precision of most rules, some items with large direct margin profit will be wrongly selected and abandon, so that the profit comes out worse than that from direct profit ranking method.

3. When the parameter value is high, the item profit is inclined to be stable. This is because many rules can not be found with high threshold value so that the cross-selling effect cannot be taken into consideration during item selection. In this way, the selection result is close to that from direct profit ranking method.

According to the result from Table 1, we determined the optimal support threshold as 3% and confidence threshold as 85%. With this parameter portfolio, we calculate the cross-selling effect coefficient according to correspondent association rules.

Let m denotes the number of items selected to be abandoned. Table 2 demonstrates the comparison of profit effect by two items selection methods when m varies. From Table 2, we find that genetic algorithm is better than direct profit ranking method. When m is small, there is no much differences between these two method, however, when m increases, selection by genetic algorithm will make more profit than directed profit ranking method. The reason is that the direct profit ranking method takes no consideration      about the cross-selling effect. When m is small, cross-selling effect is also small, and when m is large, it will be large too.

Table 2 Comparison between two methods  Profit after abandon m items?$? m Genetic algorithm Direct profit ranking    2,400 2,100 1,960 1,850 1,700 1,600 1,530 1,510 1,490 1,310  2,400 2,080 1,910 1,620 1,420 1,270 1,120 1,040  6.  Conclusions  In this paper, we have formulated the problem Item Selection for convenience store with the consideration of cross-selling effect among the items. We adopt the concepts of quantitative association rules to the determination of the cross-selling effect. Then we propose a genetic algorithm based approach to deal with this problem. The results of experiments show that our algorithm is highly effective.

