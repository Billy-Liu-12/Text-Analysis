Fuzzy Rule Extraction Based on the Mining Generalized  Association Rules*

Abstract - In data mining approach, the quantitative attributes should be appropriately dealt with as well os the Boolean anributes. This paper describes a fuzzy rule extraction method based on the mining generalized association rules from database. The objectives of the method are to improve the computational time of mining and the accuracy of the extracted rules for the actual application. In our approach, we construct a hierarchical taxonomic f u q  sets structure in each anribute. Two algorithms are shown based on the structure and the Apriori algorithm. We propose a multistage fuq rule extraction algorithm and a multiscan algorithm. From the results of numerical experiments, our methods are found to be effective in terms of computational time.

Keywords: Data Mining, fuzzy rule, association rule, database.

1 Introduction Recently, Data Mining to extract knowledge or rules  from massive data sets stored in the database or dataware house, is studied for utilizing in  various^ business scenes.

As the promising applications of Data Mining, Association. Rules[l-5] have been applied to various marketing problems. As for the other needs like in manufacturing area, there still exist many problems to cope with the stored valuable data, such as business decision, process improvement, and so on. In such domain, it seems that conventional approach such as computer assisted data analysis of stored data has been applied depending upon the human skill. Several reasons can be stated why the approach based on Data Mining methods is not applicable for such problems, one of the main reasons is that the mining system should deal with quantitative attributes, appropriately.

..

In order to deal with the quantitative attributes in mining association rules, algorithms based on the generalized association rules that handle the continuous attributes as the Boolean vector by partitioning into several intervals are proposed[ 1,2]. Though several methods were also proposed to improve the computational  Makishi  N a k a y a m a Electronics Research Laboratory  Kobe Steel, Ltd.

Kobe, Japan  m-nakayama@rd.kcrl .kobelco.co.jp  time, the results through the algorithms were still time consuming and are complicated to the user. Fuuy association rules approaches[3-5] are proposed to overcome such disadvantages based on the f u u y  set.

These approaches were based on the fuzzy extensions to the classical association rules mining by defining support and confidence of the fuuy rule. Though the mining results are easy to understand by human ?operator, two drawbacks are still remained for applying such fuzzy approaches to the actual problems. One is the computational time for mining from database, and the other is accuracy of extracted rules.

The accuracy of extracted rules depends upon the f u u y  set defined and the fineness of its partition. In existing approaches, it is assumed that the input space was divided by grid-type fuzzy partitions in advance[4,5].

However, this assumption leads to deterioration of accuracy when the hue fuzzy set exists between the grids, as well as to waste of computational time.

In this paper, we describe a fuzzy rule extraction method based on the mining generalized association rules.

The objectives of the method are to improve the computational time of mining and the accuracy of the extracted rules for the actual application. Results of numerical experiments are also shown.

2 Hierarchical Taxonomic Fuzzy Sets Structure for Data Mining The main problem of ?Mining Association Rules? is  to heighten computational efficiency in extraction process from huge database. For mining rule under the grid type fuzzy partition, increase of the partition number directly affects the computational time, i.e. query response time to the database and the memory consuming. Our approach is to generate a ?fuzzy set taxonomy? on each attribute  * 0-7803-7952-7/03/$17.00 0 2003 IEEE.

mailto:t-wata@isc.osakac.ac.jp http://kobelco.co.jp   Figure 1. Hierarchical Fuzzy Set Taxonomy  from the pre-defined grid type fuzzy partitions which are expressed as the ?information granularity.? The altemative fuzzy itemsets are generated dynamically through the mining procedure, based on the ?fuzzy set taxonomy.?  The ?fuzzy set taxonomy? is created from the base f i u q  sets, i.e. the defined grid type fuzzy partitions, by composite operations and the linguistic hedge, as shown in Fig. 1. There are three base fuzzy sets shown as A, B, C.

The fuzzy set ?X AND Y? is characterized by product operation as:  P X A N D Y  ?PY (1)  where ,U denotes the membership function. The fuzzy set ?X+Y is characterized as:  P X + Y  = midl9 Px + Pr 1 (2) It should be noted that the above definition is different from the well-known fuzzy ?OR? operation, as the composite fuzzy set should be valid in the sense of information retrieval. A new fuuy set is generated by combining adjacent base fuzzy sets applying the ?+? operation defined in Eq.(2).

The linguistic hedge represented as ?Very? is characterized as follows:  (3) 2 P,,X = Px  By using these operations, the ?fuzzy set taxonomy? is automatically formulated from user specified base fuzzy sets. These generated f u u y  sets are within partial order relation in terms of containment expressed as:  xc y 3 PX(U)5PY(U),  ?dUEU (4)  where U denotes the universal set. The relation plays an important role in mining procedure.

3 Fuzzy Data Mining Algorithm 3.1 Fuzzy Association Rules  f u v y  sets in different attribute as follows: Let F denote the f u v y  itemset which consists of  F = {P?Q,T) ( 5 )  where P, Q, and T denote the fuzzy sets. Support of the itemset F is defined as:  where x p  denotes the transaction of the database, and p F ( x P )  denotes the membership value calculated by the product operation of each item(Fuzzy Set) in F, and m denotes the total number of transactions. From the support value, confidence of the fuzzy association rule G > H is calculated by:  c(G 3 H )  = s(G U H)/s(G)  (7)  where G and Hare  fuzzy itemsets. F u u y  association rule is extracted when these values of the rule are more than pre-defined minimal support and pre-defined minimal confidence.

Generally, the ?combinatorial explosion? is occurred in fuzzy rule approach. When we apply the mining algorithm to the actual problems, especially using fuuy sets, we should avoid such problems, i.e. numerous query and memory consumption. In OUT approach, the following equation holds from Eq.(2):  s(X + Y )  = s ( X )  + s(Y) (8) This contributes the slight saving in computation. There exists more important computational phase in the association rule mining. When we apply the mining algorithm to the actual huge problems, the support calculation is critical calculation conceming the number of query to the database. The itemset which has the value greater than predefined threshold is called ?frequent itemset.? The main problem of mining association rules is how efficiently fmd the ?frequent itemsets? from the database.

3.2 Apriori Algorithm The Apriori algorithm is essential and effective  method for mining association rules. The basic idea is that the frequent itemset should contain the subsets of frequent itemsets. Owing to this characteristic, frequent itemsets can be compounded from the smaller frequent itemsets one after another. Let k-itemset denote an itemset having k items. Let Lk represent the set of frequent k-itemsets, and C, the set of candidate k-itemsets. The algorithm to generate the frequent itemsets is as follows:  Al) Ck is generated by joining the itemsets in Lk.i.

A2) The itemsets in Ck which have some @-])-subset  that is not in Lk., are deleted.

Figure 2 shows the system flow outline of mining f u q association rule based on the Apriori algorithm. In our fuuy mining problem, the Apriori algorithm can be applicable like in ?Boolean? mining problem, as the item in Apriori algorithm corresponds to the fuuy set label. It should be noted that the fuzzy sets defined in the same attribute cannot be joined in the above joining phase  Figure 2. Association Rule Mining Flow Chart  4 Mining Algorithm Based on the Fuzzy Set Taxonomy Structure  In our approach, faster algorithm can be formulated by utilizing its hierarchical taxonomic structure. Let us assume that fuur set A contains fuzzy set B on attribute G as the following relation:  where ai denotes the attribute value of i-th transaction.

Let us assume that the fuzzy set C is also defined on attribute H, and the itemsets composed of fuzzy set B and C don?t satisfy the constraint of support as follows:  From Eq.(9) and Eq.(lO), the following relationship holds:  We define the relationship ?fuzzy item subset? that fuur itemset {A, C} i s  the subset of {E, C )  in terms of the fuzzy support definition. This characteristic of taxonomic structure contributes the decrease of iteration to calculate the frequent itemsets. From these relationships, above Apriori algorithm can be enforced as the following algorithms.

4.1 Multiscan Algorithm  We first define the Ck which contains only the fuzzy sets in predefined higher level of the taxonomic hierarchy.

Let Ck denote the candidate set of L?* by joining L?k.,.

The procedure is as follows:  1) L?k.I is selected from based on the hierarchy level.

2) Ck is generated by joining L?k.,.

3) L?r is  decided through the inappropriate itemsets in  4) Ck i s  generated by joining Lk., 5) A2 procedure is employed Furthermore, the itemsets  in C, are deleted on condition that the itemset in Ck which is not the ?fuzzy item subset? of any itemset in  Ck are deleted in the same manner of A2.

L?k .

6) Lk is decided.

In the algorithm, we should do the multiple scan of the database. As this leads to increase of the computational time, we apply the sampling method in which we use the partial transactions of the database for calculation of the     item support. When we use the whole transactions in the algorithm, the result is same as one by standard Apriori algorithm.

4.2 Multistage Fuuy Rule Extraction Algorithm  The higher level fuzzy sets in hierarchical taxonomy represent more rough information of the attribute. In a multistage f u u y  rule extraction algorithm, fuzzy association rules are decided by using only the higher level fuzzy sets first. Let L? denote the fuzzy itemsets corresponding to the derived fuzzy association rules. The second mining process is employed as follows:  1) Ck is generated by joining 2 )The itemsets in C, which have some @-lj-suhset that is  not in Lk., are deleted. Furthermore, the itemsets in ck are deleted on condition that the itemset in C, which is not the ?fuzzy item subset? of any itemset in L?.

By this algorithm, required computational time can be reduced in each mining stage. As the multiple scan of the database is also needed in the algorithm, we can use the database sampling method.

Table 1. Abalone Data  41J71 0)0.710 10.555 10.195 11.9485 10.9455 10.3765 (0.495 I 12  Table 2. Statistical Information and F u u y  Sets Settings  (a) Range Information of Abalone Data  (b) Fuzzy Sets Settings  5 Numerical Experiments We develop the fuzzy mining system and evaluate  the proposed algorithms through numerical experiments.

We apply the system to ?abalone data? available from the UCI Machine Learning Repository (hap:// www.

ics.uci.edu/-mleam/MLRepository.html).

The abalone data set consists of 4177 measured data with 1 nominal attribute and 8 continuous attributes as shown in Table.1. In the experiments the nominal attribute is transformed to the continuous attribute. Table Z(a) shows the statistics and the fuzzy partition information of attributes is summarized in Table 2(b). The range of fuzzy partition is set wider than the actual data distribution for performance evaluation. The fuzzy partition example is shown in Fig.3. We use 2-level hierarchical fizzy set taxonomy for each attribute. Although it is better to use the factor such as ?interesting? for pruning the derived rules, we apply the native association rule extraction for algorithm evaluation.

The results by standard Apriori algorithm are shown in Fig.4. In 4? itemset calculation, waste computation is employed. We should reduce the computation as possible as we can. Figure 5 shows the number of calculated itemsets by the multiscan algorithm without the sampling method. The reduction rates of  the waste support calculation compared with the Apriori algorithm are shown in Fig.6. Though the required time for database scan is increased, the support calculation is reduced.

Membmhip Value I   0.0 2.0  Figure 3. An Example of F u u y  Partition     ! + CaknhrcQ Sa ~  .... \ ....... ......

I 2 3 4 5 6 1 8 9 Itemset Sm  Figure 4. Mining Results by Apriori Algorithm  ............. ........... touMculodcs.e-l,:-!

. ....................................

s  1 2 3 4 5 6 7 8 9  lv-t ser  Figure 7. Results by the 2-stage F u u y  Rule Extractio Algoritbmn  I ...............................

............................... ~~  ~ ,~.  i ~~~~~~~ . , ...........

................................

...... .._ ...

- E a 8 4 0  P 60  E .- - m    1 2 3 4 5 6 7 8 9  1lClDIet see  Figure 5 .  Mining Results by Multiscan Algorithm  12 I 1W  ...............

- - - - 2 3 4 ' 5  6 7 8 9  I,eme*sk  Figure 6. Reduction Rate of Waste Itemsets by Multiscan Algorithm  .............. \ 2 3 1 5 6 7 8 9  I l tmrC,  smc  Figure 8. Reduction Rate of Waste Itemsets by 2-Stage Fuzzy Rule Extraction  .................................

..................................

................................

.................................. -J 0 ' 0 0.2 0.4 0.6 0.8 I  sa*ph8 She Rate  Figure 9. Rule Extraction by the Sampling Method in First Mining Stage     1w ,  0 0.2 0.4 0.6 0.8 1  Samphg She Parameter  Figurelo. Rule Extraction by the Sampling Method in Both Mining Stage  The results by using 2 stage fuzzy rule extraction algorithm without the sampling method are shown in Fig.7. In the first stage, only the higher level fuzzy sets are used for mining association rule. The reduction rates of the waste support calculation compared with the Apnori algorithm are very large as shown in Fig.8. The extracted rules are the same as the standard mining rules in this case. Though the required time for database scan is increased, the method is promising from the results.

Furthermore, the extracted rules by the first stage mining can also be utilized for users. In order to reduce the cost of database scan, we apply the sampling method in the first mining stage. We should confirm the quality of rule extraction in such approximate method. The results are shown in Fig.9. The sampling size rate denotes the used transaction rate in database. The quality of rule extraction is maintained over the sampling size rate 0.5 (i.e. the half of all transactions).

Next simulation is application of the sampling methods to the both mining stages. The sampling size parameter a denote the sampling size rate in the first stage.

In the second stage, the sampling size rate is set to I-a. In this situation, the cost of database scan may be considered to be equivalent to the scan cost in conventional approach.

The results are shown in Fig.10. The quality of the extracted rules is adequately high around the rate 0.5. As the required computational time is reduced and the consumed memory is restrained from the results in Fig.8, the proposed method is effective for fuzzy rule mining.

Furthermore the method could also contribute the realization of ?Interactive mining architecture? which  provides us the useful computational environment for mining by the multistage calculation.

6 Conclusions In this paper, fuuy rule extraction method based on  the generalized association rules from the database composed of quantitative attributes, was proposed. The mining calculation efficiency is improved owing to the fuzzy sets expression as hierarchical taxonomic structure.

Based on the structure, the Multi Scan algorithm which can calculate the support value iteratively according to the hierarchy level of the fuzzy sets, was discussed. We proposed the Multistage fuzzy rule extraction algorithm to improve the computational efficiency of the mining. In the first stage of the algorithm, the fuzzy rule extraction is employed using the fuzzy sets of high hierarchy level. In the next stage, mining procedure is employed utilizing the results in first stage. We developed the mining system and applied to the benchmark database. Simulation results show the effectiveness of our methods.

In future, we will apply the system to more complicated and large actual databases.

