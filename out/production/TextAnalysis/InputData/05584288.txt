

Abstract?The current approach to postmarketing surveillance primarily relies on spontaneous reporting. It is a passive surveillance system and limited by gross underreporting (<10% reporting rate), latency, and inconsistent reporting. We propose a new interestingness measure, causal-leverage, to signal potential adverse drug reactions (ADRs) from electronic health databases which are readily available in most modern hospitals. This measure is based on an experience-based fuzzy recognition-primed decision (RPD) model that we developed previously [1] which assesses the strength of association of a drug-ADR pair within each individual patient case. Using the causal-leverage measure, we develop a data mining algorithm to evaluate the associations between a given drug enalapril and all potential ADRs in a real-world electronic health database. The experimental results have shown that our approach can effectively shortlist some known ADRs. For example, the known ADR hyperkalemia caused by enalapril was ranked as top 1% among all the 3954 potential ADRs in our database.



I. INTRODUCTION dverse drug reactions (ADRs) represent a serious problem worldwide. They refer to drug-associated  adverse incidents in which drugs are used at an appropriate dose and indication. They can complicate a patient?s medical condition or contribute to increased morbidity, even death.

Studies have shown that ADRs contribute to about 5% of all hospital admissions, and represent the 5th commonest cause of death in hospitals [2]. In year 2000, for example, about 7,000 deaths in the U.S. were attributed to ADRs [3].  According to   Y. Ji is with the Department of Electrical and Computer Engineering  Gonzaga University, Spokane, WA 99258 USA (phone: 509-313-3529; fax: 509-313-5871; email: ji@gonzaga.edu).

H. Ying is with the Department of Electrical and Computer Engineering, Wayne State University, Detroit, MI 48202 USA (email: hao.ying@wayne.edu).

P. Dews, was with the Department of Medicine, Wayne State University, Detroit, MI 48201 USA. He is now with the Department of Medicine, StJohn Health Providence Hospital, Southfield, MI 48075 USA (e-mail: peter.dews@stjohn.org).

M.S. Farber is with Drug Information/Use Policy, Detroit Medical Center, Detroit, Michigan, 48201, USA (email: mfarber@dmc.org)  A. Mansour is with Department of Electrical and Computer Engineering, Wayne State University, Detroit, MI 48202 USA (email: el_akaber@yahoo.com).

J. Tran is with the Spokane Mental Health, Spokane, WA 99202 USA (email: jtran@smhca.org)  R. E. Miller is with the John D. Dingell Veterans Affairs Medical Center, Detroit, MI 48201 USA (email: remiller@med.wayne.edu)  R. Michael Massanari is with the Research for the Critical Junctures Institute, Bellingham, WA 98225 USA (email: Michael.Massanari@wwu.edu)  [4] , between 1975 and 1999, 548 new drugs were approved by the Food and Drug Administration (FDA), 16 (i.e., 2.9%) of which were subsequently withdrawn from the market because of ADRs. Forty-five (8.2%) of the 548 drugs acquired at least 1 block box warning for an ADR that was not known when the drug was approved by the FDA for marketing (A black box warning is required by the FDA to appear in the drug package insert as well as in the Physician?s Desk Reference if substantial risk to the patient may occur or if additional information or monitoring of drug use might prevent an adverse event).

Even though pre-marketing clinical trials are required for all new drugs before they are approved for marketing, these trials are necessarily limited in size and duration, and thus are not capable of detecting rare ADRs. Therefore, drug safety depends heavily on postmarketing surveillance - the surveillance of medicines once they have been marketed. In the U.S., current postmarketing methods primarily rely on FDA?s spontaneous reporting system MedWatchTM. The limitations of this system are well described [5].

MedWatchTM is a passive system in that it depends on voluntary, spontaneous reports of suspected ADRs filed by healthcare professionals, drug manufactures, and/or consumers. Detection of an ADR generally relies on FDA?s retrospective or concurrent review of patient cases. Because ADR reports are filed at the discretion of the users of the system, there is gross underreporting. It was estimated that less than 10% of all ADR cases were reported to MedWatchTM [4]. Moreover, it depends on human recognition of a potential link between a drug and an apparent adverse reaction (called signal pair) and on the time and will to report the observation. In addition, the rate at which cases are reported is dependent on many factors, including the time period since the drug was released into the market place, pharmacovigilance-related regulatory activity, the indications for use of the drug (which impacts prescribing frequency), and media attention [6]. Finally, the  passive surveillance system is limited by latency and inconsistent [7].

Consequently, the current approach may require years to identify and withdraw problematic drugs from the market, and result in unnecessary mortality, morbidity, and cost of healthcare. The authors of  [4] pointed out that ?Many serious ADRs are discovered only after a drug has been on the market for years. Only half of newly discovered serious ADRs are  A Fuzzy Recognition-Primed Decision Model-Based Causal Association Mining Algorithm for Detecting Adverse Drug Reactions  in Postmarketing Surveillance Yanqing Ji, Hao Ying, Senior Member, IEEE, Peter Dews, Margo S. Farber, Ayman Mansour, John  Tran, Richard E. Miller, R. Michael Massanari  A          detected and documented in the Physician?s Desk Reference within 7 years after drug approval?.

Data mining methods for the detection of suspected safety problems from spontaneous reports have been studied and practically implemented. For example, the FDA currently adopts a data mining algorithm called Multi-item Gamma Poissson Shrinker [8] for detecting potential signals from its spontaneous reports. Various other methods such as proportional reporting ratios [9], empirical Bayes screening [10], and reporting odds ratios [11] have been used in the spontaneous reporting centers of other nations (e.g., England and Australian). However, the performance of these techniques could be highly situation-dependent due to the weaknesses and potential biases inherent in spontaneous reporting [12]. In addition, early generation of a new signal can be very difficult because a large number of interested cases cannot be timely collected due to the underreporting nature of the current reporting system.

As electronic patient records become more and more easily accessible in various health organizations such as hospitals, medical centers and insurance companies, they provide a new source of information that has great potentials to generate ADR signals much earlier [13]. Jin et al. attempted to signal potential ADRs using administrative health databases [14].

They mined patterns where a potential ADR occurs unexpectedly within a hazard period T after a drug is taken.

The unexpectedness was handled by excluding the expected cases among all the patient cases that show temporal associations between a drug and a potential ADR Specifically, if the potential ADR also occurs before taking the drug within a reference period in the same case, this case is considered as expected and will be excluded. Based on the rest of the unexpected cases, an interestingness measure called unexpected-leverage ? an extension of the commonly used leverage measure, was then defined and used to mine interested drug-ADR associations.

However, this work has several limitations. First, the work is solely based on administrative databases. Other electronic data sources (e.g., pharmacy data) also provide useful evidence for signal generation but are not utilized. Second, temporal association is the only parameter used for linking a potential ADR with a drug within each patient case. Other parameters such as dechallenge and rechallenge can also give direct or indirect cues of the association of a drug-ADR pair.

Third, their approach suffers from the sharp boundary problem. On the one hand, the potential ADR events near the time boundaries are either ignored or overemphasized. On the other hand, two potential ADR events contribute equally to the interestingness measure as long as they occur within the hazard period T. That is, the length of the time duration between exposure to the drug and occurrence of the potential ADR has no effect on the interestingness measure. This is not true in reality because if an ADR symptom occurs within a shorter period, it is more likely to be caused by the drug.

In this paper, we mine ADR signals using a more extensive data source that contains not only administrative data, but  also pharmacy data, clinical laboratory data, and patient medical records. We propose a new data mining method where the association between a drug and a potential ADR for each patient case is a value between [0, 1], instead of a binary number used by other mining methods in the literature.

Rather than simply mining the temporal association between drug-ADR pairs, we tried to mine the more difficult causal associations. The degree of causality is evaluated by a computational fuzzy recognition-primed decision (RPD) model [1] developed by our interdisciplinary research team before. In this model, fuzzy sets, fuzzy rules, and fuzzy reasoning are utilized to represent, interpret, and compute imprecise and subjective information such as temporal association. In addition, more parameters are employed to assess the strength of association between a drug-ADR pair (see Section II). We defined a new interestingness measure called causal-leverage where the contribution of each case to the measure depends on the degree of causal association between the drug and potential ADR within that case. The effectiveness of our data mining strategy was evaluated using real electronic patient data retrieved from the Veterans Affairs Medical Center in Detroit. Our preliminary results are presented in Section V.



II. BACKGROUND ON COMPUTATIONAL FUZZY RPD MODEL The RPD model [15] is an experience-based model. It is  particularly useful when used to model how human experts make decisions based on their prior experiences. The original RPD model is descriptive and is not directly implementable on a computer. Hence, we developed a fuzzy RPD model [1], which is not only computational but also capable of handling vague and subjective information using fuzzy logic.

Experiences play a key role in the RPD model. The ADR detection experiences were acquired through the joint efforts of our engineering and medical team members after careful analysis of the relevant literature. According to the classification scheme in [16], a particular pattern of cue values characterizes a specific degree of causality which may require certain courses of action to handle the ADR.

Therefore, we can define four experiences, each of which is associated with a degree of causality (i.e., very likely, probable, possible and unlikely). Fig. 1 is a sample experience illustrated in natural language for easier understanding.

As shown, an experience consists of four components - cues, goals, actions, and expectancies. Cues represent the higher-level information (synthesized from elementary or environmental data) that a decision maker must pay attention to. Expectancies describe what will happen next as the current situation continues to evolve in a changing context. Goals represent an end state that the decision maker is trying to achieve. Actions represent a set of potential decisions that the decision maker can take in the current situation. Cues are used to match the current situation with prior experiences and determine which experience can be reused to solve a new            Fig.1.  A sample experience  problem. This sample experience has four cues: temporal association, other explanation, dechallenge, and rechallenge.

Temporal association refers to the temporal relationship between taking the drug and occurrence of the potential ADR.

Other explanations denote alternative explanations by concurrent disease or other drugs. Dechallenge is defined as the relationship between withdrawal of the drug and abatement of the adverse effect. Rechallenge describes the relationship between re-introduction of the drug and recurrence of the adverse event. The type of a cue could be quantitative, nominal or fuzzy in the proposed computational fuzzy RPD model. For instance, the cue temporal association may have fuzzy values (e.g. unlikely, possible, likely). Table I shows how the four cues are related to degree of causality of a signal pair in the four experiences.

After representing the experiences, the next step is to extract the cue values from elementary data for the current situation (e.g. a new patient case in which a drug-ADR pair need to be evaluated). Fuzzy rules and fuzzy reasoning are used to achieve this task. For example, to obtain the fuzzy value of temporal association, one of the fuzzy rule ?if the time duration between taking the drug and the occurrence of the adverse event is short, then temporal association is likely? is used. An embedded fuzzy inference engine is employed to perform fuzzy reasoning. After the cue values of the current situation are known, similarity measures are applied to measure the degree of matching between the current situation and prior experiences. The actions in the most matching experience are then used to solve the current problem. For more details of the fuzzy RPD model as well as concrete examples, the reader is referred to our previous work [1].

The fuzzy RPD model was preliminarily validated by using it to calculate the extent of causality between cisapride and some of its adverse effects for 100 simulated patients created based on the profiles of 1,015 patients of the VA Medical Center. The simulated patients were used because we found that the number of apparent signal pairs of potential interested ADRs (i.e., cisapride and Torsades de Pointe and/or syncope) in the real patient data was very limited. Therefore, we used the real patients to create simulated patient cases, all of which containing interested drug-ADR pairs with various degrees of causality. The model?s validity was then established by  TABLE I RELATING CUES TO DEGREE OF CAUSALITY OF A SIGNAL PAIR     comparing the decisions made by the model and those by two independent experienced internists for the 100 simulated patients. The levels of agreements were measured by the weighted Kappa statistic, which is a measure of agreement between two raters after chance agreement is controlled. The results suggested good to excellent agreements [1].



III. PROBLEM FORMULATION AND A NEW CAUSAL LEVERAGE MEASURE  An association rule is an implication expression in the form of X Y? , where X and Y are two event sets and they are disjoint (i.e., X Y ?=? ), meaning that they share no common events. Both X and Y may contain one or more events. An association rule indicates that the presence of X implies the presence of Y . If X and Y have temporal relationship, a temporal constraint is often applied to the association rule. Such an association rule, represented as  TX Y??? , is called temporal association rule, where T??? denotes that Y occurs  after X within a time window of length T  in the same event sequence.

In the literature, association rule mining is usually based on two measures: support and confidence. The support of an association rule supp( X Y? ) is the proportion of sequences in which both X and Y occur at least once, among all the event sequences. This measure indicates how often a rule is applicable to a given set of event sequences. The importance of this measure lies in the fact that if a rule has very low support, it may occur simply by chance and thus would be uninteresting. The confidence of an association rule is defined as conf( X Y? ) = supp( X Y? )/supp( X ? ), where supp( X ? ) is the proportion of sequences that contain X .

This measure determines how frequently Y appears in those event sequences that contain X .  That is, given an association rule X Y? , the higher the confidence, the more likely it is forY to be present in sequences that contain X . Given these two measures, the association rule mining problem can be formalized as finding those rules whose support and confidence are greater than pre-specified thresholds minsupp and minconf, respectively.

In the context of ADR detection using electronic patient data, a health database often contains many patient records, each of which can be considered as an event sequence where  Experience_N: The causality between the drug and a particular ADR is very likely Cues: 1) The occurrence of ADR has a likely temporal association with the drug;  2) There is no other explanation; 3) The ADR has likely dechallenge relationship with the drug; 4) The ADR has likely rechallenge relationship with the drug.

Goals: Find the strength of the causality between a drug and a particular ADR;  Actions: 1) Suggest for further analytical studies; 2) Suggest filing an ADR report online.

Expectancies: 1) More similar cases are available; 2) Relevant information for filing an ADR report is  available;         various events such as drug prescription, lab test, and potential ADR occur at different times. However, the above two frequency-based measures cannot be effectively used to find the association between a drug and an ADR because occurrences of ADRs are very infrequent in electronic health databases. For example, bromfenac (Duract) was a non-steroidal anti-inflammatory agent (NSAID) that was removed by the FDA from the market in 1998, less than 1 year after it was introduced. Bromfenac caused serious hepatotoxicity in only 1 in 20,000 patients taking the drug for longer than 10 days [17]. This type of rare and long-delay drug reactions are very difficult to be detected during the pre-marketing clinical trials because most new drugs are approved with an average of 1,500 patient exposures and usually for relatively short periods of time. Thus, detection of these low-frequency ADRs requires many more exposures and can only be possibly achieved in postmarketing surveillance. If the above two measures were used, their corresponding thresholds minsupp and minconf would have to be set very small in order to detect these ADRs. But this would not only lead to a lot of false drug-ADR associations but also make the computational cost of the mining algorithm extremely high [14, 18].

Another pitfall of using the support and confidence measures is that the detected associations with relatively high frequencies may not be interesting. The reason is that symptoms of an ADR cannot be easily distinguished from those of an underlying disease in electronic health databases.

Both of them are encoded using the same ICD-9 codes. Thus, if a drug is used to treat a disease, the drug and the disease can be easily detected as an association using these measures. But this association is expected and not interesting.

Interesting measures like leverage and its variations have been used to mine temporal associations between drugs and potential ADRs [14]. The leverage of an association rule is defined as   leverage( X Y? )=supp( X Y? ) ? supp( X ?) i supp( Y? )   where supp( Y? ) is the proportion of sequences that contain Y . This measure indicates the proportion of sequences exhibiting the association between X and Y in excess of those that would be expected if X and Y were independent of each other. To mine temporal association rules, a temporal constraint can be embedded into the measure. That is,   leverage( TX Y??? )=supp( TX Y??? ) ? supp( TX ???) i supp( T Y??? )   where supp( TX Y??? ) represents the proportion of sequences in which Y occurs after X within a T sized? window.

supp( TX ??? ) and supp( T Y??? ) denotes the proportion of sequences that contain X andY , respectively, among all the T constrained? sequences. While this measure can express  the temporal association between two events, it cannot effectively represent the causal relationship between a drug and an ADR. Hence, a new measure needs to be introduced.

Our strategy is to utilize an experience-based model (i.e., the computational fuzzy RPD model) to capture the causality between X and Y . We introduce causal association rule (CAR), denoted by CX Y??? , meaning that X causesY in an event sequence. The degree of causality is determined by the fuzzy RPD model in which temporal association is only one of the four parameters that are used to assess the strength of causal association between two events. Note that the RPD model employs ?situation-experience matching? decision rules to determine how well the current situation matches various prior experiences. Specifically, for each interested drug-ADR pair, the values of four cues (i.e., temporal association, other explanation, dechallenge, and rechallenge) are abstracted from the related electronic patient record.

These cue values then match the cue values in the four defined experiences, each of which corresponds to a unique category of causality (i.e., very likely, probable, possible, and unlikely). A similarity value between the current pair and each of the experiences is obtained using a similarity measure developed in our previous work [1]. After that, these similarity values are normalized so that their sum is equal to 1. These normalized values are then used to represent the membership values of corresponding categories of causality between the interested drug and ADR. For example, if the normalized similarity value between a pair and the experience exhibiting ?probable? association is 0.4, we would say the causality of the drug-ADR pair is ?probable? with a membership value of 0.4.  Table II gives several sample drug-ADR pairs as well as their membership values related to each causality category. Note that, given a particular drug, there may exist none, one, or multiple drug-ADR pairs within each patient case. Patient 3, 6, and 7 in the table do not contain drugs and/or ADRs of our interest.

Let v? , p? , l? , and u?  represent the membership values of causality categories ?very likely?, ?probable?, ?likely,? and ?unlikely?, respectively. Then, the quadruple  { }, , ,v p l u? ? ? ? ?= can be used to characterize the causality   TABLE II MEMBERSHIP OF EACH CAUSALITY CATEGORY FOR SAMPLE SIGNAL PAIRS  (PID MEANS PATIENT IDENTIFICATION NUMBER)            of a drug-ADR pair. In order to define a causality-based leverage measure, we combine the membership values of the four causality categories into one number using weighted sum and define the degree of causality of a pair as   , v v p p l l u udrug ADRC w w w w? ? ? ?= + + +i i i i   where vw , pw , lw , and uw are the weights for v? , p? , l? ,  and u? , respectively. In this study, we set { }, , ,v p l uw w w w as { }1.0, 0.667, 0.333, 0.0 based on two considerations. First, causality categories representing stronger causal associations should have higher weights. That is, v p l uw w w w> > > must  be satisfied. Second, the range of ,drug ADRC  should be [0, 1].

That is, ,drug ADRC  should be 0 for the extreme situation  { }0,0,0,1? =  where the evidence in a patient record strongly shows ?unlikely? association of the pair. If all the evidence in the patient supports ?very likely? association (i.e.

{ }1,0,0,0? = ), ,drug ADRC  should be 1. Otherwise,  ,drug ADRC  is between 0 and 1. Given the above weights for  v? , p? , l? , and u? , the causality of pair , 1drugA ADR in patient 1 can be calculated as follows.

, 1 0.6 1.0 0.2 0.667 0.15 0.333 0.05 0.0  0.783 drugA ADRC = + + +  =  i i i i   where the superscripted number (i.e., 1) is used to indicate the PID.

In general, if the experience-based fuzzy RPD model classifies the causality between X and Y  into m categories, the degree of causality is defined as    ,  m  i iX Y i  C w? =  =? i   where i?  is the membership of the  thi causality category for the pair, and iw  represent the corresponding weight when converging all the causality categories into one.

We define the support of a CAR, supp( CX Y??? ), as the accumulated votes (with respect to pair  ,X Y ) over all  sequences. That is, it is calculated by first summing all votes of each sequence divided by the total number of sequences.

The vote of a sequence is a function of causality between X andY .  That is,  supp( CX Y??? ) = ,   n j  X Y j  n  ? = ?      where n is the total number of sequences, and ,  j X Y?  represents the vote of the thj sequence with respect to pair ,X Y . ,  j X Y? is defined as    , , ,   j j X Y X Yj  X Y  C if C  otherwise  ? ?  ? >?= ? ??     where  , j  X YC  is the degree of causality between X andY in  the thj sequence. ?  is the user-specified threshold, which ensures that if the causality of pair ,X Y  is low in a  sequence, this sequence will not be considered when calculating the support of the CAR. Note that if a sequence does not contain both X and Y , the causality between X and Y  is 0. One can see that the contribution of each sequence to the support measure becomes gradual as opposed to binary. That is, the higher the degree of association between X and Y in a sequence, the more the sequence contributes to the measure. This definition of the support measure is more reasonable in the ADR detection and likely many other medical applications than its traditional definition where the contribution of sequence to the measure is either 0 or 1.

As an example, we now compute the support of the CAR drugA C??? 1ADR  using the data in Table II. We assume the threshold ?  is equal to 0.2, as suggested by the physicians in our project team. The degree of causality of pair  , 1drugA ADR in patient 1 was already calculated above.

Since 0.783 0.2> in patient 1, 1 , 1 0.783drugA ADR? = . The  causality of pair , 1drugA ADR in patient 4 is computed as  below:   , 1 0.0 1.0 0.1 0.667 0.2 0.333 0.7 0.0  0.133 drugA ADRC = + + +  =  i i i i   Since the value is less than ? =0.2, 4  , 1 0.0drugA ADR? = .

Similarly, we can get 7 , 1 0.467drugA ADRC = , which is larger  than ? . Thus, 7 , 1 0.467drugA ADR? = . All the other cases do  not contain the pair , 1drugA ADR . Their votes are zeros.

Therefore, the support of the CAR drugA C??? 1ADR  is   supp( drugA C??? 1ADR ) = 0.783 0.467 0.156 + =   Next, we introduce a new interestingness measure, causal-leverage, based on the above definition of the support of a CAR. The causal-leverage of a CAR is given below:           causal-leverage( CX Y??? )=supp ( CX Y??? ) - supp ( CX ???) isupp ( Y??? )   where supp ( CX ???) is the proportion of sequences whose votes are not equal to 0 with respect to the pair  ,X Y . Based  on the above discussions, only the votes in patients 1 and 7 are greater than 0 when computing supp( drugA C??? 1ADR ).

Thus, supp( drugA C???)=2/8=0.25. Given the data shown in Table II, supp(??? 1ADR )=4/8=0.5 since four cases contain  1ADR . Hence,  Causal-leverage( drugA C??? 1ADR )= 0.156 0.25 0.5? i  =0.031   As a comparison, we also calculated the causal leverage of another CAR - drugA C??? 2ADR , and got  Causal-leverage( drugA C??? 2ADR )= 0.19 0.25 0.375? i  =0.096   Therefore, drugA has a stronger association with 2ADR than with 1ADR  based on our causal leverage measure, even though pair , 1drugA ADR  has a higher frequency than pair  , 2drugA ADR . Note that, in Table II, there are three cases  containing , 1drugA ADR , but only two cases containing  , 2drugA ADR . The supports for traditional association rules  drugA ??? 1ADR  and drugA ??? 2ADR  are 3/8 and 2/8, respectively. Their confidences are 3/5 and 2/5, respectively.

That is, drugA has a stronger association with 1ADR  than with 2ADR , according to the traditional support and confidence measures. We believe that our result is more reasonable because, even though fewer cases contain the pair  , 2drugA ADR , they exhibit higher accumulated degree of  causality. Moreover, common high-frequent illnesses (e.g., fever) often coexist with a drug by chance in the databases, but they can be mistakenly classified as ADRs if the traditional frequency-based measures are used. As mentioned earlier, ADRs in postmarketing surveillance should be infrequent, otherwise the drugs were not approved for marketing. Our measure can deal with the infrequency nature of ADRs better than the traditional association rule mining measures.

To see the difference between our causal-leverage measure and the traditional leverage measure, we also calculated the latter for the two association rules drugA ??? 1ADR  and drugA ??? 2ADR  as follows:  Leverage( drugA ??? 1ADR )=supp( drugA ??? 1ADR )  ? supp( X ?) i supp( Y? )= 3 5 4 0.0625 8 8 8  ? =i  leverage( drugA ??? 2ADR )=supp( drugA ??? 2ADR )  ? supp( X ?) i supp( Y? )= 2 5 3 0.0156 8 8 8  ? =i   One can see that the traditional leverage measure comes to the same conclusion (i.e. drugA has a stronger association with 1ADR  than with 2ADR ) as the traditional support and confidence measures. The reason is that all these measures have the same drawback: the degree of association of the pair in each case is not considered. That is, each patient case contributes equally to the measures as long as that case contains the interested drug-ADR pair. Therefore, the traditional leverage measure cannot effectively handle the infrequency nature of ADRs either.



IV. MINING CAUSAL ASSOCIATIONS RULES In this section, we develop a data mining algorithm to  search for causal association rules based on our causal-leverage measure. Specifically, we will look at how to mine an electronic health database in order to find out the strengths of associations between a drug of interest and various potential ADRs. In the following descriptions, we use the term cases to refer to those patient records containing the interested drug and non-cases refer to other patient records.

Fig.2 shows an overall picture of the algorithm. First, each patient case is classified as either case or non-case, depending on whether it contains the drug of interest. Next, each case is searched for all possible drug-ADR pairs based on drug start dates and diagnosis dates. As discussed earlier, in an electronic health database, one cannot easily differentiate the underlying disease from a potential ADR, both of which are encoded in the ICD-9 codes and have diagnosis dates in the database. For example, cough (its ICD-9 code is 786.2) could be either an ADR caused by a drug like Enalapril or simply a patient?s disease. Moreover, since each patient case records the patient?s history for a long period of time, the same drug may be prescribed many times and thus multiple drug start dates may exist for it. Similarly, there may exist multiple diagnosis dates for the same disease or ADR. Therefore, we must compare each start date of the interested drug with each diagnose date of a potential ADR.

A drug-ADR pair is recognized if the potential ADR occurs at least once after one of the start dates of the drug within a certain period of time (e.g., 90 days). If we assume Enalapril is our interested drug, Fig. 3 shows that two pairs are found within one case. In this case, since the ICD-9 code 729.1      Fig. 2 Algorithm for mining causal association rules          Fig.3. Sample pairs within a patient case  (myalgia) occurs before all the start dates of Enalapril, it does not form a pair with the drug. The ICD-9 code 786.2 (cough) occurs after the first start date of Enalapril in 24 days. Thus a pair is found, i.e., Enalapril ? 786.2. The code 276.7 (Hyperkalemia) occurs twice after the second start date of Enalapril. A pair is formed between the drug and the closest occurrence of 276.7.

After a pair is found, its degree of association is assessed using the fuzzy RPD model. Four cues (i.e., temporal association, other explanation, dechallenge, and rechallenge) are utilized in this process. The temporal association of a pair is determined by the length of duration between drug start date and ADR occurrence date. We let Ta and L represent the temporal association and length of duration, respectively.

Then the following fuzzy rules are used to infer Ta.

Both L and Ta are fuzzy variables, and their fuzzy values (short, likely, etc.) are represented by triangular membership functions. The universe course for L is set as 0 to 180 days.

That is, if the ADR occurs within 180 days after the drug start date, the pair is considered as having temporal association.

Dechallenge refers to the relationship between discontinuity of the drug and abatement of the ADR. We cannot directly evaluate the dechallenge of a pair since the drug stop date is usually unavailable in electronic health databases. However, we can indirectly assess the existence of dechallenge of a pair using the rule ?if the potential ADR occurs after the drug start date and another drug in the same class was prescribed after the potential ADR, then dechallenge is likely intended by the physician for the former drug?. In medical practice, if an apparent adverse effect is found on a patient and is suspected to be caused by a drug, the physician often stops the drug and prescribes another drug in the same class to avoid the problem and still treat the original disease. Thus, it is very likely that there exists dechallenge between the original drug and the ADR in this situation.

Rechallenge depicts the relationship between re-introduction of the drug and recurrence of the ADR. That is, the same pair appears again after the drug is taken by the patient again. Rechallenge is defined as a fuzzy variable and its value is determined by the temporal associations of the two consecutive occurrences of the same pair. We let Ta1 and Ta2 represent the two temporal associations, respectively. Then the following fuzzy rules are used to assess the value of the rechallenge of a pair.

The cue ?other explanations? denotes alternative  explanations by concurrent disease or other drugs. Thus, it is drug- or disease-dependent. To make our algorithm as general as possible, this variable is not utilized at present. Note that the other three variables can be easily extended to other applications since they can characterize the causal relationship between two general events.

After the cue values of a pair are extracted from a case, we use the procedure (called feature matching) introduced in Section III to transform the data of a pair to the format shown in Table II. We then compute the support and causal-leverage for all the pairs, each of which implies a causal association rule. Instead of setting an explicit threshold for the causal-leverage measure, we rank all the causal association rules in the decreasing order of the measure and return the most interesting rules.



V. EXPERIMENTS To evaluate the effectiveness of our new data mining  strategy, we retrieved the electronic data of all patients who received at least one of the 8 drugs of our interest in the Veterans Affairs Medical Center in Detroit during the time period from January 1, 2005 to December 31, 2008. The interested drugs include 6 statin drugs (i.e., rosuvastatin, atorvastatin, fluvastatin, lovastatin, pravastatin, and simvastatin) and 2 ACEI (angiotensin-converting enzyme inhibitor) drugs (i.e., captopril, and enalapril). ?Event? data such as dispensing of drug, office visits, and certain laboratory testing was retrieved for all the patients. For each event certain details were obtained. For example, the data for dispensing of drug includes name of the drug, subject ID, quantity of the drug dispensed, dose of the drug, drug start date, drug schedule, and the number of refills.

The total number of retrieved patients was 16,206. All the data were stored in a Mricrosoft Access database. The database has five tables, each of which contains one of the five types of information: demographic data, patient visit data, diagnostic data, drug-related data, and laboratory data.

JDBC (Java Database Connectivity), an application programming interface for the Java programming language, was used to access the database. It can wrap SQL (Structured Query Language) statement, send it to the database, and retrieve the desired data. Fuzzy rules and fuzzy reasoning were implemented using the freeware FuzzyJess [19], a Java-based fuzzy inference engine. It allows the user to use Java language to define membership functions, set antecedent and consequent of a fuzzy rule, and make a fuzzy inference.

This made it easier to integrate the reasoning process with the  If L is short then Ta is likely If L is medium then Ta is possible If L is long then Ta is unlikely  If Ta1 is likely and Ta2 is likely then rechallenge is likely If Ta1 is likely and Ta2 is possible then rechallenge is likely If Ta1 is likely and Ta2 is unlikely then rechallenge is possible If Ta1 is possible and Ta2 is likely then rechallenge is likely If Ta1 is possible and Ta2 is possible then rechallenge is possible If Ta1 is possible and Ta2 is unlikely then rechallenge is possible If Ta1 is unlikely and Ta2 is likely then rechallenge is possible If Ta1 is unlikely and Ta2 is possible then rechallenge is possible If Ta1 is unlikely and Ta2 is unlikely then rechallenge is unlikely         other parts of the data mining algorithm which were also implemented in Java.

To test the proposed data mining algorithm, we select a drug that has high frequency in the database since ADRs occur infrequently. In general, if the occurrence rate of an ADR is greater than 1%, it can be detected in the pre-marketing clinical trials and the drug is not likely to be approved for marketing. Thus, the occurrence rate of an ADR is generally less than 1% in post-marketing surveillance.

Moreover, to generate a valid signal, the interestingness measure is often used together with another criteria ? the count of drug-ADR pairs being greater than or equal to 3 [9].

That is, even if the calculated interesting measure for a pair is higher than a threshold, the pair cannot be considered as a valid signal if there are only one or two patient cases containing the pair. This requires at least 300 (3/0.01=300) cases in order to generate a valid signal. The real situation is even worse since the occurrence rate of most ADRs is much lower than 1%. Many more cases will be needed.

We finally picked the drug enalapril to test the proposed algorithm since 888 patients were found taking the drug at least once in the database and a number of its known ADRs had relative high occurrence rate. Causal-leverage values were calculated for each of the pairs between enalapril and all the 3,953 distinctive ICD-9 codes found in the database. All the pairs were ranked in a decreasing order according to their causal-leverage values. A pair between the drug and one of its known ADRs, 276.7 (hyperkalemia), was found to be ranked as 33 out of 3,953. That is, our data mining algorithm classified the pair into top 1% of all the pairs. Note that, in post-marketing surveillance, the primary purpose of using data mining is to shorten the long list of potential drug-ADR pairs. Like the other data mining methods, the signal pairs found by our approach will be subject to further analysis (e.g., epidemiology study) and case review and interpretation by drug safety professionals experienced in the nuances of pharmacoepidemiology and clinical medicine [20].



VI. CONCLUSION Causal association represents an important relationship  between two events in many applications. Finding causal associations can help us prevent adverse effects caused by their antecedents. We have introduced a knowledge representation - CAR and have developed a new interestingness measure, causal-leverage, to quantify the degree of causality of a CAR. Based on this novel measure and an experience-based fuzzy RPD model, we have developed a data mining algorithm to search an electronic health database for ADR signals. Experimental results showed that our method could greatly shortlist the number of pairs between a given a drug and all its potential ADRs.

