A Data Mining based Approach for the EEG Transient Event  Detection and Classification

Abstract  An automated methodology which detects transient events in EEG recordings and  classifies those as epileptic spikes, muscle activity, eye blinking activity and sharp alpha  activity is presented.  It is based on data mining algorithms and includes four stages: (I) EEG  preprocessing and transient events detection, (II) clustering of transient events and feature  extraction, (III) feature discretization and (IV) association rule mining and classification. The  methodology is evaluated using a dataset of 25 EEG recordings and the obtained overall  accuracy is 84.35%. The major advantage of our approach is that it is able to provide  interpretation for the decisions made since it is based on a set of association rules.

1. Introduction  The Electroencephalogram (EEG) is a valuable clinical tool in the diagnosis, monitoring  and management of neurological disorders. EEG can help in the diagnosis of a number of  diseases, including epilepsy, sleep disorders and brain tumors. Epilepsy is characterized by  the existence of abnormal synchronous discharges in large ensembles of neurons in brain  structures. These discharges are often referred to as ?paroxysmal activity?. They appear either  during seizures (ictal periods) or between seizures (inter-ictal periods).

Electroencephalographers detect the  epileptiform activity visually.  However, the spikes,  sharp waves and spike wave complex, as all referred as epileptic spikes (ES) are sometimes  difficult to be detected reliably.  This is due to the fact that normal brain activity (sharp alpha  activity or SAA) and human artefacts (muscle activity or EMG and eye blinking or EOG) can  be misinterpreted as epileptic spikes. As a result the presence of epileptic activity is  occasionally missed or incorrectly selected when manually reviewing EEG data. In addition,  this process is time consuming. Several methods which automatically recognize epileptic  spikes are reported in the literature.  They can be classified in three categories, based on: (i)  traditional recognition techniques, i.e. methods with a substantial mimetic component [1,2,3],  (ii) mathematical transforms [4,5], and (iii) artificial neural networks [6,7,8]. However, most  of the above methods cannot deal with the undesirable activity (normal brain activity,  artefacts). Moreover, most of the methods are not able to provide interpretation for the  decisions made. The proposed methodology handles these two aspects effectively.

In this study, we introduce a methodology based on a four-stage schema (Fig. 1) for the  transient event detection and classification. In the first stage, pre-processing of the EEG  signal is performed in order to detect the candidate transient events. In the second stage, the  transient events are clustered and feature extraction takes place. In the third stage, the  continuous valued features are transformed into discrete ones using a discretization technique.

Proceedings of the 18th IEEE Symposium on Computer-Based Medical Systems (CBMS?05)     In the last stage association rule mining is applied to generate association rules, which are  used to establish the final transient event classification model.

Figure 1: Flowchart of the four-stage methodology.

2. Materials and Methods  2.1. First Stage: Signal pre-processing and transient event detection  A data driven segmentation algorithm is used to eliminate areas of low background activity  of the EEG using a thresholding procedure.  More specifically, a threshold depending on the  average of the absolute value of the amplitude =  N  i  ix N 1  ||  of the whole EEG signal in each  single channel of each montage is calculated, where xi represents the discrete input values and  N is the number of samples. Peaks over the calculated threshold are considered as candidate  transient events.  A window of constant length of 91 points (355 msec) is used, centred at the  identified peak.  If a larger peak is found within the selected window, the window is centred  at this peak; otherwise the window of 91 signal points is considered as a candidate transient  event.  The largest peak in a window is called vertex.

2.2. Second Stage: Clustering of transient events and feature extraction  First, the number of clusters of the transient events is identified.  The procedure employed  for the identification of the number of clusters of transient events is based on the  minimization of the regularized cost function C(x,y) [9]:  = =  ?= p   k   2)()()()( ||||)|(),(C i j  jiij yxxyfyx + = =  ? p  i  k  j  jij  j yyxyfI 1 1  2)()()()( ~~  ||||)|( ? ,   (1)  where ~  jI is a multiplier unique to each cluster centre, )|( )()( ij xyf , )|( )()(  ~ ij xyf are  indicator functions given as:  EEG preprocessing and transient event detection  Transient event classification  Clustering of transient event and feature extraction  Feature discretization  Association rule mining  Raw EEG recording  EEG preprocessing and transient event detection  Clustering of transient event and feature extraction  Feature discretization  Association rule mining  Raw EEG recording  Transient event classification  Proceedings of the 18th IEEE Symposium on Computer-Based Medical Systems (CBMS?05)     ?== otherwise  yxjif xyf  (m)i  mij   minarg1 )|(  )(  )()( and  ?=?= otherwise  yx,Nyif xyf  (m)i  my  (i ij  ~ (   minarg1 )|(  )()  )()( ) ?? ,  )(?y N is the neighborhood of the cluster centre )(?y , nix ??)(  is a pattern - in our case a transient event - p is the number of patterns {x(i): i = 1,2,?,p}, k the number of clusters and  2||||minarg mim yx ?  is the value of m which minimizes the norm  )( (m)i yx ? .

Using k-means clustering we start choosing an initial set of prototypes, which implies the  partition of the patterns into k clusters. These clusters correspond to the prototype transient  events.

After the identification of the prototype transient events, feature extraction takes place. We  extract the following six features for every prototype transient event:  i) Duration: The time between the starting point and the end point of each transient  event.  It is measured from the vertex to the point where the drop of the slope is more  than 60% or a change in the direction of the slope appears.

ii) Area: The calculated area of the EEG recording for the above calculated duration of  the transient event.

iii)  |||| 01 aaslopeAverage +  = ,                      (2)  where a0,, a1 is the slope before and after the vertex x1, respectively,  a0 t  xx 01 ?= , a1 t  xx 12 ?= , where x2, x1, x0 are samples of the window and sF  t 1=  (Fs is the sampling rate).

iv) || 01 aaSharpness ?=                                              (3)  v)Standard Deviation =  ?= L  i  xix L 1  2)( 1 ? ,                                                                  (4)  where xi represents the discrete input values, L is the number of samples for each transient  event (L=91) and =  = L  i  i x  L  x   ?  represents the mean of xi.

vi) Dominant frequency: The frequency at which the maximum amplitude of the power  spectrum density (PSD) is observed.

2.3. Third Stage: Discretization  In order to use association rule mining in the last stage of our methodology, the numerical  attributes, extracted from the previous stage, must be replaced with qualitative attributes  representing intervals of numerical domains with discrete values. This process is known as  discretization and involves the transformation of a quantitative variable into a qualitative one.

The discretization approach we used is based on entropy minimization and the minimum  description length principle [10]. The algorithm uses the class entropy of candidate partitions  to select a cut point for discretization. The method can then be applied recursively to the two  intervals of the previous split, thus creating multiple intervals for the feature. For a set of  Proceedings of the 18th IEEE Symposium on Computer-Based Medical Systems (CBMS?05)     instances S, a feature A, and a cut point P, the class information entropy of the partition  induced by P is given as:  )( ||  || )(  ||  || );,( 2   1 SEnt S  S SEnt  S  S SPAE += ,              (5)  where S1 and S2 are two intervals of S bounded by cut point P, and Ent(S) is the class entropy  of a subset S. For a feature A, the cut point P which minimizes Eq. (5) is selected as a binary  discretization boundary. The procedure is repeated until the stopping criterion, which is based  on the minimum description length principle, is reached. The stopping criterion prescribes  accepting a partition induced by if and only if the cost of encoding the partition and the  classes of the instances in the intervals induced by P is less than the cost of encoding the  classes of the instances before splitting [11].

2.4. Fourth Stage: Association rule mining and classification of transient events  One of the well known data mining techniques [12] is association rule mining [13] and is  perhaps the most common form of local-pattern discovery in unsupervised learning systems.

Association rule mining is the discovery of association relationships or correlations among a  set of items. An association rule has the form YX ? and is interpreted as ?database transactions that satisfy X are likely to satisfy Y?. X and Y are composed of items and are  called itemsets. X is called the antecedent part or body of the rule and Y the consequent part or  head of the rule. The most widely used framework for association rule evaluation is the  support-confidence framework. The support of an association rule YX ? is the ratio of the transactions which contain the itemsets X and Y to the total number of transactions in the  database. The confidence of an association rule YX ? is the ratio of the transactions that contain the itemsets X and Y to the transactions which contain the itemset X.

A recent field of data mining, classification using association rules [14], applies concepts  used in association rule mining to the classification problem. Classification using association  rules makes use of a special subset of association rules whose consequents are restricted to  the classification class attribute. These rules are called Class Association Rules (CARs) and,  after their generation, they are used to form a classification model.

An effective algorithm that performs classification using association rules is the  Classification Based on Associations (CBA) [14]. CBA first generates as candidate rules all  the class association rules exceeding the given support and confidence thresholds using the  apriori algorithm [13]. After the rule generation, CBA prunes the set of rules using the  pessimistic error rate method [15]. More specifically if rule r?s pessimistic error rate is higher  than the pessimistic error rate of rule ?r (the latter is obtained by deleting one condition from  the conditions of r), then rule r is pruned. This pruning procedure can cut down the generated  number of rules substantially. In the testing phase, the above obtained rules are used for  classification. When predicting the class label for an example, the best rule (i.e. the one  having highest confidence) whose body is satisfied by the example is chosen for prediction.

That is, the unknown example is assigned the class of the rule with the highest confidence  that covers it.

3. Results  The proposed methodology is evaluated using the EEGs from 25 patients (12 normal and  13 epileptic) which have been acquired in the Neurology Department at the University  Hospital of Ioannina, Greece.  More specifically, the EEG dataset consists of 1232 prorotype  Proceedings of the 18th IEEE Symposium on Computer-Based Medical Systems (CBMS?05)     transient events: 327 epileptic spikes, 378 muscle activity, 134 eye blinking activity and 393  sharp alpha activity all characterized by two experienced neurologists. The training set  includes 50% of the prototypes from each category, while the test set consists of the rest. The  training set is used to both extract the discretization intervals and generate the class  association rules. The performance of the methodology was measured by means of  Sensitivity, Specificity, and Selectivity.

Table 1: Classification results for the CBA algorithm in terms of Sensitivity, Specificity, Selectivity  Transient Events Sensitivity (%) Specificity (%) Selectivity (%) ES 83.94 91.07 81.56  EMG 85.04 95.75 89.26 EOG 72.5 99.24 90.63 SAA 87.90 90.20 78.42  We run several experiments in order to test the accuracy of our methodology. The best  results (84.35% overall accuracy) were obtained using minimum support 1% and minimum  confidence 50% for the CBA algorithm. Two other rule based classification algorithms, CN2  [16] and RIPPER [17] were also employed but we obtained lower accuracy (82.56% and  81.63% overall accuracy for RIPPER and CN2, respectively). Table 1 displays the  experimental results obtained. All the tested algorithms performed comparably but the CBA  algorithm was found to be the most efficient. It should be mentioned that the CBA algorithm  generated 100 rules. 35 of them were rules which predicted epileptic spikes, 24 predicted  muscle activity, 10 predicted eye blinking activity and the rest 31 predicted sharp alpha  activity. Some indicative rules are shown below.

Rule 1                                                                Rule 2  If Area = (195.2975, 1835.13]                           If Duration = (-inf, 22.5189]  and Sharpness = (2.31891, 3.93423]                 and Average Slope =(0.054067, 0.077462]  Then Transient Event is ES                               Then Transient Event is EMG  (Support=6.744%, Confidence= 100.000)        (Support=9.302%, Confidence= 100.000%)  4. Discussion-Conclusions  In the current study, we introduce a four-stage procedure for the automated detection and  classification of transient events in EEG recordings. All steps in the proposed methodology  are realized automatically. In the first stage the EEG signal is preprocessed and transient  event detection takes place. In the second stage the transient events are clustered and feature  extraction is realized. In the third stage the extracted features are discretized using recursive  minimal entropy partitioning and the minimum description length principle. Finally in the last  stage association rule-based classification is applied to the discretized set of features in order  to extract rules to classify the new transient events.

In Table 2, the results of the proposed methodology are compared to those of other  approaches. Our approach shows comparable or better performance. The majority of the  reported works [1,2,4,7] address only spike detection where the number of false positives due  to spike-like artefacts (EMG, EOG) and sharp alpha activity in EEG is high. Our  methodology deals with the undesirable activity (EMG, EOG, SAA), by detecting it and  Proceedings of the 18th IEEE Symposium on Computer-Based Medical Systems (CBMS?05)     classifying it into the appropriate categories successfully. Thus, our approach can only be  directly compared with [6], a neural network based method which classifies the transient  events in all four categories. Furthermore, most of these methods [4,6,7] are based on neural  and mathematical approaches. Such methods exhibit a serious drawback compared to our  association rule approach, due to their inability to provide explanations for their classification  decisions. In contrast, due to the rule-based nature of our methodology, the proposed  approach satisfies this requirement, and it is able to provide for each transient event, the  reason that led to each decision. Finally, the performance of the transient event classification  methodology was high, however further clinical testing is considered as mandatory in order to  fully reveal its potential.

Table 2: Comparison of the performance of several methods for spike detection.

