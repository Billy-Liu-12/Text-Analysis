A New Analytical Solution of Nonlinear Geodetic  Datum Transformation

Abstract?Nonlinear geodetic datum transformation is particular suitable for the case of large rotation angles, and has been an active area of research in recent years. In this paper, we propose a new analytical solution. The method expresses the scale parameter and translation parameters as the function of rotation matrix, through the derivation process. Then, according to the orthogonality of rotation matrix, the method adopts Rodrigues matrix to represent it. Using the relative formula of Rodrigues matrix with anti-symmetric matrix which is formed by a rotation vector, we derive the solution formula of the rotation vector.

Finally, we obtain the analytical solution to the seven parameters.

The case studies indicate that the proposed method is valid, regardless of whether the coordinates are polluted by noise or not, and whether rotation angles are big or small.

Keywords- nonlinear datum transformation; analytical solution; rotation vector ; transformation residual

I.  INTRODUCTION Nonlinear geodetic datum transformation is particular  suitable for the case of large rotation angles, and has been an active area of research in recent years. Many solutions are presented, which can be divided into two categories, namely, iterative solution and analytical solution. The former are dominant, e.g., [1]-[7]. The major difference between these methods embodied in that the rotation matrix is represented differently, which lead to the linearization models are different.

However, the iterative methods have a drawback of more or less dependence on initial value of parameters. So people need to investigate more efficient analytical method. At present, the relative literature is rarely seen, e.g., [8] presented the Procrustes algorithm and [9] proposed a quaternion-based algorithm.

In this paper, we will present a new analytical solution.

Firstly, the principle of least squares is essentially an optimization problem, by taking the partial derivative of the objective function with respect to translation parameters vector and setting it to be zero, we can derive the solution of translation parameters vector which is function of scale parameter and rotation matrix. Secondly, by substituting the solution of translation parameters vector back into the objective problem, and taking the partial derivative of the objective function with respect to scale parameter and setting it to be zero, we can derive the solution of scale parameter which is function of rotation matrix. So the solution of rotation matrix is critical to solving the seven parameters. Thirdly, according to  the orthogonality of rotation matrix, it can be represented by Rodrigues matrix. Using the relative formula of Rodrigues matrix with anti-symmetric matrix which is formed by a rotation vector, we derive the formula of the rotation vector and the space unit vector in the two datums, further we obtain the analytical solution to the rotation vector. Finally, we obtain the solution of rotation matrix, scale parameter and translation parameters by back substitution step by step.

Two numerical case studies are demonstrated. one simulates the ideal circumstance, namely the simulative coordinates are noiseless, and the other simulates factual circumstance, namely, the simulative coordinates mixed by noise. The two cases both simulate two set of data corresponding to small and large rotation angles. The result shows the proposed method is valid, regardless of whether the coordinates are polluted by noise or not, and whether rotation angles are big or small.



II. MATHEMATICS MODEL OF DATUM TRANSFORMATION Usually, 3D datum transformation model uses Bursa-Wolf  model, which can be written as [10]  ,ii Rpts ?+=                                    (1) where  [ ] [ ] ),,2,1(, nizyxpZYXs TiiiiTiiii === are two sets of co-located 3D coordinates in two different systems, tagged as system A and B respectively,  [ ]Tt X Y Z= ? ? ?  denotes three translation parameters, ?  denotes the scale parameter and the 3?3 rotation matrix R is formed by the three rotation parameters. It is obvious that, in order to solve the seven parameters, the number n  of co- located coordinates must be greater than or equal to three.

Considering the errors of the two sets of co-located coordinates, the following observation equations can be got.

i i iV t Rp s?= + ? .                       (2) According to principle of least squares, i.e,  min,n Ti ii V V= =?                          (3)  we can solve the seven parameters.

Supported by Youth Science Foundation of China Three Gorges University (Grant No.KJ2009A004) and Talent Research Start-up Fund of China Three Gorges University (Grant No.KJ2009B008)        Using (2), we obtain  1 1    ( ) ( )  ( 2 2  2 )  n nT T i i i i i ii i  n T T T T i ii  T T T T i i i i i i  V V t Rp s t Rp s  t t p R t s t  p R s p p s s  ? ?  ?  ? ?  = =  =  = + ? + ?  = + ?  ? + +  ? ? ? .  (4)  By taking the partial derivative of (4) with respect to t  and setting it to be zero, we can derive the solution of t  as  1 1  1 1n n i ii i  t s R p n n  ? = =  = ?? ? .                   (5)  Denoting 1 1  1 1, ,n ni i i ii is s p pn n= = = =? ? (5) can be  rewritten as  i it s R p?= ? .                            (6) Substituting (6) into (2), and defining centrobaric  coordinates is? , ip?  as ,i i i i i is s s p p p? = ? ? = ? , we obtain  i i iV R p s?= ? ? ? .                       (7) Further we can obtain  1 1   ( ) ( )  ( 2  )  n nT T i i i i i ii i  n T T T i i i ii  T i i  V V R p s R p s  p p p R s  s s  ? ?  ? ? = =  =  = ? ? ? ? ? ?  = ? ? ? ? ?  +? ?  ? ? ? .   (8)  By taking the partial derivative of (8) with respect to ? and setting it to be zero, we can derive the solution of ?  as  1 1  n nT T T i i i ii i  p R s p p? = =  = ? ? ? ?? ? .          (9) Obviously, if rotation matrix R  is solved, we can get the  solution of scale parameter ?  and translation parameters t  by using (9) and (6). So it is critical to solve the rotation matrix R .

Bursa-Wolf model, i.e., (1) can be rewritten as follows by using the centrobaric coordinates (namely space vector) form.

i is R p?? = ? .                                (10) According to the physical meaning of ? , i.e.,  i is p? = ? ? , where the symbol i  represents the norm of space vector, (10) can be transformed as  i is R p? ?= ,                                (11) where ,i i i i i is s s p p p? ?= ? ? = ? ?  are the space unit vectors. Due to the orthogonality of rotation matrix R , it can be represented by Rodrigues matrix as follows.

1( )( )R I r I r ?= + ? ,                          (12)  where I  denotes the 3? 3 identity matrix, r  is an anti- symmetric matrix formed with a rotation vector  ( )x y zv v v v=  as   z y  z x  y x  v v r v v  v v  ? ?? ? ?= ?? ? ? ??? ?  .                       (13)  The following properties between anti-symmetric matrix r and Rodrigues matrix R  are verified.

( )TI r I r+ = ? ,                            (14) ( )TI r I r? = + ,                            (15)  1 1( ) ( )TR R I r I r? ?= = + ? ,              (16) 1 1( ) ( ) 2I r I R? ?+ = + ,                   (17)  12( )Tr I R I?= + ? .                         (18) Substituting (12) into (11), and using (16), (11) can be  rearranged as  ( ) ( )i iI r s I r p? ?? = + ,               (19) and further we obtain  ( )i i i ir s p s p? ? ? ?+ = ? .             (20) Denoting i i is p? ?? = + , i i is p? ?? = ? , and using (13), (20) can be transformed as    i z i y x ix  i z i x y iy  i y i x z iz  v v v  ? ?? ?? ?? ? ? ? ? ? ? ? ? ??? ? = ?? ? ? ? ? ? ? ? ? ? ? ?? ? ?? ? ? ?? ?  .              (21)  Due to the singularity of anti-symmetric matrix, the rotation vector v  is unable to be solved by using (21) directly. To solve v , more than three control points are required to establish 3n (n is the number of control points) equations like (21). Under the principle of least squares, the analytical solution of v  is  1( )T Tv ?= ? ? ? ? ,                           (22) where,  1 1  1 1  1 1  0 0 0 0 ,  0 0  T  z y n z n y  z x n z nx  y x n y n x  ? ??? ? ?? ? ? ?? = ? ?? ? ??? ? ? ??? ? ?? ?? ?    and 1 1 1 T  x y z nx ny nz? ?? = ? ? ? ? ? ?? ? . Once v is solved, r  is got by using (13), and R  is obtained by using (12), then ?  can be computed by using (9), and lastly t  is computed by using (6).

Supposing R  is formed by rotating angles ? , ? , ? counterclockwise around the Cartesian X,  Y and Z axes respectively, then R  can be expressed by rotation angles as        cos cos sin cos cos sin sin sin sin cos sin cos sin cos cos cos sin sin sin cos sin sin sin cos .

sin cos sin cos cos R  ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?  ? ? ? ? ?  + ?? ? ? ?= ? ? +? ? ? ??? ?  (23)  Using (23), the rotation angles ? , ? , ?  can be computed as  1 1 123 21  33 11  tan , sin ( ), tanR RR R R  ? ? ?? ? ?= ? = ? = ? . (24)  where ijR  is the element of R  in the i-th row and j-th column.



III. CASE STUDIES AND DISCUSSION In order to illustrate the application of the proposed method,  two cases are investigated in this section. Case study 1 considers the ideal circumstance. In this case, the two sets of co-located coordinates have no noise. On the contrary, case study 2 considers the factual circumstance, i.e., the coordinates are mixed with noise.

A. Case Study 1 The case simulates two sets of data corresponding to small  and large rotation angles. Firstly, give the true coordinate values of 1000 co-located points in system B and transformation parameters. Dividing a 900m?900m?900m cube averagely into 1000 100m?100m?100m cubes, we obtain 1000 corners of the small cubes, i.e., the 1000 co- located points, shown in Fig.1. The simulated transformation parameters have two sets, tagged as set 1 and set 2 corresponding small rotation angles and large rotation angles in Table I. Secondly, compute coordinates in system A (true values) by using (1). Thirdly, solve the transformation parameters (solved values) with the previous analytical method using the simulative coordinates of eight corners of the large cube marked with red dot in Fig.1 (the other points marked with black dot are used for transformation residual calibration of coordinate). Lastly, verify the correctness of the method by comparing the solved values and true values of the parameters, as well as analyzing the transformation residuals. The transformation residuals is the differences between the calculated values and true values of coordinates in system A, of which the former is obtained by substituting coordinates in system B and solved parameters into (1). The result is shown in Table II, Fig.2, and Table III. The transformation residuals use all 1000 points. , , ,x y z p? ? ? ?  in Table III denote RMSE of X, Y, Z axes direction and position, respectively.

It is seen from Table II, the differences between solved values and true values of seven parameters are very small and  negligible whether small or large rotation angle. For set 1 and set 2, Fig. 2 shows that the transformation residuals are both very small and in the same order of magnitude which are intuitively seen in Table III. And we can see that the all residual curves maintain a stable trend overall, and contain a jump per 100 points (namely, 1 plane) and a peak per 10 points (namely, 1 line), it indicates that the application effect of transformation parameters closely associated with the spatial location.

B. Case Study 2 The case obtain the simulative data by adding N(0, 0.0004)  noise to the simulative three dimensional coordinates in the case 1. Namely, the case assumes the errors of coordinate in three axes direction equivalent and independent. Then we can solve the transformation parameters with the proposed method.

Finally, the result is shown in Table II, Fig.3, and Table III.

As seen from Table II, for set 1, the errors of solved translation parameters, angle parameters, and scale parameter are in mm, second and 10-6 level; for set 2, the corresponding errors are in cm, ten-second, and 10-6 level. As seen from Fig.3, the transformation residuals are in cm level (although the transformation parameters are relatively poor for set 2 to those for set 1), whose specific statistics values are shown in Table

III. Thus the solved parameters are both accurate for set 1 and set 2.

X Y  Z    Figure 1.  Spatial distribution of the 1000 control points  TABLE I.  SIMULATIVE TRUE VALUES OF TRANSFORMATION PARAMETERS  Set no. X?  (m) Y?  (m) Z?  (m) ?  ? ? ? Set 1 100 200 300 10? 20? 30? 1.000012436 Set 2 100 200 300 30? 60? 80? 1.000012436          TABLE II.  DIFFERENCES BETWEEN SOLVED VALUES AND TRUE VALUES OF TRANSFORMATION PARAMETERS  Transformation Parameters Case 1  Case 2  Set 1 Set 2  Set 1 Set 2  X?  (m) 1.8?10-7 8.4?10-8  -0.0052 0.0204  Y?  (m) -3.2?10-8 -1.2?10-8  -0.0080 0.0311  Z?  (m) -8.6?10-8 -1.4?10-7  0.0064 -0.0033 ?  (?) -7.6?10-6 -9.8?10-5  1.2838 -11.5997 ?  (?) 2.7?10-5 4.3?10-5  0.1129 3.1142 ?  (?) -4.2?10-5 9.9?10-5  1.2957 14.2711  ?  -2.5?10-12 -4.3?10-12  -8.9?10-6 -9.6?10-6  0 100 200 300 400 500 600 700 800 900 1000 -2  -1.5  -1  -0.5   0.5   1.5 x 10  -7  point name  tr an  sf or  m at  io n  re si  du al  (a) Set 1      X direction  Y direction Z direction  0 100 200 300 400 500 600 700 800 900 1000 -3  -2  -1     x 10  -7  point name  tr an  sf or  m at  io n  re si  du al  (b) Set 2      X direction  Y direction Z direction    Figure 2.  Transformation residual in the case 1  TABLE III.  STATISTICS OF TRANSFORMATION RESIDUALS  Statistical variables Case 1  Case 2  Set 1 Set 2  Set 1 Set 2  x?  (m) ? 7.4?10-8 ? 9.1?10-8  ? 0.0286 ? 0.0293  y?  (m) ? 7.3?10-8 ? 5.5?10-8  ? 0.0315 ? 0.0369  z?  (m) ? 4.0?10-8 ? 9.2?10-8  ? 0.0289 ? 0.0314  p?  (m) ? 1.1?10-7 ? 1.4?10-7  ? 0.0515 ? 0.0566         0 100 200 300 400 500 600 700 800 900 1000 -0.1  -0.05   0.05  0.1  0.15  point name  tr an  sf or  m at  io n  re si  du al  (a) Set 1      X direction  Y direction Z direction  0 100 200 300 400 500 600 700 800 900 1000 -0.2  -0.15  -0.1  -0.05   0.05  0.1  0.15  point name  tr an  sf or  m at  io n  re si  du al  (b) Set 2      X direction  Y direction Z direction    Figure 3.  Transformation residual in the case 2

IV. CONCLUDING REMARKS It is critical to solve the rotation matrix in the proposed  method. According to the orthogonality of rotation matrix, we adopt Rodrigues matrix to represent it. Using the relative formula of Rodrigues matrix with anti-symmetric matrix which is formed by a rotation vector, we derive the formula of the rotation vector, further we obtain the analytical solution to the seven parameters. The case studies indicate that the proposed method is valid, regardless of whether the coordinates are polluted by noise or not, and whether rotation angles are big or small.

