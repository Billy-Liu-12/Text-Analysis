Knowing the Ransomware and Building Defense  Against it ? Specific to HealthCare Institutes

Abstract? In the healthcare field the patient data is very sensitive. So the hospitals should have some plan to protect it as well. However, in US alone a number of hospitals are attacked by cybercriminals through ransomware malwares to make big bucks. The hospitals should be prepared when given such situation where they have to pay money to get their data back.

Now the question arises should they be paying the ransom? In some cases a hospital may not have a choice, if their backup procedure is broken. This paper presents various steps that ransomware follows to encrypt the important files on the victims network, then asks for money and once it receives the money, then releases the data files. The paper also presents various steps those could be followed to protect against such attacks.

Keywords?malware; encryption; decryption; keys; healthcare providers

I.  INTRODUCTION Our computers could get infected by various malicious  programs, such as virus, worms, malwares, or spyware etc? If we talk about ransomware it is a malware. In other words it is computer program that applies an intricate encryption technique to decline access to the files having important data or to the computer itself. McAfee recently reported that currently cybercriminals are using over 4 million different ransomware software and on top of it this number is increasing by each month [10].

In one Indiana hospital, on 04/04/2016 a considerably regular looking e-mail is received by a clinical worker in his Outlook inbox. The subject of the e-mail is ?Invoice?. The ?From? field is having the label of the new printer and fax machine joined with its authorized e-mail ID. For any human this all seems like a routine business and a legit document. That normal looking e-mail, made its way through the firewalls of the hospital?s network and encrypted all the data files those were on the server.

Once encryption of important files finished. A message emerged in a window giving directions on how to get a key to decrypt the files and a link where ransom could be paid to get the key. In the same week King?s Daughters? Health in Madison, IN., was attacked by ransomware. Immediately, following these two attacks many more were identified at many different places all over the US.

For various reasons, Healthcare industry is very slow to embracing the changes at the pace the technology is changing.

And this is one factor that cybercriminals use to exploit the vulnerabilities that exist in the health care systems to make big bucks. Dr. Eric Liederman, medical informatics director at the Permanente Medical Group states that one of his current job duties is to bring a balance among patient data safety, clinician?s workflow needs, and the current day?s security requirements [12]. However, ransomware supplements one more responsibility to the list of duties.

The healthcare industry is the most affected by ransomware threats. A hospital in Wichita ? Kansas Heart institute paid $17000 to hackers to decrypt their data. Another hospital in LA ?Hollywood Presbyterian Medical center- also paid similar amount to ransom to decrypt their patient records. In Kentucky ? Methodist Hospital, in California -Alvarado Hospital and Chino Valley Hospital, and Desert Valley Hospital, in Canada ? Ottawa Hospital -all are among the recent targets of ransomware.

The data shows that above examples are just the representation of the effect of ransomware. HIMSS?s recent study reported that more than half of the hospitals in US are attacked by some kind of ransomware. Dept. of Homeland Security of US along with other international security agencies in the world are issuing warnings that such incidences are going to increase and the method of their operation is going to be more sophisticated.

This year, 2016, in the month of June, Health Data Management held a forum to discuss: ?Exactly how the healthcare industry and hospitals can deal with the ransomware intimidation?. During this meeting John Mertz presented some data stating that: it is assessed that during the 1st quarter of 2016 about $200 million were paid to hackers for ransomware.

He also predicted that in 2016 alone over $1 billion could be paid to hackers to save healthcare data from ransomware [2, 3].

Cybercriminals use these ransomware to block the victims from accessing their data files, such as, word documents, PDF files, spreadsheets, videos, etc? on their own computer or tablet or smartphone or even the server [9]. Once the hacker or the cybercriminal encrypts the victims? data files, a message popups on victim?s machine, threatening him with permanent    loss of all his data files unless the victim pays the ransom in given amount of time, generally within 2-3 days.

Healthcare industry is the most effected industry by the ransomware because of the patient database. It directly affects the HIPAA compliance they need to follow [7]. Healthcare industry has now started thinking about new innovative ways to enhance the security of their patient data to save it from ransomware.

When ransomware executes, the data and information is still on the victims computers, however in encrypted form, so is not accessible. The hackers keeps it encrypted until the victim pays the ransom to decrypt it.



II. RANSOMWARE TYPES AND USAGE There are various software those are used for ransomware,  such as, CryptoLocker and CyrptoWall. CryptoLocker is also known as - Locky - is very effective in encrypting the victims? important data [5]. For this reason hackers are using this software and making hundreds of millions of pounds.

Ransomware mostly spreads through email attachments or victim could download some file from a compromised web page. Once this software executes on victims computer, it encrypts the data files and locks the victims? computer. Once files encrypted a message shows up instructing how to get the key to decrypt the files for a ransom money. The question arises: What is this key? The ransomware uses the same approach that bank or other financial institutes use to protect the data, that is, they use public key cryptography. The data is encrypted using public key. It is decrypted only with the private key. This private key is the key that is provided once the ransom money is paid to unlock the data.

Figure I: The percentage of various ransomware malwares used by different cyber-criminal for the first half of the year of 2016.

The ransomware does not know what it is encrypting! The above Fig. I represents what different ransomware are used by the cybercriminals during the first half of this year. CryptoWall is used the most for attacking. CryptoLocker or Locky is in competition with CryptoWall at ~41%. Cerber is another malware that is used at ~11%. Some other malwares used are TorrentLocker, Teslascrypt, CryptXXX, and CTB-Locker [11].

Since CryptoWall is the most used ransomware in the first half of this year, so we should know how much effective it was. Fig. II represents the number of attempted attacks by CryptoWall during one year from Oct. 2015 to Oct. 2016.

However, Fig. III represents the number of actual victims of CryptoWall during the same period of time [6].

Figure II: The number of attempted attacks by Cryptowall from Oct 2015 to Oct. 2016     Figure III: The number of victims of Cryptowall from Oct 2015 to Oct. 2016

III. DOES TIME MATTERS Nowadays ransomware is getting very popular in hacker  community. The reason is that it is easy to use regardless of the hackers? skill level, this attack could even be triggered by low skilled cybercriminal. Moreover, ransomware software is very cheap and easily available online. In all, this attack would require one motivated individual with bad intent having insignificant technical skills, may be some cash not over $99, an e-mail account, anonymous network like Tor network to bring any organization to a point to pay him as much as he asks for.

Cybercriminals know how effective this malware is, and they also know how difficult it is for the industry or the organizations to protect against it. For all the above stated facts one should say ?Yes time matters?.

The following table, Table I, even shows that the time matters. Table I lists top 10 countries in the order of percentage of hits by Cryptowall malware in the year of 2015 and 2016. In both years United States is impacted the most. In 2016 India is impacted the second most, whereas in 2015 it is less impacted, although that is a good thing. However, the reason for increase in attacks is that India is leading in software development and supporting various multinational companies, and mainly operating through Internet. All these factors have increased its vulnerability to ransomware threat.

Similarly, there is increase in impact on Mexico as well, since it is a trading partner with USA. In the table for the year of 2016 some new country names have emerged. This all is happening because these countries have global business ties with global leaders.

Table I: List of top 10 countries in the order of percentage of hits by Cryptowall malware in the year of 2015 and 2016   Cryptowall 2015 Cryptowall 2016  United States United States  Canada India  United Kingdom Canada  Australia Mexico  Russia United Arab Emirates  Germany France  India Romania  Italy Taiwan  France Jamaica  Netherlands Bulgaria

IV. THE VARIOUS STEPS FOLLOWED BY RANSOMWARE DURING THE ATTACK    Any ransomware that performs attack is executed in steps.

To defend against such attacks or to minimize the effect of these attacks it is good to understand how each step is executed and what to look for as an indicator of compromise (IOCs).

Step 1: Manipulation and contamination:  Ransomware is a malware software that executes on victims? computer. It?s not the victim that executes it but it is usually done by some hacker through some e-mail or through some exploit kit. An exploit kit is again a software tool used to abuse security vulnerabilities in some application on victims? computer to spread this malware. The exploit kit usually infect the victims? computer through some running application that is not secure or some application that is unpatched and is outdated. CryptoLocker malware has one exploit kit known as Angler [13]. Angler usually exploits the vulnerabilities present in Internet Explorer (IE) and Adobe Flash.

Another malware named FakeBSOD is not very damaging since it does not encrypt the data files. However, it does not let you use your web browser. It also displays a message saying that your system is attacked by some malware. To gain access to the web browser you should see some technical support personnel or should pay some technician some money to repair it.

Step 2: Execution and Persistence mechanism:  Once the malware has its way to the victims? computer now is the time for the persistence mechanism. This process could take some time subject to the latencies of the network. The malware executable is implanted on Victims? computer not through SSL, but through encrypted channel. Where SSL Security layer is added on top of HTTP protocol for secure transactions. The malware executables are implanted in the user profile under %APPDATA% or %TEMP% directories.

Knowing that where the executables go help in monitoring and defending against such attacks. The malware is equipped with persistence mechanism. The persistence mechanism is when the victim reboots the computer knowing that the machine is infected, the malware execution has to abort the encryption process. Now when the computer is rebooted, the malware picks up from the point where it left off and completes the encryption process.

Step 3: Removing Backup folder and files:  The next step for the malware is to remove the backup files and directories from the victims? computer/server so those cannot be backed up in future. This is one of the characteristics that is unique to ransomware. Other software and APT?s used for crime do not even remove backup files. However, all the ransomware malwares definitely delete backup folders and files. So the victim has no way to recover its data and should pay the money to get hold of its data. Vssadmin tool is used for windows machines to delete volume shadow copies from the computer or server. Locky and CryptoWall both malwares    delete the backup directories and files forcefully, even when those are locked through some process.  These malwares kill that process to remove those backup directories and files.

Step 4: Key Exchange and Encryption:  The next step for this malware is to encrypt the important data files on the victims? machine then carry out an exchange of keys securely with C2 (Command and Control) server. This process creates the public and private keys those are used for encryption and decryption. This process also creates a unique ID for this transaction, which is used for further reference for different victims. The encryption process could take a few minutes to few hours, based on the latencies of the network.

Different ransomware malwares use different naming and encryption conventions. For example, while encryption Locky randomize the names of files, on top of that it adds an extension - locky -to it at the end.  CryptoWall V4 also randomizes the names of file and their extensions. During incidence response depending on the file extension, the organizations could find the breakthrough for the encryption.

These malwares use strong encryption - the most recent and current - like - AES 256. Therefore it becomes hard for the victim to decrypt own their own without paying the ransom.

For exchanging keys, some ransomware malwares, such as, SamSam, do not require to contact command and control server. It does the encryption locally without connecting to network, so this action of SamSam malware won?t be visible on IOC. If it is not visible on IOC?s on your machine this does not signify the absence of malware.

Step 5: Notice to Victim and cleaning:  Once the private and public keys are established, the victim is thrown with a popup message giving instructions on how to decrypt the files if the ransom is paid at the provided link. Usually some days are granted to the victim. If the ransom is not paid on time then ransom amount is increased.

Being system admin you should look for: ?How the demand instructions are posed?? This could help in finding which variant of ransomware is used. Usually these instructions are kept on the computer hard disk. These instructions could also be kept on the folder where it kept the encrypted files. These instructions could also be kept at some particular place on the hard drive. CryptoWall Ver3 places these instructions in HELP_DECRYPT data file. CryptoWall Ver4 places these instructions in HELP_YOUR_FILES.

Making a quick Google search could help you discover the exact ransomware variant used.

Once ransom amount is received, ransomware wipes itself off of the victims? machine in a manner that it does not even provide any forensic evidences.



V. INCIDENCE RESPONSE FOR RANSOMWARE HACK Phase 1: Preparedness  For initial review the organizations should do penetration testing and risk assessment of their systems and network. This will reduce the risk for cybercriminal to exploit the vulnerabilities those are existing on these systems. Limited  access to designated employees, so they can do their duties required of the specific job [8].

The ransomware could attack computers quite easily those are not updated or patched. Since it exploit the existing vulnerabilities. Therefore, for your defense keep updating and patching your machines. So you are eradicating the vulnerabilities, that malware can exploit. Make it a habit to create regular backups then protect them. Since ransomware removes backup folder and files, therefore it is necessary to put up backups in places those cannot be reached by ransomware ? such as offline memory. Once backups are offline make sure those could be restored when required. Just a note do not keep your backups over cloud or network storages, since those could also be encrypted or corrupted by ransomware.

Such types of attacks are inevitable if you work in software industry. Hence the software organizations or healthcare industry in particular should develop an incidence response plan for ransomware attack. Such plans greatly help to contain such situations if not stop it from happening. The hospitals should conduct awareness trainings for staff and employs, so they are aware of phishing e-mails. Sometimes, cybercriminals could use social engineering to spread the malware, so employees should be aware of how to avoid infection by being vigilant while conversing on phone or while going through the e-mails [4]. So organizations should invest in tools that scans e- mails and their attachments for malicious executable code.

Phase 2: Early detection:  The damage could be minimized if the security systems such as Intrusion Detection Systems (IDSs) could detect the ransomware?s knock on the organizations door. This could be done by adding the signatures of various ransomware malwares into the IDSs or the detection network device as an indicator of compromise. This way IDS could block the ransomware, if not it can at least warn the victim of it presence on its network. The signatures for the various ransomware malwares are available from leading IDS dealers. Hence, it is better to have good defense in place than having your system to just detect it.

The execution of ransomware takes place from the %APPDATA% directory and the %TEMP% directory on the victims? computer. So being system admin you could write scripts to locate such executable files to identify the presence of ransomware and killing it before it could encrypt all the data files on your network server. Similarly some network rules could be put in place those could identify the delivery of executable files and their execution as well. One can also write scripts to look for execution of vssadmin command. If it is executed one should be responding to CryptoLocker.

During key exchange step the malware could leave its extension with the randomly named files. This could be used to break the encryption by looking for help on the Internet.

Similarly if you see file name pattern that is random, it signifies the execution of CryptoWall, However, in this situation it is late and we could not stop its execution. But at this point it is easy to know the existence of encryption. Once detected it could help in incidence response (IR).

Phase 3: Control:    Even after all the effort and pain if ransomware still has executed then the best way is to look for its execution process and kill that process. Another, once it is detected disable your network, so that it does not reach to the main server, so that file encryption could be stopped on the network.

Phase 4: Clean-up:  After incidence identification, once you take steps for controlling it, then you should think about cleaning it up from your network. Recommendations are that computers should be replaced instead of cleaning them. Since malware could leave some files on the computers those are hidden, which could again infect the computer or the complete network. If the company prefers to clean the computers then clean the mailboxes and any file sharing devices. It is also necessary to look for signatures and other indicators of compromise to stop the ransomware attack from re initiating.

Phase 5: Regaining Possession and Control:  To regain control, after the cleanup, first you should be restoring your systems with the backup. This process could take some time but days. Full investigation should take place to know how the malware got into network. Was it through some e-mail or through some exploit kit or through some website?

Knowing the cause of attack could better prepare the company for future defense.

The law enforcement should be contacted in the case of some cyber-attack or ransomware attack [1]. The companies could also contact good experts in the cyber-attack area for incidence response. Various states have come up with different disclosure requirements. So the victims must be aware off of their rights and responsibilities.



VI. CONCOLUSION  Ransomware is a malware that executes on victims machine.

Encrypts all the important data files. Then asks for money to release those files under its captivity. Once money is received a private key is provided to the victim to decrypt the data files.

During this process the Institute suffers in a lot of ways, such as lost productivity, inconvenience, loss of business and good will.  Therefore it is recommended that do regular backups.

Keep the backups on offline memory. Keep all the systems updated and patched. Apply security in layers. Add firewalls and invest in e-mail virus scanning software. Also establish the employee specific training so they can avoid such attacks.

