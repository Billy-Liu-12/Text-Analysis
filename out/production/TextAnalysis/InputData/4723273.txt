High-resolution Bayes Detection of Dim Moving  Point Target in IR Image Sequence Using

Abstract?Probabilistic data association (PDA) technique was found its broad applications in Radar target tracking. In this paper, based on the basic idea of PDA, a bayes-rule based high- resolution detection algorithm for dim moving point target in images sequence is presented: derived the formula for computing location-dependent Bayes threshold and posterior association probabilities for every measurement being a true target location.

And the comparative performance analysis are also given in this paper.

Keywords- Dim moving point target, IR image sequence, probabilistic data association filter, Kalman filter

I. INTRODUCTION The conventional studies in infrared or visual tracking  system are mainly focused on detection and tracking short- range maneuvering targets with high signal-to-noise ratio (SNR). However, in military or civil applications, the detection and tracking of long-range dim targets with low SNR is a challenging problem, and already became the hot spot of research areas. Since the distance between targets and sensor is very far and targets occur at a priori unknown points in time that they appear like randomly scattered dots on the imaging sensor. In paper [1], we have presented a fast multi- frame based detection algorithm for that case. For the continuity of the problem solving, in this paper, we develop a single frame target detection algorithm on the basis of paper [1]. Figure1 illustrate the basic problem of this paper.

The answer for the question in Figure1 is definitely yes. The model and processes of high-resolution detection scheme presented in this paper are given in figure2 and figure3 separately. From the outputs of multi-frame detection front- end processor; we can get the possible target location in the next frame by Kalman predictor. Since, the target is very small and with low SNR, there may be lots of measurements of target location in the tracking window (vicinity area of predicted location, the detection process take place there) along with predicted one. The one among of them may be true target location. Because, no single measurement available at time k, but instead, a set of candidate observations are available there, so, the conventional Kalman filter cannot deal well with this situation that must be supplemented with some  other methods such as PDA introduced in paper [2]. The task of it is to find out a true location of target through data association technology from a set of measurements. PDA is very suitable for this kind of situation and was used widely in many areas such as target tracking in radar.

Supported by National Natural Science Foundation of China (No.60507005) and college research program funded by Department of Education of Xinjiang Uighur Autonomous Region (No.XJEDU2005I04 )  Figure 1. Basic problem illustration  Multi-frame detection scheme  Temporal Combining  Spatial                     combining through                            all possible motion                                directions  Detection resolution is? 55??K  Is it possible to detect the target in  single frame?

K frames of image  If yes, then the detection  resolution will became?  111 ??  Figure 2.   Model of high-resolution detection  * *  . .  . .

* .

.  .

Estimated track  Detections at t=k  Predicted location  Tracking window at  t=k  Input frame at t=k  t=k-1  t=k-2  * *   DOI 10.1109/CSSE.2008.329    DOI 10.1109/CSSE.2008.329     The measurement model of clutter removed image sequences with dim point target is given by:  ),,(),,(),,( kyxNktyyxxAkyxI ii +???= ? , HyWx ???? 0,0          (1)  Where, ),,( kyxN is Gaussian residual noise, A and ),( ii yx are intensity and position of a target separately.



II. BACKGROUND  A. The Kalman filter We assume that the dim target moving at constant velocity  in a image sequence, so the model of one-step estimation of target location can be represented as:  a. The Process Equation )()()()1( kkkk wXFX +=+                 (2)  T yx kvkykvkxk )](),(),(),([)( =X       (3)  ? ? ? ?  ?  ?  ? ? ? ?  ?  ?  =    )( T  T  kF  (4)  Where, )(kX is a state vector?( )(),( kykx ) is the target location in k th frame, ( )(),( kvkv yx )is target velocity,T is sample intervals and )(kw  is modeled as a zero-mean, white- noise process at time k  and )( kw 's correlation matrix defined as:  ))()(()( kkEk HwwQ =                      (5)  b.  The Measurement Equation  )()()()( kkkk uXHZ +=             (6) T  yx kzkzk )](),([)( =Z                    (7)  ? ?  ? ? ?  ? =   )( kH                                  (8)  Where, )(kZ  is measurements vector, )(kz x , )(kz y are the measured coordinates of the target in a frame at time k .

And )(ku  is modeled as a zero-mean, white-noise process                         at time k and whose correlation matrix defined as: ))()(()( kkEk HuuR =                         (9)  The )(kw  and the )(ku  are statistically independent  B. Deficiency of Kalman Filter For Dim Target Tracking The original conventional Kalman filter cannot deal well  with the situations like Figure2. Because, it requires single measurement appear at time k . We use the PDA method as the supplement to the Kalman filter. The PDA ensure a single associated true measurement appear at time k that the Kalman filter is rendered to accomplish its mission of prediction.



III. THE DETECTION ALGORITHM  A. Steps of the high-resolution Detection Algorithm  Let { } kniik kZZ 1)( == are the observations at time k , comprise kn constituents. Thus determination of which (if any) of the kn  constituents of kZ  is target generated is the association problem.We assume that the target location up to time k estimated as )/(? kkX  with associated covariance  )/( kkP . The notation in the subscripts indicates that the estimate is conditioned on kii  k ZY ??== }{ .The process of the high-resolution Detection algorithm at time k , as follows:  Step1: Predict the target location at time k from prior at time 1?k ,  )1()1()1|(? ??=? kXkFkkX          (10)  Step2: At the predicted location dig a tracking window centered about it. Then, detect the possible targets.

Step3: For all candidate measurements kn , calculate the innovation, )1|(?)()()( ??= kkXkHkZkv ii  kni ...1=    (11)  Innovation covariance, )()()1|()()( kRkHkkPkHkS T +?=  (12)  Figure 3.  Inner-processes of high-resolution detection scheme  Detection results  Bayes detection Confirm the true target from all candidate measurements  Estimation of possible target position in next frame  Target?s prior information  Probabilistic data association  Image sequence (background clutter  removed)  Target information by multi- frame detection  Target information by multi- frame detection  Kalman filter     where, )1()1()1|1()1()1|( ?+????=? kQkFkkPkFkkP T  (13) is the prediction covariance.

Step4: Use those association probabilities to form a synthetic ?innovation?, ?  =  = kn  i ii kvkkv  )()()( ?  (14)  And update the track according to,  )()()1|(?)|(? kvkGkkXkkX +?=              (15)  where )()()1|()( 1 kSkHkkPkG T ??=                (16) is the Kalman gain.

Step5: Update the estimation covariance,  )(~)|()](1[)1|()()|( 00 kPkkPkkkPkkkP c +?+?= ??     (17)  where ? ?= )()]()()()()()[()(~ kGkvkvkvkvkkGkP TTTiii?  and )1|()]()([)|( ??= kkPkHkGIkkP c           (18)  Step6: The system receives the next frame and go to the setp1, until all image sequence was tracked over.

B. Development of the algorithm We assume that a test of absence or presence of a target at  particular location ),,( kyx is to be performed. Hypothesis 0H is that there is no target, and Hypothesis 1H that there is  indeed a target at location ),,( kyx , that is we can write pdfs as,  ?2 ]2)([))((:   kaexpkaf ?=H                (19)  ? ?  }2])([{))((:   ??  = kaexpkafH     (20)  Where, )(ka is corresponding amplitude, ? is SNR.

From the Bayesian viewpoint, the appropriate test is,     0])(2[2    )( )(  )/)(( )/)((    CC CC  P P  e kaf kaf ka  ? ?  ? < >  ?? ?  ? ?? ?  ? =  ?  H H  H H  H  H ??   (21)  In which, P( jH )are the prior probabilities of hypothesis, )/)(( Hkaf is pdf given hypothesis, jkC is cost making  decision j  when k  is true. And the PDA assumes that: ? If the measurements are from true target, then the target's  true location should be afforded a Gaussian distribution about its estimated value.

? False-alarm measurements are uniformly distributed within the tracking window and are independent. From the two assumptions above, we can calculate prior probabilities of hypothesis that,  )()()21(   1)( kvkv  k  ik T  ieP ???? S  S H  ? and   V  P 1)( 0 ?H                                                  (22)  Where, V is the volume of tracking window, )(kv i is the 'innovation' for all candidate measurements, and )(kS is the innovation covariance of the true measurement. And we have:  )()()21(  1 1  )( )( kvkv ikTie  P P ??? S  H H                         (23)  ?? ?  ? ?? ?  ? ? ?  ++=+? < > ? )ln(ln1  1)()(  1)(      cc cc  kkvkvka ik T  i ? ??  ? S  H  H  (24)  In which ?  is a tunable parameter, it is easy to find that the threshold is location-dependent.

From (22), we deduce that the detection and false alarm probabilities are both conditioned by v , and are more probable for smaller v . So ?= dvvfvdetectionPPd )()/(          (25)  dxxexpdxHxfvdetectionP ])( 1[  1)/()/( 21 ????  ??== ?? ??  (26)  where              ? ?  ? += ? vv T 1 1 S ,  vv Tevf 1)21(  1)(  ???= S S?  (27)  The paper taked Newton-Kete Si integral algorithm, and the number of the coefficient is eight. To improve the accuracy of the results, eight amendments were increased.

21)()/( CCdvvfvdetectionPPd +== ? 2 2 2 2   2 2 2 2  2 2  2 2   ( ) 2 (6 7 ) 49C1= [751 exp( ) 3577 exp( ) 2 1 2 49 32 6417280 2  (5 9 ) 98 (4 10 ) 491323 exp( ) 2989 exp( ) 49 81 162 8 49 50 100 9  (3 11 ) 982989 exp( ) 1 49 121 242 32  ? ? ? ? ? ? ? ? ?? ?? ??  ? ? ? ? ? ? ?? ? ?? ?  ? ? ? ?? ?  + ? ?? ? ? + ? ? ? + + +  ? ?+ ? ? ? + ? ? ? + + + +  ?+ ? ? ? + + +  2 2   2 2 2  2 2  (2 12 ) 49323exp( ) 49 72 144 25  ( 13 ) 98 13577exp( ) 751exp( 4 ) ] 49 169 338 72 2 4 8  ? ? ? ?? ?  ? ? ? ?? ?? ? ? ? ?  ?? ? + +  ?+ ? ? + ? ? ? + + + +    2 2 2 2  2 2  2 2 2 2  2 2 22 2   2 2 2  3 1 17 98C2= [751exp( 2 ) 3577exp( (. ) 4 2 2 717280 2 17 34 98  200 98 1 32 981323exp( ) 2989exp( (. ) 49 2 720 200 98 32 2 32 98  1 26 982989exp( (. ) 1323ex 2 7 26 2 26 98  ? ? ?? ? ? ??? ?? ?  ? ?? ? ?? ? ?? ?  ?? ?? ?  ? ? + ? ? + + + +  + ? ? + ? ? + + + ? +  + ? ? + + ? +   2 2 2  2 2 2 2  2 2 2 22 2  1 29 98p( (. ) 2 7 29 2 29 98  1 32 98 1 35 983577exp( (. ) 751exp( (. ) ] 2 7 2 732 2 32 98 35 2 35 98  ?? ?? ?  ? ?? ? ?? ? ?? ?  ? ? + ? +  + ? ? + ? ? + ? + + ? +    PDA assumed that the number of false alarm constituents of kZ is accorded a Poisson distribution with mean V?  for  fixed threshold (CFAR rule)used ,in which ? is referred to as the spatial clutter density andV is observation volume. But in the Bayes detection the number of false-alarms is controlled by the detection thresholding. Hence there is subtle difference on the average number of false-alarms per unit volume.

Assumption: there exists an underlying homogeneous poisson process with spatial density ?~ , to each event in this new process we attach an amplitude with unit Gaussian distribution, and each amplitude is independent.Then, we have the relations,  ? ??  ?  ~ 2  2?  ?= e                                   (29)  (28)     In which ? is fixed threshold in CFAR detection scheme.

Define the events at time k  as (30):  (k){)( ii Zk =?  is from true target}, ],1[ kni ? )(0 k? ={all constituents are not target generated}   (30)  Then, the association probabilities defined as: }|)({)( kii Ykpk ?? =        kni ...1 =            (31)  And we have    ? =  = kn  i i k  1)(?                                     (32)  Let { })(...,),(),( 21 kvkvkvv knk =  and { })(...,),(),( 21 kakakaa knk =  are a vector of  ?innovation? and amplitude of measurements at time k ; )(kv ? , )(ka? are true target?s ?innovation? and amplitude  separately, then for 0=?  we have,  ****  **  ****  ))(),((  ))(),(/(  ))(),(,/0())(),(  ,,0/(),,0(  dadvkakvf  kakvmnp  kakvmnpkakv  mnvfmnvp  k  k  kkkk  ?  =?  ==?  ===== ?? ?  ??   the same way for 0?? , we have  )())(),(())(),((  )),(),(0(  )),(),(,0()),(),(,~(  )()),(),(,~,(),,(  kdakakvfkakvmnP  mnkakvP  mnkakvPmnkakvvf  kdamnkakvvmnvP  k  k  kk  kkk  ?????  ??  ????  ???  ? ???  ??  ?=?  =??  =??==  === ?   According to paper[1], we get the association probabilities:  knb k  + = 1)(??    , ],1[ kn??                      (35)  knb bk  + =)(0?    , 0=?                              (36)  kd Spb ??? ?? 2)exp()  exp(]1[~  ????????=       (37)

IV. EXPERIMENTAL RESULT AND ANALYSIS In the paper, we has used 200 frames sequence images, the  picture?s size is 240*320 picture elements, the targe?s size is 3*3 picture elements, the track window?s size is 11*11. Figure 4 and Figure 5 are the results of Bayes detection of the 50th frame in 200 image sequences with brightness and without brightness respectively.

We make a contrast of the variance diagrams between tracking result with brightness and without brightness.

In figure4 and figure6 we use the Bayes high resolution detected technology with brightness and without brightness to track target separately, and track succeed. From figure7 and figure8, we may see the variance value of Bayes detection with brightness is smaller than that of Bayes detection without brightness obviously, and the number of false targets also obviously reduces. Figure9 and figure10 are target?s real track and estimate track with brightness and without brightness, and high-resolution Bayes detection can track dim point target well.



V. SUMMARY In this paper, we apply the probabilistic data association  method to dim moving point target detection and tracking area, get some valuable analytical results: derived the formula for computing location-dependent Bayes threshold and posterior association probabilities for every measurement being a target location. One perhaps remarkable feature of this algorithm is that posterior association probabilities (a given threshold exceedance is target-generated rather than false- alarm) are uniform and independent of location.

