Temporal Outlier Detection using Fuzzy logic    and Evolutionary Computation

Abstract? Early detection of adverse climatic conditions saves life and prevents harmful health impacts. One of the factors that causes such climatic conditions is the changes in ozone layer.

Hyper levels of ozone concentration may cause several lung diseases and respiratory disorders. Many data mining algorithms perform analysis on the given data only after performing discretization. Discretisation involves the process of partitioning the data intervals of the attributes with crisp boundaries which leads to over estimation or under estimation of the boundary values. Fuzzy logic overcomes this problem by considering the natural boundaries of attributes .Genetic algorithm overcomes this crisp boundary problem by considering the entire interval of the attribute and yields optimal boundaries. Temporal data mining involves the process of extracting useful information from temporal database. The proposed method identifies these unusual climatic conditions using fuzzy logic and Genetic algorithm. Our method aims to find out  the unexpected parameters(in terms of climatological variables)  that causes ozone day/normal day from ozone level detection database which is of quantitative, multidimensional and time series in nature by using temporal outliers. These parameters which causes ozone day/normal day are identified by using Temporal Association Rule mining. Then the temporal association rules are pruned by the unexpectedness measure, Leverage to generate temporal outliers.

Finally our proposed approach is validated through a set of experiments which show its efficiency in terms of accuracy.

Keywords? Data Mining; Outliers; Fuzzy logic; Temporal database; Genetic Algorithm

I. INTRODUCTION Data mining is the process of extracting interesting patterns or mining knowledge from large amount of data. Data mining techniques involve the processes that focuses on automatic exploration of data and leads to data analysis in order to discover meaningful patterns and relevant rules [1][2].

A. Association Rules Association rule mining is one of the important research  areas in the field of data mining. An Association rule is an expression given by the form X?Y, where X, Y are subsets of items and X?Y=?. Mining suffers from the problem of extracting association rules from large collection of basket data type transactions with some specified  support  and confidence threshold[3].Moreover this method suffers from the problem of handling categorical attributes.

The task of discovering association rules between items in a large database of sales transactions is served by Apriori algorithm [4]. Quantitative association rule mining helps to mine association rules from quantitative and categorical data by performing discretisation on the data values into   intervals.

An approach to mine association rules with quantitative and categorical attributes f r o m  large relational tables is introduced [5]. The process  o f discretization on quantitative attributes refers to static(fixed) partitioning of intervals which leads to loss of information [6].Multi dimensional association rules are rules  that have two or more dimensions or predicates [1], [7], and [8]. These association rules are framed by the combination of attributes involved, which is used to predict the consequence.

B. Temporal Mining Among many data  mining  techniques, temporal  data  mining  is used to discover obscure patterns, unexpected trends or other elusive relationships from sequential data(time related data) [1].Time series analysis has its application in various fields like weather forecasting, stock market prediction and retail industries[9]. Temporal association rules are obtained from temporal data base. These rules helps in providing  more realistic information like, in which time period the rule is valid and applicable. Temporal data mining is capable of producing rules indicating the cause-effect association and has its panoptic applications in many fields [10], [11], [12]. For example, in the field of retail industry, they can store data relating to the purchase information of items by customers. An interesting rule specifies the purchase of an item by customers for a particular time interval.

C. Genetic Algorithm The evolutionary nature of genetic algorithm makes it to be  one of the popularly used data mining algorithms [13].

Genetic algorithm considers the entire interval of attributes and thereby overcomes the problem of generating irrelevant rules. Optimal rules are generated over several generations using genetic algorithm [14]. In this paper we present an approach to find out the unexpected parameters that causes ozone day/normal day from ozone level detection database by using temporal outliers. These parameters which causes ozone        day/normal day are identified by using temporal association rule mining. Since the ozone level detection database is quantitative in nature, fuzzy logic and genetic algorithms are used to overcome the unnatural boundary of data intervals.

D. Fuzzy association rule Fuzzy set theory [6] is most used in data mining technique  because of its crisp nature and its simplicity. Fuzzy association rule has natural boundaries in partitioning of data. It also facilitates the interpretation of rules in a more realistic way.

Fuzzy technique has membership functions like triangular membership function, trapezoidal membership function. With this membership function, the input values get partitioned with natural boundaries. And the main advantage of using this fuzzy logic is it consists of linguistic terms, which is of interpretable form. Fuzzy association rule mining for ozone/normal day can be given by  If ((temp is high) and (wind speed is high)) then day=ozone [0.675, 0.325]    E. Outliers Outlier is defined as an observation that deviates too much  or seems to be abnormal from other observations. The identification of outliers can lead to the discovery of useful and meaningful knowledge. Outlier detection has been extensively studied in the past decades. In the database research field the problem of outlier detection has recently drawn increased attention due to its wide applicability in areas such as fraud detection, data cleaning, and clinical diagnosis.

The process of detecting outliers is a challenging task either to clean errors or discover the meaning of exceptions through a further investigation.

F. Contribution and Outline In the proposed work the discretization is addressed by  considering the entire interval of attributes as a part of the data mining process for discovering outliers. We have used genetic algorithm for generating optimal rules by using fitness function with weighted support and weighted confidence.  The usage of adaptive intervals in genetic algorithm instead of fixed ranges to represent the   membership of values enhances the optimality of rules .Fuzzy logic is used to solve the unnatural boundary problem in data during partitioning of data intervals. From these rules obtained from the above methods the rules with unexpected association are identified and by which the temporal outliers are detected from Ozone level detection database [17] obtained from UCI repository to predict ozone day or normal day.

G. Related Work The author uses a Weighted Counting Algorithm to  generate rules from continuous data with one to one relation between antecedent and consequent to predict monsoon rainfall has been proposed [6]. The frequent patterns are  generated using FP-Tree method. A new method called Ward?s method is proposed to partition the shopping market and uses Supervised Apriori algorithm for the recognition of positive and negative values of customer interest in shopping industry [18]. To discuss about the amino acid interactions in protein sequences an Equi-depth partitioning Approach and Apriori algorithm to group the quantitative data [19]. To study the risk factor of heart disease and to analyze the price of houses in a region by mining Quantitative Association rules by using genetic learning has been discussed [20]. To predict the ozone level concentration of the day the author uses an evolutionary algorithm to extract association rules without performing discretization on the climatological variables which are quantitative in nature [21]. To examine the effects of ozone on day to day activities among children with asthma  the author proposes a method to perform logistic regression analysis on the respiratory symptoms and the in the usage of rescue medication is prescribed [22].

Fuzzy association rule helps in extracting the relation between the variables by overcoming sharp boundary problem. An approach for the generation of fuzzy association rules is done by partitioning of values using fuzzy logic [31].

To identify the customer?s interest in car purchasing industry the Quantitative Association rules are generated by qualitative approach [23]. An approach to predict the hidden data about the customers in bank is done using fuzzy association rule mining. This approach has predicted the hidden data and the bank has given approval for incentives for regular customers [6].The author uses a multi-objective evolutionary algorithm on quantitative data that form temporal patterns to extract  frequent fuzzy item sets and from which the association rules are generated[24]. Fuzzy data mining algorithm can also be given by allocating dynamic membership functions by using a 2-tuples linguistic approach[32]. Ferdousi et.al proposes a method to find outliers in time series financial data using Peer Group Analysis (PGA), which is an unsupervised   technique for fraud detection over real stock market data sets with continuous values over regular time intervals [27]. Huidong Jin et.al proposed a domain-driven knowledge representation for Unexpected Temporal Association Rule (UTAR) and a mining algorithm MUTARA (Mining UTARs given the antecedent)to signal unexpected and infrequent patterns and characteristics of adverse drug reactions using an unexpectedness measure unexlev[29].

H. Paper Organization The rest of the paper is organized as follows. In  section II, the frame work to detect Temporal Outliers (TODOs) is discussed. In section III, the algorithm to detect TODOs is being dealt. In section IV the experimental evaluation of the algorithm based on confidence of outliers detected and its accuracy has been verified. And finally in the section V, our work is concluded.



II. FRAMEWORK FOR TEMPORAL OUTLIER DETECTION  Our goal is to detect outliers from Ozone level detection database by using genetic algorithm and fuzzy logic by using climatological variables as the parameters. The parameter which causes the outlier is identified using association technique by determining the unexpected association among thsee parameters. The frame work for detection of temporal outliers (DOTOs) is given in figure 1.

Fig. 1. Architecture for detecting temporal outliers  A. Dataset Used The proposed approach is evaluated using ozone level  detection database which is taken from UCI repository [21].

The dataset contains the following description: Number of Instances: 2538 Number of instances after data cleaning: 1840 Number of attributes: 72 Dataset consists of 26 attributes relating to temperature (T0,??,T23, T_PK, T_AV),  another 26 attributes relating to wind speed ratio (WSR0,??..WSR23,WSR_PK,WSR_AV), the relative humidity with 3 attributes(RH85,RH70,RH50), atmospheric height with 3 attributes(HT85, HT70, HT50) and the directions with 6 attributes (U85, U70, U50, V85, V70,V50 ) and sea level pressure.  Though the temperature and wind speed ratio are measured for different time periods, the values have only slight variations. Hence to avoid repetitions and redundancy of data the process of attribute selection is performed based on CFS subset level algorithm and best first algorithm using weka tool. Based on this algorithm, the selected attributes include WSRAV, T_PK, RH50, HT50 and V70.

B. Measures Used Interesting measures play a crucial role in data mining,  regardless of the kind of patterns that are mined. These measures are purposed for selecting and ranking patterns based on their likely interest to the user. Good measures  helps in the reduction of time and space cost of the mining process[15]. Measuring the interestingness of the discovered patterns is a specific and important area among data mining techniques. An objective measure for a class association rule to generate the frequent item sets is its support value. It represents the percentage of transactions from a transaction database that the given rule satisfies [16]. Support value for the rule say,   is defined as follows,   (1)  Where |T| is the total number of transactions in the database, ?A(xp) is the matching degree of the transaction xp with the antecedent part of the rule considered. Another objective measure for class association rule is its confidence value. It presents the degree of certainty of the identified association between the antecedent and the consequent [16]. Confidence value for the rule say,   can be defined as follows,   (2)   An objective function in genetic algorithm is the fitness  function that  is used to measure the potential of an individual to reproduce in successive generations. The fitness function used in the proposed technique is given by,   (3)   Where F is Fitness function, supp is support, conf is confidence, recov is number of records covered by the rule, nattri is number of attributes used, ampl is amplitude(difference) between the intervals in the rule taken, Ws ,Wc ,Wr , Wn , Wa  are weights to derive search where Ws  is weight value for support, Wc is weight value for confidence, Wr is weight value for coverage of rule, Wn is weight value for number of attributes, Wa is weight value for amplitude of a rule Ws =0.5 ,Wc =0.4 , Wr =0.3, Wn  =0.4 , Wa =0.2.

The proposed method uses lift measure to prune the necessary rules from all association rules. Lift measures how many times more often X and Y occur together occur together than expected if they were statistically independent. Lift is measured by using the following formula,  Lift(X Y) = Conf(X Y)/Supp(Y) = P(X AND Y) / (P(X)P(Y))    (4)  Leverage measure is used to identify the unexpected associations among the association rules generated.

The leverage of the association rule  , is the proportion of T-constrained sub sequences that exhibits the unexpected association between A and C in excess of those that would be supposed if unexpected A and C were    independent of each other. That is defined as follows:  leverage (A -> C) = P(A and C)- (P(A)P(C))                 (5)   It particularly indicates the degree to which the observed unexpected   associations between A and C exceeds the supposed associations based on an independence assumption.

It considers the observed unexpected associations between A and C.



III. ALGORITHMIC DESIGN CONCEPT The algorithm for detecting temporal outliers (TODOs)  from ozone level database is given in figure 2.  The algorithm involves various steps which have been described as follows.

A. Data Preprocessing The pre-processing of data encompasses two steps namely  data cleaning and attributes selection. Data cleaning is performed to remove noisy and missing values. Attribute selection deals with the process of selecting necessary attributes from other attributes present in the dataset. It based on the CFS Subset level algorithm and best first algorithm using weka tool to avoid the redundancy and repetition of attributes considered.

Fig. 2. Architecture for detecting temporal outliers  B. Rule Generation In the rule generation process firstly the pre-processed data  is taken as input and the frequent item sets are generated. The item sets which are having high support than the user specified  minimum support value are called frequent item-sets. The frequent set generation is done by two methods namely:  1) Frequent set generation using fuzzy logic 2) Frequent set generation using Genetic algorithm  Once the frequent item-sets are generated , it is straight  forward to find the quantitative association rules. For each frequent item-set identified, generate all combination of rules, from which the quantitative association rules are generated.

The Frequent set generation by fuzzy logic is shown in figure 3 and the Frequent set generation by Genetic algorithm is shown in figure 4. From these association rules generated a subset of rules is selected from using lift measure and the temporal outliers are generated using the leverage measure.

1)  Frequent set generation using fuzzy logic:  The pre-processed real valued dataset is taken and the  process of fuzzification is performed. Fuzzification is the process of converting the original values present in the data set into linguistic terms which is given as input for the rule generation. In this proposed method, trapezoidal membership function is used for partitioning of natural boundaries in data.

Linguistic terms used in the proposed system are low, medium, and high for the selected attributes. From these fuzzified data, the frequent item sets are generated using Apriori approach.

The conventional method of Apriori is used to generate frequent patterns on the fuzzified input. The Apriori approach assumes that the items within a transaction or item set are sorted in lexicographic order. Let the set of frequent item sets of size x be Fx and their candidates be Cx. Apriori first scans the database and searches for frequent item sets of size one by accumulating the count for each   item and collecting those item sets that satisfy the minimum support requirement.

The algorithm iterates on the following three steps and extracts all the frequent item sets.

1. Generate Cx+1, candidates of frequent item sets of size x+1, from the frequent item sets of size x.

2. Scan the database and then calculate the support of each  candidate of frequent item sets obtained.

3. Add those item sets that satisfies the minimum support  requirement to Fx+1.

From these frequent item sets generated on the fuzzified  input the association rules are generated by the above mentioned Apriori approach. By using the lift and leverage measures (discussed in section II) the temporal outliers are detected. The Frequent set generation by fuzzy logic is shown in figure 3          Fig. 3. Frequent set generation using fuzzy logic        Fig. 4. Frequent set generation using genetic algorithm    2)  Frequent set generation using Genetic algorithm:  In this phase the frequent item sets are generated and association rules are extracted using genetic algorithm. The evolutionary approach considered in this paper involves the codification of individuals in the form of chromosomes. The pre-processed numerical data is taken as input and maximum and minimum value of all attributes is calculated. Using the maximum and minimum values of all attributes calculated the individuals are codified. The codification of individuals is performed by two structures Upper and Lower.

The upper structure of the individual contains all the  attributes present in the data set taken and their corresponding interval limits .The interval limits are given by an upper limit Ui and lower limit Li. The lower structure contains the type of the attribute in terms of the values 0, 1.The value 0 is used to represent that the attribute does not belong to the individual and value 1 is used to represent that the attribute belongs to the individual. The structure of an individual is given in figure 5.

Fig. 5. Example of an individual    Where x1, x2,x3 represent  the attributes of the dataset. The codified individuals in the form of chromosomes are subjected to the three genetic operators Selection, Crossover and Mutation.

1) Selection: From the codified individuals obtained the genetic operator of selection is implemented using tournament selection. Tournament selection process works by evaluating the individuals using the fitness function and best fit individuals are selected from the population to perform the process of crossover.

2)   Crossover:  From the individuals obtained after selection process, the genetic operator of crossover is performed between two individuals to produce a new offspring. Here two parent individuals X and Y,which are chosen by means of tournament selection are made to perform a crossover between them to produce a new child individual Z.

Let [lix ,uix], [liy, uiy], [liz,uiz] be the intervals with  lower limit li and upper limit ui in which the attribute ai varies for the individuals  X,Y,Z respectively. Let tix, tiy, tiz be the type of the attribute ai taken for the individuals X, Y, Z respectively. For each attribute ai two cases possibly occur based on the types present in the lower structure of the individual considered.

Case 1:   if (tix= tiy )  then  (tiz = tix) [liz,uiz]=[random(lix,liy),random(uix,uiy)]   Case 2:    if  ( tix ? tiy  )  then [liz,uiz]=[lix,uix]   if (tiz=tix)  [liz,uiz]=[lix,uix]  if (tiz=tiy)   The crossover between the individuals is shown pictorially as in figure 4.

15   28   38    39      43   59  1 1 0  X1                X2               X3  Upper structure  Lower structure    3) Mutation: The selected individuals are subjected to    the genetic operator mutation. The mutation process can be defined as any change that is made to the gene of the individual that is subjected to mutation. The change is determined by the probability of the randomly selected individual. In this paper mutation is focused on the type ti of the attribute in lower structure of the individual. Mutation is done by two types Null Mutation and Not Null Mutation. In the process of Null Mutation if the type ti of the selected attribute is not null (1) then it is changed to null (0). In the process of Not Null Mutation if type ti of the selected attribute is null (0) then  it is changed to not null (1). The Mutation process is pictorially represented as shown in figure 5.

Now the individuals that are obtained from the crossover and mutation genetic process are evaluated using the objective function called the fitness function. If the fitness of the new individual obtained  is higher then it is allowed to enter into next generation to compete with other individuals else the individual is discarded. This process is performed in an iterative fashion for N generations and the best individuals are extracted.

Fig. 6. Crossover between individuals    C. Evolving TODOs The class association rules obtained from the frequent sets  generated by using fuzzy logic and frequent sets generated by using genetic algorithm. Our proposed method uses lift measure to prune the necessary rules from all association rules.

From the rules that are pruned using lift measure, the leverage measure is applied on these rules to find the unexpected associations between them and the rules are arranged in descending order of leverage values. Then the top 10 rules are  pruned and are termed as the required outliers (TODOs) which consequently have confidence and lift values nearer to 1.

Fig. 7. Mutation of  individuals

IV. EXPERIMENTAL ANALYSIS We carried out several experiments on a real world dataset named ozone level detection  dataset to evaluate the proposed approach. This data set  contains data  collected from the year 1996 to 2003 at the Houston, Galveston and northern parts of Brazoria area in west of south central United states of America. In this paper the proposed methods of Outlier detection by using fuzzy logic was compared with the method of Outlier detection  by using Genetic algorithm(without discretization) in terms of accuracy as the performance measure. The following table I depicts the relationship between the data size and accuracy of the outliers detected for the two methods, Outlier detection  by fuzzy logic and Outlier detection  by genetic algorithm(without discretization).The table I also shows the maximum and minimum confidence of the outliers generated for each data size.

Figure 8 maps the relationship between the two  methods Outlier detection by fuzzy logic and Outlier detection by genetic algorithm (without discretization)in terms of accuracy and data size. It can be easily seen from the figure that the accuracy of the outlier detection by fuzzy logic method is more accurate than outlier deduction by genetic algorithm method for any given data size. The accuracy of outlier detection by fuzzy logic method is high because the confidence of the outliers generated by fuzzy logic are higher the confidence of the outliers generated by genetic algorithm.

1  1         0  20   35            4.0   5.0         3.2   5.3  0  1         0  22    38            60   65         40   45  1  1         0  20   35            50   62         33   51  Parent X Parent Y  Child Z  {Rand (32, 40),Rand (45,53)}  {Rand (40, 60),Rand (50,65)}    0  1         1  11   26            35   58         42   55  1  1         0  15   28            38   59         43   58  1  1         1  11   26            35   58         42   55  1  0         0  15   28            38   59         43   58  Individual Y Individual X  Individual X Individual Y  Scheme of Not null mutation         Scheme of Null mutation    TABLE I.  COMPARISION OF TWO METHODS  Data Size  Leverage without discretisation-Genetic  Algorithm   Leverage with Fuzzy logic  25% Accuracy -73% Min conf -0.79 Max conf -0.84  Accuracy -82% Min conf  -0.83 Max conf -0.89  50% Accuracy -77% Min conf -0.80 Max conf -0.87  Accuracy -84% Min conf  -0.85 Max conf -0.92  75% Accuracy -80% Min conf  -0.83 Max conf-0.88  Accuracy -87% Min conf  -0.85 Max conf -0.96  100% Accuracy -82% Min conf  -0.82 Max conf -0.90  Accuracy -89% Min conf  -0.89 Max conf -0.98         Fig. 8. Data size Vs no. of rules

V. CONCLUSION To overcome the problem of unnatural boundaries in  partitioning the quantitative data we have used fuzzy logic and genetic algorithm. Genetic algorithm overcomes the problem of generating irrelevant rules by considering the entire interval of the attributes taken without performing discretization.

Fuzzy logic overcomes the problem of crisp boundaries by considering natural boundaries of attributes. These two methods are used to generate temporal outlier which aids to find out the unexpected parameters that causes ozone  day/normal day from ozone level detection database. From the experimental evaluation it has been identified that the outliers generated by fuzzy logic are more accurate than the outliers generated by Genetic algorithm (invariable of the data size).

The accuracy of outlier detection by fuzzy logic method is high because the confidence of the outliers generated by fuzzy logic are higher the confidence of the outliers generated by genetic algorithm.

.

