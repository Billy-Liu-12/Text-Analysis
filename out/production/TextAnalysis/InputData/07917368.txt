1551-3203 (c) 2016 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

Abstract?In this paper, a dynamic modeling method for unevenly sampled data is proposed for the monitoring of bi- layer (i.e., a process layer and a quality layer) dynamic processes.

First, a novel uneven data dynamic canonical correlation analysis method with an integrated dynamic time window is proposed for inter-layer latent structure modeling, which captures the dynamic relations between regularly sampled process data and quality data with slow and irregular sampling. The new model is a step towards big data modeling to deal with data irregularity and diversity. Secondly, after extracting co-variations using an inter- layer model, intra-layer variations are extracted using subsequent principal component analysis on the residual subspaces of the original process data and quality data, respectively. Thirdly, a concurrent monitoring method for unevenly sampled bi-layer data is proposed. Finally, the proposed method is demonstrated using an illustrative simulation example and applied successfully to a real blast furnace iron-making process.

Index Terms?Dynamic canonical correlation analysis, uneven- ly sampled data modeling, inter-layer and intra-layer concurrent monitoring, blast furnace iron-making processes.



I. INTRODUCTION  With the increasing complexity of modern industrial pro- cesses, data-driven latent structure modeling and monitoring have attracted more attentions and gained wide applications [1]?[10]. While model-based fault monitoring methods require a process dynamic model as a priori knowledge that is not easy to be obtained [11], data-driven latent structure methods provide an easy way to monitor unexpected variations of the relations between process data and quality data [12], [13]. The relations are commonly modeled using principal component analysis (PCA), partial least squares (PLS), and canonical correlation analysis (CCA) [14]?[18]. PCA is widely used for  Manuscript received September 08, 2016; revised January 26, 2017; ac- cepted April 08, 2017. This work was supported in part by the National Natural Science Foundation of China under Grant 61673097, Grant 61573022, Grant 61490704, and Grant 61304107, the Fundamental Research Funds for the Central Universities under Grant N160804002 and Grant N160801001, the International Postdoctoral Exchange Fellowship Program under Grant 20130020, the National High-Tech. Research and Development Program of China under Grant 2015AA043802, the Fundamental Disciplinary Research Program of the Shenzhen Committee on Science and Innovation under Grant 20160207, and the Texas-Wisconsin-California Control Consortium (TWCCC). Paper no. TII-16-1018. (Corresponding Author: Q. Liu.)  Q. Liu and T. Y. Chai are with the State Key Laboratory of Syntheti- cal Automation for Process Industries (Northeastern University), Shenyang, Liaoning 110819 China, and Q. Liu is also with the Department of Chemical Engineering and Materials Science, University of Southern California, Los Angeles, CA 90089 USA (email: liuq@mail.neu.edu.cn).

S. J. Qin is with the Department of Chemical Engineering and Materials Science and the Department of Electrical Engineering, University of Southern California, Los Angeles, CA 90089 USA, and also with the School of Science and Engineering, The Chinese University of Hong Kong, Shenzhen, Shenzhen 518172.

monitoring variations of a single process layer data while the quality-layer data are not used. However, unexpected process variations detected by PCA may have no influence on the quality variables, which will increase the false alarm rates if they are used to infer quality relevant faults. To overcome this problem, PLS and CCA based methods can be used to include the quality data to monitor abnormal variations in two layers, i.e., a process layer and a quality layer [15], [17], [19].

The traditional PLS-based monitoring method in [20], how- ever, divides the process data space in a similar way as PCA.

Recently, total PLS in [21], [22] and concurrent PLS in [1] are proposed to provide a more comprehensive monitoring of the process faults and quality faults. The nonlinear and decentralized extensions of total PLS are proposed in [23], [24]. The multiple modal and decentralized extensions of concurrent PLS are proposed in [25], [26].

PLS is the backbone algorithm in the aforementioned work.

The objective of PLS is to extract maximum covariances between quality data and process data. PLS can extract latent variations of process data which have large magnitude of variance but are not necessarily relevant to the quality. This makes PLS not necessarily efficient for quality prediction, since it usually requires many latent variables of process data to model a single quality variable. CCA in [18] in contrast enables a more efficient prediction by extracting the mul- tidimensional correlations instead of extracting covariances.

However, variance information is ignored in CCA, making it not suitable for process monitoring. The concurrent CCA is thus proposed in [17] to retain the CCA efficiency in predicting the quality while exploiting the variance structure for process monitoring. The comparisons with concurrent PLS demonstrate improved performance of concurrent CCA on quality prediction and quality relevant fault monitoring.

When dynamic relations exist between process variables and quality variables, static methods for monitoring tend to make the normal range too large which leads to a higher rate of missed alarms. Dynamic extension is necessary, such as dynamic PCA and dynamic PLS are studied [22], [27]? [31]. A straightforward way is to include lagged values of process data to form an augmented data matrix [30], [32].

They provide an easy way to monitor dynamic variations inherent in the data, but it is difficult to interpret and explore the underlying data structures due to the augmentation. In addition, indirect dynamic PCA that treats dynamic PCA with instrumental variables is proposed in [33]. The problem for the dynamic PCA and indirect dynamic PCA is that they can only model the autocorrelations explicitly. A new dynamic latent variable modeling method is thus proposed to extract both    1551-3203 (c) 2016 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2700520, IEEE Transactions on Industrial Informatics   autocorrelations and cross correlations explicitly by modeling the original space instead of augmented space [31]. Moreover, an autoregressive dynamic latent variable model is proposed in [34] to capture both dynamic and static relationships si- multaneously. However, all of the above mentioned dynamic methods are categorized into single layer dynamic modeling and monitoring of process variations only with quality relevant variations un-monitored. In contrast, the work of [22], [32], [35] makes effort to extract and monitor the inherent dynamic relations for bi-layer data. While the inner model remains implicit in [22], the work of [35] proposes a dynamic inner PLS to give an explicit and consistent inner model and outer model.

For many practical dynamic processes, process data and quality data are sampled asynchronously. While the process data are collected with a regular sampling, quality data are usually collected with irregular sampling and measurement delay. Quality data, although irregularly sampled with delays, are directly indicative of quality-relevant faults. To overcome the irregular sampling and the measurement delays, it is helpful to monitor quality-relevant faults using process data according to their relations to quality data before quality data are available. However, the inconsistent sampling frequency makes the existing dynamic modeling and monitoring methods not applicable for this kind of bi-layer dynamic processes.

This paper aims to propose a novel bi-layer modeling and monitoring method for dynamic processes based on unevenly sampled data. First, in order to extract inter-layer dynamic relations between regularly sampled process data and quality data with infrequent and irregular sampling, the dynamic time window technique in the work of [37], [38] is incorporated into CCA. By dynamic time window sampling of process data synchronized with the sampling instant of quality data while the measurement delays are also taken into considera- tions, the lagged values of process data are used to generate augmented process data matrix. Using the augmented process data matrix, a dynamic CCA modeling method is applied to extract inter-layer dynamic relations between regularly sampled process data and irregularly sampled quality data.

Secondly, by subsequent principal component decomposing the residual subspaces of the original process data and quality data, intra-layer variations are extracted for the concurrent monitoring of both layers. Thirdly, the proposed method is applied to an important industrial blast furnace iron-making process.

The remainder of the paper is organized as follows. In Section II, the concurrent dynamic CCA (CDCCA) method is proposed for unevenly sampled data modeling of dynamic pro- cesses. Following that, CDCCA based concurrent monitoring strategy is proposed in Section III. Results on an illustrative simulation and a real blast furnace iron-making process are presented in Section IV. Conclusions are summarized in the last section.



II. UNEVENLY SAMPLED DATA CONCURRENT DYNAMIC CCA MODELING  A. CCA and Concurrent CCA  Given process data matrix X ? Rn?m consisting of n samples with m process variables, and quality data matrix Y ? Rn?p with p quality variables, canonical correlation analysis (CCA) in [39] projects X and Y to a lower-dimensional space defined by a small number of latent variables t1, . . . , tA, where A is the number of CCA factors. The mean-centered X and Y are decomposed as:{  X = ?A  i=1 tip T i +E = TP  T +E  Y = ?A  i=1 tiq T i + F = TQ  T + F (1)  where T = [t1, . . . , tA] are the sets of canonical variates for X, P = [p1, . . . , pA] and Q = [q1, . . . , qA] are the loading vectors for X and Y respectively, E and F are the residuals for X and Y respectively.

CCA focuses on extracting multidimensional correlation instead of extracting covariance for PLS. While the correlation structure in CCA enables it to build a more efficient prediction, the lack of attention to variance structure in the data makes it not suitable for process monitoring.

Inspired by the improvement from PLS to concurrent PLS on fault monitoring in the work of [1], concurrent CCA is thus proposed in [17]. The concurrent CCA algorithm is given in TABLE I to decompose X and Y as:  X = TcR ? c +TxP  T x + X? (2)  Y = TcQ T c +TyP  T y + Y? (3)  where the loadings R?c ? Rm?Ac , Px ? Rm?Ax , Qc ? Rp?Ac and Py ? Rp?Ay characterize the concurrent CCA model, and the scores Tc ? Rn?Ac , Tx ? Rn?Ax and Ty ? Rn?Ay represent the correlations in X that are related to predictable part of Y, variations in X that are useless to predict Y, and variations in Y that are unpredictable from X, respectively.

The concurrent CCA retains the CCA efficiency in predict- ing the quality while exploiting the variance structure suitable for process monitoring. But as a static method, the dynamic relations between quality data and process data remain un- extracted. In addition, the process data and quality data are required to be sampled synchronously. In the next subsection, a novel dynamic CCA method is proposed to model dynamics based on regularly sampled process data and quality data with slow and irregular sampling.

B. Unevenly Sampled Data Dynamic CCA Modeling  1) Motivation of Unevenly Sampled Data Dynamic Model- ing: Many practical industrial processes operate dynamically, whose dynamics come from thermal inertia, mass inertia, feedback control of lower-level loop, etc. The dynamics make the quality variables and process variables auto-correlated and cross-correlated. While the process data are regularly sampled, the quality data are usually sampled irregularly in a slow sampling that makes traditional dynamic modeling methods not applicable. In order to derive the dynamic modeling    1551-3203 (c) 2016 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2700520, IEEE Transactions on Industrial Informatics   TABLE I CONCURRENT CCA ALGORITHM  1. Scale X and Y to zero-mean. Perform CCA on process data matrix X and quality data matrix Y to give R, T, Q, and P.

2. Perform singular value decomposition (SVD) on the predictable quality Y? = TQT ,  Y? = UcDcV T c = TcQ  T c  where Tc = Uc is comprised by left singular vectors, and Qc = VcDc contains nonzero singular values in descending order and the corresponding right singular vectors. The number of components is denoted as Ac1.

3. Obtain the unpredictable quality variations Y?c = Y?TcQTc , and perform PCA with Ay principle components,  Y?c = TyP T y + Y?  This gives the quality-principal scores Ty and quality-residuals Y?.

4. Obtain the quality-irrelevant process variations by projecting on the orthogonal complement of Span Rc, X?c = X?TcR?c, where Rc = RQTVcD  ?1 c , and R  ? c =  ( RTc Rc  )?1 RTc , and perform PCA with  Ax principal components,  X?c = TxP T x + X?  to yield the process-principal scores Tx and process-residuals X?.

method based on the unevenly sampled data, the following two assumptions are taken into consideration.

? Assumption 1: Dynamic relations, i.e., auto-correlations and/or dynamically cross-correlations, are involved a- mong the process data and quality data.

? Assumption 2: The sampling period of process data, the order of dynamic process (i.e. the length of the dynamic time window), and the sampling period of quality data for each sampling instant k are defined as T , Tli , and Tq(k) ? [Tminq , Tmaxq ] , respectively. It is assumed that T < Tli < T  min q .

The above two assumptions are usually satisfied for a num- ber of practical industrial processes, e.g., the BF. Assumption 1 is valid because of the existences of the thermal inertia, mass inertia, feedback control of lower-level. Assumption 2 is valid due to the facts that i) the process data are usually sampled at a fast sampling; ii) the quality data are sampled irregularly at a slow sampling since the sampling for quality data is usually time-consuming or cost-consuming; and iii) the length of dynamic time window can be selected between T and Tminq .

2) Dynamic CCA for Latent Structure Modeling of Inter- Layer Co-variations: The following two steps are used to model the inter-layer co-variations.

Step 1: Uneven Process Dynamic Data Sampling and Pro- cessing. The even process data and uneven quality data are described as Xr and Yir, respectively.

Xr=  ????? x1(0) x2(0) ? ? ? xm(0) x1(T ) x2(T ) ? ? ? xm(T )  ...

...

. . .

...

x1((n? 1)T ) x2((n? 1)T ) ? ? ? xm((n? 1)T )  ?????  Yir =  ????? y1(ty1) y2(ty1) ? ? ? yp(ty1) y1(ty2) y2(ty2) ? ? ? yp(ty2)  ...

...

. . .

...

y1(tyny ) y2(tyny ) ? ? ? yp(tyny )  ????? where m, p, and n are defined in Section II.A., ny represents the number of samples for quality variables.

A dynamic time window is used to collect uneven process data Xir:  Xir = [ xir1 x  ir 2 ? ? ? xirm  ] (4)  xiri =  ????? xi(tx1) xi(tx1 ? T ) ? ? ? xi(tx1 ? (li ? 1)T ) xi(tx2) xi(tx2 ? T ) ? ? ? xi(tx2 ? (li ? 1)T )  ...

...

. . .

...

xi(txny ) xi(txny ? T ) ? ? ? xi(txny ? (li ? 1)T )  ????? (i = 1, 2, ...,m)  where li = [Tli/T ] ? 1, txiy ? tyiy < txiy + T , txiy ? {0, T, . . . , (n ? 1)T}(iy = 1, 2, ..., ny), Tli is the length of dynamic time window for each variable i. It is noted the measurement delay of quality variables and inherent orders of process variables can be different from each other as priori knowledge in the above algorithm.

Step 2: Inter-layer Co-variation Latent Structure Modeling.

Using a pair of inter-layer data matrices, i.e., uneven quality data Yir and uneven augmented process data Xir, inter-layer co-variation latent structure is modeled using concurrent CCA algorithm in TABLE I [17].

Xir = TircR ? c + X?  ir c (5)  Yir = TircQ T c + Y?  ir c (6)  where the loadings R?c ? Rm?Ac and Qc ? Rp?Ac charac- terize the inter-layer co-variation latent structure model, the scores Tirc ? Rn?Ac represent the correlations in X that are related to predictable part of Y, and X?irc and Y?  ir c are  the residuals for the uneven process data and quality data, respectively.

The above decomposition extracts the dynamic co-variations between uneven process data and quality data, while the latent structure in the even process data after co-variation extraction remains un-modeled. In addition, there may still be large variances in the residual X?irc and Y?  ir c . It is helpful to further  extract the latent structure to make it more suitable for process monitoring. The concurrent DCCA algorithm for the original bi-layer uneven data is thus derived in the next subsection.

C. Concurrent Dynamic CCA for Latent Structure Modeling of Layer-specific Variations  After inter-layer latent structure is extracted using uneven quality data and uneven augmented process data, the inter- layer co-variations and intra-layer specific variations are mod- eled for the original process data collected regularly at a fast sampling.

1551-3203 (c) 2016 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2700520, IEEE Transactions on Industrial Informatics   1) Bi-Layer Co-variation Latent Structure Modeling: As process data can be regularly collected at a fast sampling, process layer latent structure is decomposed for the regularly sampled process data Xr instead of Xir in Eq. (4).

First, the augmented process data matrix is constructed as follows  Xrd = [ xr1 x  r 2 ? ? ? xrm  ] (7)  xri=  ????? xi(0) xi(T ) ? ? ? xi ((li ? 1)T ) xi(T ) xi(2T ) ? ? ? xi(liT )  ...

...

. . .

...

xi((n? li)T ) xi((n? li + 1)T ) ? ? ? xi((n? 1)T )  ????? (i = 1, 2, ...,m)  Second, process layer variation X?rc is extracted using X r d  and inter-layer latent structure Pc. X?rc = X r d ?TrcPc, where  Trc = X r dPc.

2) Process Layer Latent Structure Modeling for Original Process Data: Process specific variation is modeled by per- forming PCA on X?rc to have X?  r c = T  r xPx + X?  r d.

3) Quality Layer Latent Structure Modeling: Quality spe- cific variation Y?irc is first extracted using Y  ir and inter-layer latent structure Qc, Y?irc = Y  ir ?TircQTc , where Tirc = XirPc.

After that, quality layer variation is modeled by performing PCA on Y?irc to have Y?  ir c = T  ir yP  T y + Y?  ir.

By doing 1), 2), and 3), the ultimate model structure  provided by the concurrent DCCA algorithm for the original process data and quality data is listed as follows.

Xrd = T r cR  ? c +T  r xP  T x + X?  r (8)  Yir = TircQ T c +T  ir yP  T y + Y?  ir (9)  where the loadings R?c, Qc, Px, and Py characterize the un- evenly sampled concurrent dynamic CCA (uS-CDCCA) latent structure model. The scores Trc ? Rn?Ac , Trx ? Rn?Ax and Tiry ? Rn?Ay represent the correlations in X that are related to predictable part of Yir, variations in X that are useless to predict Yir, and variations in Yir that are unpredictable from X, respectively. X?r and Y?ir are the residuals of the even process data and uneven quality data, respectively.

The loadings R?c, Qc are the same as Eqs. (5)-(6), while Px and Py are computed from 2) in a similar way as concurrent CCA algorithm in TABLE I. Trc = X  r dRc, T  r x = (X  r d ?  TrcR ? c)Px, T  ir y = (Y  ir ?TircQTc )Py .



III. US-CDCCA BASED INTER-LAYER AND INTRA-LAYER CONCURRENT MONITORING OF DYNAMIC PROCESSES  For the process data regularly collected at a fast sampling, the augmented sample xrd(k) ? ?l1+???+lm is constructed similar to Xrd in Eq. (7).

xrd(k) = [ xr1(k) x  r 2(k) ? ? ? xrm(k)  ] (10)  where  xri(k) = [xi(k) xi(k ? 1) ? ? ? xi(k ? (li ? 1))]  The uS-CDCCA scores and residuals for the process data at instant k are calculated as follows  tc(k) = R T c x  r d(k) (11)  tx(k) = P T x x?c(k); x?c(k) = (Ix ?RcR?c)xrd(k) (12)  x?(k) = ( Ix ?PxPTx  ) x?c(k) (13)  The uS-CDCCA scores and residuals for uneven quality data at instant k1 are calculated as follows  ty(k1) = P T y y?c(k1); y?c(k1) = y(k1)?QcRTc xrd(k1) (14)  y?(k1) = ( Iy ?PyPTy  ) y?c(k1) (15)  where Ix and Iy are the identity matrices of (l1 + ? ? ?+ lm)? (l1 + ? ? ?+ lm) and p? p, respectively.

The fault monitoring statistics are summarized and the cor- responding control limits can be determined by F distribution and ?2 distribution in TABLE II [1]. In the table ?c, ?x, and ?y are the sample covariances of tc(k), tx(k), and ty(k1), respectively, Sx and Sy are the sample variances of Qx(k) and Qy(k1) respectively, and ?x and ?y are the sample means of Qx(k) and Qy(k1), respectively.

TABLE II US-CDCCA MONITORING STATISTICS AND CONTROL LIMITS.

Statistic Calculation Control limit  T 2c (k) t T c (k)?  ?1 c tc(k) ?  c =  Ac(n2?1) n(n?Ac)  FAc,n?Ac  T 2x (k) t T x (k)?  ?1 x tx(k) ?  x =  Ax(n2?1) n(n?Ax)  FAx,n?Ax  T 2y (k1) t T y (k1)?  ?1 y ty(k1) ?  y =  Ay  ( n2y?1  ) ny(ny?Ay)  FAy ,ny?Ay T 2cy(k1) t  T c (k1)?  ?1 c tc(k1) ?  cy = ?  c  Qx(k) ?x?(k)?2 ?2x = (Sx/2?x)?2(2?2x/Sx) Qy(k1) ?y?(k1)?2 ?2y = (Sy/2?y)?2(2?2y/Sy)  The uS-CDCCA based concurrent monitoring scheme can be summarized as follows:  1) For even process data sampled at instant k in a fast frequency, faults are detected when T 2c (k) > ?  c ,  T 2x (k) > ? x , or Qx(k) > ?  x. a) T  c (k) is used to  monitor quality relevant process variations; b) T 2x (k) is used to monitor process variations that may be relevant to unnecessary consumption of energy and materials; c) Qx(k) is used to monitor abnormal variations with no appearance in normal condition.

2) For uneven quality data sampled at instant k1 in a slow frequency, faults are detected when T 2y (k1) > ?  c , or  Qy(k1) > ? y . T  y (k1) and Qy(k1) are incorporated  into a combined index ?y(k1) to simply the monitoring of quality relevant faults that cannot be predicted from process variations [40].

1551-3203 (c) 2016 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2700520, IEEE Transactions on Industrial Informatics   Compared to static modeling of data in a low sampling frequency, the proposed concurrent monitoring scheme can a) detect quality-relevant faults in real time before they are made available in a slow sampling frequency; and b) distinguish quality relevant process faults, process specific faults, and quality specific faults.



IV. SIMULATIONS AND INDUSTRIAL CASE STUDIES  A. Simulations on A Numerical Example  The following dynamic process is employed to demonstrate the proposed uS-CDCCA method.

tk = A1tk?1 ?A2tk?2 + t?k (16)  xk = P1tk +P2t2,k + ek (17)  yk = C1tk +C2tk?1 +C3t3,k + vk (18)  where ek ? R5 ? N([0, 0.12]), vk ? R3 ? N([0, 0.12]), t?k = t0k ? R3 ? N([0, 42]), t2,k ? R1 ? N([0, 102]), t3,k ? R1 ? N([0, 42]), tk=0 =  [ 1.1700 0.8356 -1.2163  ]T , tk=1 =  [ 3.1099 1.0191 -1.7900  ]T ,  A1 =  ?? 0.4389 0.1210 -0.0862-0.2966 -0.0550 0.2274 0.4538 -0.6573 0.4239  ?? , A2 =  ?? -0.2998 -0.1905 -0.2669-0.0204 -0.1585 -0.2950 -0.1461 -0.0755 0.3749  ?? ,  P1 =  ?????? 0.5586 0.2042 0.6370 0.2007 0.0492 0.4429 0.0874 0.6062 0.0664 0.9332 0.5463 0.3743 0.2594 0.0958 0.2491  ?????? ,P2 = ??????  -0.6294 0.7379 -0.0526 0.2342 -0.0404  ?????? ,  C1 =  ?? 1.5257 1.1793 1.36541.0821 0.5357 1.0514 1.0821 0.5357 1.0514  ?? ,  C2 =  ?? 0.9983 1.2676 0.9936-0.8332 0.1295 0.2530 -0.8332 0.1295 0.2530  ?? , C3 = ?? 0.12490.0960  0.5456  ??T .

The parameters of the dynamic model are selected similar  to the ones of Reference [22]. For example, the parameters A1,A2,P1 are derived from the ones of [22]. The magnitudes of the correlated latent variables tk, process specific latent variables t2,k, and quality specific latent variables t3,k, are selected to be significantly larger than the ones of process noises ek and quality noises vk. The number of process variables is m = 5. The number of quality variables is p = 3.

The modeling data are collected from the dynamic process that operates under normal situation. A number of n = 10000 samples are generated from the above process as a training data set. The process data X are collected regularly with a fast sampling time T , while the quality data Yir ? Rny?p are collected irregularly with a slow sampling time (Ts = d?T, d ?  {10, 11, 12, 13, 14, 15}). The normal data are used to establish the parameters of the proposed CDCCA model.

Four data sets are generated from the above dynamic process when it operates under faulty situations. Each dataset with 2000 samples are generated when k > 1001 according to four faulty situations (Fault 1-Fault 4). The monitoring results for the four faults are shown in Fig. 1-Fig. 4. The statistics for regularly sampled process data and the control limits are marked with solid blue line and dashed red line in Fig. 1(a)- Fig. 4(a). The statistics for uneven quality data and the control limits are marked with hollow blue square and dashed red line in Fig. 1(b)-Fig. 4(b). The quality measurements and predictions are marked with solid blue square and dashed red line in Fig. 5.

Fault 1 (Inter-layer fault): When a fault occurs in the co-variation subspace as t?k = t0k +[  -5.9400 -12.7800 19.8000 ]T in Eq. (16), k > 1001,  the quality variables are not affected significantly as shown in Fig. 5(a). However, the quality relevant process fault is successfully detected by T 2c as shown in Fig. 1(a), while the other statistics for the process variations in Fig. 1(a) and ?y statistic for quality variations in Fig. 1(b) remain normal. Although the quality variables are affected by the fault, they can be predicted precisely in Fig. 5(a) since the inter-layer latent structure between process variables and quality variables remains invariant during the faulty period.

In addition, the quality-relevant is detected at Sample 1002 before the quality measurements are made available at Sample 1017.

Fault 2 (Process specific fault): When a fault occurs in the process specific subspace as t2,k = t2,k + 30 in Eq. (17), k > 1001, the quality variables are not affected as shown in Fig. 5(b). It is also observed that the quality variables can be predicted precisely from the process variables because the fault does not affect the co-variation subspace. However, the statistic T 2x in Fig. 2(a) exceeds the control limit while the other statistics for the process variations in Fig. 2(a) and statistics for quality variations in Fig. 2(b) remain normal. The process specific fault is detected successfully.

Fault 3 (Quality specific fault): When a fault occurs in the quality specific subspace as t3,k = t3,k + 30 in Eq. (18), k > 1001, the quality variables are affected obviously as shown in Fig. 5(c). It is also observed that y3 is apparently affected by the fault, which deviates from the prediction in red line. The deviation is caused by the fault happens in quality specific subspace. Also the quality specific fault is detected successfully by the ?y statistic in Fig. 3(b), while the other statistics for the process variations in Fig. 3(a) remain normal.

Fault 4 (Potentially quality relevant fault): When a fault occurs in the potentially quality relevant sub- space for the process variations as xk = xk +[  -1.9004 -0.9248 0.2402 -0.8177 7.6686 ]T in Eq.

(17), k > 1001, the quality variables are not affected obviously and can be predicted precisely as shown in Fig. 5(d). But the fault is detected by the Qx statistic as shown in Fig. 4(a), while the other statistics for the process variations in Fig. 4(a) remain normal. Also it is observed that the statistics for the    1551-3203 (c) 2016 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2700520, IEEE Transactions on Industrial Informatics   0 500 1000 1500 2000   T  c2  0 500 1000 1500 2000    T x2  0 500 1000 1500 2000    Sample number  Q x  (a) Monitoring of quality-relevant process variations  0 500 1000 1500 2000    T cy2  0 500 1000 1500 2000    Sample number  ? y  (b) Monitoring of quality variations  Fig. 1. Monitoring results for inter-layer fault (Fault 1).

0 500 1000 1500 2000    T c2  0 500 1000 1500 2000    T x2  0 500 1000 1500 2000    Sample number  Q x  (a) Monitoring of quality-relevant process variations  0 500 1000 1500 2000    T cy2  0 500 1000 1500 2000    Sample number  ? y  (b) Monitoring of quality variations  Fig. 2. Monitoring results for process specific fault (Fault 2).

quality variations exceed the control limit as shown in Fig.

4(b). The abnormality cannot be observed from the variations of quality variables in Fig. 5(d).

In order to compare with the static CCA algorithm on quality prediction, the quality prediction results of the CCA algorithm are shown in Fig. 6(a)-(d). In addition, the mean squared errors (MSEs) for DCCA and CCA are computed and the results are listed in TABLE III. From Fig. 6(a)(c)(d), the quality variables cannot be predicted precisely for Fault 1, Fault 3, and Fault 4. Also some predictions deviate the quality measurements. But actually the quality variables should be predictable for Fault 1 and Fault 2 as the fault happens in the co-variation subspace and process specific subspace. The CCA algorithm displays disadvantage on quality prediction for dynamic processes. From TALBE III, it is observed that for each fault (Fault 1-Fault 4), the MSEs of the proposed DCCA algorithm are smaller than the ones of CCA. The proposed DCCA gives more precise quality prediction. From TABLE III, the magnitude of MSEs value for y3 of Fault 3 is large.

B. Case Studies on A Blast Furnace Iron-Making Process  The proposed uS-CDCCA method is applied to a real blast furnace (BF) iron-making process. The schematic layout of the BF is depicted in Fig. 7. The raw materials including iron ore and coke, are heated in the working zones including lump  TABLE III MEAN SQUARED ERRORS OF DCCA AND CCA  Fault 1 Fault 2 Fault 3 Fault 4 MSE (y1-DCCA) 0.0420 0.0239 0.0742 0.0502 MSE (y2-DCCA) 0.0183 0.0221 0.0705 0.0314 MSE (y3-DCCA) 0.0754 0.0787 0.3765 0.0741 MSE (y1-CCA) 0.4409 0.3324 0.3574 1.0171 MSE (y2-CCA) 0.3017 0.1233 0.1552 0.2116 MSE (y3-CCA) 0.2992 0.1365 0.4078 0.2076  zone, cohesive zone, dropping zone, and coke roundabout zone, to have the final products, i.e., molten iron. The BF processes usually operate dynamically in a multi-level manner.

The molten iron quality indices, including molten iron Si- content, P-content, S-content, and temperature, are directly indicative of the product quality. They are tested irregularly with a slow sampling around 20 to 60 minutes. The process variables, including cold air flow rate, air temperature by thermocouple, air temperature by infrared detector, hot air pressure, and differential pressure and air permeability, which are related to the real-time working situation are collected regularly with a sampling of 1 minute. The following fault diagnosis experiments are carried out using two data sets. The first one includes a number of 4000 process data samples and a number of 109 quality data samples, while the second one includes a number of 7744 process data samples and a number    1551-3203 (c) 2016 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2700520, IEEE Transactions on Industrial Informatics   0 500 1000 1500 2000   T  c2  0 500 1000 1500 2000    T x2  0 500 1000 1500 2000    Sample number  Q x  (a) Monitoring of quality-relevant process variations  0 500 1000 1500 2000    T cy2  0 500 1000 1500 2000     Sample number  ? y  (b) Monitoring of quality variations  Fig. 3. Monitoring results for quality specific fault (Fault 3).

0 500 1000 1500 2000    T c2  0 500 1000 1500 2000    T x2  0 500 1000 1500 2000    Sample number  Q x  (a) Monitoring of quality-relevant process variations  0 500 1000 1500 2000    T cy2  0 500 1000 1500 2000    Sample number  ? y  (b) Monitoring of quality variations  Fig. 4. Monitoring results for potentially quality relevant fault (Fault 4).

200 400 600 800 1000 1200 1400 1600 1800 2000  ?50   y 1  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   y 2  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   Sample number  y 3  (a) Fault 1  200 400 600 800 1000 1200 1400 1600 1800 2000  ?50   y 1  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   y 2  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   Sample number  y 3  (b) Fault 2  200 400 600 800 1000 1200 1400 1600 1800 2000  ?50   y 1  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   y 2  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   Sample number  y 3  (c) Fault 3  200 400 600 800 1000 1200 1400 1600 1800 2000  ?50   y 1  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   y 2  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   Sample number  y 3  (d) Fault 4  Fig. 5. Measured and predicted values of quality variables using DCCA.

1551-3203 (c) 2016 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2700520, IEEE Transactions on Industrial Informatics   200 400 600 800 1000 1200 1400 1600 1800 2000  ?50   y 1  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   y 2  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   Sample number  y 3  (a) Fault 1  200 400 600 800 1000 1200 1400 1600 1800 2000  ?50   y 1  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   y 2  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   Sample number  y 3  (b) Fault 2  200 400 600 800 1000 1200 1400 1600 1800 2000  ?50   y 1  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   y 2  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   Sample number  y 3  (c) Fault 3  200 400 600 800 1000 1200 1400 1600 1800 2000  ?50   y 1  200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   y 2 200 400 600 800 1000 1200 1400 1600 1800 2000  ?20   Sample number  y 3  (d) Fault 4  Fig. 6. Measured and predicted values of quality variables using CCA.

Inject coal  Blast airProduct: molten iron  Raw materials: iron ore, coke  lump zone  cohesive zone  dropping zone  coke roundabout zone  Quality layer: molten iron quality indices,  including molten iron temperature, Si-  content, S-content, and P-content, artificial  laboratory test and operation optimization  Uneven quality data (irregularly sampled  around 20-60 minutes):  molten iron  temperature, Si-content, S-content, and P-  content  Process layer: closed-loop control of process  variables, including cold air flow rate, air  temperature by thermocouple, air temperature  by infrared detector, hot air pressure, and  differential pressure and air permeability  Process data (regularly sampled at 1 minute):  cold air flow rate, air temperature by  thermocouple, air temperature by infrared  detector, hot air pressure, and differential  pressure and air permeability  Fig. 7. The schematic layout of blast furnace iron-making processes.

of 258 quality data samples.

Case 1: The original even process data and uneven quality data for the first data set are shown in Fig. 8. The correspond- ing process monitoring results are shown in Fig. 9. From the monitoring statistics, the BF process operates normally except some excursions appear around Sample 2770 for T 2x and one single excursion at Sample 3614 for ?y . The quality specific abnormality is observed at Sample 3614 is possibly caused by the improper sampling location or the instrument damage for the quality test. The practitioners double check and confirm the improper measurement. The process specific variations from the statistic T 2x around Sample 2770 that caused by normal  variations of cold air flow rate as shown in Fig. 8(a) can be excluded from the quality relevant faults.

Case 2: The original even process data and uneven quality data for the second data set are shown in Fig. 10. The corresponding process monitoring results are shown in Fig. 11.

From the statistic ?y in Fig. 11(b) and quality measurements in Fig. 10(b), the quality specific abnormality is observed at one single Sample 3675 that caused by improper mea- surement similar to Case 1. Moreover, from the statistic T 2c in Fig. 11(a), quality relevant fault around Sample 7330 is diagnosed successfully, while the process specific variations from the statistic T 2x around Sample 4510, Sample 5380, and    1551-3203 (c) 2016 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2700520, IEEE Transactions on Industrial Informatics   0 500 1000 1500 2000 2500 3000 3500 4000  x 1  0 500 1000 1500 2000 2500 3000 3500 4000 1100x 2  0 500 1000 1500 2000 2500 3000 3500 4000 1100x 3  0 500 1000 1500 2000 2500 3000 3500 4000 0.38 0.39 0.4  x 4  0 500 1000 1500 2000 2500 3000 3500 4000  x 5  0 500 1000 1500 2000 2500 3000 3500 4000  Sample number  x 6  (a) The original even process data  0 500 1000 1500 2000 2500 3000 3500 4000 0.2 0.4 0.6 0.8  y 1  0 500 1000 1500 2000 2500 3000 3500 4000  0.12 0.14 0.16 0.18  y 2  0 500 1000 1500 2000 2500 3000 3500 4000  0.02 0.03 0.04  y 3  0 500 1000 1500 2000 2500 3000 3500 4000  Sample number  y 4  (b) The original uneven quality data  Fig. 8. Process data and quality data for the BF process (Case 1).

0 500 1000 1500 2000 2500 3000 3500 4000   T c2  0 500 1000 1500 2000 2500 3000 3500 4000   T x2  0 500 1000 1500 2000 2500 3000 3500 4000   Sample number  Q x  (a) Monitoring of process variations  0 500 1000 1500 2000 2500 3000 3500 4000    T cy2  0 500 1000 1500 2000 2500 3000 3500 4000   Sample number  ? y  (b) Monitoring of quality variations  Fig. 9. Process monitoring results for the BF process (Case 1).

Sample 6206 can be excluded from the quality relevant faults.

By a detailed analysis, the process specific variations denote normal operation of the BF when cold air flow rate and hot air pressure change synchronously as shown in Fig. 11(a).

It is consistent with the priori knowledge of BF operation.

Incorporating the statistic of T 2c with the statistic of ?y in Fig. 11(b), the quality relevant faults are successfully diag- nosed, but the fault is omitted by the quality measurement around Sample 7330. The practitioners are encouraged to pay attention to the samples around Sample 7330. For this practical application case, process specific variations, molten iron quality-relevant process abnormalities, and molten iron quality-specific abnormalities, are successfully distinguished from each other.



V. CONCLUSIONS  In this paper a novel uS-CDCCA method is proposed for dynamic modeling and monitoring of bi-layer dynamic processes based on uneven data, with the major conclusions summarized as follows:  1) The proposed uS-CDCCA scheme gives concurrent monitoring from even process data and uneven quality  data.

2) Results from an illustrative simulation example demon-  strate the advantages of uS-CDCCA. a) uS-CDCCA demonstrates improved quality prediction accuracy com- pared to static CCA; b) uS-CDCCA gives insightful monitoring for the process-layer and quality-layer faults before quality data are available.

3) When the proposed method is applied to the concurrent monitoring of quality-layer and process-layer of a real industrial blast furnace iron-making process, the molten iron quality relevant process faults, quality specific fault, and process specific fault are successfully distinguished.

It is noted the proposed method does not focus on explicit description of dynamic inner model and outer model, but providing an easy way for concurrent monitoring of dynamic processes. The future work can focus on: 1) developing a con- sistent dynamic CCA method which decomposes the original X space while providing consistent explicit inner model and outer model by utilizing a weighted combination of lagged process data; and 2) applying the proposed method to the other complex dynamic systems with uneven data.

1551-3203 (c) 2016 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/TII.2017.2700520, IEEE Transactions on Industrial Informatics   0 1000 2000 3000 4000 5000 6000 7000  x 1  0 1000 2000 3000 4000 5000 6000 7000  x 2  0 1000 2000 3000 4000 5000 6000 7000  x 3  0 1000 2000 3000 4000 5000 6000 7000 0.36 0.38 0.4  x 4  0 1000 2000 3000 4000 5000 6000 7000   x 5  0 1000 2000 3000 4000 5000 6000 7000   Sample number  x 6  (a) The original even process data  0 1000 2000 3000 4000 5000 6000 7000 0.2 0.4 0.6 0.8  1.2 1.4  y 1  0 1000 2000 3000 4000 5000 6000 7000 0.12 0.14 0.16 0.18 0.2  y 2  0 1000 2000 3000 4000 5000 6000 7000  0.02  0.04  0.06  y 3  0 1000 2000 3000 4000 5000 6000 7000   Sample number  y 4  (b) The original uneven quality data  Fig. 10. Process data and quality data for the BF process (Case 2).

0 1000 2000 3000 4000 5000 6000 7000    T c2  0 1000 2000 3000 4000 5000 6000 7000    T x2  0 1000 2000 3000 4000 5000 6000 7000    Sample number  Q x  (a) Monitoring of process variations  0 1000 2000 3000 4000 5000 6000 7000   T cy2  0 1000 2000 3000 4000 5000 6000 7000     Sample number  ? y  (b) Monitoring of quality variations  Fig. 11. Process monitoring results for the BF process (Case 2).

