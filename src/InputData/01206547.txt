A Clustering Algorithm with Genetically Optimized Membership Functions for Fuzzy  Association Rules Mining

Abstract-In this paper, we propose Genetic Algorithms (GAS) based clustering method, which dynamically adjusts the fuzzy sets to provide maximum profit within an interval of user specified minimum support ,values. This is achieved by tuning lhe base values of the membership functions for each quantitative attribute so as to maximize the sum of large iicnaetb in a certain iuterval of minimum support values. To the hi%t uf our knuuledee. thi, is the l int  effort in this dirrction.

I_  To support our claim, we compare the proposed GAS-based approach with a CURE-based approach. Experimental results on synthetic transactions show that the proposed clustering method exhibits a good performance over CURE-based approach in t e r m  of the number of produced large itemsets and interesting association rules.



I. INTRODUCTION Early research on association rules mining concentrated on  boolean association rules mining [l], which is concerned only with whether an item is present in a transaction or not, without considering its quantity. However, quantity is a very useful piece of information. However, the problem of discovering association rules from quantitative attributes is a relatively difficult task, which has received the attention of several research groups. It is difficult because determining reasonable intervals for unknown quantitative attributes is not an easy task. Clustering is one of the techniques employed recently to overcome this problem.

Earlier approaches developed for quantitative association rules mining require discretizing domains of quantitative attributes into intervals. which may not be concise and meaningful enough for human users to easily obtain nontrivial knowledge from the discovered rules. In other words, they introduced a major problem, which is caused by the shalp boundaty between intervals. Explicitly, existing quantitative mining algorithms either ignore or over-emphasize elements near the boundary of an interval.

Instead of using sharp boundary intervals, some work has recently been done on the use of fuzzy sets in discovering association rules for quantitative attributes. However, in existing approaches fuzzy sets are either supplied by an expert or determined by applying an existing known clustering algorithm.

The former is not realistic, in general, because it is extremely hard for an expert to specify fuzzy sets in a dynamic environment. On the other hand, approaches that applied classical clustering algorithms to decide on fuzzy sets have not led to satisfactory results. They have not considered the optimization of membership functions. Motivated by this, we contribute to the ongoing research by proposing a clustering method that employs GAS for the automatic optimization of membership functions used in discovering fuzzy quantitative association rules. GAS are general purpose search algorithms that use principles inspired by natural genetic populations to generate solutions to complicated search problems [7, 1 I].

Reda ALHAJJ  ADSA Lab &Department of Computer Science University of Calgary  Calgary, Alberta, Canada al hajj @ cpsc.ucalgary.ca  In our approach, the base values of membership functions for each quantitative attribute are tuned by GAS in order to maximize the number of large itemsets in a certain interval of minimum suppon values. So, we defined a fitness function in terms of large itemsets and minimum support. Experimental results on synthetic transactions show that when membership functions optimized according to an interval of lower minimum support values are applied to another interval of near-higher minimum support values, they do not show a sharp difference.

Also, we have demonstrated the superiority of the proposed GAS-based approach over other existing clustering-based automated approaches in terms of the number of produced large itemsets and interesting association rules. In particular, we compared our approach with a CURE-based approach, as CURE is considered as one of the most efficient clustering method.

The rest of this paper is organized as follows. Section I1 includes an overview of the related work. Fuzzy quantitative association rules are defined in Section II. Our approach of utilizing GAS to optimize membership functions is described in Section IV. Fuzzy association rules mining is discussed in Section V. Experimental results are presented in Section VI.

Section VI1 is the conclusions.

11. RELATED WORK Fuzzy association rules are also easily understandable to  humans because of the linguistic terms associated with fuzzy sets. In addition to fuzziness, researchers proposed different approaches to overcome the sharp boundary problem. However, we have not encountered in the literature any approach that employs GAS as presented in this paper. So, the rest of this section is dedicated to cover the existing different approaches to deal with the sharp boundary problem.

Srikant and Agrawal [21] used qui-depth partitioning to mine quantitative rules. ?hey separate intervals by their relative ordering and quantities equally. Miller and Yang applied Birch clustering [18] to identify intervals and proposed a distance- based association rules mining to improve the semantics of intervals. Lent et al. [I71 presented a geometrjc-based algorithm to perform the clustering in numerical attributes. They showed that clustering is a possible solution to figure out meaningful regions and support the discovery of association NleS.

Another trend to deal with the problem is based on fuzzy theory. In contrast to quantitative clustering, fuzzy linguistic- based approaches focus on qualitative filtering. Yager [23] introduced fuzzy linguistic summaries. Hirota and Pedrycz [IO, 201 proposed a context sensitive fuzzy clustering method based on fuzzy C-means to construct rule-based models. However, the context-sensitive Fuzzy C-means method cannot deal with data consisting of both numerical and categorical attributes. To solve the qualitative knowledge discovery problem, Au and Chan 141 employed fuzzy linguistic terms to relational databases with    numerical and categorical attributes. Later, they proposed the F- M A C S  method [3] to discover fuzzy association rules. They utilized adjacent difference analysis and fuzziness in finding the minimum support and confidence instead of having them supplied by a user. They determine both positive and negative associations.

Fu et al [6] proposed an automated method to find fuzzy sets for the mining of fuzzy association rules; their method is based on CLARANS clustering algorithm [191. Hong et al [121 proposed an algorithm that integrates fuzzy set concepts and Apriori mining algorithm to find interesting fuzzy association rules from given transaction data. In another paper, Hong et al [13] proposed definitions for the support and confidence of fuzzy membership grade and designed a data mining approach based on fuzzy sets to find association rules consistent with linguistic terms of human knowledge. Gyenesei [9] presented two different methods for mining fuzzy quantitative association rules, namely without normalization and with normalization. The experiments of Gyenesei showed that the numbers of large itemsets and interesting rules found by the fuzzy method are larger than the discrete method defined by Srikant and Agrawal [211. Ishibuchi et al [14] illustrated fuzzy versions of confidence and support that can be used to evaluate each association rule. The authors employed these measures of fuzzy rules for function approximation and pattern classification problems.

Wang and Bridges [22] used GAS to tune membership functions of the fuzzy sets used for intrusion detection system in mining fuzzy association rules. Chien et al. [51 proposed an efficient hierarchical clustering algorithm based on variation of density to solve the problem of internal partitioning. Finally, in a previous step of our ongoing research on data mining, we developed an efficient approach to automatically specify fuzzy sets based on CURE clustering algorithm [15].

111. FUZZY ASSOCIATION RULES Let T=[t , ,  q, ..., t.) be a database of transactions; each transaction tj represents the j-th tuple in T. We use I = { i f ,  i2, ..., im)  to represent all attributes (items) that appear in r; each attribute ik may have a binary, categorical or quantitative underlying domain 4,. Besides, each quantitative attribute ik is associated with several fuzzy sets. Explicitly, it is possible to define some fuzzy sets for attribute ik with a membership function per fuzzy set such that each value of attribute it qualifies to be in one or more of the fuzzy sets specified for ik. The degree of membership of each value of attribute ik in any of its fuzzy sets is directly based on the evaluation of the membership function of the particular fuzzy set with the value of ix as input.

Let F,, = I f , : .  /,,* ..... I,: t be a set of 1 fuzzy sets associated with ik. Membership function of fuzzy set L.,?, denoted P,:. is a mapping from the domain of it into the interval [0,I]. Formally, yI :D, 40.11, and the obtained value ~ ,~ ( fd fa l l s  in the interval [0,11, with the lower bound ?0? strictly indicates ?not a member?, while the upper bound ?I? indicated ?total membership?. All the other values between 0 and 1, exclusive, specify a ?partial membership? degree.

So, given a database of transactions T, irs set of attributes I, and the fuzzy sets associated with quantitative attributes in I.

Note that each transaction fj contains values of some attributes from I and each quantitative attribute in I has two or more  corresponding fuzzy sets. ?he target is to find out some interesting and potentially useful regularities, i.e., fuzzy association rules with enough support and high confidence. We use the following form for fuzzy association rules [161:  If X = { x f , x 2  ,..., x,) isA=lf, .h ,..., f , )  then Y={yi, y2. ..., yq l  is B = k , ,  82, ..., gql,  Here, X and Yare disjoint sets of attributes called itemsets, i.e., xC,, yc,and X n Y = $ k  A and B contain the fuzzy sets associated with corresponding attributes in X and Y, respectively, i.e.,h is the set of fuzzy sets related to attributexi and gj is the set of fuzzy sets related to attribute y)  Finally, for a rule to be interesting, it should have enough support and high confidence value, larger than user specified thresholds.



IV. EMPLOYING GENETIC ALGORITHMS TO OPnMIZE MEMBERSHIP FLINCnONS  In general, GAS are applied to spaces that are too large to he exhaustively searched. They have had a great measure of success in search and optimization problems. The reason for a great part of their success is their adaptation, i.e., their ability to exploit the information accumulated about an initially unknown search space in order to bias subsequent searches into useful subspaces.

GAS offer a valid approach to problems requiring efficient and effective search techniques.

The rest of this section is organized as follows. The encoding of chromosomes is presented in Section A. The fitness function is described in Section B. The selection process is discussed in Section C.

A. Chromosome Encoding Our target in using GAS is to cluster the values of quantitative attributes into fuzzy sets with respect to a given fitness evaluation criteria. For this purpose, each individual represents the base values of membership functions of a quantitative attribute in  the database.

In our experiments, we used membership functions in triangular shape because it is in general the most appropriate shape and the most widely used in fuzzy systems. To illustrate this, consider a quantitative attribute ik and assume it has 3 corresponding fuzzy sets. Three fuzzy sets are assumed because it is in general the most common case encountered in real world applications. However, in the experiments presented in Section VI, we considered 2 , 3  and 4 fuzzy sets.

U!.)  Fig. I :  Membership functions and base variables of attribute i k  Membership functions for attribute ik and their base variables are shown in Figure 1. Each base variable takes finite values. For instance, the search space of base value 6,: lies between the minimum and maximum values of attribute ik, denoted M D , ,  I and max(D,, I ,  respectively. Enumerated next are the search intervals of all the base values and intersection point R, of attribute ik.

e, :[min(D,),max(Q,N 8, : 1 ~ " Q  I.-@, 11 b,: :Imin(D,,).8, I b,: :I&, . m(4.11 6; : rww, ).-(4., 11  So, based on the assumption of having 3 fuzzy sets per attribute, as it is the case with attribute ik, a chromosome consisting of the base lengths and the intersection points is represented in the following form [2]:  b:b:R,b,, b,, bI2b, R, b:b; -bL b: Rcb:b: We use real-valued coding, where chromosomes are  represented as floating point numbers and their genes are the real parameters. These chromosomes form the input to the fitness function described in the next section.

B. Fitness Evaluation The fitness function measures the goodness of an individual in a given population. It is one of the key issues to a successful GA, simply because the main task in a GA is to optimize a fitness function. Consequently, the fitness function should be carefully set, by considering all factors that play important role in optimizing the problem under investigation. Every new population generated in the process is evaluated with respect to the fitness function. The evaluation process is a main source to providing the mechanism for evaluating the status of each chromosome; it is an important link between the GA and the system.

, * I  2  lurr ,U="  Fig. 2: The correlation between large itemxts and minimum support values  The fimess function accepts a decoded chromosome and produces an objective.value as a measure of the performance of the input chromosome. The aim of the GA employed in this study is to maximize the integral of the curve that correlates large itemsets and minimum'support values in a given interval as shown in Figure 2. Consequently, the fitness function of the GA used in this study is calculated as follows: flrnerr = ZC-. suplil-  rmn. supli - II)XIWW. izemreirli -11) ,where n is the number of iterations in a given interval of minimum support values.

C. Selecrion Process During each generation, individuals with higher fitness values survive while those with lower fitness values are destroyed. In other words, individuals who are strong according to parent selection policy are candidates to form a new population. Parent selection mimics the survival of the best individuals in the given population.

Many selection procedures are currently in use. However, Holland's original fitness-proportionate selection is one of the  3.2  simplest selection procedures [ I l l .  So, we used this selection policy in our experiments.

Letfiiness(x.t) and Avgfifnesslf) be, respectively, the fitness of individual x and the average fitness of the population during evolution phase f. Then, the usage value of individual x as a  ~ r n ~ s j r ( i . 0  parent is: ,s,(x,,) =-  After selecting chromosomes with respect to the evaluation function, genetic operators such as, crossover and mutation, are applied to these individuals.

Crossover refers to information exchange between individuals in a population in order to produce new individuals.

The idea behind the crossover operation utilized in our study is as follows. It takes as input 2 individuals, selects a random point, and exchanges the subindividuals behind the selected point.

Since the lengths of chromosomes are very long, the multi-point crossover strategy was used with the crossover points determined randomly.

On the other hand, mutation means a random change in the information of an individual. It is very important for populations.

It is an operation that defines a local or global variation in an individual. Mutation is traditionally performed in order to increase the diversity of the genetic information. Otherwise, after several generations, the diversity of the chromosomes decreases and some chunks of the chromosomes may end up being the same for all population members and the information they contain may not evolve further. A probability test determines whether a mutation will be carried out or not. The probability of mutation depends on the following condition:  average fitness of new generation <average fitness of old generation Since the initial population can be a subset of all possible  solutions, an important bit of each chromosome may be inverted, i.e., 0 appears as 1 or vice versa. Crossover may not solve this and mutation is inevitable for the solution.

Finally, the whole GAS 'process employed in this study can be summarized as follows. After generating each individual in the initial population, the executed GA includes the following steps: 1)Specify population size N and generate initial chromosomes, 2)Find the number of frequent itemsets according to current  3)Evaluate each chromosome based on the fitness function, 4)Perform selection, crossover and mutation, 5)If not (end-test) go to step (2), otherwise stop and retum the  I h e  test in step 5 depends on the values retumed by the, fitness function. The fittest chromosomes are selected to form the next generation and the manipulation process is repeated until no significant improvement of the population is observed.

AqJfmss ( I )  chromosomes,  best chromosome,

V. MINING FUZZY ASSOCIATION RULES After tuning the membership functions in each generation, according to the adjusted base values, the process of mining fuzzy association rules is executed. However, while adjusting membership functions of attribute ik by GAS, each value of i k intersects with one or more of the membership functions devoted to ik. Therefore, membership functions do not generally have a uniform structure. Having this in mind, attribute ik undergoes a normalization process, which is mainly a transformation that     leads to a total contribution of 1.0 for attribute ik. The normalization is done as follows:  where I ; ,  represents the maximum number of fuzzy sets related to attribute ik, @,t(f,,'.f.k) represents the membership degree in the j-th fuzzy set for the value of attribute it in transaction f.

To generate fuzzy association rules, all sets of items that have a support above a user specified threshold should be determined first. Itemsets with at least a minimum support are called frequent or large itemsets. The process alternates between the generation of candidate and frequent itemsets until large itemsets are identified. The following formula is used to calculate the fuzzy support value of itemset Z and its corresponding set of fuzzy sets F, denoted Sd. -.

where IT1 is the number of transactions in database T.

This way, all large itemsets are located and identified. and  the membership functions have been adjusted by GAS in a way that maximizes the sum of large itemsets in a certain interval of minimum support values. So, the problem of mining all fuzzy association rules converts into generating each p l e  whose confidence is larger than the user specified minimum confidence.

Explicitly, each large itemset, denoted L, is used in deriving all association rules (L -S )aS ,  for each ScL.. The strong association rules discovered are chosen from among all the generated possible association rules by considering only rules with confidence over a pre-specified minimum confidence.

However, all of these rules are not interesting enough to be presented to the user. Whether a rule is interesting or not can be judged either subjectively or objectively. Ultimately, only the user can judge if a given rule is interesting or not, and this judgment, being subjective, may differ from one user to another.

However, objective interestingness criterion, based on the statistics behind the data, can be used as one step towards the goal of weeding out uninteresting rules.



VI. EXPERIMENTAL RESULTS We conducted three sets of experiments in order to analyze  the effectiveness of the proposed GA-based clustering method.

Further, the superiority of our approach has been demonstrated by a comparison with our other approach 1151, where we adjusted fuzzy sets using CURE clustering algorithm [E]. As CURE is concemed, its input parameters are: first, the input data set D containing IDI-values in n-dimensional space, where ID1 is the number of values in the database and n is the number of attributes; and second, the desired number of clusters k. Starting with individual values as individual clusters, at each step the closest pair of clusters are merged to form a new cluster. The process is repeated until only k clusters are left. This way, the values of each attribute in the database are distributed into k cluster. The centroids of the k clusters are the set of midpoints of the fuzzy sets for the corresponding attribute.

All experiments were conducted on a Pentium El 1.4GHz CPU with 512 MB of memory and running Windows 2000. As experimental data, a synthetic S A L E S  database with 6 attributes and 10K transactions was generated using a randomized  transaction generation algorithm. Further, in all the experiments conducted in this study, the GA process started with a population of 60 individuals, and the results of the 400th generation of the developed GAS program are given next in this section. Finally, it is worth mentioning that as the per attribute number of fuzzy sets is concemed. three different cases, namely 2, 3, and 4 fuzzy sets, denoted FS2, FS3 and FS4, respectively, have beeo considered in all the conducted experiments.

The first set of experiments is dedicated to maximize the integral of the curve that correlates large itemsets and minimum support values within the two intervals [5,15] and [15,251. The reason for choosing these intervals is that larger number of large itemsets is found with lower minimum support values. This way; the sensitivity of the membership functions to be adjusted increases. In these experiments, the value of n was set to 10 and the GA process was executed for each integer value between 5 and 15 as well as between 15 and 25, inclusive. The results are reported in Figures 3-6.

v"""m)  Fig. 3: Number of large itemsets found by GA and CURE fox different values of minimum support  4.x  150 I I 302 6" 2 ?m 2i :: i IO  I, 16 li IS I 9  20 I ,  n 11 U U MlrvMmEvppn 1 9  Fig. 4: Comparison of the solutions found by GA with respect to the two intervals 15,151 and [15,25]  I 6 1 I P 10 I ,  , I  I, I. I>  Mnun""? svppon rb)  Fig. 5 :  The solutions found in case the membership functions adjusted by GA according to the interval [15,25] of minimum  suppolr values are applied to the interval [5,151  The numbers of large itemsets produced by applying each of CURE and GA within the interval 15,151 of minimum support values have been reflected into the curves plotted in Figure 3,     where it  can be easily seen that GA-based method outperforms CURE-based approach except for small minimum support values of FS2. Funher, the number of large itemsets found with respect to both methods decreases as the minimum support value increases. Also, the number of large itemsets is directly proportional to the'number of fuzzy sets. However, as the minimum support value increases, the difference in the number of itemsets produced for different numbers of fuzzy sets becomes smaller. Finally, the decrease in the number of large itemsets becomes sharper as the number of fuzzy sets increases.

t '? 6 110 j. *m  ; Im  -  i = I30  i 50  I, I6 I 7  II 19 20 21 12 11 2. 2)  Minimnlsvnnnn (1)  Fig. 6:  Applying the membership functions adjusted by CURE to the interval 115,251  Figure 4 shows the case of how the membership functions optimized by GA according to the interval [5,15] of minimum support values exhibit in the interval 115,251. Figure 4 also gives the best solutions (curves) found by GA within the interval [15,25] of minimum support values.

It can be easily observed from Figure 4 that.as the number of fuzzy sets increases, the difference between each two solutions that correspond to the same number of fuzzy sets but with respect to different intervals increases. The direction of this increase in the difference depends on the considered minimum support values. For small minimum suppon values, the solutions found according to the interval [5,15] produce more large itemsets. This can be easily observed by comparing each solution in Figure 3 with the solution that employs the same number of fuzzy sets in Figure 5 ,  which gives the solutions obtained in case that the membership functions adjusted according to the interval [15,25] of minimum support values are applied to the interval 15,151. However, this advantage moves in favor of the solutions found according to the interval [15,25] as the support value increases. This latter case is obvious from Figure 4. Finally, plotted in Figure 6 are the numbers of large itemsets found by applying CURE in the interval 115,251 of minimum suppon values. Here, it should he noted that CURE finds the ranges of fuzzy sets independent from minimum suppon values.

The second set of experiments is dedicated to investigate the correlation between minimum confidence and the number of interesting association rules discovered with different numbers of fuzzy sets and within the two intervals [5,15] and [15,251 of minimum support values. The results obtained by employing GA are shown in Figure 7 and Figure 8, with the minimum suppon value set to 8% and 20%, respectively; the results of the CURE- based approach for the same two minimum suppon values are reported in Figure 9.

From Figure 7, it can be easily seen that by considering the Same number of fuzzy sets in each of the two intervals, the number of association rules discovered within the interval [5,15] is larger than the number of association rules discovered within  1w1 . , A -  the interval 115,251, for small values of minimum confidence.

However, as the minimum Confidence increases, the number of discovered association rules decreases, and each pair of solutions that employ the same number of fuzzy sets get close to each other. This can be easily observed by looking at the right hand side of Figure 7 and at all of Figure 8.

-FS2(88) --ii--FS2(208)  -dr-FSJ(XCa) - -CFSqZWr) -0-FS3(8%) +FSXZW)  L  o >  0 . z  0 1  011 0 4  0 4 1  0 5  01, 0 - MinimmConfidence  Fig. 7: Number of association rules found by GA according to the two intervals [5,15] and [15,251; minimum suppon set to 8%  01 <,I 0, "3, ,,a "c) "I " 5 5  ,,6  Mwmum Colddrncs  Fig. 9:  The relationship between the number of association rules and the solutions found by CURE, with both minimum suppon values  The decrease in the number of discovered association rules becomes sharper as the number of fuzzy sets involved in the process increases. Further, for each pair of solutions that correspond to the same number of fuzzy sets, there is a value of minimum confidence after which the number of association rules discovered within the interval [5,151 exceeds the number of association rules discovered within the interval [15,25]. This can be easily seen by looking at the right hand side of Figure 8.

Finally, comparing the curves plotted in Figure 9 with those plotted in Figure 7 and Figure 8, i t  can be stated that, under the     same conditions, GA-based approach produces more fuzzy association rules than CURE-based approach.

6 n value 8 10  Fig. IO: The values of fitness obtained with respect to &fferent n values  m e  last experiment shows the effectiveness of the value of n. As the value of n increases in a constant interval, the execution time of the GA-based method also increases.

However, since the sensitivity of membership functions enhances, a more suitable clustering is handled with a higher value of n.  Fitness values obtained with respect to 4 different n values in the interval [5,151 of minimum support values are given in Figure 10. As the number of fuzzy sets used in the process increases, the value of the fitness increases as well. Also, the value of the fitness decreases along with an increase in the value of n; this is quite consistent with our intuition.

At the end, the number of fuzzy sets to consider depends on the application; it is in general accepted as three fuzzy sets for most applications: Also, the choice of the method to adapt is also based on the expectations of the application under consideration.

However, optimizing membership functions by GAS-based method is in general more effective.



VII. CONCLUSIONS In this study, we proposed a clustering approach to solve the problem of interval partitioning in favor of the maximum number of large itemsets within a particular interval of minimum support values. The main achievement of the proposed approach is employing GAS to dynamically adjust and optimize membership functions in an interval of user-specified minimum support values. We realized that the CA-based method is completely dependent on the specified interval of minimum support values. In order to show its superiority, we compared the proposed approach with a CURE-based approach. The conducted experiments showed that in general fuzzy sets optimized by GA produce larger solutions and hence more interesting rules than a clustering algorithm based approach.

In this study, we also observed that membership functions adjusted by GA according to intervals of lower minimum support values produce larger number of large itemsets and hence large number of interesting association rules compared to those optimized in an interval of near-higher minimum support values. However, if the former membership functions are used in the latter interval, when comparing the membership functions adjusted according to the latter interval, the difference between these two solutions is not very sharp. For this reason, although it requires larger execution time after a certain number of transactions, it is recommended to consider membership functions adjusted and optimized by using CA in an interval of smaller minimum support values.

