PREDICTION METHOD WITH THE VARIABLE THRESHOLD BASED ON  FUZZY ASSOCIATION RULES

Abstract: Quantitative attributes are partitioned into several fuzzy  sets by fuzzy c-means algorithm, and the search technology of Apriori algorithm is improved to dissover interesting fuzzy association rules. Then, the prediction method with the variable threshold ,based on the fuzzy association rules is presented. In this prediction method, a little error between prediction value and actual value is allowed. When the error is less than a given threshold, prediction value is regarded as acceptable or rational. The parameters of triangular fuzzy numbers are adjusted to improve the prediction accuracy by the genetic algorithm last. This prediction method can obtain the different prediction accuracy corresponding to the different error threshold chosen by the users, so it is more flexible and effective.

Keywords: Data mining; Fuzzy clustering; Association rules;  Prediction; Genetic algorithm  1 Introduction  Prediction is an important topic in data mining technology. The problem of prediction is concerned with the mining of a set of production rules that can allow the values of an attribute in a database to be accurately predicted based on those of other attributes. The categorical and quantitative attributes are mainly dealt with in the problem of prediction. In particular, when dealing with quantitative attributes, their domains are usually divided into equal-width or equal-frequency intervals'". But it caused some problems. The first problem is that equal-width partitioning cannot embody the actual distribution of the data. The second problem is caused by the sharp boundary. In most cases, the resulting intervals are not too meaningful and are hard to understand.

Ref. [2] uses fuzzy set to soften partition boundary of the domains, and presents the concept of fuzzy association rules, but it does not present the partition algorithm that can embody the actual distribution of the data and does not  present the mining algorithm for fuzzy association rules which fits for large databases. Ref. [3] uses the relational fuzzy c-means algorithm to partition the quantitative attributes into several linguistic terms, then the problem of mining association rules with linguistic terms is introduced by combining linguistic terms. The relational fuzzy c-means algorithm can embody the actual distribution of the data. Furthermore, linguistic terms can soften partition boundary. But combining linguistic terms can obtain excessive association rules with linguistic terms, so the mining algorithm cannot fit for large database.

In this paper, quantitative attributes are fmt partitioned into several fuzzy sets by fuzzy c-means algorithm, and the search technology of Apriori algorithm is improved to discover interesting fuzzy association rules. Then, the prediction method with the variable threshold based on the fuzzy association rules is presented. In this prediction method, a little error between prediction value and actual value is allowed. When the error is less than a given threshold, prediction value is regarded as acceptable or rational. The parameters of triangular fuzzy numbers are adjusted to improve the prediction accuracy by the genetic algorithm. This prediction method can obtain the different prediction accuracies corresponding to the different error threshold chosen by the users.

The rest of this paper is organized as follows. In section 2, Apriori algorithm is improved for mining the interesting fuzzy association rules. In section 3, a prediction method with the variable threshold based on the fuzzy association rules is presented. In section 4, an experiment is given. The conclusions are briefed in section 5.

2 An algorithm for mining fuzzy association rules  Let T = ( t l , f 2 , . . . , t n }  be a relational database, f, represents the j-th record in T, let I = { i I , i 2 , - , i m }  be the attribute set where i, denotes a Boolean, categorical or quantitative attribute, t,[ik] represents value of the j-tb  0-7803-78652/03/$17.00 02003 IEEE    record in attribute i k .  Values of the record in attribute need to be partitioned into several fuzzy sets for mining fuzzy association rules.

Let A, and A, .be two values of the record in Boolean attribute, then two values can be partitioned into two fuzzy sets A, and A, , where  Categorical attribute with fewer values can be partitioned into several fuzzy sets with the same method.

Each quantitative attribute is partitioned into several fuzzy sets represented with triangular fuzzy numbers by FCM alg~rithm'~'.

The method of representing fuzzy sets in triangular fuzzy numbers is as follows. Let p&,) be membership degree of x, in the fuzzy set with center v i ,  let  x' = ( x ,  : ~ * ( ~ , ) > ~ , ( x , ) , t l j ~ { 1 , 2 , . . . , ~ ) ) We first find the samples with minimum membership  degree at both sides of the center vt in Xh U(",), let the left sample with minimum membership degree be X I ,  its membership degree be p k ( x ' ) ,  and let the right sample with minimum membership degree be X' , its membership degree be ~ ~ ( x ' ) ,  then the expression of triangular fuzzy numbers / ( x )  with center vk is  x - a a < x < v ,  x < a  or x > b  l o I  In order to mine fuzzy association rules, we first construct a new database through original database T. In this new database, attributes are fuzzy sets; values of the record in attributes are obtained as follows: Let i: be a fuzzy set of attributei, , ik is an attribute in new database.

Value of the j-th record in attribute i: is i ; ( t , [ i* ] )  , i : ( t , [ ik])  is membership degree of t j [ i k ]  with respect to  fuzzy set i: . In this new database, because attributes are  fuzzy sets, we call attributes fuzzy attributes, and I still is the fuzzy amibute set. Let t , (yk )  represent value of the j-th record in fuzzy attribute y k ,  f j ( y t )  falls in [O,l]. Let  X = ( Y , , ~ - , Y p I c l  y ={Yp+,.-.Ypr7) c I XnY=0  A fuzzy association rule is an implication of the form X a Y .  The support and confidence of fuzzy association rule are defined as Ref. [3].

Definition 1: The support ofXis defined as follows  Fuzzy attribute sets with at least a minimum support  Definition 2: The support of X - Y  is defined as are called frequent fuzzy attribute sets.

follows  Definition 3: The confidence of X 3 Y is defined as follows  Because t j ( y k )  falls in [O,l], we can h o w  that all subsets of a frequent fuzzy attribute set must also be frequent according to definition 1. With the above findings, it is easy to modify Apriori algorithm to mine fuzzy association rules.

3 Prediction method with the variable threshold based on hiay rules  Suppose we have obtained 1 rules as follows by the improved algorithm for mining fuzzy association rules  If i, is/,',and i,is/:, ..., and im-,is/i., then imisf;, j=1 ,2 , - . , l  where /,' are triangular fuzzy numbers. To these fuzzy association rules, we can use inference method of standard additive model[" to make prediction. When input values of antecedents i ,  , i ,  ,' -, im., are xI  , x 2  ,. . . , xm., respectively, based on these fuzzy association rules, we can obtain the prediction result of consequent i ,  as follows  Proceedings of the second International Confexence on Machine Learning and Cybernetics, Wan, 2-5 November 2003      c .  = R*fL(x)dr  ' bfL(x)dr vj = J f L ( X ) d x  In practice, it is usually allowed that there is a little error between prediction value and actual value. When the error is less than a given threshold, prediction value is regarded as acceptable or rational. For example, we use some attributes to predict the economic growth rate of 2002 year. Suppose the prediction value of the economic growth rate is about 7.3 %, the actual economic growth rate of 2002 year is 7.8 %. Although there is a little error 0.5% between prediction value and actual value, the prediction value is regarded as acceptable or rational.

The users can choose an allowed error threshold Ae according to the actual need. When the error between the prediction value y,, and the actual value yi is less than A e ,  the prediction value is regarded as acceptable or rational. Let m be the total number of rational samples, n be the total number of samples, then the prediction  accuracy is defined as E .

Because triangular fuzzy numbers only approximately represent the fuzzy partition, we usually cannot obtain perfect prediction accuracy. So genetic algorithm is applied to improve the prediction accuracy. The optimizing process of genetic algorithm is to maximize the prediction accuracy by adjusting triangular fuzzy numbers in antecedent and consequence of the fuzzy association rules. The whole process of the algorithm is described as follows.

( I )  Load the initial data and set the parameters required for genetic algorithm  Load training dataset, initial triangular fuzzy numbers of each attribute, and fuzzy association rules obtained. Set the size of population L, maximum number of generations T, and set crossover probability P,, individual mutation probability P,, parameter of crossover a, parameter of mutation b. Use f count current generation.

(2) Generate initial generation Po Each individual forming the genetic population will  consist of triangular fuzzy numbers of all attributes that have been encoded by real values. Each triangular fuzzy number is represented by three real parameters. The triangular fuzzy numbers of all attributes are joined into an individual C, with the length H = C:,3.ij , which is shown as follows  C,( =(a,,,b,,,c,,  ,...,aq,b,,,c,l,}  c, =c,,c,,...c, where C,j codes the fuzzy partition of the i-th  attribute, 1, denotes the number of fuzzy sets that the I-th attribute is partitioned, and m denotes the number of attributes.

The encoded initial fuzzy partition is taken as the first individual of initial generation, denoted as Cp , and other initial individuals are generated randomly according to the variable range of each gene. Each gene c, ,h = 1,2, ..., H is the parameters of fuzzy numbers, and their variable ranges [c:,c;] are identified by Cp. The variable ranges of three parameters (C, ,C~+~,C,+~)  of a fuzzy number are the following  C,*I -c ,  1 C,+I - c, c,+2 -cw A,+,+-  C,+I - c, ] [c : ,c : ]=[c ,  -~ ,c, +2  2 [c:+,>C:+,l = [C,+I --  I I ,  c,+2 -c,+,  c,+z - C,*I .cr*2+- [ C , + 2 J , + 2 1 =  k , * 2  -- Since the size of population is L, initial generation can  be denoted as Po = (Cp,C ,",..., C , " } .

(3) Evaluate individuals To each individual of current generation population  P' , we use function E to evaluate its degree of adaptation.

Smaller the value of error function is, higher the individual adaptation is.

through genetic operators; this process consists of three steps as follows   (4) Generate a new generation  (A) Selection Applying the selection schemes of stochastic universal  sampling and keeping the elitist, we generate parent individuals from current generation for other genetic operators.

P"'  (B) Crossover The Max-Min-Arithmetic crossover operator['] is  applied to the selected individuals according to the crossover probability P,. If the two individuals is crossed are C, = (c  ,,..., ch ,_.., c,,) and C. = (c; ,..., c; ,..., c;), then four offsprings are generated as follows  c, = n . (C.)+(l-o).C, C, = a .  (Cy) + (1 - a ) .  C, C, with C,, =min(c,,c;} C, with C,, =max(c,,c;)  Select the best two of them as the results of the crossover operator, where a is a constant that is set beforehand.

(C) Mutation The nonuniform mutation operato+'] is applied to the      selected individuals according to the mutation probability P,. Suppose that mutation is happened on the gene cI  E[c: ,c;]  of an individual C, = ( c  ,,_.., ck ,..., c,,) , and generate new individual C: = ( c  ,,.._, c; ,.._, c , , ) , k ~ 1 , 2 , - . , H .

The process of mutation operator is as follows  c1 +A( t ,c ;  - c k ) ,  p =  0 1 c k - A ( f , c k - c : ) ,  B = l where p is a random integer of {OJ}, function  A(t ,y)  returns a value of [0, y] such that the function value tends to zero with the augment of f. Here we choose  A(t ,y)  = y(1- r ) , where r is a random value of [0,1], T is the maximum number of generation, f denotes current generation, and parameter b determines the degree of dependence to the iterative number.

c; =  B  ,,Lf  (5) Check the condition of termination The iteration terminated until to the maximum number  of generation T, otherwise retum to the third step and begin a new iteration.

In the prediction method with the variable threshold based on the fuzzy association rules, the users can choose a different error threshold Ae according to the actual need, and can obtain different parameters of triangular fuzzy numbers and prediction accuracy at the same time. So this prediction method is flexible and effective.

4 Experimental analysis  Experimental database Abalone is taken from UCI Machine Learning Repository, which has nine attributes and 4177 records. Each attribute is quantitative except for the attribute sex. Attribute sex is denoted as io, quantitative attributes are denoted as il....,i8 . Nine attributes are partitioned into three fuzzy sets, these fuzzy sets are denoted as im(l),im(Z),im(3),m =0,1,...,8 . We use the former eight attributes io, .... i, to predict the attribute &(rings), which denotes the age of abalone. In order to make prediction, it is required to mine fuzzy association rules with such as  If io is io(Io),.,,and i, is & ( I , )  We randomly select 2784 records in database as the training samples,' the rest records as the testing samples.

300 interesting fuzzy association rules are mined to make prediction. Let T=lOOO, L=61, P,=0.6, P,,,=O.I, ~ 0 . 3 5 , b=5, Ae = 2 , using the prediction method in section 3, we get the prediction precision 72.5575% on the training samples and the testing precision 71.0696% on the testing samples. Although the prediction precision is not perfect  then i, is i&), 1,=1,2,3,  m=0,1,.. . ,8 .

r  and should he improved farther, we claim that the prediction precision is acceptahle in this high-dimensional system with nine attrihutes.

5 Related works  Lent, Swami and Widom['] propose association rule clustering system (ARCS). This system mines association rules based on clustering, and then uses these rules to classify, but this system is only fit for the case, which there are only two attributes in a rule. Liu, Hsu and Mac9' propose classification based on associations (CBA), which uses iterative method to find the frequent and accurate'possihle rule set and then uses method of elicitation to build classification system. But it is important to' note that the intervals involved in quantitative association rules may not be concise and meaningful. A method for constructing fuzzy decision trees (FID) and a number of inference procedures based on conflict resolution in rule-based systems and efficient approximate reasoning methods have been presented in [IO]. Given a database, this approach can he used to build a fuzzy decision tree and the resulting tree can be used for inference in [lo]. A fuzzy approach that can be used for mining interesting rules for classification with degree of membership in [11,12]. This approach represents the revealed regularities and exceptions using linguistic terms. The use of linguistic terms allows human users to understand the discovered rules better because of the affinity with the , human knowledge representation.

Furthermore, this approach is capable of finding interesting relationships among attributes without any subjective input required of the users. Some results show that the classification methods in [11,12] have good accuracy and interpretability than C4.5, CBA and FID.

6 Conclusion  Quantitative attributes are first partitioned into several fuzzy sets by fuzzy c-means algorithm, and search technology of Apriori algorithm is improved to discover interesting fuzzy association rules. Then, we present a prediction method with the variable threshold based on the interesting fuzzy association rules. In this prediction method, a little error between prediction value and actual value is allowed. When the error is less than a given threshold, prediction value is regarded as acceptable or rational. The parameters of triangular fozzy nurnbers are adjusted to improve the prediction accuracy by the genetic algorithm last. Because the users can choose a different error threshold, and can obtain different prediction accuracy, this prediction method is more flexible and effective.

Acknowledgements  This work was supported in part by the National Natural Science Foundation of China (NSFC) (60073012), National Grand Fundamental Research 973 Program of.

China (2002CB3 12000), National Research Foundation for the Doctoral Program of Higher Education of China, Natural Science Foundation of Jiangsu Province, China (BK2001004), Opening Foundation of State Key Laboratory of Software Engineering in Wuhan University, and Opening Foundation of Jiangsu Key Laboratory of Computer Information Processing Technology in Soochow University.

