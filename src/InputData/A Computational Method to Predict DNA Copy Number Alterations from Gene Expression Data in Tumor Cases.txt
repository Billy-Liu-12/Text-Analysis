A Computational Method to Predict DNA Copy Number Alterations from  Gene Expression Data in Tumor Cases

Abstract  Genetic alterations, such as chromosomal gains and losses, are key causes of tumorigenesis.

Comparative Genomic Hybridization (CGH) is a molecular method for detecting such DNA copy number alterations in tumor cells. Recent observations have reported that in many tumors, the mRNA transcript changes measured by gene expression profiling (GEP) are correlated with corresponding DNA copy number alterations, supporting the possibility of predicting DNA copy number alterations from GEP data. In this paper, contrary to the traditional use of GEP, we present a new analytical approach utilizing GEP data for predicting DNA copy number alterations. The proposed approach is built on a hidden Markov model and trained in the light of paired GEP and CGH data on a sufficient number of tumor cases of the same tumor type. Then it can be applied to new cases of that tumor type to predict the CGH profiles from their GEP profiles.

1. Introduction   Genetic alterations, such as chromosomal gains and losses, are key causes of tumorigenesis. Prior to undergoing cell division, a cell must exactly replicate its genome by synthesizing a new copy of each chromosome. During this process, regions of DNA can be deleted or fail to be replicated, resulting in a loss, or conversely duplicated or multiplied, resulting in a gain of copy number. Healthy cells maintain checkpoints to monitor and correct this genomic instability. However, if a checkpoint has been inactivated, the cell can survive in its altered state. A particular danger exists if genomic alterations predispose a cell to uncontrolled proliferation. For example, if an oncogene, a gene which stimulates cell growth, is housed in a gain region, that oncogene may be over-expressed and  cause the transformation of normal cells into cancerous tumor cells. On the other hand, the loss of a region that houses a tumor suppressor gene, a gene whose activity opposes uncontrolled cell growth, will result in the inactivation of that gene and hence cell growth to progress without control. Such regional alterations in copy number are a characteristic of many tumors.

Thus, there is an inherent need to track and understand these genetic aberrations.

Comparative Genomic Hybridization (CGH) was developed as a molecular cytogenetic method for detecting and mapping such copy number alterations in the DNA content of tumor cells [1, 2]. It is a powerful fluorescent in situ hybridization (FISH) method for assessing whole genomic DNA from tumor samples that provides a comprehensive analysis of changes in the relative copy number of chromosomal material.

Researchers have used CGH to examine the chromosomal aberrations in tumors in order to identify chromosome regions containing genes that may contribute to the disease [3-6]. The method was based on the hybridization of fluorescently labeled tumor and normal genomic DNA to normal metaphase chromosomes. Using epiflourescence microscopy and quantitative image analysis, the (fluorescence) color ratio along the chromosomes is used to evaluate regions of DNA gain or loss in the tumor sample. Gene expression profiling (GEP) is a genome-wide microarray technique which measures mRNA expression of thousands of genes simultaneously.

Researchers have been using GEP arrays to detect expression patterns under certain circumstances, such as tumor vs. normal samples or between subtypes of tumors.

In the post-genomic era, the majority of the studies in tumor biology have been focusing on GEP but not CGH due to limitations in resolution. As a result, a substantial amount of genome-wide, high density GEP data have been accumulated and made publicly      available via centralized and standardized databases in the last decade, but few CGH studies have been done with a large series of tumor cases. The tremendous amount of GEP data represents an important resource for biomedical research. Nevertheless, this resource has not yet fully been exploited. High resolution array CGH is expensive and labor intensive. It requires sample cutting and DNA extraction which is often cumbersome in tumor biopsies. For some tumors, it is very difficult to obtain adequate tumor specimens due to the rarity of the disease or the difficulty to obtain tumor necrosis which are often associated with the disease. In addition, it is usually very difficult, if not impossible, for an investigative group to collect a large series of tumor specimens, which have been GEP performed by other groups, for a new CGH study. It would be a big advantage to derive DNA copy number alterations from GEP data without performing actual CGH experiments.

In this study, we proposed a novel computational model using a hidden Markov model (HMM) to predict DNA copy number alterations based on GEP data.

Since the model takes GEP data as the input to infer a ?virtual? CGH profile, we call it virtual CGH (vCGH) predictor. The rationale for vCGH is based on the observation that, in general a region with chromosomal gain or loss results in comparative increased or decreased mRNA expression all along the aberrant loci, as reported in diffuse large B-cell lymphoma (DLBCL) [7], mantle cell lymphoma (MCL) [8], natural killer-cell lymphoma (NKCL) [9], leukemia [10], breast cancer [11-13], prostate cancer [14], gastric cancer [15] and sarcoma [16]. In general, the expression level of 30~50% of the genes present in the aberrant regions showed an association with the corresponding DNA copy number alterations. It is true that chromosomal structural changes are not the only reason for gene expression changes, and there are other mechanisms to regulate gene expression, such as epigenetic modification, translocation, mutation, transcription units and so on. But most of those mechanisms only affect one or a few genes, but not a set of genes in a region. The only exception reported so far having large regional effects is an epigenetic modification which could silence the entire X chromosome. So if the pattern of gene expression in an entire region is changes, it is likely to come from the chromosomal ragional alterations. To our advantage, we had both GEP and CGH experiments performed on 64 mantle cell lymphoma (MCL) cases. In the light of the association between GEP and CGH, it?s likely to predict DNA copy number alterations from the GEP data by a novel computational model.

The rest of the paper is organized as follows. In section 2, we illustrate vCGH model, including model  structure, model training and model predicting. In section 3, we describe the MCL dataset used to evaluate vCGH model and the GEP and CGH experiments. In section 4, we provide the vCGH model performance. In section 5, we conclude that vCGH predictor is a powerful tool that may significantly enhance the data analysis of GEP in cancer research.

2. Proposed Method   Hidden Markov models (HMMs) are well developed statistical models used to capture hidden information from observable sequential symbols.

HMMs have been successfully applied to biology as in finding protein secondary structure, CpG islands and families of related DNA or protein sequences [17]. One of the most common problem formulations using HMMs is, ?Given a sequence of symbols as observations, predict the hidden state for each symbol along the sequence.? Applying to our vCGH, we want to decode hidden CGH state from GEP observations.

The observation symbols from GEP are ?H?, ?L? or ?M? for high, low or medium expression, and hidden states for CGH are ?+?, ?-? or ?o? for gain, loss or normal status.

2.1   vCGH Model Structure   A HMM is a Bayesian network which describes a  doubly-embedded stochastic process with one observable process {xi} (xi = ?H?, ?L? or ?M?), describing the observed GEP data, and one hidden process { i} ( i = ?+?, ?-? or ?o?), describing the unobserved CGH states. In a HMM, the state is not directly visible, but variables influenced by the state are visible. Figure 1 illustrates the vCGH model, where the shaded nodes S1, S2, ?, Sn represent hidden state variables and the visible nodes E1, E2, ?, En represent the observations for the variables. The observable emission space consists of three GEP symbols {H, L, M} and the hidden state space consists of nine states describing GEP profiles superimposed on CGH states {H+, L+, M+, H-, L-, M- , Ho, Lo, Mo} , where E  emits E, E=?H?, ?L? or ?M? and =?+?, ?-? or ?o?.

S1 ? ?Chromosome ? S2 Sn  E1 E2 En  S1 ? ?Chromosome ? S2 Sn  E1 E2 En   Figure 1. vCGH model presented as a Bayesian network. The hidden states variables are shaded as S1, S2, ?, Sn, representing nine hidden states {H+, L+, M+, H-, L-, M-, Ho, Lo, Mo}.

The observations for the variables are E1, E2, ?, En, representing three emission symbols {H, L, M}.

The model parameters for a HMM come from two categories: 1) state transition probabilities,  1( | )kl i ia P l k? ? ?= = = , which is a probability from state k to state l; 2) emission probabilities,  ( ) ( | )l i ie b P x b l?= = = , which is a probability distribution over all the possible output symbols b for each state l. The state transition diagram of the vCGH model was shown in Figure 2.

The model is a single chain incorporating three Markov sub-chains: sub-chain (+), sub-chain (-) and sub-chain (o). In each sub-chain there is a complete set of transitions describing the state transitions within a CGH state. The transitions between sub-chains are allowed for describing CGH state changes. This design makes it possible to identify alterative regions of variable length automatically by screening a chromosome, without the fixed-window-size problem.

It?s obvious from the transition diagram that the transition probability parameters are composed of a 9 x 9 matrix (nine states) and the emission probability parameters are composed of a 9 x 3 matrix (nine states, three symbols).

H+  M+  L+ H-  M-  L-  Ho  Mo  Lo  sub-chain (+)  sub-chain (o)  sub-chain (-)  H+  M+  L+H+  M+  L+ H-  M-  L-H-  M-  L-  Ho  Mo  LoHo  Mo  Lo  sub-chain (+)  sub-chain (o)  sub-chain (-)  Figure 2. State transition diagram of vCGH model. The model is a single HMM chain integrating three Markov sub-chains: (+), (-) and (o).

2.2   vCGH Training   We can develop a HMM (or train model parameters) for the genome as a whole or a separate HMM for each chromosome, depending the targeting organisms and the customer requirement. For example, for some model organisms such as bacteria, which have short and simple genomes, we can have one set of HMM parameters trained on the entire genome. But for long and complex genomes such as human, we can train HMM parameters for each chromosome accordingly, since each chromosome is a well- organized, condensed structure both physically and functionally and the gain and loss patterns for each chromosome, for each tumor type are different. Our program can handle HMM training on chromosome level or genome level depending on customers? requirement.

In this study, we train each chromosome separately to get more refined model parameters. The spatial order of the genes on each chromosome was preserved and mapped onto the CGH cytobands according to Affymetrix probe sets alignments and NCBI Human Genome database Build 36.1. The paired GEP and CGH data were preprocessed separately and translated into the symbolic format before integrating into the vCGH model: ?H?, ?L? and ?M? for high, low and medium expression of GEP data, and ?+?, ?-? and ?o? for gain, loss and normal state of CGH data.

In our training data each tumor case has both GEP and CGH data associated, and hence the hidden state path for each observation sequence is known.

Therefore, we estimate transition and emission parameters using maximum likelihood estimation (MLE) in Eq. (1), where akl is the transition probability from state k to state l, el(b) is the emission probability of symbol b at state l, Akl and El(b) are the counts that a particular state transition event or an emission used in the set of training sequences.

'' '  ( )    and   ( ) ( ')  kl l kl l  kl ll b  A E ba e b A E b  = =                   (1)    2.3   vCGH Prediction   Having the model parameters specified, we can now predict hidden CGH state path for a new sequence of GEP observations using either Viterbi decoding or Posterior decoding. Viterbi algorithm is a dynamic programming algorithm and it estimates the state path by finding out the most likely one. We have presented this decoding method in the vCGH model in [18]      Posterior (or Forward-Backward) algorithm is an alternative to the Viterbi algorithm to predict the hidden, probable state path, but instead of finding the most likely path as a whole, it intends to find the most likely symbol at each position and then concatenate those symbols as a path. Therefore it provides the flexibility to set the threshold in alteration calling which could not be handled in the Viterbi algorithm.

Posterior algorithm is derived from Forward and Backward algorithms. Forward algorithm is a similar dynamic programming procedure to the Viterbi algorithm, but by replacing the maximization steps with sums to obtain the full probability for all possible paths, ( ) ( , )P x P x  ?  ?= . In Forward algorithm,  1( ) ( , )k i if i P x x k?= =  is the full probability for all the probable paths ending in state k with observation up to and including xi, and  1( 1) ( ) ( )l l i k kl k  f i e x f i a++ =  is the recursion  corresponding to the observation up to and including xi+1. Backward variable 1( ) ( | )k i L ib i P x x k?+= = is analogous to the Forward variable fk(i), but instead obtained by a backward recursion starting at the end of the sequence,  1( ) ( ) ( 1)k l i kl l l  b i e x a b i+= + .

Algorithm (1):  Forward: Initialization: (i=0) Recursion: (i=1?L) Termination: (i=L)  0 (0) 1, (0) 0 for 0.kf f k= = >   ( ) ( ) ( 1) .l l i k kl k  f i e x f i a= ?  0( ) ( ) .k k k  P x f L a=   Algorithm (2):  Backward: Initialization: (i=L) Recursion: (i=L-1?1) Termination: (i=1)  0( )  for 0.k kb L a k= >  1( ) ( ) ( 1).k l i kl l l  b i e x a b i+= +  1 0( ) ( ) (1).l l l l  P x e x a b=   Having the Forward and Backward algorithms, the  posterior probability that observation xi comes from state k given the emitted sequence x, is:   ( | ) ( ) ( ) / ( )i k kP k x f i b i P x? = =             (2)  where P(x) can be obtained by the Termination step in the Forward or Backward calculation as shown in  Algorithm (2). Posterior probability of symbol i coming from a state in the specific set is:   ( | ) ( | ) ( )i  k  G i x P k x g k?= =                            (3)   where g(k) is a function defined on the states, in our vCGH, g(k)=1 for k {H+, L+, M+}, g(k)=-1 for k {H- , L-, M-} and g(k)=0 for the rest k. Then we concatenate the most probable state at each position to form the entire CGH state path.

2.4   Smoothing Algorithm   Since our conventional CGH data has the resolution on cytobands while GEP data is on the basis of genes, a smoothing algorithm was also performed on gene- level gain/loss to determine cytoband-level gain/loss.

Basically, we used a multinomial model to estimate the likelihood of a cytoband being a gain or loss as a whole, based on the genes (or probe sets) located in that cytoband, as we presented previously in [19].

3. Data Description   The data used in this study included 64 mantle cell lymphoma (MCL) cases, provided by the LLMPP consortium [20]. All the cases have been GEP and CGH performed.

3.1. Gene Expression Experiments   The GEP data on the 64 MCLs was performed  using Affymetrix HG-U133 Plus 2 arrays (Santa Clara, CA). The HG-U133 Plus 2.0? Array analyzes the expression level of over 54,000 RNA transcripts and variants with 22 different probe sets per transcript and 1.3 million data points in all representing about 20,000 genes?the majority of the predicted 20,000 to 25,000 human genes are covered. The GEP experiments, including isolation of RNA, hybridization and image processing, were performed strictly according to the protocol set up by Affymetrix. The Affymetrix GCOS software was utilized for management, sharing and analysis of expression data generated. BRB-ArrayTool [21] was used to import and normalize (global median normalization) the expression data, and to obtain the functional annotations of probe sets. Increased and decreased 1.5-fold change was used as the threshold to determine high and low expression of a gene in tumors as compared to the median expression of all tumor cases in the cohort.

3.2. CGH Experiments  The CGH data on the 64 MCLs was performed  using a commercially available CGH kit provided by Vysis (Downers Grove, IL), which detects genomic alterations on the basis of cytobands (Mb) [22]. The summary of the CGH procedure is as follows: extract DNA from the tumor tissue of interest and lable the DNA with SpectrumGreenTM dUPT; hybridize SpectrumGreen-labeled specimen DNA and SpectrumRedTM reference DNA in the presence of COT-1 blocking DNA to denatured normal metaphase cells for 48 to 72 hours; wash slides to remove nonspecifically bound DNA. Hybridizations and digital image acquisition, processing, and evaluation were performed on a Cytovision Ultra workstation (Applied Imaging, Sunderland, UK) [23]. The result of the hybridization and subsequent CGH analysis is a ratio profile of two fluorescent signals whose relative strengths indicate gain or loss of DNA material within chromosomal sub regions. As suggested by the company, signal ratios greater than 1.25 or less than 0.75 were considered as chromosomal gains or losses, respectively. Due to CGH technical limitation, small- sized chromosomes including chromosomes 19, 20, 21, 22 and Y didn?t have precise detection calls of gains or losses and hence were excluded from the CGH study.

Due to lack of gender data, chromosome X was also excluded from this study. All CGH data are available at http://www.ncbi.nlm.nih.gov/sky.

4. Results   We applied the vCGH model to the MCL dataset as described in section 3. The prediction performance was evaluated using leave-one-out cross validation as shown in Figure 3. The entire MCL dataset was split into training and testing sets. In the training set, coupled GEP and CGH data were used for model parameter estimation; in the testing set, GEP data was used for virtual CGH prediction while the corresponding actual CGH data was used for validation. The splitting process was repeated until all the tumor cases were traversed in the testing. It is noticeable that each time we leave one case in testing no matter whether this testing case exhibited gain or loss on a chromosome or not.

Testing Cases  CGH data GEP data CGH data  Parameter Estimation  vCGH Prediction  vCGH Validation  Training Cases  GEP data      Cases   Sum Cross Validation  Re-splitting  vCGH performance  Testing Cases  CGH data GEP data CGH data  Parameter Estimation  vCGH Prediction  vCGH Validation  Training Cases  GEP data      Cases   Sum Cross Validation  Re-splitting  vCGH performance    Figure 3. The flowchart of performing and evaluating vCGH model using MCL cases.

Questioning whether a sophisticated model is  necessary or not in predicting DNA copy number alterations from GEP data, we also manufactured two other simple and obvious methods to compare with vCGH? one is GEP raw observations and the other is GEP after smoothing. Another reason that we made those two methods is that, to our knowledge, there is no such prediction tool existing yet to compare with vCGH. By GEP raw observations, we mean that the gain and loss status for individual genes are obtained from a direct correlation to the expression level without performing any further analysis, that is, a greater than 1.5-fold increase in gene expression corresponding to a gain, a greater than 1.5-fold decrease to a loss, and any number in between to a normal region. By GEP after smoothing, we mean applying the smoothing algorithm described in 2.4 on GEP raw observations, which is basically a sliding window spanning a certain number of consecutive genes across a chromosome and a LOD likelihood score for the window. The size of the window varied depending on the length of the cytoband scanned. LOD score of 2 was used as the cutoff value. As a notational convention, we denote the methods of GEP raw observation as GEP and GEP after smoothing as sGEP in the rest of the paper.

4.1. Prediction on Gene Level   The prediction performance was evaluated using  leave-one-out cross validation by comparing the predicted gain and loss status of each gene with the ?gold? standard from the actual CGH experiments. We compared sensitivity and specificity of GEP, sGEP and vCGH (both Viterbi and Posterior decoding) methods in predicting gain and loss regions in Figure 4 and 5, respectively. Each box represents one chromosome.

We use different colors to represent the performance of different methods: light green for GEP, dart green for sGEP, red cross for vCGH Viterbi decoding, and the rest colors for a series of vCGH Posterior decoding with posterior probabilities equal to 0.5, 0.6, 0.7, 0.8 and 0.9. The ideal performance point should be at the upper right corner where both sensitivity and specificity are good. From Figure 4 and 5, it is obvious that vCGH outperforms GEP and sGEP methods by lying at the most upper right corner for most chromosomes. GEP method laid at the most lower left corner, indicating a bad agreement with the experimental CGH. sGEP, which is a simple processing of GEP data, lying in the middle, improved the prediction a little bit. But vCGH, both Viterbi and Posterior decoding, has the best sensitivity and specificity values, benefiting from the model refinement and the training process.

As expected, under the vCGH Posterior decoding, increasing the posterior probability (from p=0.5 to p=0.9) resulted in an increased specificity and a decreased sensitivity in predicting gains or losses. We noticed that the vCGH prediction were good for the majority of chromosomes, but not good for some chromosomes, such as chr1, chr6, chr9, chr10 and chr13 for gains and chr4, chr5, chr15 and chr18 for losses. The reason for this is due to infrequent aberration of these chromosomes being observed in MCL. For example, in the experimental CGH, of the 64 MCL cases, only one, three, one, two and one case were observed with gains on chr1, chr6, chr9, chr10 and chr13, respectively, and two, one, one and two cases with losses on chr4, chr5, chr15 and chr18, respectively.

In general, in predicting gain, sensitivity was improved from 40% in GEP to 45% in sGEP and to 75% in vCGH, and specificity from 70% in GEP to 85% in sGEP and to 90% in vCGH (Figure 4); in predicting loss, sensitivity from 30% in GEP to 50% in sGEP and to 60% in vCGH, and specificity from 80% in GEP to 90% in sGEP and vCGH (Figure 5); in predicting normal, sensitivity from 40% in GEP to 60% in sGEP and to 70% in vCGH, and specificity from 45% in GEP to 50% in sGEP to 65% in vCGH (figure was not shown).

4.2. Prediction on Cytoband Level   We showed the predicted gains and losses on the  cytoband level by vCGH Viterbi decoding (Figure 6 left) and Posteriori decoding (Figure 6 right). The losses were plotted on the left side and gains on the right side. In Posterior decoding, we also plotted a range of posterior probability values, from p=0.5 to p=0.9, denoted by different colors in the figure. Under  Posterior decoding we found that the number of predicted gains/losses increases as posterior probability decreases, but the shapes of the plots were in concordant trend. Comparing the shapes of Viterbi and Posterior, a good agreement was also observed.

The cytoband-level vCGH prediction was also compared with CGH ?gold? standard using Fisher?s exact test. In Fisher?s exact, the sums of the gains and losses from vCGH Viterbi and CGH were compared on a band-by-band basis. Among a total of 290 cytobands, only 6 cytobands in the two groups exhibits nonrandom association if p-value <5% (Table 1). This holds true for the comparison between vCGH Posterior and CGH as well. This indicates the prediction from vCGH are similar to CGH for most of the cytobands.

Table 1. Cytobands exhibiting different patterns of gains and losses between CGH and vCGH using Fisher?s exact test (p<0.05).

band p-value band p-value 3p24 0.019 6p25 0.011 3p26 0.031 6p24 0.011 3p25 0.031 8p23 0.032     5. Conclusions   In this paper, we proposed a novel computational approach, vCGH, for the prediction of CGH profiles (DNA copy number alterations) from GEP profiles in tumor cases. vCGH was constructed on a hidden Markov model, which was trained in the light of the paired GEP and CGH data on the same set of a sufficient number of tumor cases, and then applied to new cases of the same tumor type for the prediction of chromosomal gains and losses based on their GEP data. Viterbi and Posterior algorithms were used as the decoding methods in the vCGH model. The prediction performance was tested using leave-one-out cross validation on 64 MCL cases. The results showed that vCGH predictor reached 70% sensitivity and 90% specificity in predicting both chromosomal gains and losses, which is significantly better than simple processing methods of GEP raw observations.

In this study, we used MCL as an application, but, vCGH is a general tool which can be applied to other types of tumors. In addition, our model does not only highlight DNA copy number alterative regions but also served as an integrative tool cross-linking genomic and transcriptiomic data. In conclusion, vCGH is a powerful tool that may significantly enhance the data analysis of GEP and the detection of genetic abnormalities in cancer research.

Figure 4. Sensitivity and specificity in predicting gains by GEP, sGEP, vCGH Viterbi and Posterior decoding with p=0.5, 0.6, 0.7, 0.8 and 0.9, respectively.

Figure 5. Sensitivity and specificity in predicting losses by GEP, sGEP, vCGH Viterbi and Posterior decoding with p=0.5, 0.6, 0.7, 0.8 and 0.9, respectively.

Figure 6. Chromosomal gains and losses predicted by vCGH Viterbi (left) and vCGH Posterior (right). In Posterior decoding, different probability cutoff values p=0.5, 0.6, 0.7, 0.8 and 0.9 are shown by different colors. Left-sided bars of each figure correspond to losses whereas right-sided bars indicate gains. X-axis represents the frequency of the alterations. In Y-axis, cytobands are ordered along the chromosome from pter to qter.

