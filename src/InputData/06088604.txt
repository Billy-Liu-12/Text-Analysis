A Human Motion Recognition using Data Mining for a Service Robot

Abstract? This research presents a system that provides useful information by data mining. The system collects human motions data to process data mining, and uses the result to detect human intention, and then provide service. The system includes three parts: the input devices part which is to collect data, the server part which is to analyze and process the data mining, and the client part which is to provide a service. The way that set the devices on human to get motions always makes human feel uncomfortable. Therefore, the authors consider using the cameras to obtain human movements rather than setting the devices on human. The collected data can be classed by the server part to find the motion data. The motion data are analyzed to process data mining and find the relation between motion and intention. The result of mining can be applied to provide information on the mobile device or to use for human- robot interaction. The system shows the possibility of applying the data mining to human motion to detect human intention.

And the results can offer useful data to assist robotic system or show useful information to user.



I. INTRODUCTION  Nowadays, the meaning of robotic technology means not only visible robots; it also means systems or devices that help to collect, analyze, and show information to support people.

Such systems are powerful, but they can only help people who are familiar with how to use their application systems.

For people who are unfamiliar with electronic devices or application systems, the systems are still hard to understand and difficult to use. In other words, the benefit of robotic systems is limited to the user?s knowledge of the application system. This problem has caught the notice of developers and made them think about how to develop a user-friendly system, one that is not only user-friendly but one that can truly understand human beings. The concept of ?a system that can truly understand human beings? means a system that is able to collect, process, analyze, and show information to users by the easiest and most direct way.

The increase in the number of data collection methods and the progress that has been made in Internet usage has helped to make it easy to find information very easily, but the speed in which data increases, which is the reason that data has become hard to arrange, has also become the reason that making data has become very complicated. The complicated data is hard to apply in application systems. This problem has made developers start to think about how to obtain the data that is needed for the systems. For acquiring useful information, the methods to collect or process data have also  Y. Ho, Y. Kawagishi, E. Shimokawara, and T. Yamaguchi are with Faculty of System Design, Division of Information and Communica- tions Systems, Tokyo Metropolitan University, 6-6 Asahigaoka, Hino, Tokyo, Japan { ho-yihsin, kawagishi-yoshihiro, eri } @sd.tmu.ac.jp, yamachan@tmu.ac.jp  become a discussion topic. Furthermore, many of the data collection methods, which involve human action, are used to acquire human movement data by physically setting devices upon a human beings body. This is a very uncomfortable and troublesome way of obtaining data.

In this paper, the authors consider the idea of offering the user an intelligent system. We apply use vision-based motion recognition to obtain the characteristic motions of human beings. The reason we chose vision-based motion recognition is that it involves no need to set devices on the human body.

The process of such systems is as follows: First, the system captures the image of a user and obtains movement data. The data includes the coordination of the user?s head and hands and the time the images were captured. We use the term ?Time logs? to refer to the human motions along with the time the motions happened.

We applied data mining to find the relation between serious ?Time logs? data and human intentions. In this way, we were able from the data to acquire knowledge that rep- resents a possible human intention recognition method. The knowledge obtained from Time logs can help to understand human intentions and help the system to distinguish between user?s situations and intentions. This enables us to apply the results obtained on human intentions to a system to offer appropriate service to users.



II. RELATED WORK  The speed at which data is increasing is as fast as that at which technology is progressing. The amount of data that enriches databases helps in the obtaining of information, but it also causes information overflow. This has spurred researchers to start investigating the idea of data mining.

Data mining is a series of processing steps. It can be approximately broken down into three parts: collecting data, analyzing data, and finding knowledge. Every one of these parts is important. The collected data virtually determines what kind of knowledge may be found, so the data collection methods and the data chosen are important. The data analysis helps to arrange and analyze data to find knowledge. It commonly includes four methods: classification, clustering, regression, and association rule. The knowledge-finding step is accomplished through decision making, data cleansing, visualization, and other processes used to find hidden knowl- edge. Humans also allow their judgments to be added to the knowledge-finding step to acquire knowledge. The function execution sequence and methods can be changed by users.

Recently, data mining has been used in many application systems. For example, Fukuda et al. applied the data mining  Tallinn University of Technology Tallinn, Estonia, June 20-23, 2011     technique in a cooking support system [1], [2]. The technique allows the system to infer the next human action by using sensors to take account of past human behaviors. The system then provides advice on the next action to be taken, advice which is obtained from collected statistical data and provided to users by monitor or voice. Morita, Sato, and Doi [3] used a wristwatch-type sensor to achieve human action recognition using acceleration and physiological data. To enable recognition of actions, they extracted features from the sensor data and constructed a decision tree using the features. Palafox and Hashimoto [4] used sensors that were attached to a human beings body to obtain human motions, and used clustering with a particle swarm optimization (PSO) optimization algorithm to read and classify user object activ- ity. C.-C. Tseng and D. Cook [5] used wireless accelerometer sensors to collect and transform the data, and then identify age categories and detect possible changes in the individual?s health condition. X. Wang et al. [6] proposed a method for clustering multivariate time series. They proved that clustering may be a valuable addition to the tools available for human motion pattern recognition research, but with the research target of recognizing human motion rather than detecting human intentions. Most of these techniques need to place sensors on the human body to acquire human motion data or to obtain object usage frequency. Furthermore, the mining results of these research works are advancing to recognize human motion or predict the next action, but not to find out human intentions. In this paper, we present a system in which devices do not need to be placed on the human body, a system that uses a series of human motions as data to determine human intentions.



III. SYSTEM OUTLINE  A. Motion detection  To obtain information about human beings and offer them suitable service, the first step is to recognize human motions.

Towards this end, we use image processing software to capture human motion data. The image processing software uses the RGB (R: Red, G: Green, B: Blue) color space as the basic color space to trace objects. It analyzes the colors of the original images captured by the camera, calculates the coordination of the object?s weight points and the coordinates obtained from the color pixels, and then saves the points and coordinates data into a database.

By repeating the process of calculating the weight points and coordinates, after a period of time the image processing software can use the data to ascertain the trajectory and trace the object. The software can also be applied to capture human motions. It also includes a background subtraction technique to improve the capability of detecting moving objects with complex backgrounds. After processing by the image processing software, the coordination data of a human body can be applied to judge the motion data. The data can then be classified and calculated so as to serve as preprocessed data for data mining. The Fig. 1 shows the experiment view of the image processing software.

Fig. 1. The experiments view of image processing software  B. Data mining  In this section, we discuss data analysis methods for processing data mining with human motions in intelligent systems.

The basic data analysis methods in the data mining process involve four types: classification, clustering, regression, and association rule. Classification is the method used to gener- alize the data and merge it into groups. Clustering removes the defined groupings and allows the data to classify itself according to similar items, i.e., the method is used to discover the group or the data structure itself. Regression focuses on the function of the data. It is used to model or analyze by means of data variables, i.e., it analyzes the relationship between two or more independent variables. The association rule attempts to find relationships between data. It shows attribute value conditions that occur frequently together in a given dataset.

The target in a system is to find the relation between human motions and then to determine the human intentions.

Our approach is to save the motion data including the capture time, the amount and the series of characteristic motions, and the human motions with the time they were obtained as Time logs. In the next section, we will describe how we used data mining to find the results of human intentions to apply them to the system.



IV. EXPERIMENT  To put the system into practice, we designed an imaginary clothing store as the experiment environment. Fig 2 shows the actual furnishing in the environment. In using the system, we wish to use data mining to find persons who are interested in the merchandise but don?t want to buy anything, and then offer the service to encourage their desire to purchase the merchandise. The system recognizes human motions from images captured by stereo cameras set within the clothing store, processes the motion data to find the relationship between human motion and human intention, and then pro- vides the information to customers. In this experiment, we focus on the customer?s motions. The system captures human movements by processing the images obtained from the stereo cameras. It then classes and analyzes the movements to find human motions. In a real clothing store, the store staff always uses several customer motions, such as their stopping in front of a display or taking the merchandise in hand, to guess the customer?s shopping desires. In the imaginary store, we use the same thought pattern to decide     which human motions to obtain. Accordingly, we decided to take four motions into consideration (taking, walking, stopping, and turning in front of the merchandise) as the characteristic motions. Since the major portion of human movement data can be classified into these four characteristic motions, it enables the step of classifying human movements to be performed simply.

Fig. 2. The image of experiment environment  Prior to the experiment, we prepared a space in which there was one table and one item of merchandise (see Fig. 2). We randomly invited seven university students (six males and one female) to participate as subjects and asked each of them individually to go to the imaginary store and perform one of three roles: 1) A customer who is interested in but has no intention of buying the merchandise, 2) a customer who has no interest at all in the merchandise, and 3) a customer who decides to buy the merchandise in the experiment environment. They were asked to do this so that we could collect their motions. We captured their movements on camera, used them to collect motion data, and used the data to analyze and process data mining to ascertain their intentions.

One thing that should be noted in particular is that although the system?s experiment data was not based on a real store or on natural human actions, the idea of the experiment was to prove that the system has the ability to recognize human intentions through the use of data mining, not to focus on ascertaining actual human shopping desires in a clothing store.

A. Action recognition  As described in Section 3, we use image processing software to capture motion data. We allow the system to automatically analyze the colors of original images, calculate the weight points and the coordinates by using color pixels, and then save the point and coordinate data into a database.

Because there are so many colors in the images and because this research focuses on human movement, the system was set up to process only skin colors to lighten the system weight.

After repeating the process of calculating the weight points and coordinates over a period of time, the system can obtain close coordination between the data of human being?s faces and their hands. In other words, the system can use the data to trace and find the trajectories of face and hands.

The system also includes a background subtraction technique to improve its capability of detecting moving objects or objects set against a complex background. After the image processing step, the coordination data of human beings can be applied to find the movement data. The system can then classify and calculate the data to obtain human motion data.

We next introduce the processes of analysis and classifica- tion of human movement data to obtain human motions. To express this motion analysis mathematically, we define the following values:  The production coordination value is Cp = (xp, yp, zp).

The production coordination value is Ch = (xh, yh, zh), the left hand coordination value is Cl = (xl, yl, zl) and the right hand coordination value is Cr = (xr, yr, zr). The head movement vector is shown as Vh.

Vh(t) = Ch(x,y)(t) ? Ch(x,y)(t?1) (1)  The difference between the head movement vectors is Dh.

Dh(t) = Vh(t) ? Vh(t?1) (2)  The angle between the head movement vectors is Ah.

Ah(x,y)(t) = tan ?1(Vh(t) ? Vh(t?1)) (3)  The rules of characteristic motion recognition are as follows:  1) Take: If the coordination of the right or left hand is at the position of merchandise every 0.1 seconds, it can be judged as Take.

IF Cl(t)orCr(t) = Cp(t) THEN Take  2) Turn: If the variable of the angle between the parallel plane and the ground coordination of the head (the movement vector) is over the threshold value every 0.1 seconds, it will trigger a condition judgment. If the next four angle values of the movement vector are under the threshold value, a Turn judgment is made. The trajectory of a Turn example is shown in Fig. 3. The following is the logic operation: 1. Trigger:  IF Ah(t) > Athreshold THEN enter the condition judgment  2. Condition judgment:  IF m?  i=0  f(t? i) = m  f(t? i) = {x|(Ah(x,y)h(t?i) > Athreshold) = 1 : 0, t > i}  THEN Turn  3) Walk: If the vector-valued variable between the parallel plane and the ground coordination of the head (the movement value) is over the threshold value every 0.1 seconds, it will trigger a condition judgment. If the next four movement vectors are over the threshold value, a Walk judgment is made. The trajectory of a Walk example is shown in Fig. 3.

The logic operation is as follows: 1. Trigger:  IF Dh(t) > Dthreshold of walk THEN enter the condition judgment  2. Condition judgment  IF m?  i=0  d(t? i) = m  d(t? i) = {x|(Dh(t?i) > Dthreshold of walk) = 1 : 0, t > i}  THEN Walk  4) Stop: If the vector-valued variable between the parallel plane and the ground coordination of the head (the movement value) is under the threshold value every 0.1 seconds, it will trigger a condition judgment. If the next four movement vectors are under the threshold value, a Stop judgment is made. The logic operation is as follows: 1. Trigger:  IF Dh(t) < Dthreshold of walk THEN enter the condition judgment  2. Condition judgment  IF m?  i=0  d(t? i) = m  d(t? i) = {x|(Dh(t?i) < Dthreshold of walk) = 1 : 0, t > i}  THEN Stop  The data captured by stereo cameras may include noise.

The results of the previously described rules may include noise that affects the motion, which is obtained by, and even affects, the results for recognizing human intentions.

To solve the problems in areas that are difficult to dis- tinguish, we designed a range of values to handle these problems. To do this, we designated a condition we named Don?t care (represented as an asterisk *). Before creating a result according to the rule, if the vector-valued variable for judging Walk and Stop is under the threshold value, the data will be processed by a trigger. The function for judging Stop and Walk will then operate on the four vectors created after the trigger process. The trajectory of Don?t care is illustrated in Fig. 3.

After the system recognizes the characteristic motion by applying the rules, it can obtain more stable motion from Walk. However, two problems, i.e., camera accuracy and noise emanating from a head shaking in the Stop state, may still give rise to the problem of false recognition. Therefore, the ambiguous operation * , which lies between Walk and Stop and functions rather like a noise, is applied to identify and separate conditions such as ?Walking but very near stop? and ?Complete stop?. Thus, after analyzing the movement data, the system will recognize five motions: Walk, Stop, Take, Turn and Don?t care (*).

Fig. 3. The rule of reorganization human characteristic action  B. The data analysis and finding knowledge  Human beings can get a lot of further hidden information from a data mining environment in which data is obtained by input devices. In the system we have been describing, we want to use data mining to find persons who are interested in merchandise but do not intend to buy it, and then offer service to encourage them to purchase the merchandise.

Because data mining is a series of process steps, every step in data mining is important. In particular, the methods in the data analysis step are more complex than those in the other steps. Thus, it is easy for data mining to become very time consuming. But if the methods can be applied appropriately, the data analysis step will be very helpful in finding valuable information. The obtained data is the amount of motion, the motion capture time, and the motion sequence. We considered applying different motion data to different methods in an attempt to try to find some different knowledge.

Firstly, we used clustering analysis as an estimation method. Clustering analysis is a way to determine the natural class of a set. It can be applied to many fields, including machine learning, data mining, pattern recognition, image analysis, information retrieval, and bioinformatics. We clus- tered data by a k-means cluster method and judged the results obtained.

We therefore separated the subject into two sets. We performed two analyses, in the first of which the x-axis is the amount of Take and the y-axis is the amount of Walk (Fig.4? (1)) and in the second of which the x-axis is the amount of Take and the y-axis is the amount of Stop and Don?t care (Fig.4 ?(2)). The data obtained shows that under the same amount of Don?t Care and Stop or Walk motions, if the amount of Take motions is increased, it means the customer may be interested in the merchandise but doesn?t want to buy it. In other words, the results show that when the customer is interested in the merchandise but doesn?t want to buy it, the amount of Take motions will increase.

Those data shows the finding knowledge that if the take motion is under general amount, and the frequency of Don?t care, Walk and Stop is increased, then it may represent     Fig. 4. Results of using clustering to analyze human motion data. The authors normalized the data, set the amount of Take motions as the x- axis and the amount of other motions as the y-axis, and then carried out clustering analysis.

that the customer shows the intention of interesting but don?t want to buy anything. However the general amount of take motion is different from every case. And the knowledge is imprecisely what still includes some exception. The average value of the inaccuracy which is clustered to the wrong group is 8%.

Secondly, we applied the association rule to the motion data. This rule shows attribute value conditions that fre- quently occur together in a given dataset. It aims to find interesting associated and correlated relationships among large data item sets [6]. The data relating human motions with time (i.e., ?Time logs?) is shown in Fig. 5.

We used the following mathematical expression to cal- culate confidence and support values to do the association analysis.

Support = Tunion(x) ? consequent(y)  Number of Transaction (4)  Confidence = Tunion(x) ? consequent(y)  Transaction number of antecedent(x) (5)  Tunion : Transaction number of union of antecedent  Fig. 5. The example of Time log data. The data collect a serious human action and action time as the analysis data  We focused on ?Take? motions as the main factor of human motions and used the motions to extract the association rule.

The results shown in Table I summarize the knowledge we obtained. Tables I shows the results of knowledge discovery: the confidence of customers who are interested in but do not wish to buy merchandise is 100%, while that of customers who are either not interested in the merchandise or have decided not to buy it are both 0%.

The data mining methods described above obtain various knowledge from motion data. The knowledge about human motions that can be found differs slightly for every method.

Clustering analysis finds that when customers are inter- ested in merchandise but do not want to buy it, their Take motions will increase. The association rule shows that when customers perform Stop and Take motions three consecutive times, Take and Stop/Don?t care motions 19 consecutive times, or Stop and Don?t care motions 10 consecutive times, it shows that the customer is interested in the merchandise but does not wish to buy it. We used clustering analysis to find regularly increasing or decreasing data trends. We also used the association rule to show very precise values. The results we obtained are not entirely sufficient in terms of pre- cision, but the analysis methods we used demonstrated that human motions can be applied to detect human intentions.

We also found that the association rule can provide more precise results than other methods. In other words, from our experiments we demonstrated that it is possible to detect human intentions by mining human motions. Human motions usually are not based on any strong logic principles but rather reflect hidden patterns. It has been said that a method that can help to ascertain these patterns and does not need to rely on any strong logic conditions will make it possible to obtain valid mining results. Thus, we conclude that the association rule is a very suitable means of obtaining good results from human motions. We also believe that if we can collect more human motion and intention data, the accuracy of our data mining results will increase.

TABLE I  KNOWLEDGE OBTAINED FROM ASSOCIATION RULE Action of customer who is interesting to but don?t want to buy (%)  Decided to buy (%) Not Interesting at all (%)  Confidence Support Confidence Confidence Stop and Take x 1 78 33 22 0 Stop and Take x 2 78 33 0 0 Stop and Take x 3 100 33 0 0 Stop and Take x 4 100 33 0 0 Stop and Take x 5 86 28 0 0 Sum of Take (except walk) = 15 86 28 14 0 Sum of Take (except walk) = 16 83 23 17 0 Sum of Take (except walk) = 17 83 23 17 0 Sum of Take (except walk) = 18 83 23 17 0 Sum of Take (except walk) = 19 100 23 0 0 Sum of Take (except walk) = 20 100 23 0 0 Stop and * x 8 75 14 25 0 Stop and * x 9 75 14 25 0 Stop and * x 10 100 14 0 0 Stop and * x 11 100 9 0 0 Stop and * x 12 100 4 0 0 Stop and * x 13 100 4 0 0

V. FUTURE WORKS ? EXTENDED APPLICATION  The knowledge we discovered on predicting shopping behavior can be applied to robot systems and used to perform experiments within the context of relevant environments. The system we developed can use robots or mobile devices to provide customers with services that will help encourage their shopping desire, but only when it detects characteristic motions on their part showing that they are interested in the merchandise but do not wish to buy it. That is, after discovering knowledge on how to predict shopping behavior, a visible type robot can provide services to customers to encourage their purchasing motivation only when it detects motion indicating that the customer is interested in the merchandise but does not intend to buy it.

The aim of our future work will be improving the system to enable it to collect three-dimensional space data from the surrounding environment, as well as to collect data from specific human motions along with motion time to improve its ability to recognize human intentions. To achieve this, the system will need to intake and process information on such factors as the vision of human beings, the way human beings move their bodies and heads, and how much time they take to perform these motions. Such information will make it possible to build ?space intelligence? and to ascertain the relationship between the motions that human beings make and the environment surrounding them.

Moreover, improving the system in this way will enable the development of robots or mobile phones that can directly provide service to human beings and also collect their reactions as data for use in further carrying out the data mining process.

The data mining using human motion also can be applied in many systems, for example, the system for elderly people.

The system can collect data from the room where the elder lives. The authors design a room for collection and assist the elder?s life; the room is called intelligent room. Intelligent room installs many sensors, cameras and robots. The sensors and cameras are to collect the direct data of elder?s amount of using furniture and electronic devices, or the motion condition in the room. The robot is for assistant elder with both physical and spirit life. The data type that collects from intelligent room is Time log data. After collection the data,  the authors can apply the data mining to help remain the elder?s physical and spirit situation, and then to prevent ills of elderly people.

Moreover, we are planning improve the developed wheel- chair [7] using proposed action recognition and mining technique. Wheel-chair might navigate a user in a store, a museum, and so on considering with the user?s preference.



VI. CONCLUSION  Robotic systems of today have to incorporate many kinds of technologies, including those related to data, transmission, and display objects.

With this background in mind, in this paper we presented a system that uses the data mining technique to detect human intentions by collecting, processing, and analyzing human motions. The system collects data by attempting to obtain human motions in a way that reflects the actual experiences of human beings. The mining method it uses operates without any need to physically place equipment on the bodies of experimental subjects.

