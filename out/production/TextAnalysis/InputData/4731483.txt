An anomaly intrusion detection algorithm based on minimal diversity   semi-supervised clustering

Abstract?An anomaly intrusion detection algorithm based on minimal diversity is proposed. It can deal with mixed attributes, so overcomes the deficiencies of most unsupervised learning methods. Based on the minimal diversity measurement, we use a small amount of marked data to guide clustering. When detecting new records, we calculate its diversity from the existing clusters to determine its category.

This algorithm can detect known and unknown types of attacks, and update detection model automatically. The simulative experiment indicates that the new algorithm improves the performance of detecting attacks, and it is more effective than K-means intrusion detection method.

Keywords-minimal diversity; intrusion detection; clustering; semi-supervised.



I.  INTRODUCTION With the rapid development of network technology and  scale, network attacks have also increased. Intrusion detection technology, as the second security barrier after firewall, has become a hot research of network security in recent years. Its goal is to detect the actions of any damage or attempt to harm the confidentiality, integrity or availability. Speaking from the detection strategy, intrusion detection can be divided into two categories: misuse detection and anomaly detection. Misuse detection establishes a pattern library according to the known attacks, and then matches the happened actions to detect attacks. It can only detect known attacks, so has a low false positive rate and a high false negative rate; Anomaly detection judges intrusions based on the user's behavior or use of resources.

Although  having a high false positive rate,  it can detect unknown attacks. Therefore anomaly detection has become a hot and important research[1].

In recent years, data mining technology has been widely applied in intrusion detection, People mine interesting knowledge from audit data or stream data, and then use knowledge to detect new or known attacks. The main methods are: association rule, sequence mode, classification, clustering and outlier detection. Anomaly detection usually adopts unsupervised clustering method[2]. Clustering technology divides data into groups, making them have the maximal similarity within group and the minimal similarity between groups. Compared with supervised learning, it overcomes the deficiencies of needing marked data, but its accuracy is lower than supervised intrusion detection   algorithm. In practical application, a small number of original data may be marked, then using these marked data to guide clustering receives widespread concerns[3], and can get better effect than unsupervised learning. In anomaly intrusion detection, we establish models in accordance with known and normal actions, and judge intrusions by estimating whether network actions deviate from the normal action model. This shows that the majority of training data is marked.In order to overcome the deficiencies of unsupervised learning, and combine with the marked characteristics of intrusion data. This article puts forward an anomaly intrusion detection algorithm based on minimal diversity semi-supervised clustering. This algorithm first guides the initialization of threshold according to marked data; Then clusters based on the minimal diversity, and identifies normal and abnormal clusters; In the end, giving a new network action, we calculate its diversity between the two clusters to determine whether it intrudes.



II. ANOMALY INTRUSION DETECTION ALGORITHM BASED ON MINIMAL DIVERSITY SEMI-SUPERVISED  A. Basic ideas Most traditional clustering methods can only deal with  numerical or classification attributes, But in actual application, the attributes of an object may be mixed.

Therefore clustering algorithm which can handle mixed attributes develops into a new direction; The original network data is massive, it is very difficult to mark all data, but most or a small number of them are marked, so we can consider improving the accuracy of detection algorithm by using the marked data; At the same time, network data is dynamic and will produce new types of attacks, so we need a method to detect unknown types of attacks automatically. In order to solve the above problems, this article proposes an anomaly intrusion detection algorithm based on minimal diversity semi-supervised clustering .It can handle mixed attributes, firstly uses a small amount of marked data which have binding nature to guide the clustering process, then detects known or unknown types of attacks based on detection  models.

B.  Related concepts[4] Definition 1: On the assumption that there is a set O, it  contains n objects and m attributes. The first mc attributes  2008 International Symposium on Computer Science and Computational Technology  DOI 10.1109/ISCSCT.2008.171     are numerical attributes, and the following mn attributes are classification attributes, apparently m = mc + mn, then: DC represents the classification attributes set of set O; DN represents the numerical attributes set of set O; DC i  (i=1,2,?,mc) represents  No.i classification attribute of set O; DN i  (i=1,2,?,mn) represents No.i  numerical attribute of set O; DC i .V represents the value collection of No.i  classification attribute; DC i .V k represents No.k value of No.i classification attribute; Max(DN i )represents the maximum value of No.i numerical attribute; Min(DN i )represents the minimum value of No.i numerical attribute; O i .DC j  (i=1,2,?,n;j=1,2,?,mc; O i .DC j ?DC j .V?  represents No.j classification attribute?s value of object O i ;  O i . DN j ?i=1,2,?,n;j=1,2,?,mn;Min(DN j )?O i .DN j  ?Max(DN j )),represents No.j numerical attribute?s value of  object O i .

As for the diversity between objects and the diversity  between object and cluster, we make the following definitions:  Definition 2: Supposing object O 1 ,O 2 ?O, then the  diversity between O1 and O 2 in classification attribute  DC i is :  dif_pp(O1 . DC i , O 2 . DC i )=  ? ? ?  = ?  ii  ii  DCODCO DCODCO ..,0 ..,1     The diversity between O1 and O 2 in numerical attribute  DN i  is :  dif_pp(O1 . DN i , O 2 . DN i )=  )()( |..| 21  ii  ii  DNMinDNMax DNODNO  ? ?   Definition 3: Supposing object O 1 ,O 2 ?O, then the  diversity between O1  and O 2 is:  dif_oo(O1 ,O 2 )=  m  DNODNOppdifDCODCOppdif mc  i  mn  i iiii? ?  = = +  1 1   21 ).,.(_).,.(_   Definition 4: Supposing object O i ? O. It has mn  numerical attributes DN j  (j=1,2,?,mn),their value is  O i . DN j ; It has mc classification attributes DC j  (j=1,2,?, mc),their value is O i .DC j ; Supposing C is a  cluster during clustering, then the diversity between  O i and C is the average diversity  in all objects of C, that is: dif_oc(O i ,C)=  ? ?  + CO  zi z  OOoodif ),(_ |C|  ))1|C(|ln(ln   C. Algorithm introduction  The anomaly intrusion algorithm proposed by us is mainly divided into two phases:  The first phase (establish detection model). Based on the marked training data?we firstly  randomly select two data objects which represent normal and abnormal types as initial clusters; Secondly calculate the diversity between each object and clusters (by definition 4); Then add the object to the minimal diversity cluster, until all objects have been clustered;Finally most normal objects are gathered into a large cluster. Small part of intrusions are gathered into a separate and small cluster. At this time, we will get two clusters: normal and abnormal cluster.

The second phase (intrusion detection). Firstly we calculate the diversity between new data object and the existing clusters. If the cluster which has the minimal diversity from the object, is an abnormal cluster, then the object's action is abnormal and add it into abnormal cluster; Otherwise, the object's action is normal and add it into normal cluster.

The specific algorithm is described as follows: ? choose two objects(representing normal and  abnormal clusters )as initial clusters; ? read a new object, calculate its diversity from the  two clusters; ? add the object to the cluster which has the minimal  diversity; ? repeat step two and three, until all objects have been  disposed; ? mark clusters; ? giving a new record, calculate its diversity from the  two clusters; ? give the object the same marker of the cluster which  has the minimal diversity, and add it to corresponding cluster.

The algorithm?s flow chart is shown in figure 1.

D. Algorithm analysis The algorithm?s time complexity depends on the size(n)  of data sets , the number of attributes( m ) and the number of classification attribute?s value, but has no relation  with the calculation of diversity. In the course of clustering, the number of final cluster is two. If m attributes contains mc     classification attributes and mn numerical attributes, then the time complexity is:  O(T)= O(2n?? =  + mc  i i mnVDCNum  ))).(  Num(DC i .V) represents the number of No.i classification attribute?s values. Because the number of classification attribute?s values is limited, so Num(DC i .V) is limited. Therefor the time complexity nears O (n). It has a linear relationship with the size of data sets.

Figure 1.   The flow chart of this algorithm

III. EXPERIMENT ANALYSIS  A. Experiment data The experimental data comes from KDD CUP1999[5]  data sets. It is a test set widely used in the field of intrusion detection. It includes about 4.9 million simulative attack  records and 22 types of attacks. We select thirteen important attributes (including eleven numerical attributes and two classification attributes). They are duration, src-bytes, dst- bytes, urgent, count, srv-count, same-srv-rate, dst-host-count, dst-host-srv-count, dst-host-same-srv-rate, dst-host-same-src- port-rate, protocol-type and service.

Since the entire data set is too large, we select two training subsets (S1, S2) and two testing subsets (T1, T2) to test the algorithm?s performance. Each subset includes 10,000 records (normal records account for 99%). Testing subsets contain types of attacks not included in training subsets, so we can test the algorithm?s ability to find unknown types of attacks.

B. Performance evaluation In order to evaluate the performance of our algorithm, we  consider three indexes, they are: detection rate (DR), false positive rate (FR) and unknown types of attacks detection rate (UR).

DR=the number of detected attacks?the whole attacks FR=the number of normal records detected as attacks?  the total number of normal records UR=the number of detected unknown types of attacks?  all unknown types of attacks  C.  Experiment results and analysis The simulative experiment results and contrast are shown  in table 1.

TABLE I.  SIMULATIVE  EXPERIMENT  RESULTS  AND  CONTRAST  Training set-- Testing set  Our algorithm K-means (k=2,r=0.75)  DR (%)  FR (%)  UR (%)  DR (%)  FR (%)  S1--T1 79 0.93 55.46 67 4.83 S1--T2 80 1.47 47.67 63 6.59 S2--T1 85 1.67 57.05 72 4.24 S2--T2 83 1.08 51.32 75 3.71  Average value 81.75 1.29 52.88 69.25 4.84 From the experiment results, we can see that: out  algorithm?s average detection rate reaches 81.75  percent, and average false positive rate is only 1.29 percent; Although the average unknown types of attacks detection rate is not too satisfactory, only reaches 52.88 percent,  this still shows that the algorithm has the ability to find unknown types of attacks. Compared with K-means clustering method, our algorithm?s detection rate is higher than k-means?, and false positive rate is lower than k-means?. This indicates that the anomaly intrusion detection algorithm proposed in this article is reasonable and effective.



IV. CONCLUSION Most traditional clustering methods can only deal with  numerical or classification attributes, and they are easily affected by threshold. This article, based on minimal diversity semi-supervised clustering, proposes an anomaly intrusion detection algorithm. This algorithm uses semi- supervised diversity clustering to detect attacks. It can deal     with mixed attributes. Most importantly, it can detect unknown and known types of attacks. When finding new types of attacks, the detection model will be updated automatically. The simulative experiment indicates that the new algorithm improves the performance of detecting attacks, and it is more effective than K-means intrusion detection method.

