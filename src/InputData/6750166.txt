A comparison of major issues for the development of forensics in cloud computing

Abstract?Cloud computing has become an increasingly im- portant resource in recent years, with the provision of easy to use on demand resources attracting many users. The way the cloud delivers its services brings with it some problem areas such as security, and in particular the ability to look into these problems in digital forensic investigations. In this paper we look at a number of important areas in the area of cloud forensics.

We look at the stakeholders, the possible designs which may aid cloud forensics, and the big issues in the area ? many being big data issues concerning the recording, storage and acquisition of data. We provide a comparison between how the designs will perform with regard to these issues, and look at how the competing demands of stakeholders on these issues will require a balance in order for the development of cloud forensics.



I. INTRODUCTION  The use of cloud computing has increased enormously in recent years, with its popularity still growing today. Cloud computing has enabled users to reduce their IT costs, and allowed them to scale their IT resources up and down as required, on demand. In non-cloud environments, any prob- lems could be easily investigated thanks to easy access to physical machines. When necessary, evidence could also be seized for the purposes of (possible) criminal investigations.

The emergence of the cloud has changed the way in which investigations can take place, creating a problem for the digital forensics community. The virtual machines (VMs) in use in the cloud share hardware resources with other VMs, allowing cloud providers to exploit economies of scale to offer cheap services but creating problems of isolating evidence. The VMs are run from data centres with the data stored there backed up in other locations, crossing multiple jurisdictions ? another headache for evidence acquisition.

The Oxford English Dictionary defines forensics as an applied science ?pertaining to, connected with, or used in courts of law? [1]. The purpose of forensics is to help with the process of law, and to do this by using established techniques for the acquisition, investigation, and presentation of evidence, and its subsequent use in a court. Digital forensics is the application of this process to computing environments, with its use in the cloud known as cloud forensics. The defini- tion provides an indication of the inter-disciplinary nature of the digital forensics process, which has been developed in conjunction with the judicial and legal fields. Through this process, judicial proceedings are able to have confidence in any evidence used from a digital forensics investigation. This  period of development of forensics in non-cloud systems has coincided with a rise in the use of the cloud, providing big challenges for cloud users who need investigators to look into possible crimes or security breaches. With these challenges, developments for the process of forensics in the cloud will need the input of the whole inter-disciplinary community.

Varying sources suggest different steps necessary for a digital forensics investigation, depending on the level of detail they wish to include [2][3]. We present a simplified model comprising of four stages:  ? Identification: Identification of machine(s) suspected of being involved in a crime and a request to seize the evidence.

? Collection: The collection of evidence, including preservation of evidence (such as hashing the data) in order to verify its integrity later on.

? Examination: The use of scientific justification to establish the facts from the most plausible scenarios from the evidence, within the constraints of legislation.

? Reporting: Objective presentation of the conclusion of the investigator, for possible use in a court of law.

The use of cloud computing has created problems in each of these steps, since problems in any individual stage will create a domino effect, with difficulties for any later stages in the process. Problems with collection of evidence, for example, could create a justification for its subsequent questioning in a courtroom in the reporting phase. Identifying an instance/instances, and even the collection of evidence itself may not be a straightforward task, especially due to the various ways in which cloud services are offered.

These delivery methods include: Software-as-a-Service (SaaS), in which applications or software are offered for use; Platform-as-as-Service (PaaS), in which platforms for devel- opment are offered, with the language execution requirements; and Infrastructure-as-a-Service (IaaS), in which the user is able to control the entire hosting environment. With the different levels of access offered for users in these environments, the forensics process will need to consider the best approaches for the each of these delivery models too.

Even in the most open delivery model of IaaS, a terminated instance of a VM is traditionally deleted immediately, with the      user unable to access the disk image for retrieval. Other im- portant data such as network logs, a traditionally useful source of information, are not easy to come by with cloud providers reluctant to provide any information about the operations of their data centres. This means that requesting such evidence will usually need to involve a legal request, and will usually be very time consuming ? a big problem for investigations with time constraints.

Forensics investigations use evidence from any sources containing evidence, but OS logs and network logs, VM disk images, and volatile state data are the most commonly used.

As developments are made for cloud forensics, there will need to be a reappraisal of the way in which information containing these sources can be acquired. The traditional method of seizing evidence after the fact can no longer be allowed to remain as a default setting. The cloud would become an ideal environment for criminals to operate in if there were no chance of evidence being preserved. Instead it is likely that more information will be required to be recorded at run time, such as the OS logs which are normally retained within the VM disk. The issues following such methods of collection would cover a variety of concerns, not just technical issues but social issues such as privacy too. From a big data perspective, the recording of this information will involve an overhead for performance and networking. This data will also need to be stored somwhere, and acquired through the network, all important problems to be solved. Any new developments will also need to consider the inter-disciplinary nature of cloud forensics, in order to ensure that they are compatible with the accepted standards which have been developed over the years.

Our aim in this work is to look at how the development of cloud forensics will be affected by the big issues in this area.

Other work looking at the major issues in the area of cloud forensics has tended to concentrate upon the big problems in the field [4][5]. We believe that our work is the first to provide a comparison of these issues, and to look at the importance of the need to balance the competing demands of the many stakeholders involved. Our motivation is due to the lack of development in this area, with a view to providing a discussion about how the different issues could affect any work, and possibly push research in particular directions.

Although the legal and judicial fields are important aspects of digital forensics, our work here concentrates mainly on the computer science aspect. We look at how some of the forensic issues are affected by the various possible techni- cal implementations. We therefore think carefully about the question of evidence integrity, for example, but mainly from the technical question of how to achieve it. We nevertheless note that the inter-disciplinary nature of digital forensics is an important part of its development and will be crucial to helping to develop the future processes for cloud investigations, just as it has been important in the development of forensics in non-cloud systems. Also, whilst there are some developments which might be able to be applied on open source cloud systems such as OpenStack [6], we cannot risk ignoring the most popular cloud vendors, which are unlikely to change their closed nature any time soon. For this reason, our work has to consider implementations on closed delivery model too.

Our paper is structured in the following way: We provide an introduction to the area of cloud forensics in Section I,  and cover the major stakeholders involved in the development of cloud forensics in Section II. We cover details of the various issues which may affect the development of tools and processes in Section III, and the possible designs through which tools may be implemented in Section IV. We provide a comparisons of issues with designs, and with stakeholders in Section V, discuss other related work in Section VI, and provide a conclusion in Section VII.



II. STAKEHOLDERS  This section provides an examination of the various stake- holders who will be involved in the development of cloud forensics. The stakeholders will all play important roles in the way in which the tools and processes of the future are shaped, whether due to their demands or due to the roles that they will play in balancing the issues in question through any powers they might have.

A. Users  Cloud users, along with the cloud providers, are the two main players in the market for cloud services. Cloud users demand specific services, and the quality of those services.

A lot of detail is abstracted away from them, and although this may be acceptable to many users, there are also many organisations who need to be wary of government or industry regulations regarding data and its hosting. Without the ability to accurately investigate security breaches, some users will be concerned that they may be breaking laws which are intended to prevent valuable data being lost. For this reason, cloud providers may lose out by abstracting away some of the detail of virtual machines.

Overall however, users? main concerns are likely to be with issues such as privacy and overhead (both operational and network). They will want to maintain given levels of quality in their service which have made the cloud so attractive to use.

The loss of these features could lead to users choosing to use non-cloud options.

B. Cloud providers  Cloud service providers (CSPs) are motivated by profit, and aim to offer an attractive product and price for the market they are operating in. With many competing providers operating in the market, any moves attracting bad publicity for a particular provider could have a negative effect on their market share.

This is why providers will be reluctant to anger their users by, for example, invading their privacy. With cloud providers based in many different jurisdictions, some countries could pass laws with a negative impact on cloud providers based in their borders, allowing rival providers to take advantage of the situation. For this reason, cloud providers are unlikely to be happy with any attempt to impose requirements on them. Even requiring cloud providers to retain data will impose additional energy costs, with energy costs a large part of the cost of running data centres.

As long as cloud providers are able to make a profit, they will continue to provide their services to users. They will want the market of customers to be as large as possible, without any being put off by concerns about privacy or overhead.

The problem for providers comes from the interests of other      stakeholders, such as government, who may alter things to suit their own agenda, something which may not suit the interests of the providers.

C. Government  One of the aims of governments is to try and reduce crime.

The difficulty of applying forensic techniques to the cloud has made it a more appealing environment in which to commit computer crimes. In order to make it less appealing, and to help law enforcement in the cloud, governments will need to consider introducing legislation which requires investigators to be able to retrieve evidence upon request. The nature of investigators access, and the kind of data required to be provided, are the kinds of details which will need to be discussed. The various stakeholders themselves are likely to use whatever means they can to lobby government towards their own interests. However any regulation impacts on the balance between the issues discussed here, it is likely to make one or more of the stakeholders unhappy.

The various stakeholders are each likely to have different levels of power to lobby governments in the countries around the world. It is much harder to know where governmental motivations in this matter may lie. Although some governments may consider the economic benefit of cloud computing to be too important to jeopardise by any interference, other countries which have high profile unsolved crimes committed in the cloud may be swayed towards requiring cloud providers to keep detailed records and provide these records to investigators as soon as possible.

D. Law enforcement  Law enforcement and forensics investigators use available evidence, within the guidelines given by the law, to try to produce an account of what occurred during a crime. Their interest in forensic tools in the cloud is in being able to seize and access at least as much evidence as they would be able to do in a non-cloud setting. To this end, they are much less likely to care about issues such as overheads, privacy, or cost.

Other than access to evidence, and the quality of evidence, law enforcement is unlikely to have any strong feelings about any of the other issues (unless a crime itself involves breaking a law regarding something like privacy). Their main aim will be to demonstrate that any newly developed forensic tools and practices are compatible with the established guidelines and are acceptable to a court of law.



III. ISSUES  The issues summarised below are all factors which are likely to make a difference to attempts to record information which could be of use to an investigator. The issues themselves span different areas of concern for different stakeholders in the cloud, with the balance between these issues likely to play a major part in how forensics for the cloud will be developed.

A. Privacy  Privacy of data is considered an important element of security, with data privacy in the cloud another one of the important security considerations for cloud services. Although  hypervisors provide effective privacy between running VMs, problems with attackers using side channel attacks after co- locating their VM with a target?s VM have been discovered [7]. At the same time, techniques which are able to monitor the internal state of VMs from the hypervisor, known as VM introspection, also exist [9]. Gathering data about VM activities would be important information of an investigator, but there are clear issues with how this data will be gathered, especially if they are performed without the knowledge or permission of the VM user. Cloud service providers and hypervisor developers are unlikely to want to advertise tools which violate privacy, as they would project the wrong kind of image about their firms.

The most likely way to counter those concerns is for the data gathering mechanisms to be optional for the user, and to be based inside the VM. Anything based outside could be considered a violation of privacy, and could be used against the VM owner. Of course, no VM user with malicious intent would opt for this, again demonstrating the way in which trying to balance out the issues can result in advantages favouring particular stakeholders in these scenarios. The likelihood is that to catch criminals, some element of data gathering without the permission of the user will need to take place, on whatever level is deemed most appropriate.

B. Performance Overhead  Cloud forensics is more likely to be performed on dead systems than live ones. On some cloud services, VM instances are deleted as soon as they are terminated, creating headaches for dead investigations in such scenarios. For this reason, the data which forensics examiners will need to investigate may need to be collected at run time, and stored elsewhere. In order to do this, operating systems or hypervisors will need to create additional programs which collect the relevant material and send it for storage somewhere else, but will need to be wary of the additional overhead this will create. Although system logs are regularly redirected in networks as a way of keeping centralised records, there are no standards amongst logging mechanisms, meaning that simply redirecting standard system logging may not be the most desirable way to solve this problem, with a possible need to create new system loggers expressly for the purpose of cloud computing. The benefits and costs will need to be considered, especially in terms of how the system overhead could be affected.

Adding in any new mechanisms risks slowing down run- ning VMs. Loggers placed within VMs are likely to be based on user?s preferences, but those based outside such as on a hypervisor could affect running services and therefore the provider?s ability to live up to service level agreement guarantees.

The need to provide integrity means that there is likely to be use of techniques such as encryption, key servers, and hashing. These too are likely to add even more workload to the other work already being done. This demonstrates the way in which the issues have an interdependence with each other, with the balance between the issues having possible effects on the overall forensics process.

C. Network Overhead  In addition to performance overhead, a big concern for many of the stakeholders is network overhead. Those users      who already consume a lot of network traffic will be concerned about using any other tools which could add a bigger burden to their network overhead. Cloud providers too would prefer to keep network overhead to a minimum. Network overheads could be reduced if tools are developed ensuring that data to be sent over a network remains on site in a data centre, although this kind of approach would need to be developed with cloud providers. Depending on what is being recorded, the network traffic could be kept to a minimum. However in this age of big data, there is still likely to be an impact on network traffic by any mechanism which is using networks to send information about running OS or network activities.

D. Integrity  As cloud services are provided from a place without any physical access to its users, the traditional method of seizing evidence is too difficult to rely on. The chain of custody, an important record of ownership of data in forensics investigations, will need to be adapted to consider not just those who have had physical possession of the data. The chain of custody of evidence is there for both sides to use in order to try to prove their innocence or guilt in court. As a result, being able to prove that data has remained the same from the moment of seizure on the cloud will be an important question to be solved. Integrity is the common method for proving this in computing, with any data being used as evidence requiring some verification that it has not been modified, either from its moment of creation or from the moment it has been acquired.

Integrity can add an extra difficulty for cloud forensics, as it requires the investigator to place additional trust in another authority (such as the cloud provider, or an external actor providing additional services) to verify the data in question.

Placing trust in any authority inevitably leads to the question of infinite regress, and of the reasons behind placing trust in that authority. Unless a precedent has been set in which the authority providing verification of integrity is trusted by the courts, it will be difficult to justify using them as a source for integrity verification.

E. Granularity  Granularity in data refers to the level at which data is being recorded, with more detail down to finer levels of granularity providing more detail for investigators to use. The granularity of the data being recorded will depend on what it is being recorded for, and where it is being recorded from. For forensic investigations, the level of detail can be important, but can also overwhelm investigators with too much data ? although there are many tools available which provide effective monitoring and analysis of data produced within these environments.

However finer levels of granularity can also come with higher levels of performance overhead, affecting the running of active machines.

Different mechanisms will also be able to provide varying levels of data granularity. Mechanisms operating from within VMs will be likely to offer much a much better balance be- tween granularity and overhead than those from the hypervisor level, another example of the need to find the best balance between the various issues.

F. Standalone  Many cloud services are now composed of distributed components. This approach can help to reduce relying entirely on one end point which could run the risk of compromise, or of the risk of a single point of failure. For example, distributed services commonly use key servers as a method of helping to provide irrevocable digital signatures to sign files with.

Although such approaches can be useful, they again add the need to put trust in more authorities, creating difficulties for the use of records such as chain of custody.

One of the most important reasons to keep these tools as standalone is the fact that there was no need to have additional tools for forensics in non-cloud systems. The difficulty of conducting forensic investigations in the cloud has meant that additional tools are now needed, but many users may be unaware of their importance to security. For widespread use therefore, the most useful approach would be for any mechanism to be standalone and easy to install/sign up for rather than the difficulty involved in setting up more complex systems. Less technical cloud users may feel that they would rather avoid devoting more resources to operations which previously were a routine job for operating systems, unaware of the dangers of compromise in the cloud. In the event that they can satisfy the other issues listed here, standalone services are likely to be the preferred option of cloud users and forensic investigators.



IV. POSSIBLE DESIGNS  This section is concerned with the possible designs with which data could be collected or retained for use in investiga- tions later on. Since very little has so far been developed in this area, we are influenced by current practice and directions from other research, with the suggestions conceptual in nature.

We look at how the issues mentioned in the previous section could affect the designs.

A. In-VM activity collection, stored with image  Operating system logs are routinely diverted in computing networks, as a way of ensuring collection of material on dedicated storage machines. Using the same principle, open source hypervisors could be adapted to be able to receive files from running VMs (but not to be able to send files back). Recorded OS level activity could be encrypted using a security protocol such as GPG [8], before being redirected to the hypervisor. This would satisfy many of the identified issues associated with overhead. This data could then be stored with a separate file associated with the VM image or for the VM user. By keeping the data separate from the VM, it also avoids the possibility of giving a malicious user any chance of making changes to the redirected information.

This method would satisfy many of the issues, as it would cause minimal overhead (if using the standard OS loggers or something similar), and allow the chance to encrypt the data.

The major deficiency is its concern only with OS level activity, with forensic investigations sometimes requiring other data from network logs and volatile storage too. But combining this approach with other mechanisms collecting other material could be one way in which to gather the relevant material whilst addressing this deficiency.

B. In-VM activity collection, sent to secure server  This method is almost exactly the same as the previous one discussed, but instead of sending the material to the hypervisor, the material would be sent over the internet to a dedicated server/VM secure enough to store it. In contrast to the currently used redirection methods, a method guaranteeing delivery to the storage would be needed, which could be done by hashing each message being sent from one point to the other to ensure correct messages are being passed. The negatives here would be the addition to network traffic, especially for machines which generate large amounts of activity such as log traffic.

As a way of balancing the different issues, this may be one of the strongest options since it would allow users to make their own choice on where they would like to store the gathered data, and reduce the reliance on the cloud providers.

C. In-Hyp (VM activity)  Hypervisors work by abstracting away the underlying hard- ware in order to allow VMs to act as if they are communicating directly with the physical machines they are running on. There is potential to exploit this abstraction by peeking into the operations within running VMs. VM introspection has been presented as a technique which allows a hypervisor to detect malware within a VM, although there is a limit to how much of the VM operations the hypervisor is able to understand [9].

Any operations to collect data from the hypervisor however would be controversial, and much more so if utilised without a user?s permission. As part of the need to balance the many issues discussed, cloud providers may be unlikely to use this technique at all, particularly as any service provided in this way would look like a clear violation of their customer?s privacy.

There would also be a problem of performance overhead, with these techniques requiring much more work than those operations performed within VMs.

D. In-Hyp (VM + Network activity)  Organisations with internal networks will log network traffic to aid intrusion detection for any possible later investi- gations. Cloud data centres will also log data about network traffic and security violations, although at present they are reluctant to give this information out upon request. There may be opportunities to implement the retrieval of some of this data from open source cloud providers such as OpenStack, but this may prove more difficult with the more popular offerings such as EC2 [10] and Google [11]. Nevertheless one of the best ways in which cloud forensics can be aided is through the use of this data, and if the demand for it grows enough cloud providers may decide that it would be worth offering.

This option would still suffer from the problems of privacy violation, but by providing the additional data on network ac- tivity, might be considered to be worthwhile to some customers just for that additional information.

E. Forensics-as-a-Service (3rd party)  Forensics as a service is one of the latest ideas in the series of services which could be offered as-a-service. Forensics-as- a-service would mean trusting a service to collect relevant data by installing their software on a VM, and putting one?s  trust in this service to collect enough data. Although similar to diverting the in-VM option of recording activity to send over the network, this option would collect specific information required by the service, based on their requirements for later investigation.

This option has major issues, slowing down the network and quite probably adding overhead to the performance of the running VM, with the required need to trust the service provider a particular problem for any investigator to demon- strate to a court.

F. Forensics-as-a-Service (CSP)  Cloud providers themselves could provide Forensics-as-a- Service to their customers as an additional service on top of the cloud services the customer buys. The advantages with this approach would be to add network logs and have no reliance on third parties. There would also be a smaller impact on network traffic, with the extra traffic staying inside the data centre. The providers could also create a system with a smaller performance overhead, with a more ideal system to work on their machines.



V. COMPARISON  This section looks at a comparison of the different issues with stakeholders in the first subsection, and with the possible designs in the second.

A. Comparison ? Stakeholders and Issues  For the first comparison table, we look at the different ways in which the stakeholders view at the issues of cloud forensics (Table I). We take a position of the stakeholders being either for or against an issue, or sometimes having no preference.

Issue Users CSPs Gov Law Privacy 3 - - 7 Small Performance Overhead 3 3 - - Small Network Overhead 3 3 - - Integrity 3 - 3 3 Standalone 3 - - 3 Granularity 3 - - 3 Network logs 3 7 - 3  TABLE I. A COMPARISON OF THE ISSUES FOR EACH STAKEHOLDERS.

In this comparison, we can see that there is an indifference on the part of the cloud provider to a number of things wanted by the users and law enforcement. We can also see that privacy mainly concerns users, but not law enforcement. Importantly however, are the issues of low overhead on which the users and cloud providers agree, but which could be overruled by a government with new legislation. Governments cannot all be placed in a single block, as many could be for or against a particular issue, or change their minds based on who is in power. But with the way in which the issues are divided here, stakeholders indifference could have a big impact on the way in which cloud forensics will be able to develop.

B. Comparison ? Designs and Issues  For our second comparison, we look at how the issues would affect the conceptual designs (Table II). There is a difficulty of generalising how the designs would perform with      regard to each issue, so we acknowledge that some designs could be able to solve specific issues that we have not assigned to them. The column labels for the Table are the same as the letter labels for each subsection, i.e. Privacy is listed as A.

Issue A B C D E F Privacy 3 3 7 7 7 7 Small Performance Overhead 3 3 7 7 7 7 Small Network Overhead 3 7 3 3 7 7 Integrity 3 3 3 3 3 3 Standalone 3 3 7 7 7 7 Granularity 3 3 7 7 3 3 Network logs 7 7 7 3 7 3  TABLE II. A COMPARISON OF THE ISSUES FOR EACH DESIGN.

Looking at the comparison, each possible design will have shortcomings. We can see that those designs set within the operating system are far better with regard to privacy and overhead issues, but cannot provide any network logs, a high priority for investigators. Hypervisor based solutions have problems with regard to privacy, overhead, and granularity issues. This suggests that hypervisor based solutions alone will have many shortcomings for a forensics investigation.

Those designs offered as a service, would have issues with regard to overheads, and might cause problems for any forensics process in terms of trusting the provider of the service. The issue of the network logs is one that can only be solved with the help of the cloud providers handing over the data. At the moment, there is no certainty of this.

Comparing the issues across the possible designs shows us the importance of the need to find a balance between these issues, without which it will be difficult to provide an adequate environment for cloud forensics to progress.



VI. RELATED WORK  As cloud forensics is not a very old topic, a lot of the work has been analytical in nature with very little implementation.

Birk and Wegener discuss the important technical issues in providing forensics in the cloud, and discuss a number of possible solutions [4]. Reilly et al. cover the pros and cons of applying the forensics process to the cloud, discussing how integrity and data acquisition provide some of the biggest challenges, particularly with regard to current guidelines on the handling of evidence [5]. Ruan et al. cover the legal and judicial issues in cloud forensics as well as the computing issues, and define cloud forensics as a subset of network forensics [12]. Our work also considers all of these issues, but concentrates on comparing how the need to balance them will affect the development of cloud forensics.

Dykstra and Sherman look at the acquisition capabilities of current forensic tools in the cloud [13]. Marty proposes a logging framework for the cloud, concentrating on SaaS, to ensure that information necessary for forensics investigations is collected [14]. Zawoad et al. look at the problem of VM logs in cloud environments and introduce Secure-Logging-as- a-Service (SecLaaS), which stores VM logs and protects their integrity [15]. Our work tries to consider approaches from all angles which will make a difference to forensics investigations, and to compare what issues they would be able to help to solve.



VII. CONCLUSION  We have provided an analysis and comparison of some of the major issues which could affect the development of forensics for cloud computing, from the view of the major stakeholders and possible designs for forensics tools.

We find it likely that in order to satisfy the shortcomings of any potential designs, any developments will need to make use of multiple components in order to satisfy the demands of forensics investigators. However we also believe that it is difficult to know how cloud forensics will develop based on the varying demands of some of the stakeholders. We have also seen how the different perspectives of stakeholders, and the problems from the various possible designs, mean that any developments for cloud forensics will need to carefully consider how to best balance these issues against each other.

ACKNOWLEDGEMENT  The authors wish to thank BT for their help with the development of this work, and the reviewers for their suggested corrections. Mustafa Aydin is sponsored by BT and is an EPSRC funded EngD student, and part of LSCITS.

