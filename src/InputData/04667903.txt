Vehicle Multi-sensor Information Optimization Based on Federal Fusion  Valuation*

Abstract   Dead Reckoning system (DR) and Global Positioning System (GPS), which consist of integrated navigation system, are two important positioning methods in the intelligent vehicle navigation. The information from the different sensors of vehicle GPS and DR integrated navigation system needs to be fused in order to implement the optimal evaluation of global states, because of the different measurements and their noise characteristics. The federal Kalman filter is designed to fuse GPS and DR information. Two local filters process GPS and DR data respectively, and the main filter is responsible for data fusion and reset to the local filters. The information fusion based on federal filter solves some key problems such as system unavailability, big accumulative errors with GPS or DR alone, and it makes the system?s global evaluation optimal. The simulation results show that the positioning accuracy and the credibility of the vehicle integrated navigation are much higher than that when GPS or DR is used alone.

Key words: Information optimization, Fusion, Federal filter, Credibility, Positioning accuracy   1. Introduction   Researchers have attached more and more importance to the Intelligent Transportation System (ITS), of which many advanced sensor techniques, electronics, information and system engineering are integrated[1]. The real-time, high precision positioning of vehicles is an important branch of ITS. Global Positioning System (GPS) is applied widely because it can provide navigation and timing information quickly in all weather. However, GPS signals usually interrupt when the vehicles are sheltered from buildings, bridges, channels, etc, and it results to navigation  information unavailability. On the other hand, Dead Reckoning (DR) is an another widely used positioning technique because of its low cost, however, it cannot be used solely for long time due to its big accumulative errors[2]. Currently, the integrated system combining GPS sensor with DR sensor is employed in the vehicle navigation. Consequently, the problems such as system unavailability, big accumulative errors with GPS alone or DR alone can be solved effectively. In addition, the vehicle positioning accuracy is improved greatly.

The information from GPS and DR sensors needs to be fused, because the measurements and noise characteristics of GPS and DR system are significantly different. Generally, there are two main fusion methods including the centralized fusion and the distributed fusion[3]. In the centralized fusion, all sensor measurement information is transmitted to the data center to be processed and fused[4]. Apparently, the outcome of fusion center is optimal because the original measuring data used by fusion center have no information loss. But its requirements for system bandwidth and computation speed are rather high, so it is difficult to be implemented in engineering. On the contrary, the federal filter presented by Carlson is a distributed filter. It can fuse multiple sensors? information to gain the optimal global state evaluation[5], of which the variance up-limit technique and the uniform information distribution rule are adopted. Compared with the centralized fusion, the federal filter has many advantages such as its higher credibility, more convenient information distribution and quicker computation [6].

In this paper, the information of GPS and DR is updated respectively on the basis of uniform state variables, and is fused by the federal filter. The positioning accuracy and credibility of the vehicle navigation system are improved greatly.

DOI    DOI    DOI 10.1109/ICNC.2008.366    DOI 10.1109/ICNC.2008.366     2. Structure of integrated navigation  2.1. System organization   Vehicle GPS/DR integrated navigation system is composed of a GPS system and a DR system. The system organization is given in Fig.1. It shows that the GPS system is composed of all-direction antenna, satellite receiver, interface circuits, filter, and the DR system is composed of rate gyro, odometer, interface circuits and filter.

Fig.1 Organization of vehicle GPS/DR  integrated navigation system  2.2. Structure of federal filter   Both of the GPS and DR systems have a measuring  system independently and capture their respective information. A two-level federal filter is designed to fuse the GPS and DR information, in which the main filter combines GPS and DR local filters. According to the information distribution principle, the federal filter can make the multi-sensor information fused optimally, and the system credibility is better. Ref. [7] demonstrated the fact that the global state evaluation by the federal filtering is as optimal as by the centralized filtering. The information fusion process of the federal filter used by GPS/DR integrated navigation is shown in Fig.2.

Fig.2 Federal filtering structure   Where )(|?  i kkX ,  )( |  ? m kkX  are the state valuation values of  local filters and main filter respectively, )(| i kkP ,  )( | m kkP are  the covariance matrixes of local filters and main filter  respectively, i? represents information distribution coefficient, 2,1=i , and 121 =+ ?? .

3. Local filtering  3.1. System model   Let [ ]T??nene aavvne=X represent the global state variable of the integrated navigation system. Where: e , n , ev , nv , ea , na  are east- position, north-position, east-velocity, north-velocity, east-acceleration and north-acceleration respectively.

?  is gyro?s drift error and ?  is odometer?s calibration coefficient. We using the Singer model[8,9] as the vehicle?s dynamic model, the integrated system model can be expressed to be kWXX +?=+ kkk 1                            (1) Where: state transfer matrix is  [ ]1,,,diag ne Tk e ?????=?  ? ? ?  ?  ?  ? ? ?  ?  ?  ? ++?  =? ?  ?  ?  Te e  Te e  Te e  e e  eTT  ?  ?  ?  ? ??  /)1(10  /)1(1 2  e  ? ? ?  ?  ?  ? ? ?  ?  ?  ? ++?  =? ?  ?  ?  Tn n  Tn n  Tn n  e e  eTT  ?  ?  ?  ? ??  /)1(10  /)1(1 2  n  e? , n? are the correlative frequencies  of east- acceleration and north-acceleration respectively, ??  is the frequency of gyro drift. T is sampling interval and the covariance matrix of process noise is  [ ]222nne2e ,2,2,2diag ][E  ??? ??????? ne  T kkk  QQ  WWQ  =  =  (2) For GPS system, let kk XX =  )1(   be its state variable, its state equation is the same as (1). Its measurement equation is  )1( 1 )1(  )1(  )1( 1 ++++ += kkkk VXHL                          (3)  Where: Tkkk neL ][ 11 )1( 1 +++ =  is GPS measurement vector,  T knkek uuV ][ 1,1,  )1( 1 +++ =  is measurement noise vector, east  position error 1, +keu  and north position error 1, +knu  are respectively ),0(N 2eq  and ),0(N 2nq  Gaussian white noises. The measurement matrix is  ? ?  ? ? ?  ? =+ 00000010  00000001)1( 1kH  The covariance matrix of measurement noise is [ ]22)1( 1)1( 1)1( 1 ,diag])([E neTkkk qq== +++ VVR             (4)  For DR system, let kk XX = )2(  be its state variable,  its state equation is the same as (1). The measurement equation [10] is  Antenna  Vehicle Position  Interface GPS receiver  Filter  Rate gyro  Odometer     Fusion center  Filter Interface  GPS sensor  DR sensor  Local filter 1  Local filter 2    Main filter   Information fusion  )1( |kkP ,  )1( |  ? kkX  kkP |  ?? , kkX |?  kkP |  ?? , kkX |?  )2( |kkP ,  )2( |  ? kkX  kkP |  )( | m kkP  )( |  ? m kkX  kkX |?       ? ? ?  ?  ? ? ?  ? +  ? ? ? ?  ?  ?  ? ? ? ?  ?  ?  +  + +  ?  =  ++=  +  +  +++  + ++  ++++  ++++  1,  1,  1,  1,1  1,  2,  1,1,1,1,  )2(  )2(  )2(  )2( 1 ]1,[  ks  k  knkek  k knke  knkekekn  kkkk  u u  vvT  vv  avav  VkXhL  ?  ?  ?        (5)  Where: Tkkk sL ][ 11 )2( 1 +++ = ? is the measurement vector of  DR system, 1+k?  is the first order Markov process component of the rate gyro. Tkskk uuV ][ 1,1,  )2( 1 +++ = ?  is  measurement noise vector, 1, +ku?  and 1, +ksu  are respectively ),0(N 2?q  and ),0(N 2sq Gaussian white noises. The covariance matrix of measurement noise is  [ ]22)2( 1)2( 1)2( 1 diag])([E sTkkk qqVVR ?== +++               (6)  3.2. GPS local filtering   It shows from (1) and (3) that the GPS system is a  linear model. Using basic Kalman filtering algorithm[11], we calculate  the state evaluation as follows: Step 1    Choose the GPS receiver?s first output as the filter?s initial state variable.

Step 2   Calculate one step prediction mean square error matrix (MSE):  k T  kkkkkkk QPP +??= +++ |1 )1(  |1 )1( |1  Step 3     Calculate filtering gain matrix: 1)1(  )1(  )1(  )1(  )1(  )1( |1  )1( 1 ])([)(  ? +++++++ += k  T kkk  T kkkk RHPHHPK  Step 4     Evaluate state: )?(?? )1(|1  )1(  )1(  )1(  )1( |1  )1( 1 kkkkkkkkkk XHLKXX ++++++ ??+?=  Step 5   Calculate filtering MSE: )1( |1  )1(  )1(  )1( 1 )( kkkkk PHKIP ++++ ?=  Step 6   Return to step 2, continue to calculate.

3.3. DR local filtering   From (1) and (5), it shows that the DR system is a nonlinear model, and basic Kalman filter cannot be used directly[12]. The extended Kalman filter (EKF) is usually used in nonlinear systems. Spread the nonlinear function )( )2( 1  )2( 1 ++ kk Xh  as Taylor series, and the first  component is reserved only:   )2(  )2( |1  )2( 1)2(  |1 ?)2(   )2(  )2(  )2( |1  )2(  )2(  ]?[ )(  ]1,[  ]?[  +++ ++  ++  +++  +? ?  +? +  ?  kkkk kkX  T k  kk  kkkk  VXX X  kXh  XhL (7)  Let  )2( |1  ?)2(  )2(  )2( 1)2(  1 )(  ]1,[  kkX T  k  kk k X  kXh H  ++  ++ + ?  +? =  ? ?  ? ? ?  ? =     HHH HHHH  Where:  1,  1,  1,1,1,1,1,  1,  1,  1,1,  13 )??(  ?????2 )?(  ??  ++  +++++  ++  ++  + +  ? +  = knke  knknkeknke  knke  kekn  vv vaavv  vv va  H ,  1,  1,  1,1,1,1,1,  1,  1,  1,1,  14 )??(  ?????2 )??(  ??  ++  +++++  ++  ++  + ?  + +  = knke  knkeknknke  knke  keke  vv vaavv  vv va  H ,  1,  1,  1, 15 ??  ?  ++  +  + =  knke  kn  vv  v H , 2  1,  1,  1, 16 ??  ?  ++  +  +  ? =  knke  ke  vv  v H ,  1,  1,  1,1  ??  ?  ++  ++  + =  knke  kek  vv  vT H  ? ,  1,  1,  1,1  ??  ?  ++  ++  + =  knke  knk  vv  vT H  ? ,  1,  1,28 ?? ++ += knke vvTH  DR local filter works as follows: Step 1   Calculate one step prediction mean square error matrix (MSE):  k T  kkkkkkk QPP +??= +++ |1 )2(  |1 )2( |1  Step 2    Calculate filtering gain matrix: 1)2(  )2(  )2(  )2(  )2(  )2( |1  )2( 1 ])([)(  ? +++++++ += k  T kkk  T kkkk RHPHHPK  Step 3   Evaluate state: )?(?? )2(|1  )2(  )2(  )2(  )2( |1  )2( 1 kkkkkkkkkk XHLKXX ++++++ ??+?=  Step 4   Calculate filtering MSE: )2( |1  )2(  )2(  )2( 1 )( kkkkk PHKIP ++++ ?=  Step 5   Return to step 1, continue to calculate.

4. Information fusion   The vehicle?s position evaluation data of the GPS  local system and the DR local system are transmitted into the main filter, where they are to be fused.

Design the main filter, of which its information distribution coefficient is 0=m? , namely  0)( 1)(| = ?m  kkP . The main filter itself has no distributed information and no filtering calculation, however, it only fuses the local filters? data. The process of information fusion is given as follows.

4.1. Information distribution   The main filter distributes information to GPS and  DR local filters according to the following rule:  )2,1( ,  ??  1)( |  1)( |  | )(  | = ??  ? ? ?  ==  = ??  i QQPP  XX  ki i  kkki i kk  kk i kk  ??   Where: i?  is the information distribution coefficient.

4.2. Information update  While the main filter has no time update and no  measurement update, the local filters need to be     updated. The time updating of the two local filters is as follows:  )2,1( ??  )()( |  )( |1  )( |  )( |1 =  ??  ? ? ?  +??=  ?=  +  + i QPP  XX i  k T k  i kkk  i kk  i kkk  i kk  The measurement updating of the local filters is as follows:  )2,1( )()(?)(?)(  )()()()( )(  1)(  )(  )( |1  1)( |1  )( 1|1  1)( 1|1  )(  1)(  )(  1)( |1  1)( 1|1  = ??  ? ? ?  +=  +=  + ?  +++ ?  +++ ?  ++  + ?  ++ ?  + ?  ++ i LRHXPXP  HRHPP i  k i  k Ti  k i  kk i  kk i  kk i  kk  i k  i k  Ti k  i kk  i kk   4.3. Information fusion  The main filter fuses the information of GPS and DR local filters as follows:  ( )?? ? ? ?  +=  += ??  ++ ?  ++++  ++ ?  ++++ ?  ++++++  11)2( 1|1  1)1( 1|11|1  )2( 1|1  1)2( 1|1  )1( 1|1  1)1( 1|11|11|1  )()(  ]?)(?)[(?  kkkkkk  kkkkkkkkkkkk  PPP  XPXPPX    5. Simulation and analysis   In order to justify the information fusion algorithm based on federal Kalman filter in vehicle navigation, the semi-physical simulation is designed and performed on the computer with Matlab software.

Suppose the initial velocity of vehicle is 10m/s, and  0.1=? , 0=?? . The initial value of system global state variable is  [ ]T0 1000101000? =X The sample interval is 1s and the simulation time is 500s. Other parameters are shown in Tab. 1.

Tab.1 Parameter Settings e? / n?  e? / n?  ??  eq / nq  ?q  sq 1Hz 0.1m/s2 0.1 Hz 20m 0.10/s 0.5m   GPS and DR positioning data are captured from a  moving vehicle. Assume the detection probability and false probability of GPS receiver are 0.94 and 0.05 respectively, and its state is u1. The detection probability and false probability of DR system are 0.95 and 0.02 respectively, and its state is u2.The main filter selects the optimal fusion rule based on minimum false probability. The detection performance comparison with different poisoning methods is shown in Tab.2.

Tab.2 System Detection Performance  Comparison Both DR  GPS and abnormal  GPS positioning alone  DR positioning alone  GPS/DR integrated positioning  Detection probability 0.0010 0.0570 0.0470 0.8930  False probability 0.9310 0.0196 0.0196 0.0030  It shows from Tab.2 that the detection performance of integrated positioning system is the best when both GPS and DR work normally, which is consistent with the theoretical analysis above.

In our simulations, the vehicle position is evaluated using GPS filtering alone and GPS/DR fusion filtering respectively, in order to justify the information fusion.

The variances of positioning error calculated by the two filtering methods are given in Tab.3. The simulation results are shown in Fig. 3-6.

Tab.3   Positioning Error Variance Comparison  Before filtering  GPS filtering  alone  GPS/DR integrated filtering  East error(m) 24.53 12.69 5.01  North error(m) 24.12 14.79 5.45     Fig. 3   East error with GPS filtering alone     Fig. 4   North error with GPS filtering alone     Fig. 5   East error with GPS/DR integrated  filtering      -50 0              100           200              300             400           500  Ea st  E rr  or (m  )  Time (s)  Before filtering After filtering      -50 0              100           200             300             400           500  Time (s)  N or  th E  rr or  (m ) After filtering Before filtering  0              100            200             300              400           500      -50E as  t E rr  or (m  )  Before filtering After filtering  Time (s)      Fig. 6   North error with GPS/DR integrated  filtering  From Tab.3, it is known that the positioning error  of GPS/DR integrated filtering is reduced by approximate 150% to 180%, compared with GPS filtering alone, so the vehicle positioning accuracy is improved greatly. By further analysis, it is easy to find the following reasons: the main filter provides feedbacks to reset GPS and DR local filters, so the evaluation accuracy of GPS filter and DR filter is improved respectively, and in return, it makes the global state evaluation of the main filter optimal and the vehicle positioning accuracy improved.

From Fig. 3-4, it is easily known that the positioning error near 320s of GPS filtering alone changes greatly. It might have been caused by GPS signal interrupting, so the GPS/DR integrated filtering can avoid effectively the system unlock issue with a GPS alone system, which improves system credibility.

From the above analysis, we can conclude that the vehicle?s position evaluation based on GPS and DR information fusion has some advantages over the system with GPS or DR filtering alone.

6. Conclusion   In summary, combining the GPS system with the low cost DR system, a vehicle integrated navigation system can avoid the system unlock caused by signal interrupt with GPS alone and big accumulated errors caused by gyro drift with DR alone. The federal Kalman filter is employed to fuse GPS and DR information, which makes the system?s global performance optimal. We design and implement the vehicle?s position evaluation based on GPS and DR information fusion, and it has the following advantages: ?GPS system and DR system work independently.

When GPS or DR system breaks down, the broken- down system can be isolated from the main system.

The evaluation of main filter can be calculated by the other filter so that the main system continues to work normally.

?Because the main filter can provide feedbacks to reset the local filters, the evaluation accuracy of GPS filter and DR filter is improved respectively. In return, it makes the global state evaluation of the main filter optimal.

?GPS filter and DR filter calculating in parallel makes the system gain better real-time processing capability.

