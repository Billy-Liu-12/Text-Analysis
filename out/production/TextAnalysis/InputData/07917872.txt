The Comfstat - Automatically sensing thermal  comfort for smart thermostats

Abstract-Current smart thermostats aim to increase the efficiency of heating and cooling systems by adjusting the temper? ature whenever the conditioned zone becomes empty. However, targeting energy savings, these systems often fail to achieve a comfortable thermal environment for the inhabitants. We propose to increase thermal comfort by automatically monitoring the inhabitants' satisfaction with the thermal environment using commodity hardware. To this end we designed the Comfstat infrastructure and publish detailed temperature and heart-rate data of seven users of the system to the community. Using this data we show that thermal comfort can be inferred automatically from a combination of sensor data within 0.5 points on the ASHRAE scale.



I. INTRODUCTION  A vital goal of current building automation systems is to  reduce the energy consumption of heating, ventilation and air  conditioning (HVAC) units. To this end, numerous projects in  research [1], [2], [3] and industry [4], [5] have shown that it  is feasible to build systems and algorithms to autonomously  regulate the temperature in buildings in a "smart" way, for  example based on actual occupancy.

However, non-technical challenges like sensor placement,  uncertainty about the choices made by the system and doubts  regarding achievable savings mean that user acceptance for  such smart thennostats is still quite low [6], [7], [8]. And  even if they show how energy consumption can be reduced,  they often struggle with providing thermal comfort for the  occupants. In fact, to save the maximum amount of energy,  one could simply switch off the HVAC system altogether [9].

The strategy of most modern HVAC systems is to define a  single comfort temperature. The building is then kept at this  temperature throughout the day whenever it is occupied. While  its value may have been obtained from experiments, the fixed  temperature makes no allowances for the individual occupants'  thermal preferences. In this paper, we target this problem by  evaluating techniques to automatically sense thermal comfort  from the occupants' heart rates as well as ubiquitous temper?  ature and humidity sensors.

Thermal comfort has been described by the American  Society of Heating, Refrigerating and Air Conditioning En?  gineers (ASHRAE) as "that condition of mind that expresses  satisfaction with the thermal environment" [10]. As such it is  defined by a combination of environmental as well as personal  factors - including the clothing, health and mental state of the   Wilhelm Kleiminger Dept. of Computer Science  ETH Zurich, Switzerland  Email: wilhelmk@ethz.ch  occupants. Since Ole Fanger first examined these factors in  1970 [11], further research has culminated various standards  such as ASHRAE 55 [10] and ISO 7730 [12].

Following the observations made by Fanger, various re?  searchers have sought to build systems to sense comfort  automatically [13], [14], [15], [16]. As obtaining some of  the parameters which influence thermal comfort (e.g., air  speed and mean radiant temperature) is difficult in real-world  settings, these systems combine sensory input (e.g., infrared  temperature sensors) with user participation (i.e., through  voting on the current comfort level) to enhance the accuracy  of their models. While some of these systems include the  metabolic rate in their calculations, none use available sensors  to sense the heart rate as a proxy for the metabolic rate.

The importance of the metabolic rate for thermal comfort  has recently been re-affirmed by Luo et al. [17]. The authors  have shown that an increase in the metabolic rate is often a  sign for discomfort. We build upon this work and the fact that  the heart and the metabolic rate are closely related [18]. The  Comfstat architecture allows for the collection of heart rate  data from both Android Wear smartwatches and compatible  Bluetooth chest straps. By using a machine learning approach  and combining the heart rate with temperature and humidity  data, we present a system that may deduce comfort automat?  ically from the raw sensor data.

Besides showing that our approach can deduce thennal  comfort with a mean error between 0.06 and 0.36 on the 7-  point ASHRAE scale, we make the following contributions:  ? An infrastructure' to collect sensory data from Android  Wear watches, compatible BLE heart rate monitors, tem?  perature and humidity sensors; as well as an application  for registering ground truth thennal comfort through  voting on both Android and Android Wear devices.

? A thermal comfort data set2 comprised of seven partici?  pants, and including three different experiments.

? A comparison between heart rate data collected on current  smartwatches and dedicated chest straps.

? An overview of the feature space and a detailed analysis  of the performance of two approaches to predict thennal  comfort.

I https://github.comILilianaB/Comfstatinfrastructure 2https://github.comILilianaB/ComfstatDataSet     The goal of this study is to provide a first analysis of  using commodity hardware to automatically sense thermal  comfort. To the best of our knowledge, the resulting data  set, which we make publicly available, is the first of its kind.

Our contributions are thus especially relevant for researchers  interested in exploring the possibilities of using wearable  technology to support thermal comfort prediction.

The outline of this paper is as follows. In Section II we  introduce the main factors influencing thermal comfort and  discuss related work. In Section III we show the components  making up the Comfstat infrastructure. In Section IV we  briefly describe the data set before we explain the feature  extraction and selection in Section V. After we present our  results in Section VI we conclude the paper in Section VII.



II. BACKGROUND  ASHRAE 55 identifies six primary factors (metabolic rate,  clothing level, air temperature, mean radiant temperature3, air  speed and humidity) that influence the occupants' satisfaction  with the thermal environment. Based on climate chamber ex?  periments, the standard provides equations to compute thermal  comfort from these factors.

The metabolic rate thereby plays a crucial role. The  metabolic heat production is determined by the energy balance  of the human body [19]. Thermal balance is obtained when  the heat loss to the environment is equal to the metabolic  rate. The human body normally maintains a core temperature  around 37?C. When the hypothalamus (i.e., the portion of the brain controlling the core temperature) detects any changes in  the surrounding conditions, it sends signals to the rest of the  body to regulate the temperature by sweating or shivering. The  person feels uncomfortable.

Following the 7-point scale first introduced by Fanger, the  ASHRAE standard puts the thermal sensation of an individual  on a scale ranging from +3 (hot) to -3 (cold). A value of 0 thereby indicates thermal neutrality and thus a comfortable  environment. By combining the votes from multiple occu?  pants, Fanger introduced the Predicted Mean Vote (PMV) and  Predicted Percentage Dissatisfied (PPD) metrics. The PMV  indicates the overall (average) satisfaction with the thermal  environment. The PPD on the other hand shows the number  of people who are feeling either too cold or too warm in the  current environment.

a) Systems for sensing comfort: As both PMV and PPD  do not explicitly track individual occupants' thermal comfort  levels, Gao et al. introduced the "Predicted Personal Vote"  model which extends the PMV for individual occupants [13],  [14]. The model allows to achieve different micro-climates  using personal heating and cooling appliances. Similarly to our  approach, Gao et al. measure the temperature near the surface  of the occupants' clothing using an infrared thermometer  directed by a Microsoft Kinect camera. However, for the  metabolic rate they depend on pre-computed tables.

3The average temperature of surfaces like the floor and the walls.

Fig. I. Overview of the main components of the Comfstat sensing infras? tructure.

Other work examines how occupants can dynamically vote  on their current thermal comfort. In [15], Erickson et al. allow  occupants to use their iPhone to vote on the 7-point ASHRAE  scale, periodically. In [16], Lam et al. provide a mobile  application for occupants to express their thermal satisfaction.

We build on these ideas and extend it to smartwatches to gather  ground truth for our Comfstat system.

Only few systems currently attempt to measure the  metabolic rate to assess thermal comfort. Ciabattoni et al.

propose a system very similar to ours, utilizing a Raspberry Pi  to measure environmental parameters like the temperature and  CO2 levels [20]. In addition they use a smartwatch to measure the heart rate and skin temperature. However, while we learn  individual comfort levels using user participation, the authors  depend on fixed equations from ISO 8996 to deduce thermal  comfort from the raw measurements [18].

Revel et al. propose an environmental monitoring system  to monitor the PMV in an environment. However, while  they discuss the importance of using the correct metabolic  rate during the calculation they require the user to input  their clothing level and metabolic rates manually through an  Android device [21].

Abdallah et al. [22] employ an artificial neural network to  link sensor data from wearable devices to thermal comfort.

However, while their work seeks to approximate Fanger's  equations, our model infers thermal comfort directly.



III. SYSTEM DESIGN  Comfstat's goal is to unobtrusively sense users' thermal  comfort levels. We envision it to be installed as part of smart  heating and cooling systems to better regulate setpoint tem?  peratures. To achieve this, Comfstat is built around a mobile  phone application supported by different sensors. Figure 1  shows the three key components of our architecture. Sensors  worn on the body or placed in the room, a smartphone as  sensing hub, and a server for data collection and analysis.

A. Server  As sensing and recording users' metabolic rates can be  considered an intrusion into their privacy, one requirement of  our system is to work standalone inside their home. However,  in order to sense comfort, environmental parameters (e.g.,  air temperature) as well as personal factors (e.g., heart rate  HTTPBLE  ROOM SENSORS  SERVERArmband  OR  Heart Rate BODY SENSORS     : Comfort level * cold 9. cool  .. hot  ? cold  ?? Fig. 2. The mobile applications (left: smartphone, right: smartwatch) collect votes on the 7-point ASHRAE scale.

and thennal comfort votes) have to be combined. We thus  aggregate the data on a local server. To this end we designed a  Web application that allows for the storage and analysis to run  on a low-cost single board system such as the Raspberry Pi.

The Raspberry Pi runs a Apache HTTP Server and a MySQL  database to store all user data for processing.

B. Mobile application on the smartphone  The mobile application serves as the central hub for gath?  ering personal sensory data. It connects via Bluetooth Low  Energy (BLE) to an Android Wear smartwatch and a chest?  worn strap to collect heart rate data. It also obtains humidity  and temperature values from sensors worn by the participants.

All sensory values are quickly accessible to the user through  the application.

The mobile application is realized on a Nexus 5 smartphone  running the Android operating system. It synchronizes its data  with the in-home server every five minutes. To preserve pri?  vacy and battery life, data is only collected and synchronized  when the smartphone is situated within the home. This is  achieved by validating that the user is connected to her home  Wi-Fi.

In addition to the raw sensor values, the application allows  us to collect ground truth thermal comfort data on the 7-  point ASHRAE scale. A companion app on the smartwatch  also allows for quick voting (cf., Figure 2). The data can be  collected at frequencies between 5 and 15 minutes. Note that  the collection of this "ground truth" data is only necessary  for training the system. Once trained, the system should sense  comfort automatically using the sensors introduced in the next  section.

C. Sensors  The goal of Comfstat is to use sensors to automatically sense  the users' comfort levels through a combination of body-worn  and stationary sensors.

a) Heart rate: Heart rate (HR) measurements are a proxy  for the metabolic rate. The metabolic rate is closely linked to  thermal comfort as it determines how much thermal energy  leaves the body [18]. Comfstat offers two modalities to reliably  collect heart rate data.

First, a smartwatch application for the Android Wear operat?  ing system (running on an LG Watch R WIlO), which obtains  heart rate values directly from an optical HR sensor built into  the watch. The data are then transferred via the smartphone  application to the server.

Secondly, heart rates can be collected directly through a  dedicated sensor which implements the Bluetooth profile for  heart rate service advertisement. We use an off-the-shelf Polar  H7 heart rate sensor. As the Polar H7 uses a chest strap to  measure the heart rate, its measurements are more accurate  than those of the smartwatch.

In the following analysis, we will rely mainly on values  from the Polar H7 strap to analyze the feasibility of automati?  cally sensing comfort from the users' heart rates. Section VI-D  gives an indication of the accuracy possible with current wrist?  worn optical sensors.

b) Room temperature sensor: In order to collect the  temperature in the conditioned area we use a DS18B20 tem?  perature sensor connected to a Raspberry Pi. The temperature  is retrieved every five minutes and forwarded to the in-home  server.

c) Armband sensors: Normally, the air temperature  varies slightly throughout the conditioned area (e.g., it will be  slightly warmer near the windows due to the solar radiation).

Therefore we provided users with an armband carrying an  additional DHT22 temperature and humidity sensor. Note that  the close proximity of the sensor to the body of the participant  also means that its reading is likely to be influenced by the  participant's body temperature. We will discuss this further  in Section V when we elaborate on the features used to  automatically deduce comfort.

The sensor is sampled every three seconds by an Adafruit  Feather 32u4 Bluefruit LE board. The sensor data is exposed to  the smartphone through the Bluetooth profile for environmen?  tal sensing. The board is powered by a Lithium Ion Polymer  Battery with 2500 mAh, which allows for approximately five  days of uninterrupted sensing.



IV. THE COMFS TAT DATA SET  The analysis presented in this paper is based on sensor  data collected from seven participants in three controlled  experiments. We refer to this data as the Comfstat data set  and make it available to the research community.

Table I shows the recorded variables and their respective  sampling interval. To achieve a higher accuracy for the HR  measurements, participants were asked to use the Polar heart  rate monitor instead of the smartwatch. Before each exper?  iment, participants were asked to sign a consent form for  volunteer subjects in an ergonomics investigation involving  exposure to hot or cold temperatures. This consent form is  based on the ISO 12894 standard [23].

The preliminary "cold" experiment was carried out with  PI and P2 only. Participants PI, P3, P4, P5, P6 and P7 took part in the main "controlled" temperature experiment. In a  third experiment ("non-sedentary") with PI we assessed the effects of physical exercise on thermal comfort. Table III     TABLE I COLLECTED VARIABLES.

Variable Abbrev. Interv.

Room temperature (0C) room_temp 5 min Temperature (armb.) (0C) ard_temp 3 sec ReI. humidity (armb.) (%) ard_hum 3 sec Heart rate (bpm) hr 1 sec Comfort (7-point scale) comfort 1-5 min  TABLE II PARTICIPANTS' PROFILES.

Participant Gender Age Height Weight  PI female 26 1.65m 62kg P2 male 28 1.80m 66kg P3 female 28 1.59m 55kg P4 female 23 1.61m 67kg P5 male 26 1.72m 77kg P6 female 28 1.64m 65kg P7 female 30 1.63m 63kg  summarizes which participants took part in which experiments.

The following subsections explain each experimental setting.

A. Cold experiment  This preliminary experiment was conducted to test the  Comfstat infrastructure and to measure the participants' re?  sponses to extreme thermal conditions. Two participants, PI and P2 were subjected to low temperatures between 8?C and 14?C while wearing light clothing (i.e., 0.49 clo - 0.76 clo).

The data was collected twice from 9.30 a.m. until 4.00 p.m.

on two separate days. Figure 3 shows the timeline of each  session.

During the preparation phase, participants were situated in a  comfortable environment and explained how to use Comfstat.

Next, the participants were asked to enter a cold (e.g., between  8?C and 14?C) environment for an hour. During this time, the participants were requested to provide feedback through  the mobile application every one to five minutes. After one  hour, the participants returned to their offices and resumed  their normal daily routines (e.g., mainly sedentary activities).

The room temperatures in PI'S office varied from 22?C to 24 ?C, while P2'S office temperature was stable at 22?C. After their respective lunch breaks, the participants resumed their  sedentary activity until 4 p.m.

B. Controlled temperature experiment  Six participants (PI, P3, P4, P5, P6 and P7) took part in the main experiment. Five of the participants are female  and one is male. While the previous experiment served to  measure the subjects' responses to extreme conditions and to  TABLE III EXPERIMENT PARTICIPANTS.

Experiment Participant  Cold PI, P2 Controlled PI. P3, P4, P5, P6, P7 Non-sedentary PI   8- 14? C 22-24?C 22-25?C -... - --... - --... -  % * ? ? ? ? ,25min I 60mm 120min I 60mm d 120min Preparation Cold Indoor activity Lunch brea Indoor activity Fig. 3. Timeline of the "cold" temperature experiment.

23? C 27? C- 29? C 23 ? C  17?C - 18?C -... - ... -... - ...

% -& * ? , 10min I 20min 20min 20mln 20min Preparation Neutral Warm Neutral Cold Fig. 4. Timeline of the "controlled" temperature experiment.

test the system, the goal of this experiment was to measure  the subjects' responses in more natural settings. For this  purpose, participants were exposed to three different thermal  environments: (i) warm (27?C to 29?C), (ii) neutral (23?C), and (iii) cold (17 ?C to 18?C).

The main goal of this experiment is to analyze the sub?  jects' body responses to temperature changes. To achieve the  different thermal environments, three rooms were conditioned  to the warm, neutral, and cold settings, respectively. Figure 4  shows the timeline of the experiment for each participant. The  participants were exposed to each temperature setting for 30  minutes. In total, each experimental session lasted for 90 min?  utes. During the experimental period, all participants remained  seated and only engaged in sedentary activities. Environmental  data as well as the participants' satisfaction with the thermal  environment were collected using the Comfstat infrastructure.

Each participant undertook the experimental setting twice.

C. Non-sedentary experiment  The previous two experiments investigated how thermal  comfort varies with different thermal environments when the  subjects are sedentary. In order to analyze the effect of physical  activity on thermal comfort, we conducted a separate 90-  minute experiment with participant Pl. During the experiment PI wore light clothing (i.e., 0.44 clo) [24]. During the first 30 minutes, PI was asked to relax during a sedentary activity to obtain a baseline. Next, she was asked to perform physical  exercise for 30 minutes followed by another 30-minute phase  of relaxation.

D. Preliminary observations  Before going on to explain how we compute thermal com?  fort from the measured sensor values, we will identify a few  key observations from the data set.

a) Thermal comfort is subjective: Figure 5 shows how  the participants' thermal satisfaction is linked to the current  temperature level. For each vote obtained through the smart?  phone application, Figure 5 shows the average temperature  when the vote was cast. In general, participants show different  thermal sensations at the same temperature levels, while fe?  males prefer higher temperatures. These results are confirmed  by Karjalainen et al. [25], who found a significant impact     30r- ----,-----,-----,-----,---?   . ? ?  Ther mal sensati on  Fig. 5. Thermal comfort preference per user.

TABLE IV AVERAGE HEART RATE PER COMFORT LEVEL (-3: COLD, -2: COOL, -1: SLIGHTLY COOL, 0: NEUTRAL, 1: SLIGHTLY WARM, 2: WARM). NOTE  THAT NO DATA FOR HOT (3) IS AVAILABLE.

-3 -2 -1 0 1 2 (PI) 75 72 69 81 86 87 (P2) 84 84 77 93 94 (P3) 74 67 72 74 70 71 (P4) 84 80 84 85 84 (P5) 79 76 79 81 80 (P6) 79 80 81 78 84 83 (P7) 69 68 72 65 68  of gender on thermal comfort. Our results indicate that to  automatically infer thermal comfort it may be necessary to  create and train multiple models.

b) Heart rate higher in extreme environments: Figure 6  shows the distributions of the measured heart rates per thermal  comfort level for Pl. The figure shows that the median heart rate (red line) tends to increase towards both cold and hot  thermal sensations. Table IV summarizes these results for all  participants. Our results are confirmed by Maohui Luo et  al. [17], who found that the metabolic rate increases when  the thermal sensation tends towards either end of the scale.

c) Thermal comfort indicated by temperature: During  the preliminary analysis we also observed a correlation be?  tween participants' thermal comfort and the temperature mea?  sured by both the armband and the stationary sensor. Figure 7  shows, exemplary for PI, howard_temp, the temperature measured on the participants' arms, the room temperature  room_temp and thermal satisfaction comfort change over the course of one "controlled" session. A summary of the  correlation between ard_temp and comfort for all par? ticipants is shown in Table V.



V. MODEL  Our goal is to show how thermal comfort can be deduced  automatically from the sensory input collected by the Comfstat  infrastructure. According to the ASHRAE 55 standard, the   120.-,-----,----,----,----,-----,-,   ? 100 E a.

D 90 ? t: 80 f1l Q)  J: 70  50L-C- o ?  ld?---c o ?  o?I ?-  s -_ ?  c -o o- l?n-e-u L tr-a?l-s-_- w  ? a-r -m--w- a  ? r? m ?  Ther mal sensation  Fig. 6. PI heart rate per thermal comfort level.

TABLE V PEARSON CORRELATION BETWEEN ARD_TEMP AND COMFORT  ("CONTROLLED" TEMPERATURE EXPERIMENT).

Pearson correlation  PI P3 P4 P5 P6 P7 Session 1 0.85 0.80 0.81 0.79 0.76 0.78 Session 2 0.80 0.89 0.84 0.76 0.79 0.73  satisfaction with the thermal environment can be expressed  on a 7-point scale where -3 indicates cold and +3 indicates hot. This is also how thermal comfort is registered through the  mobile application (cf. Figure 2).

Thus, thermal comfort may be considered a categorical  variable. In Fanger's PMV and PPD calculations, however,  fractional values are also possible. In the following we will  therefore use two regression techniques - linear regression  and logistic regression4 to model the relationship between  the measured data and thermal comfort. While the former  outputs values on a continuous scale, the latter uses the discrete  ASHRAE scale.

A. Feature extraction  Before we evaluate the performance of the two regression  approaches in Section VI, we show how we identified and ex?  tracted a set of features which serve as good indicators for the  comfort level. The features are based on the six fundamental  factors (metabolic rate, clothing level, air temperature, mean  radiant temperature, air speed and humidity) which define  human thermal comfort [11].

1) Environmental factors: From the environmental factors (i.e., air temperature, mean radiant temperature, air speed and  humidity), we only include air temperature and humidity by  means of the ard_temp, ard_humidi ty and room_temp features. The first two are based on the sensor worn on the  participant's arm while the latter is situated at a fixed position  in the room.

4Regularization parameter set to 1 and not tuned for for best possible alpha.

#   NEUTRAL WARM NEUTRAL COLD 23?C 27 ?C - 29?C 23?C 17 ?C - 18?C  30.0 - ... - ...

G 28.5 3 c 0 ::.... 27.0 2 :p 10 Q) 25.5 1 OIl '- C :::J 24.0 0 Q) ..., 22.5 OIl 10 '- ? 21.0 -q? E 19.5 - - - - - - - - - - - - - _  . .  _ _  . .  _ _  . _ - - -2 lii Q) 18.0 -3 ? I- 16.5 11:30 11:40 11:50 12:00 12:10 12:20 12:30 12:40  ard _temp_ 3sec comfort - room_temp_ 3sec  Feature name  polar room_temp ard_temp ard_humidity temp_delta weight height age gender polar_lmin_min polar_lmin_max polar_lmin_mean room_temp_lmin_min room_temp_lmin_max room_temp_lmin_mean ard_temp_lmin_min ard_temp_lmin_max ard_temp_lmin_mean ard_hum_lmin_min ard_hum_lmin_max ard_hum_lmin_mean  Fig. 7. PI Thermal comfort and temperature correlation.

TABLE VI FEATURES COMPUTED ON COLLECTED DATA.

Description  Heart rate in bpm in Is intervals Room temperature interpolated to Is intervals Armband temperature sensor interpolated to Is internals Armband humidity sensor interpolated to 1 s internals Difference between room temperature and armband temperature interpolated to Is intervals Participant's weight in kilograms Participant's height in meters Participant's age in years Participant's gender (l: female and 0: male) Minimum heart rate (bpm) value registered in the last minute (sliding window) Maximum heart rate (bpm) value registered in the last minute (sliding window) Mean heart rate (bpm) value registered in the last minute (moving average) Minimum room temperature value registered in the last minute (sliding window) Maximum room temperature value registered in the last minute (sliding window) Mean room temperature value registered in the last minute (moving average) Minimum armband temperature value registered in the last minute (sliding window) Maximum armband temperature value registered in the last minute (sliding window) Mean armband temperature value registered in the last minute (moving average) Minimum armband humidity value registered in the last minute (sliding window) Maximum armband humidity value registered in the last minute (sliding window) Mean armband humidity value registered in the last minute (moving average)  We do not model the air speed or the mean radiant tem?  perature as both are difficult to measure outside the controlled  environment of a climate chamber.

by both, the room temperature and the participant's heat  dissipation. As the armband is worn over the clothing, the  weight of each temperature is influenced by the clothing level  of the participant. 2) Metabolic rate: ISO 7730 establishes a linear relation?  ship between the heart and metabolic rates of a person [12].

However, the calculation of the metabolic rate from the heart  rate requires additional calibration to obtain parameters like  the resting heart rate. To avoid this overhead, we decided to use  the raw heart rate as a feature. In previous work, the heart rate  has proved to be a good indicator for approximating energy  expenditure [26]. We use the polar feature to denote the heart rate in bpm over a 1 s interval.

3) Clothing level and temperature differences: In addition to the heart rate, we model the difference temp_delta between the temperature measured on the body using the  armband ard_temp and the temperature measured by the fixed sensor (i.e., room_temp). temp_delta is influenced   4) Temporal variations: Table VI sununarizes the selected features. All features are computed at I-second intervals.

Whenever the granularity of the raw data was less than 1 s, linear interpolation was used. In addition to the raw data  from the sensors (i.e., polar, room_temp, ard_temp and a rd_h umi di t y), we introduce, for each, their respective minimum, maximum and mean over the previous 60 seconds  to capture temporal variations. We denote these by adding the  suffixes _lmin_min, _lmin_max and _lmin_mean.

Using the temporal variations on the polar feature (i.e.,  features ho, ill and h2) our goal is to recognize when a person's activity level has increased for a short period of time  (e.g., a person just climbed the stairs to reach her office). The     thus increased metabolic rate may cause thermal discomfort  only for a brief moment, making an adjustment to the thermal  environment unnecessary.

Features h3 to 121 capture recent changes in the environ?  mental conditions (i.e., temperature and humidity). This is  important as the human body needs time to adapt to changes  in the thermal environment. Figure 7 shows that when a  participant entered a neutral from a warm environment, she  needed several minutes before feeling comfortable.

5) Regression over multiple participants: Features 16 to  19 (e.g., weight, height, age and gender) are used specifically for evaluating the performance of the regression  on different participants.



VI. RES ULTS  We investigate whether the satisfaction with the thermal  environment - expressed on the 7-point ASHRAE scale by  our participants - can be determined automatically from the  raw sensor data. To this end, we tested both linear regression  and logistic regression on the Comfstat data set. We will use  the subscripts LIR and LOR to denote performance figures for  the linear and logistic regression, respectively.

A. Evaluation  To evaluate the approaches, we merged all available data  for each participant. The data was then shuffled and split  into training and testing sets using lO-fold cross validation.

For each fold, the regression was tested on 1/10 of the data and trained on the remaining 9/10. To ensure that each fold contained sufficient training data, the folds were chosen to  preserve the distribution of samples for each thermal comfort  category.

1) Metrics: We use four different metrics to measure the performance of the approaches. e and e denote the mean and median absolute error, respectively. These two metrics give an  indication of how many points (on the ASHRAE scale) the  comfort prediction is away from the actual sensation of the  participants. The R2 measure is included for reference in the figures as it is the standard means for determining the fit of a  regression line.

As the median absolute error e is less useful for logistic regression - which outputs a categorical variable - we have  also included the classification accuracy Acc as a metric.

The accuracy gives the percentage of samples that have been  classified correctly (e.g., the system correctly classified that a  participant was feeling "cold" at a particular interval).

2) Baseline: As baseline we used three models. Temper? ature only, denoted by the subscript TEM is the performance  obtained by using linear regression on the temperature data  alone (i. e. only 12 - room_temp - is used to predict comfort).

The Neutral model (subscript NEU) always assumes that a person is feeling comfortable (i.e., the vote on the ASHRAE  scale is 0). This neutral vote is in the middle of the scale  and has a maximum error of 2. The Random model (subscript  RND ) assigns a uniform probability to all seven points on the ASHRAE scale and predicts a random comfort level at each   TABLE VII REGRESSION PERFORMANCE (CONTROLLED TEMPERATURE  Pl Linear R. eUR 0.46  eUR 0.38 Logistic R. eLOR 0.36  ACCLOR 68% Temp. only eTEM 0.67  (Lin. Reg.) eTEM 0.67 Neutral eNEU 1.02  ACCNEU 33% Random eRND 1.95  ACCRND 15%   2 ?'-----:-n..J ....... .

c: o ? 1 IJl c:  ? 0 ro E ? -1  .s::: I-  -2  EXPERIMENT).

P3 P4 P5 P6  0.53 0.47 0.39 0.43 0.47 0.42 0.32 0.37 0.28 0.10 O.ll 0.27 75% 94% 89% 77% 0.60 0.53 0.56 0.57 0.85 0.40 0.40 0.49 1.17 0.94 0.89 0.86 28% 49% 43% 36% 2.05 2.02 1.92 1.93 15% 14% 14% 14%  -3 nn nnn i - e xpe ct e d  pre dict e d  I n  P7 Avg.

0.25 0.42 0.16 0.35 0.06 0.20 94% 83% 0.53 0.58 0.48 0.55 0.83 0.95 47% 39% 1.91 1.96 14% 14%  o 2000 4000 6000 8000 10000 Time (5)  Fig. 8. PI Linear regression.

3 eLOR=O.?54 RloR=oi763  2 ACCWR ='0.675 ........ ......... .

c: o ? 1 IJl c:  ? 0 ro E ? -1  .s::: I-  -2  -3 nn nnn i - e xpe ct e d o 2000 4000 6000  Time (5)  pre dict e d  I n  Fig. 9. PI Logistic regression.

interval. While the latter two approaches do not require any  knowledge about the distribution of the comfort levels, they  serve as lower bounds for the performance of the regression.

B. Regression performance  Table VII shows the performance of the two regression  approaches on the data from the controlled temperature exper?  iment (cf. Section IV-B). Both regression approaches clearly  outperform the baseline strategies. When only the temperature  is used to deduce the participant's comfort levels, the mean  error eTEM is on average 0.58 points. The Neutral strategy has a mean error eNEU between 0.83 and 1.17, while ACCNEU is only 39% in the best case. As expected, the Random approach  performs even worse with eRND between 1.91 and 2.05 and an average ACCRND of 14%.

For the linear regression, the mean error eUR varies between  0.25 and 0.53 for P7 and P3, respectively. This means, the  prediction falls on average within 0.5 points of the actual thermal satisfaction of the participants. Similarly, the median  error eUR ranges from 0.16 to 0.47, meaning that 50% of the time, the actual vote is within less than 0.5 points of the prediction. Using the full feature set means the mean error  incurred (i.e., eUR) is 0.16 points lower than the mean error incurred when only the temperature data is used (i.e., eTEM)' The effect of the additional heart rate features is strongest for  PI and P7 where the respective differences in e are 0.21 and 0.28.

Figure 8 shows the results of the linear regression for  Pl over all data points. This data has been obtained by  concatenating the results from all 10 testing folds. While it  fails to notice short changes in the thermal sensation, the green  regression line tracks the ground truth (expected) comfort  level quite closely. As the output from the linear regression  is continuous, it also seems5 to capture intermediate comfort  levels. However, as the thermal satisfaction is measured on the  7-point scale, these intermediate levels are deemed erroneous.

Thus, as the logistic regression models a categorical vari?  able, one might expect it to show smaller errors. Indeed,  Table VII shows that eLOR varies between 0.06 for P7 and 0.36 for Pl. The Accuracy ACCLOR shows that between 68% (i.e., PI) and 94% (i.e., P4 and P7) of intervals are classified  correctly.

To understand why the logistic regression fails to achieve  a higher accuracy for PI, Figure 9 shows the result of the  regression over the whole duration of the cold experiment. The  uncertainty regarding the current comfort level results in a lot  of fluctuations of the predicted thermal sensation. When the  linear regression outputs a value between two distinct comfort  levels (cf., Figure 8), the logistic regression often oscillates  between them. While having a lesser effect on eLOR, this reduces the overall accuracy of the regression.

1) Discussion: The two regression approaches follow dif?  ferent goals. While the linear regression tries to model the  relationship between the input variables (e.g., heart rate and  temperature) and the output (i.e., thermal sensation) on a  continuous scale, the logistic regression follows a classification  (i.e., assigning input data to a number of distinct classes)  5The votes captured by the Comfstat infrastructure are expressed on the 7-point ASHRAE scale and thus do not allow for this granularity.

1.8,.......,--..,.---,-----,---r---,---  ....

o  1.6  1.4  1.2  ? 1.0  Pl P3 P4 P5 Participant  P6 P7    40? ? >-  30 ? ....

::J U u  20 ?    Fig. 10. Generalizability - Using other participants ' data to predict comfort.

approach. Thus, both strategies have advantages and disadvan?  tages. The linear regression results in a higher average error  also because it may produce values outside the [-3,3] interval.

On the other hand, it allows for detecting fractional comfort  levels - something that the logistic regression is not capable  of. The logistic regression may thus oscillate between two  comfort levels as the available input data cannot be used to  conclusively determine a single level.

These fluctuations are not good for heating and cooling  systems as they may cause the system's setpoint temperature  to fluctuate as well. In the worst case, this may lead to further  oscillations breaking the control loop. In order to alleviate this  problem, an additional smoothing step should be employed to  reduce the number of fluctuations. A similar post-processing  step could remove extreme values for the linear regression,  effectively capping its output at -3 and 3.

However, the choice of method to predict thermal comfort  also depends on how the individuals' thermal sensations are  used. If the smart thermostat subsequently combines all votes  from multiple inhabitants to compute a single assessment  of the current thermal comfort level like Fanger's PMV,  individual fluctuations may be less important. As our sample  of seven participants is too small for such an analysis, we  leave this question for future work.

C. Generalizability of trained model  During our preliminary analysis of the data set in Sec?  tion IV-D we observed that thermal sensations varied sig?  nificantly between participants for the same thermal environ?  ments. To understand how this affected the trained regression  models, we used 5-fold cross validation. By leaving one  participant out and training on all available data from the  other participants we want to examine how well the regression  generalizes over different participants. For this experiment,  features 16 to 19 were introduced to model the weight, height, age and gender of the participants.

? 100 E a.

.0 90 ?IY ''/Il'llb, dflllllll: 2 ? 1: 80 ro Q)  ::c 70   Fig. 11. HR monitoring accuracy (smartwatch vs chest strap). Pearson correlation: -0.045.

Figure 10 shows the result of this experiment for the logistic  regression. As before, e denotes the average absolute error, while Acc denotes the accuracy. For all participants e is above 0.5. Moreover, by using the other participants' data  to predict P2 to P5, the logistic regression is wrong by a whole comfort level on average. This figure is similar to the  performance of the Neutral baseline for both the controlled and  cold temperature experiments. As the Neutral approach has no  knowledge about any of the participants, thermal sensation  does not seem to generalize for multiple people. This is  important to note when considering alternative approaches like  measuring the six primary factors defined in ASHRAE 55 and  using equations derived from climate chamber experiments to  deduce comfort [10]. By introducing a small training overhead  that is made less strenuous through the use of smartwatches,  our Comfstat approach offers personalized comfort prediction.

D. Replacing the chest strap  The major drawback of our current system is that it relies  on a chest strap to measure the participants' heart rates. To  understand whether current smartwatches might be a suitable  substitute, we used the Comfstat infrastructure to collect  heart rate data from a LG Watch R (W 11 0) Android Wear  smartwatch. In contrast to the Polar H7 chest strap which  was sampled at 1 Hz, the smartwatch was only sampled every minute. Higher sampling frequencies were not possible as the  watch would often time out as no value was detected.

Figures 11 and 12 show the result of a two-hour experiment  during which we tested both the accuracy and the resulting  battery drain. During this experiment, the smartwatch was only  used to measure the heart rate. Notifications were disabled and  the watch was not otherwise used.

Figure 11 shows that the heart rate measured by the smart?  watch can deviate substantially from the chest strap, at times  logging only half the value and well outside a reasonable   E a.

.0 Q)  ....

? 1: ro Q) ::c  Time  Fig, 12. Smartwatch battery drain.

range. This means that without significant thresholding and  smoothing, the values from the smartwatch cannot currently  be used to monitor comfort. The sampling interval is also  restricted by the battery drain of the sensor. Over the course  of the two-hour experiment, the smartwatch lost 25% of its  capacity. This means that even if it was only used for sensing  comfort, a smart thermostat could depend on the smartwatch  for merely eight hours a day.

The low accuracy and restricted sampling interval thus  make current smartwatches an unsuitable candidate for sensing  the heart rate. However, as previous work has shown how  pedometers and accelerometers can be used to monitor phys?  ical activity [27], future work might show how these can be  integrated with the heart rate data to overcome periods of low  accuracy and to reduce battery drain.



VII. CONCLUSIONS  We introduced our Comfstat infrastructure and showed how  thermal comfort may be derived from participants' heart rates  as well as environmental data including the room temperature  and humidity. Furthermore, we made our data set publicly  available to the research community. We show that high  accuracies are possible when training a regression model using  individual thermal sensation data and highlight that one cannot  easily generalize the thermal sensation experienced by one  participant in a particular environment to other participants.

We propose to solve this problem by offering an easy to use  calibration tool on both smartphones and smartwatches that  allows occupants to periodically vote on the 7-point ASHRAE  scale. Finally, we look into the future and examine the  suitability of current smartwatches to measure the participants  heart rates and conclude that further developments in sensor  technology are necessary before they may be used to sense  comfort.

