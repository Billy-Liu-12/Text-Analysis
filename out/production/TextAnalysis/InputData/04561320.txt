HIDDEN: Hausdorff distance based Intrusion Detection approach DEdicated to Networks

Abstract  DoS attacks represent a big threat for the Internet. While most of attack detection techniques are based on pas- sive monitoring of traffic, we propose a detection method, HIDDEN, based on active measurements, the objective be- ing to make possible the real-time detection and classifica- tion of DoS attacks, without intrusive probing. The original- ity of our contribution relies on the use of the entropy func- tion computed from probabilities of time series of measured ICMP request/echo delays. However, the evaluation of the method exhibits a dramatic number of false positives. It has then been enriched by the use of the Hausdorff distance on probabilities of time series, which significantly decreases the number of false positives. In addition, a method for dis- criminating ICMP attacks from others (TCP/UDP attacks) using icmp seq has been added. Experiments for evaluat- ing the effectiveness of the approach have been run on the French operational RENATER network, on which artificial attacks have been generated using TFN2K [14]. Results exhibit that TCP, UDP and ICMP DoS attacks have been accurately detected in less than 1 second.

1 Introduction  DoS attacks represent a big threat for the Internet, and their detection and mitigation is a key research issue. Most of previous work on attack detection has been concentrat- ing on monitoring traffic using passive measurement tech- niques, as in Intrusion Detection Systems. This paper pro- poses an alternative approach based on active measure- ments, the objective being to make possible the real-time detection of DoS flooding attacks, without intrusive prob- ing. It relies on the assumption that delays will be impacted in case of attack. The advantage of active measurement is its user oriented nature which allows anybody to cope with DoS attack detection (whereas it is usually devoted to net- work administrators). The end to end approach of active measurements also makes possible to detect attacks any- where in the Internet from any source. Active measure- ments would then significantly ease the design of a global  attack detection system for the Internet. Active measure- ments are very popular in the Internet for measuring delays, loss rates, inferring network topologies, etc. They are also used for estimating available bandwidth (see tools as Abing, Spruce, Pathload, IGI-PTR, Pathchirp, etc). As for our at- tack detection method, these tools aims at interpreting de- lay variations on pairs or trains of packets as changes in the link or path load [11]. Our method then relies on analyz- ing time series of measured ICMP request/echo delays. The originality of this method relies on how this time series are computed in order to exhibit anomalous values correspond- ing to DoS flooding attacks and classifying them. For this purpose, and taking advantage of previous work on anomaly (passive) detection which demonstrated the benefits of spec- tral [8] or entropy [6] analysis, our detection method also computes the entropy from probabilities of RTT time se- ries. However, first results when working on the entropy function only were not convincing, because of a high rate of false positives. The methodology has been extended by the use of the Hausdorff distance on probabilities of time se- ries, which proved to significantly reduce this level of false positives. Moreover, it increases the level of true positives detected by the entropy function. The paper is organized as follow: section 2 presents the two needed concepts of entropy and Hausdorff distance. Section 3 presents how our detection method, HIDDEN, has been assessed. Espe- cially, it indicates how RTT time series in the presence of attacks have been built. Then in section 4, experimenting our detection method on this RTT time series repository, it has been possible to show that thanks to the Hausdorff distance estimations, DoS attacks have been accurately de- tected in less than 1 second. It also shows how the method performs in discriminating between ICMP and TCP/UDP attacks. Section 5 proposes an evaluation of performances about false/true positives/negatives and the choice of Haus- dorff distances. Finally, section 6 concludes the paper by describing ongoing and future work for improving and val- idating this method.

DOI 10.1109/ICIMP.2008.17     2 Entropy and Hausdorff distance concepts  2.1 Entropy  The entropy of a distribution was defined by Shannon for the discrete laws defined by its probabilities and was extended then to the continuous laws defined by their den- sity. The entropy received a strong attention in information theory, with physical analogies but it has also specific prop- erties to its probabilistic origin. The relative entropy shows the difference between the distribution of the packet serie in the current network traffic and a well-known distribution packet serie. If this difference is too large, it indicates that a portion of some packet serie that rarely appear in the train- ing data increases significantly, or that appear regularly de- creases significantly. In other words, this serves as an indi- cation of the presence of an anomaly in the network traffic.

Entropy aims at measuring the uncertainty degree of var- ious random experiments. The use of entropy concept is motivated in this work by the need to estimate the disorder level in probabilities of RTT time series.

2.1.1 Renyi and Shannon entropies.

It is often convenient to introduce generalized Renyi en- tropies before giving the Shannon one. The Renyi entropy is a generalisation of Shannon entropy to quantify the un- certainty or randomness of a system. The Renyi entropy of order ? is defined as:  R?(X) =  1?? log(  n  ? i=1  p?i ) (1)  where ? ?= 0, pi are the probability distributions of {p1, . . . , pn}, which consist of non-negative numbers sum- ming up to unity. The Renyi entropy R? converges to the Shannon entropy in the limit ?? 1.

R1(X) =? n  ? i=1  pilog(pi) (2)  2.1.2 Renyi divergences.

As well as the absolute Renyi entropies, there exist the gen- eralised relative divergence of order ? which described an approximate distribution Q(X) from a well-known distribu- tion P(X):  D?(P?Q) =  1?? log(  n  ? i=1  p?i q??1i  ) (3)  The divergence of order ? = 1 defined as  D1(P?Q) = n  ? i=1  pilog pi qi  (4)  is the Kullback-Leibler divergence. This last one has been used in MetroSec Project [10], in passive detection ([12], [2]). In this work, the Renyi entropy and divergence of order ? = 1 are used.

2.2 Overview of Hausdorff distance  The Hausdorff distance measures how far two compact non-empty subsets of a metric space are from each other, in topology. Let?s give an overview of the Hausdorff distance and a number of formulations about it.

2.2.1 Directed Hausdorff distance and undirected Hausdorff distance  Given two finite point sets A = {a1, ...,ap} and B = {b1, ...,bq}, the Directed Hausdorff Distance (DHD) is de- fined as  h(A,B) = max a?A  min b?B ?a?b? (5)  with d(a,B) = min  b?B ?a?b? (6)  and ? ? ? is a norm on the points of A and B, e.g. the L2 or Euclidean distance between a and b. The function h(A,B) is called the Directed Hausdorff Distance (DHD) from A to B.

It is noticed that the function (5) is not symmetrical, it can- not thus be a distance with the metric direction. However, it is used much to measure a degree of similarity between two contours A and B. Symmetry is usually restored by taking the maximum between h(A, B) and h(B, A). Then, we ob- tain the definition of the undirected (or classic) Hausdorff distance (CHD):  H(A,B) = max(h(A,B),h(B,A)) (7)  H(A,B) = max(max a?A  d(a,B),max b?B  d(b,A)) (8)  The Hausdorff distance (CHD) H(A,B) is the maximum of h(A,B) and h(B,A). Thus, it measures the degree of mist- match between two sets by measuring the distance of the point of A that the farthest from any point of B and vice versa.

2.2.2 Modified Hausdorff distances  There is a great number of alternatives to the preceding definitions which give better results shown in the field of the recognition of form and the imagery. In the case of the detection of anomalies, the authors are not informed of work using the distances from Hausdorff (classic or modified distance). There are thus various ways of calcu- lating Directed Hausdorff Distances (DHD) [4]. Moreover, undirected Hausdorff distances can be also modified [5].

By combining directed and undirected Hausdorff distances, one obtains a great number of alternatives.

? Undirected Hausdorff distance alternatives  H1(A,B) = min(h(A,B),h(B,A)) (9)  H2(A,B) = max(h(A,B),h(B,A)) (10)  H3(A,B) = h(A,B)+ h(B,A)  (11)     H4(A,B) = Nah(A,B)+ Nbh(B,A))  Na + Nb (12)  ? Directed Hausdorff distance alternatives  ? Directed Hausdorff distances  DHD1 : h1(A,B) = max a?A  d(a,B) (13)  DHD2 : h2(A,B) = min a?A  d(a,B) (14)  ? Partial Hausdorff distances (PHD) [4]  PHP50 : h3(A,B) = 50 Ktha?A d(a,B) (15)  PHP75 : h4(A,B) = 75 Ktha?A d(a,B) (16)  PHP90 : h5(A,B) = 90 Ktha?A d(a,B) (17)  ? Modified Hausdorff distance (MHD) [5]  MHD : h6(A,B) =  Na ? a?A  d(a,B) (18)  ? Doubly Modified Hausdorff distance (M2HD) [13]  M2HD : h7(A,B) = min a?A  d?(a,B) (19)  where  d?(a,B) = max(I ? min b?NaB  ?a?b?, (1? I)P) (20)  There exist others various alternatives used in face recog- nition which are supposed to alleviate the sensivity of the Hausdorff distance: M?estimation and least trimmed squares Hausdorff distances (M?HD, LTSHD), Modified Merit Hausdorff Distance (M2HD), Spatially Weighted and Eigen-Weighted Hausdorff Distance (SWHD, SE- WHD), Spatially Weighted and Eigen-Weighted Doubly Modified Hausdorff Distance (SWM2HD, SEWM2HD), Weighted Modified Hausdorff Distance, Hausdorff Dis- tance with Explicit Paring (HDEP), Grey Image Hausdorff Distance, Weighted and Weighted Doubly Hausdorff Dis- tances (WHD, W2HD). All these distances are referred and explained in [7]. In this work, CHD (equations 10 and 13), MHD (equations 10 and 18) are used to determine the degree of resemblance between two probe sequence re- sponses. The use of Hausdorff distance is also motivated by its capability describing fractal or self-similar objects [1], as it has been exhibited that traffic as well as other Internet objects have multi-fractal and self-similar properties ([3], [15], [9]).

3 HIDDEN: Entropy/Hausdorff distance based intrusion detection approach  Let?s now present the Entropy/Hausdorff distance based intrusion detection algorithm.

?Step 1: ICMP probing: RTT is measured as the ICMP re- quest/echo delays. Different packet lengths can be selected, as well as the period between the sending of two successive probes (up to 200ms, for a simple user).

? Step 2: Entropy Calculus: Using a reference established in a first time (without DoS attack controlled by passive techniques, [12], [2] for examples), one calculate probabil- ities of delay time samples. Then, computing the entropy function on probabilities of RTT series in our method re- quires to fix two parameters: the sliding window Ws and the overlapping parameter Op.

? The sliding window Ws is the granularity for analyzing probabilities of RTT series. The longer the sliding window, the more precise the results, the less reactive the intrusion detection.

? The overlapping parameter Op allows shifting the sliding window Ws from part or the full studied interval. It allows an overlapping between two consecutive sliding windows Ws(k?1) and Ws(k), k ? IN.

? Step 3: Hausdorff distance estimation: The Hausdorff metric is applied to a subset of probabilities of RTT series according to (Ws,Op). The level of intrusion is ?filtered? thanks to the combination between entropy and Hausdorff distance.

? Step 4: Discriminating between Dos attack (ICMP, TCP or UDP) relies on the observation that an attack based on ICMP protocol uses a high level of icmp seq. On the other side, TCP and UDP protocol based attacks use a low level of icmp seq. Thanks to the ICMP probing techniques, it is then possible to discriminate between ICMP attacks and others. Assessing the accuracy and performance of our detection method requires RTT time series measured while attacks arise. Unfortunately, hackers do not warn us when they launch an attack, and as far as we know, such public repository of RTT times series in the presence of attacks does not exist. We then decided to generate our- selves our own attacks on the French operational Renater network. The Denial of Service attacks were launched us- ing the TFN2K attacking tool. The attacker in Mont-de- Marsan sent different DoS attacks to LAAS in Toulouse.

DoS attacks have been sent with different profiles (?ramp burst?, ?flat burst? and ?mixed burst?) and different proto- cols (UDP, TCP, ICMP). In parallel of the attacks, an ICMP ping probing was sent out periodically. A set of these differ- ent kinds of attacks with different intensities were launched: it allows the assessment of our detection method for cases ranging from high intensity attacks increasing seriously de- lays, to low intensity ones, which have more limited im- pact. Detecting low intensity attacks which could be part of large distributed DoS is one of the challenges for any attack detection methods, and has been the core of our as- sessment work. Attacks combining all profiles and all the three quoted protocols have been performed, as illustrated in figure 2 (a,b and c) (each zombie involved on this figure     is responsible of sending out the traffic of a single attack type) for assessing the classification method.

4 First results and analysis of the proposed algorithm  4.1 An example of Detection (March 2007, 20)  Two sorts of attack scenarios are presented: the ?ramp? and ?flat? burst attacks. Figure 1 presents the results on a ?ramp? (resp. ?flat?) example when ana- lyzed with two different sets of parameters (Ws,Op):= {(10s,20%),(10s,60%)} (resp {(5s,20%),(5s,60%)}).

Each ICMP ping probe is sent out every 1s. For each subfigure (a, b, c and d), top curve represents the ICMP RTT measured (which by the way confirms our starting hypothesis on the impact of attacks on delays), middle curve the detection alarms when applying only the entropy function on probabilities of RTT time series, and bottom curve the detection alarms when Hausdorff distance (CHD in this case) is used. In all cases, the use of the entropy function only leads to several false alarms: 6 and 1 respectively for figures 1.(a) and (b) corresponding to ?ramp? bursts. The number of false alarms in case of ?flat? burst is significantly high, exhibiting a serious lack of the entropy only detection method. Note also that increasing the overlapping factor makes the false positive rate significantly better. At the opposite, in the four cases, combining the Hausdorff distance (CHD) with the entropy function on probabilities of RTT time series leads to perfect detection results without false alarms.

4.2 ICMP vs TCP/UDP attack classifica- tion (March 2007, 20)  The figure 2.d describes the level of icmp seq utiliza- tion for the 3 zombies described in the figure 2.(a, b and c).

The different evolutions are subtracted to a normal icmp seq evolution (icmp seq= 1,2,3, ...). On this figure, it clearly appears that it is possible with this method to discriminate ICMP attack from other kinds, and then it can contribute to false positives reduction.

5 [Entropy/CHD] vs [Entropy/MHD] perfor- mance evaluation  In this section, we interest in the entropy, CHD and MHD performances. As we have seen before, entropy detects True Positives (TP) but reveals also False Positives (FP). On the other side, CHD detects True Positives and didn?t reveal False Positives. In this section, we want to evaluate the ca- pacities of these three concepts when we modify (Ws,Op).

Our performance evaluation concerns the True Positives, Falses Positives, True Negatives for the three concepts and averages to distinguish CHD to MHD performances. The Denial of Service attacks were launched using the TFN2K  (a)  (b)  (c)  (d)  Figure 1. Examples of Ramp bursts (Intru- sion levels (Entropy (E) and Hausdorff (H)) for (Ws,Op):= {(10s,20%) (a), (10s,60%) (b)) and Flat bursts (Intrusion levels for (Ws,Op):= {(5s,20%) (c), (5s,60%) (d)}).

attacking tool on March 2007, 21. The attacker in Mont- de-Marsan sent different DoS attacks to LAAS in Toulouse.

DoS attacks have been sent with flat bursts profile. In paral- lel of the attack, an ICMP ping probing was sent out period- ically with the smallest packet size and the smallest simple user period, i.e 200ms: for example, Ws = 1 means that one ICMP ping probe has been sent out and the sliding window     (a)  (b)  (c)  (d)  Figure 2. Intrusion levels for the 3 zombies (a, b and c) - Identification of ICMP attack using icmp seq utilization.

equals to 200ms. The overlapping parameter Op is fixed to 1 ICMP ping probe. The results are described in the table 1 and illustrated by the figures 3 and 4.

Few observations can be done:  ? The number of CHD and MHD True Positive alarms are the same.

? The number of MHD True Positive alarm is higher than the Entropy one.

Figure 3. Ramp bursts: Intrusion levels (En- tropy, CHD and MHD techniques) for different Ws (1, 2, 5 and 10 probes).

? The number of Entropy False Positive alarms is too high if Ws is small; that was previously detected.

? The number of MHD or CHD False Positive alarms is null except for the first case; that means this approach is robust and reactive for this kind of DoS attack.

Measuring CHD and MHD averages give us an information about the intrusion detection level. The higher the Haus- dorff distance, the more sensitive to an intrusion the ap-     Ws 1 2 3 4 5 C/MHD True positives 714 704 695 686 678 C/MHD False Positives 1 0 0 0 0 Entropy True positives 692 673 656 639 625 Entropy False Positives 275 27 6 2 0 Entropy True Negatives 22 31 39 47 53  Ws 6 7 8 9 10 C/MHD True positives 670 662 655 648 641 C/MHD False Positives 0 0 0 0 0 Entropy True positives 612 599 588 577 567 Entropy False Positives 0 0 0 0 0 Entropy True Negatives 58 63 67 71 74  Table 1. Classic and Modified Hausdorff Dis- tance Performances: number of alarms.

proach. We illustrate this comparison between two cases: Ws = 1 and Ws = 9 probes.Global results are given in the ta- ble 2. As we can see, the MHD values are always lower than the CHD one, except at the positive alarms. Then, MHD av- erage is lower than the CHD one, that is much convenient to use for the intrusion detection.

Ws 1 2 3 4 5 CHD average 0.943 0.928 0.916 0.906 0.897 MHD average 0.902 0.875 0.854 0.837 0.822  Ws 6 7 8 9 10 CHD average 0.889 0.882 0.875 0.870 0.864 MHD average 0.809 0.796 0.785 0.775 0.767  Table 2. Classic and Modified Hausdorff Dis- tance Performances.

Figure 4. Positives, negatives.

6 Conclusion  This paper proposed a method, HIDDEN, for detecting DoS attacks, in real time, using active measurements of  ICMP RTT, and an original analysis method of the related RTT time series combining the use of entropy and Haus- dorff distance on their probabilities. The method also en- able us to discriminate between ICMP attacks from other kinds (TCP/UDP attacks) using icmp seq. The evaluation of the method demonstrated a high-level of intrusion de- tection. We proposed to use two different Hausdorff dis- tances associated to the entropy: the MHD is more adapted to the intrusion detection than the CHD. Future work in- cludes more extensive experiments with other DoS attacks, but also with other kinds of anomalies. If we notice that the method detects DoS attacks, it will be improved to make it able to differentiate legitime anomalies from DoS attacks.

