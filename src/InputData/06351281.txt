UNSUPERVISED NONLINEAR SPECTRAL UNMIXING BY MEANS OF NLPCA APPLIED TO HYPERSPECTRAL IMAGERY

ABSTRACT  In the literature, for sake of simplicity it is usually assumed that the model ruling spectral mixture in a hyperspectral pix- els is basically linear. However, in many real life cases the dif- ferent materials are usually in intimate association, like sand grains, resulting in a nonlinear mixture. Unfortunately, mod- eling a nonlinear approach is not trivial, and a general proce- dure is still up to be found. Aim of this paper is to evaluate the potentialities of Nonlinear Principal Component Analysis (NLPCA) as an approach to perform a nonlinear unmixing for the unsupervised extraction and quantification of the end- members. From this point of view scope of this paper is to demonstrate that the NLPCs derived from the proposed pro- cess can be considered as endmembers. To perform an ac- curate evaluation, the proposed algorithm has been tested on two different hyperspectral datasets and compared with other approaches found in the literature.

Index Terms? NLPCA, hyperspectral, nonlinear unmix- ing  1. INTRODUCTION  The principal objective of this paper is to identify and quan- tify the chemical species at the surface seen by a hyperspectral imager. In the literature the most used unmixing approaches are based on a linear mixture model. However, this model is based on the assumption that the mixtures are produced by different materials having lambertian surfaces. This means that the radiance is equally reflected in all directions. In many real cases, where different materials are in intimate associ- ation, like sand grains, the light that interacts with differ- ent materials does not results in an equally distributed radi- ance, and produces a nonlinear mixture. In the same way, non uniformity of the same material can produce nonlinear effects. From this point of view a nonlinear representation of the mixture is desired. In this paper we propose an un- supervised approach for the extraction and quantification of the endmembers by means of Nonlinear Principal Compo- nent Analysis (NLPCA). NLPCA can be seen as the non- linear generalization of standard principal component anal-  ysis and is performed by an Autoassociative neural network (AANN). In literature it has been demonstrated that AANN is an effective instrument for the projection of the original spectral information into a lower space, compressing the in- formation contained into hundreds of bands in few compo- nents. Analyzing the NLPCs it has been noted that each com- ponent is polarized on a different type of element contained in the image [1]. Starting from this assumption we consid- ered the derived NLPCs as endmembers. The proposed algo- rithm has been tested on two different hyperspectral datasets.

First the well-known Cuprite image acquired by AVIRIS will be used as a benchmark, then the NLPCA will be applied to a CRISM/MRO dataset acquired on Mars, where a detailed ground truth has been derived from high-resolution imagery in [2].

2. UNSUPERVISED NONLINEAR UNMIXING  2.1. Nonlinear principal component analysis  In this work we propose the use of nonlinear principal com- ponent analysis (NLPCA) for the extraction and estimation of the abundances of the endmembers present in a hyper- spectral image. Firstly introduced by Kramer in [3], NLPCA has been successfully applied in several hyperspectral images processing applications [4][5]. NLPCA, commonly referred to as nonlinear generalization of standard principal compo- nent analysis, is based on Autossociative Neural Network (AANN) or as autoencoder. The AANNs are multi-layer perceptrons neural networks of a conventional type featuring feedforward connections and sigmoidal nodal transfer func- tions, trained by backpropagation or similar algorithms. In this paper the training algorithm is the Standard Conjugated Gradient SCG [6]. The particular network architecture used employs three hidden layers, including an internal bottleneck layer of smaller dimension than either input or output. The training phase of the AANN is performed to obtain the iden- tity map, where the input has to be equal to the output. In this way, if the training error reaches an acceptable value, almost all the information content passes through the bottleneck layer. Since there are fewer units in the bottleneck layer than     the output, the bottleneck nodes must represent or encode the information obtained from the inputs for the subsequent layers to reconstruct the input. In this paper each NLPC is considered as an endmember, which associated values are used to describe the abundance maps.

2.2. Endmember extraction  Differently from other unmixing approaches, in the NLPCA the number of endmembers is directly related to the number of nodes of the bottleneck layer. From this point of view, the choice of a correct topology of the AANN is not an easy task because while the number of nodes in the bottleneck layer not only influences the number of endmembers but also the training error. On one hand, a high number of endmembers, leading the training error to extremely low values, may rep- resent material that are not effectively in the scene. On the other hand, too few nodes in the bottleneck layer may be not sufficient for a satisfactory training of the AANN. However, from an extensive analysis it emerged that an increase of the number of nodes in the bottleneck layer over a certain thresh- old won?t correspond to an effective increase of the number of endmembers. In fact, it has been observed that, choosing a number of nodes higher than the endmembers intrinsically present in the image, will result in one or more very similar NLPCs representing the same physical sources. Starting from this assumption, the number of nodes in the bottleneck layer is firstly set to an arbitrary value and then the NN is itera- tively trained increasing or decreasing the number of bottle- neck nodes until any replicated endmember is present in the final set of NLPCs. Once selected the appropriate number of nodes in the bottleneck layer, a simple grid search algorithm that varies recursively the number of nodes of the outer hid- den layers has been performed to reduce the training error.

However, some artifacts, mainly produced by residual atmo- spheric contributions and heterogeneity of surface illumina- tion may lead to the presence of endmembers that are not physically present in the scene. In this case, the number of endmembers estimated by the previous method may be higher than expected.

2.3. Abundance estimation  Once trained the network, the activation level of the bottle- neck nodes represent the strength of membership of a pixel to the associated endmember, which has values on a scale from 0 to 1, representing the variation from extremely low to ex- tremely high strength of membership. The activation level of a bottleneck unit is a function of the input to and the units activation function, that is a conventional sigmoid function.

The aim of this function is to force the bottleneck nodes to have values between 0 and 1 and provide a nonlinear mea- sure of the strength of endmember?s membership. To obtain a correct representation of the membership, the output unit ac- tivation levels were rescaled to remove the bias towards very  low and high values imposed by the unit activation function.

This task has been achieved by switching, after training, the activation function of the output units to a linear function, and then rescale the values between 0 and 1 [7].

In a linear approach the detected endmembers are weighted so to respect a sum to one constraint. This means that a cer- tain proportion of one endmember represents the percentage of the associated material present in the part of the scene im- aged by a particular pixel. Indeed, Hapke [8] states that the abundances in a linear mixture represent the relative area of the corresponding endmember in an imaged region. However, in the nonlinear case, the situation is not as straightforward.

The reflectance is usually not a linear function of the mass of the material nor is it a linear function of the cross-sectional area of the material. A highly reflective, yet small object may dominate a much larger but dark object at a pixel, which may lead to inaccurate estimates of the amount of material present in the region imaged by a pixel, but accurate estimates of the contribution of each material to the reflectivity measured at the pixel. For this main reason a representation of the end- members where their abundances should be subject to the sum to one constraint does not have much sense.

3. EXPERIMENTAL RESULTS  The proposed method has been applied to two different hyper- spectral datasets. In a first experiment a CRISM/MRO dataset acquired over the Russell dune on Mars, has been processed and the results have been compared with other unmixing tech- niques. As for the NLPCA, an AANN approach has been also applied to the CRISM/MRO image. After a grid search on the number of nodes, the best topology found was composed by 250-130-6-130-250 nodes, resulting in 6 endmembers de- tected. In this case the number of endmembers was set to 6 as it is done in [2] in which an automatic strategy for determin- ing the number of endmembers is applied to the test image.

Similarly to what it is done in [2] we considered three end- members out of six, representing three physical sources. As it can be seen the resulting composite abundance map shown in Fig. 2 is significantly similar to those obtained using linear unmixing techniques. However, the Russell dune is mostly composed of martian dust which is covered by CO2 ice dur- ing the winter season. In the beginning of spring, when the CRISM image was acquired, the dune presents mixed pix- els containing residual ice, uncovered dust and a mixture of the two components due to the melting ice. The authors in [2] proved that the spectral unximing of this area based on a linear mixture model can provide satisfactory results at first order. However, due to the melting of CO2 ice, the two ele- ments are more likely to be mixed in intimate association (Fig 3), resulting in non-linear mixtures that may be addressed by the proposed method. In this case the incident solar radia- tion (E0) encounters an intimate mixture that induces multi- ple bounces. Defining as ?n the attenuation coefficients of the     different materials, it is possible to define the radiant power of a linear mixed target as ML = E0  ? e??k . In the same way,  the radiant power of a target showing nonlinear interaction can be defined as MNL = E0e  ???k . The total radiant power detected by the sensor is a linear combination of both linear and nonlinear radiant power contributes Mtot = ML+MNL.

In this way, the endmembers represent not only the materials present in the scene but also their nonlinear interaction. From this point of view the application of the sum-to-one constraint may lead to values different from the unity. To evaluate the accurateness of the proposed method we have computed the Pearson coefficient to measure the similarity of the endmem- bers maps with the ground truth as regards to relative spa- tial distribution. For sake of comparison, the obtained results were compared with those obtained in [2]. From a quanti- tative point of view, an accurate analysis of the abundances cannot be carried out. This because of the assumption that in a nonlinear model the reflectance is not a linear function of the masses of the endmembers. In fact, due to the fact that the values of the components are not subject to the sum-to-one constraint, as we expected the average value of the absolute error is quite high if compared with other approaches.

Method All pixel well registration r ? r ?  NLPCA 0.64 0.38 0.66 0.39 VCA 0.68 0.08 0.73 0.08 BPSS 0.57 0.10 0.59 0.08 MVC-NMF 0.69 0.09 0.72 0.08 Spatial VCA 0.50 0.14 0.56 0.13  Table 1. The table reports the validation results expressed as Pear- son coefficient (r) and the average value of the absolute error ? re- garding all pixels (mean(rreg = 0.7)) and the moderately well- registered areas (mean(rreg = 0.83)).

Another experiment has been carried out using the Cuprite image acquired by AVIRIS. In this case we used an image where no atmospheric correction has been applied. This to demonstrate that atmospheric contributions and heterogene- ity of surface illumination can result in new endmembers that are not related with the physical composition of the soil. From a computational point of view, the noisy bands of the AVIRIS image have been discarded resulting in 199 spectral bands.

After a grid search on the number of nodes of the hidden lay- ers, the topology of the associated AANN was found to have 199 input/output nodes, 100 nodes for each outer hidden layer and 10 nodes in the bottleneck layer, corresponding to 10 end- members. From a first analysis it has been noted that 6 end- members out of 10 are related to different minerals effectively present on the scene as reported in Fig. 4. The remaining 4, on the other hand, seems to be more related to other nonlinear effects. On a more accurate analysis, it resulted that consider- ing only the 6 physically consistent endmembers the average  Fig. 1. Endmembers obtained using a NLPCA approach on the CHRISM-MRO image acquired on Mars. It is important to note that the endmember represented in f) is related to uncovered dust, while the others are related to different nonlinear mixtures of CO2.

Fig. 2. RGB composite obtained using three endmembers.

Fig. 3. The resulting signal detected by the sensor. Incident solar radiation (E0) encounters an intimate mixture that induces multiple bounces resulting in nonlinear mixture.

Fig. 4. Endmembers obtained using a NLPCA approach on the Aviris image acquired over Cuprite site: a) Alunite; b) Muscovite; c) Kaolinite; d) Jarosite; e) Halloysite; f) Calcite.

error presents a value of ? = 0.09.

4. CONCLUSIONS  In this paper, we have evaluated a novel unsupervised non- linear spectral unmixing techniques applied on planetary hy- perspectral data and compared with other linear techniques.

Two different experiments have been carried out on a hyper- spectral image acquired on Mars by the CRISM instrument and the well known AVIRIS Cuprite image. Being the con- sidered method a nonlinear unmixing algorithm, the retrieved endmembers represented not only the materials present in the scene, but also their their nonlinear interactions. Finally the quality of the results is estimated through the correlation co- efficient and average error between the reconstructed abun- dance maps and the ground truth.

5. REFERENCES  [1] Licciardi G., ?Neural network architectures for informa- tion extraction from hyper-spectral images,? Ph.D. The- sis, 2005.

[2] X. Ceamanos, S. Doute?, Bin Luo, F. Schmidt, G. Jouan- nic, and J. Chanussot, ?Intercomparison and validation of techniques for spectral unmixing of hyperspectral im- ages: A planetary case study,? Geoscience and Remote 4358, 2011.

[3] Kramer M. A., ?Nonlinear principal component analysis using autoassociative neural networks,? American Insti- tute of Chemical Engineers, vol. 37, pp. 233?243, 1991.

[4] G. Licciardi and F. Del Frate, ?Pixel unmixing in hyper- spectral data by means of neural networks,? Geoscience 11, pp. 4163?4172, 2011.

[5] G. Licciardi, P. R. Marpu, J. Chanussot, and J. A.

Benediktsson, ?Linear versus nonlinear pca for the classi- fication of hyperspectral data based on the extended mor- phological profiles,? Geoscience and Remote Sensing Letters, IEEE, vol. PP, no. 99, pp. 1?5, 2011.

[6] Bishop C., ?Neural networks for pattern recognition,? Oxford Univ. Press London, U.K., 1995.

[7] Foody G. M., ?Relating the land-cover composition of mixed pixels to artificial neural network classification output,? Photogramm. Eng. Remote Sens., vol. 62, no.

5, pp. 491?499, 1996.

[8] Hapke B., ?Theory of reflectance and emittance spec- troscopy,? Cambridge Univ. Press, U.K., 1993.

