The Intrusion Detection System Based on Fuzzy Association Rules Mining

Abstract In this paper, we integrate fuzzy association rules to  design and implement an abnormal network intrusion  detection system. Since the association rules used in traditional  information detection cannot effectively deal with changes in  network behavior, it will better meet the actual needs of  abnormal detection to introduce the concept of fuzzy  association rules to strengthen the adaptability. This paper  mainly focuses on the study of Denial of Service (DOS).

According to the experimental results, it is found that our  system can correctly identify all DOS attacks on test after  appropriate adjustment of system parameters. Moreover, it  also proves, in the experiment, that our system would not  result in false positives under such circumstances as a large  amount of instantaneous FTP normal packet flow.  In addition,  if source of an attacker can be determined, the system will also  be able to promptly inform the firewall to alter its rules and  cut off the connection.

Keywords  network security; fuzzy theory; association  Rules; fuzzy association rules; denial-of-service attack

I. INTRODUCTION  Network Intrusion Detection System is commonly  classified into host-based intrusion detection system (HIDS)  [1] and network intrusion detection system (NIDS) [2]. Of  course, there are some intrusion detection systems which are  a combination of both, generally referred to as hybrid  intrusion detection System (HIDS). HIDS protects  individual host while NIDS protects the whole network.

And both of them have their advantages and disadvantages.

In this paper, fuzzy association rules are introduced to  design a real-time network intrusion detection system.

Different from [3], it takes a long time to collect packets of  information before making off-line analysis. However, [3]  has its disadvantages. On one hand, the system does not  meet the needs of real-time detection and real-time  processing, which are required in an invasion system. On  the other hand, short-term attack is likely to be diluted  during a long-period flow of packet information and cannot    be detected since it is unable to meet the minimum support.

In addition, because different types of attacks usually  require specific detection methods to achieve excellent  results, the text also differs from [3] in the selection of  signature and the application of fuzzy function. In this  paper, denial-of-service attack serves as an experimental  subject.



II. DOS AND DDOS  The so-called DoS(Denial of Service), refers to an  attack that utilizes limited network resources (such as  Memory, Processor and Bandwidth, etc), as well as  loopholes in the design and application of partial network  system software, or other related communication protocol to  make the attacked websites unable to process requests  through substantial and intensive packet transmission. In  this way, many users who try to get normal access to those  websites will be rejected; or the attempt to identify  loopholes the program has failed to handle will crash the  system so that it will be out of service. DDoS (Distributed  Denial of Service) uses the same method as common denial  of service attacks but there are more triggered attackers.



III. THE ALGORITHM OF FUZZY ASSOCIATION RULES  We will give an introduction of how to compute the  similar degree among association rules, fuzzy association  rules and rules, which are basic knowledge related to this  paper. Then, specific examples will be given to explain how  to apply the knowledge to the design of network intrusion  detection system..

A. The Algorithm of Association Rules  Association rules [4] are defined as follows: suppose  },.....,,,{ 321 miiiiI = is the set of all items, database D the  set of all transaction record T and T a subset of any item  from I. A set X  I is called itemset, the number of items  which contained is regarded as the length of it. If its length is  k, then it is claimed as k-itemset. If a transaction record  supports an itemset X, it must contain all items of X, X  T,  written as support(X).

The representation form of association rules is X  Y,X,  Y  I and X ? Y = . Association rules depend on two  parameters (support and confidence) to judge whether they  are meaningful or not. Support refers to the percentage of X  Y transaction records in database, written as support (X    Y), while confidence defines the credibility of such  association rules, that is, the chances that Y will appear when  condition X occurs, written as support (X  Y) / support  (X). For valid association rules, their degree of support and  confidence must be equal to or higher than the threshold  level set by the user, which is also the minimum support and  confidence. In general, the widely used algorithm in  association rules is Apriroi algorithm [4]. Apriori algorithm  for mining association rules is divided into two parts:  V7-667978-1-4244-6349-7/10/$26.00 c2010 IEEE  (a)  (b)  Figure 1. Adopting the Difference between Discrete Split  and Fuzzy Logic  Phase1: search database and find out frequent itemset or  large itemset.

Phase2: use frequent itemset or large itemset to extract all  association rules, whose confidence is lower than the  minimum.

B. The Algorithm of Fuzzy Association Rules  Support (X) in Apriroi algorithm is an item of itemset X  and is calculated according to its record counts in database  D. When used in intrusion detection, each item will appear in  every record, and have a quantization value. Their difference  between them can be learned from record description by  checking database D. Suppose I = (A, B, C, D, E) and there  are five records in database D.(a) in figure1 describes records  in traditional Data Mining and (b) in figure1 in the network  Intrusion Detection. The first record in (b) in figure1  indicates statistical network traffic in certain unit time. And  there are 25 packets with signature A, 53 with signature B, 9  with signature C, 21 with signature D and 12 with signature  E. The network information flow in next unit time will be  described by the second record, and so on. Unit time can be  determined by network traffic but we must take into account  the processing time to ensure the instantaneity. However, the  traditional Apriori algorithm doesnt apply to quantitative  database. In the field of data detection, many solutions on the  problem of item quantification have been proposed. In this  paper, fuzzy Logic is adopted to mine such quantitative  database and the association rules mined is called Fuzzy  Association Rules.

For quantitative data, one of the most straightforward  ways is to grade value for each item clearly. In item A, we  set value below 20 is Low, value between 21 ~ 60 Medium,  value above 61 High; In item B, we set value below 100  Low, value between 101 ~ 300 Medium, value above 301  High, and so is with C, D, E. The database in (b) in tableI  and tableI is described as follows:  A=Medium, B=Low, C=x, D=x, E=x  A=Low, B=Low, C=x, D=x, E=x  A=Low, B=High, C=x, D=x, E=x  A=High, B=Low, C=x, D=x, E=x  A=Medium, B=Medium, C=x, D=x, E=x  TABLE I. FOR DATA MINING  # Record  1 A,B,D  2 B,C,E  3 A,C  4 D,E  5 B,D,E  TABLE II. FOR NETWORK INTRUSION DETECTION  # Record  1 A=25,B=53,C=9,D=21,E=12  2 A=1,B=35,C=7,D=31,E=7  3 A=6,B=345,C=91,D=41,E=32  4 A=61,B=85,C=15,D=22,E=33  5 A=31,B=277,C=34,D=81  With x  (Low, Medium, High), the traditional Apriroi  algorithm is more applicable, but there is a Sharp Boundary  Problem in such a clear manner of grading. In (a) 0f figure 1,  for example, the occurrence counts of A = Medium can only  be calculated by accumulating records in the database, such  as A = 21, A = 22, ..., A = 60. Although there are a great deal  of such records as A = 18, 19 or 61, 62, they contribute little  to the counts of A = Medium. Obviously, it is possible that  the association rules mined though this method will fail to  describe the real situation. Let suppose the interval of A =  Medium extends to 19 on the left or 61 on the right, then the  association rules mined may be completely different.

To solve Sharp Boundary Problem, the concept of Fuzzy  Logic is introduced in [6]. In accordance with Fuzzy Logic,  each item is renamed Fuzzy Variable and each category  Fuzzy Sets, such as Low, Medium and High. The difference    lies in the fact that Fuzzy Sets (Low, Medium and High) is  no longer clearly graded, but individually described by a  continuous function, which is called Membership Function,  such as (b) of Fig. 1. Therefore, with record item y  (A, B,  C, D, E), it may also belong to more than one Fuzzy Set, but  usually must be accompanied by y being part of weighted  values(grade) of each set. Taking (b) of Fig. 1 for example,  there is one record A = 20, B = ..., which belongs to A =  Low (0.5), A = Medium (0.95) and A = High (0). The value  in parentheses is 20 and that is the weighted value when  respectively incorporated into Membership Function (A.

Low, A. Medium and A. High). In [6], Significance and  Certainty are introduced to replace the degree of support and  confidence in traditional Apriori algorithm.

Here we regard <F,S> as an itemset, where F is the  sequence of signature(or item), S the counterpart of F in  Fuzzy Set, if  the ith signature  and ()iFS  the corresponding  Membership Function in the itemset( li ??1 , l  is the length  of itemset). For example, if A = Low, B = High and C =   Low, then F = (A, B, C), S = (Low, High, Low),  32,1 ,, fff represents A, B, C and (),(), 321 FSFSFS represents A.

Low ( ), B. High (), and C. Low () respectively. The itemset  with a length of l   may be represented by ?? SFSig . , which can  be formally defined as follows:    ||  )(   . D  vlaueoffFS  Sig  l  i  ii  Drecord  SF  =?

??

?

=     As long as cesignificaniSig SF _min. ??? , it is a large-item.

When all large-item of different lengths are found out, Fuzzy  Association Rules will be generated, with all Certainty ?

mini-certainty. The calculation of Certainty can be defined  like this: suppose <F, S> is the large-item that produces  Fuzzy Association Rules, and it is the presupposed itemset of  such rules(conditional narration), then certainty of Fuzzy  Association Rules can be defined as follows:  ??

??

???? =  ''  ''  .

.

.,.

SF  SF  SFSF Sig  Sig  Cer    (2)  l  is the length of <F, S> and k is the length of <F , S  ?. The Certainty of each rule can be calculated by ?? SFSig . /  ?? '' .SFSig  . All the rules with certainty ? mini-certainty will be  kept and the rest removed.

C. Computation of Similar Degree  Lets first introduce the computation of similar degree  between two fuzzy association rules and later between two  sets of fuzzy association rules. Suppose r1 and r2 are two  fuzzy association rules, s1 and c1 represent Significance and  Certainty of r1, and s2 and c2 represent Significance and  Certainty of r2. Then the similar degree between s r1 and r2  is calculated as:  (3)  The so-called r1=r2 indicates that it is the same between  antecedent and consequent of two conditional narrations. In  other words, different rules cant be compared and their  similar degree is zero; only similar degree of the same rules    can be computed by the above formula. As to two sets of  fuzzy association rules, suppose their similar degree are s0  and s1 respectively, the computation for will be like:  |1||0|)1,0( S  Score  S  ScoreSSSimilarity =  Where  ?

??

??

=    )1,0(  Sr  Sr  rrsimScore  |Si| represents the number of rules, i=0,1      ( 4

IV. SYSTEM  FLOW  Although [3] are based on fuzzy association rules to  study intrusion detection, they do not apply this method to  real-time detection system. In other words, it takes them a  long time to collect packet information before making offline  analysis of whether such packet flow is abnormal or not.

However, it is unable to make instantaneous response though  this method. Whats worse, if the attack time is very short,  the number with attacking signature will fail to reach  minimum support and be ignored in such long-time packet  flow. In addition, it doesnt mention in [3] how signature is  produced. Through carrying out 150 automatically collected  Dos attacks, checking possible signatures and sorting them  according to the value of Information Gain, signatures in this  paper refer to the first twelve ones with high Gain value,  under the premise of considering a system with  instantaneous ability. Last, based on identifying the source  address and fixing communication port, this system can  dynamically alter the filtering rules of the firewall (Linux' s  iptable).

Since this system regards fuzzy association rules detected  by packet flow information as its basis for judgment and  packet flow may affect setup of certain parameters, it is    suggested that the simulating tests and the actual tests should  be in the same position of the whole network topology to  receive better detection results. When doing simulating tests,  we collect packets in a specific position of network topology  for three hours and make sure if there are DoS/DDoS attacks  before simulating set of fuzzy association rules for  comparison. The concrete steps are as follows: gathering  packet traffic statistics once per unit time(2 seconds),  calculating twelve required signature values and forming the  first record of 5400 in total, written as 5399i0 ??ir ( i is the serial  number of record). In the end, we need only 3 records. Then  we try to average the total sum of records with the same  remainder when 3 is divided by the serial number and the  three averaged records will better display the state of  network traffic in a certain period. Last, the three records is  used to figure out a set of fuzzy association rules for  matching. Particularly,network traffic condition differs  greatly in different period. In order to get better detection  results and reduce false positive rate, fuzzy association rules  for individual matching is required in the experiments,  aiming at different periods, such as morning, noon,  afternoon, evening and night.

In practical tests, a record is also formed by twelve  signature values of packet traffic statistics gathered once per  unit time (2 seconds). After a set of fuzzy association rules is  worked out by three accumulated records, we compute the  similar degree between it and the rules produced in  experimental periods. If the similar degree is lower than  threshold, it is decided that there are attacks. Once attacks  occur, this system cannot automatically update the firewall to  block connection unless source of such attacks have been  traced.

Network attacks vary a lot. A complete intrusion  detection system is usually constituted by a number of  detection modules, each of which is responsible for detecting   Figure 3   Low, Medium, and High in Membership Function  certain type of attacks. On the other hand, given to  considerations of instantaneity, more than one detection  module will be more convenient for parallel processing. Any  intelligent judgment depends upon the selection of signature,  but different signatures are required to effectively detect    different types of attacks. This system mainly aims at  DoS/DDoS. Based on Information Gain values, the selected  12 signatures are arrayed in descending order as follows:  0. number of different payload length  1. number of different source IP address  2. number of different destination IP address  3. number of different TCP source port  4. number of different TCP destination port  5. number of different UDP source port  6. number of different UDP destination port  7. number of TCP protocol  8. number of UDP protocol  9. number of ICMP protocol  10. number of SYN flags  11. number of ACK flags  Each signature has three Fuzzy Sets: Low, Medium and  High. Membership Function in use is taken from Default  Function of MATLAB Fuzzy Tool Box (as follows), of  which a, b, and c can be adjusted into constants. Fig. 3 is the  instance of Membership Function. Constants of a and c in  Low are 0.3 and 30; constants of a, b and c in Medium 15, 2,  50; constants of a and c in High -0.3 and 80.

Low f ( x ) = 1 / ( 1 + exp( a ( x - c) ) )  Medium f ( x ) = 1 / ( 1 + | ( x - c) / a | ^ 2b )  High f ( x ) = 1 / ( 1 + exp( -a ( x - c) ) )  In experiments, we adjust the coefficient so that the  signature attains more significance by making Information  Gain value higher and Overlay Memory wider. However,  since not all signature statistics applies to the same Fuzzy  Membership Function, many testing experiments are  required to fine-tune each Membership Function to  appropriate values and grade of individual Membership  Function must be calculated in each signature. There are 12  signatures in one record and each signature have to calculate  its grades in three different Membership Function. In other  words, every record has 36 items, such as f0.low, f0.medium,  f0.high, , f11.low,f11.medium, f11.high,so it may mine  numerous rules in 3 records.



V. THE ANALYSIS OF EXPERIMENTAL RESULTS  The setup of system parameters differs as its operating  environment changes, because we need to take into account  in experiments which period is more accurate. Namely, the    morning detection rules is best used for network intrusion  detection merely in the morning as sometimes great changes  takes place in network traffic condition in different periods  of a day. This experiment is based on two buildings of  students dormitory and performed in the night. Of the 150  collected DoS attacking software, 100 is used in experiments  to search the above-mentioned 12 signatures (higher  Information Gain) and the rest 50 serves as testing subjects.

In order to test the detection results of this system, we have  selected three types of attacking (i.e. SYN Flood Ping of  Death and Smurf) to do   experiments. In the experiment, we  set 2seconds as an unit time and perform mining (a  judgment) once every three unit time, so a unit in the  horizontal axis of Fig.5 and Fig. 4 represents 6 seconds.

During the experiment, Fuzzy Association Rules is produced  by a long-period accumulating of packets, averaging three  records and incorporating them into algorithms of fuzzy  association rules. Through long-time collecting and  averaging, normal conditions can be better reflected, but it  have to take us more time to identify whether these packets  contain DoS attacks.

The bar graph value in Fig. 4indicates the similar degree  between fuzzy association rules and detection rules of real-  time packet information. If the similar degree is lower than  0.1(10%), it is regarded as attacks. (a) of Fig. 4shows the  experimental results when the school uses DoS-  NIC(Promiscuo  us Mode  Sniffering packet  capture feature  t ti ti  Cumulativ3  ClearHistory  yes  no  yes  Calculate the  value of grades  Mining Fuzzy  Association Rules  Threshold No  Abnormal    network  behavior  Yes  Normal network behavior  No alarm Yes  alter the filtering  rules of the firewall  Figure 2. System Flow Chart  Calculation of similarity  Identify the  source of  attack is IP?

(a)Smart                         (b)Ping of Death(school)  (c) Ping of Death(dormitory)       (d)SYN flood(school)  Figure 4. (a)~(e) Different Types of Attacks  Figure 5.  Mass Transmission      Figure 6. The Computed Value of  of Normal FTP and Similar          Similar Degree in Different Dos  Degree Measured in Different Places        Attacks111111111111111  Smurf(IGMPNUKE V1_0) at night. At the first two time  points, we perform normal network behavior, but at the later  stage of the third time point, we start attacking procedures  and keep attacking, from which it is found that the rules  detected during following time points carry low similar  degree with fuzzy association rules. The detection results in  (b) and (c) of Fig.4 show Ping of Death attacks  (TosserV2.1). In (b) of Fig. 4, Tosser attacks are suffered  continuously at time points of 6, 7, 8 and 9 and it is obvious  that they are different from normal network behavior. During  the first  (d) in Fig. 4shows the situation we detect the school by  SYN Flooderv3.0 when they are attacked by SYN Flood.

From (d) of Fig. 4, it is observed that attacks occur at time  points of 1, 4, 6, 7, 10, 11 and 12 while continuous attacks  are found at time points of 3 and 4 from (e) of Fig. 4.

Since DoS features massive packets in a moment, we use  multiple computers at the same time to download through  FTP large amounts of data to verify if our system will make  false positives. In Fig. 5, although it indicates clear decline  after the second time intervals, there is still some way from  10%, the threshold. Finally, we execute the 50 attacking  procedures thoroughly and their similar degrees are shown in    Fig. 6. In Fig. 6, each value is the average of ten times, once  each day, ten days in total. With every similar degree lower  than 10%, it suggests that the twelve signatures selected by  sorting Information Gain values and the selecting mode of  coefficients in Membership Function can immediately detect  Dos/DDoS attacks in the design of our real-time network  intrusion detection system.

Last, we emphasize that measurement of similar degree is  greatly affected by network traffic. If network packet  information changes frequently, then the measured value will  fluctuate in a larger section. Besides, the similar degree is  also influenced by density or duration of the attacking.



VI. THE CONCLUSION AND FUTURE RESEARCH  This paper mainly contributes to the design of a real-time  network intrusion detection system based on Fuzzy  Association Rules. Though we take only three units of time  to detect information traffic, there are 36 actual items in each  record and three records can detect out many rules since 12  signatures are adopted in each record and each signature  value can be incorporated into three fuzzy Membership  Functions. By comparing similar degree with experimental  rules, if they are lower than 0.1(10%), the system will regard  them as attacking events. According to experimental results,  it is found that our system can make correct judgment and  wont cause false positives towards massive FTP packets in a  moment after appropriate adjustment of system parameters.

In the following few days, our work should focus on  improving the efficiency of detecting procedures, including  cutting unit time from the present two seconds to one  second; redefining the calculating mode of similar degree;  adjusting the coefficients of fuzzy function by Genetic  Algorithm; attempting to detect based on Incremental  transaction database instead of three transaction records. In  the detection of incremental transaction database, we expect  only one more accurate detection is performed in each unit  time because both the present and the past information of the  record will be detected.

