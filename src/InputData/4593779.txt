

Fuzzy Modeling Method Based on Data Mining *   Yongfu Wang, Hong Zhao and Jiren Liu Tianyou Chai School of Mechanical Engineering and Automation  Center of Automation Research  University of Northeastern University of Northeastern Shenyang, Liaoning  Province, China Shenyang, Liaoning  Province, China  wyf3000@sohu.com    *This work is partially supported by China Postdoctor Fund (20060400962) and Shenyang Science and Technology Fund (???????	?	?? ????????	?	??	).

.

Abstract - Aiming at WM method lacking of completeness and robustness, which was presented by Lixin Wang, fuzzy system is set up by data mining in this paper. Rules base and fuzzy system produced by data mining can ergodic all the fuzzy subspace, which insures the completeness of rules base. Otherwise, rules produced by data mining are elected out in the whole sample data, but WM method is a result only from a certain datum. So, data mining has better robustness and simulation results show its validity.

Index Terms - Fuzzy logic system? modelling, fuzzy rules, completeness,  robustness,  data mining

I.  INTRODUCTION  In the modeling field of the industrial process, it is very difficult to establish accurate mathematics model for those non-linear complicated systems. In practic it is an effective method to utilize the IF?THEN rules to construct the fuzzy description model of system, but the obtaining of fuzzy rule is the key element of fuzzy modeling. Generally three kinds of methods are usually used to generate fuzzy rules: (1) The rules generated by Expert's language; (2) The rules generated from the sample data automatically; (3) The hybrid rules generated by combining sample data with Experts? language. In recent years, more attention has been paid on the method that the rules are generated from the sample data automatically, because the simple system can adopt expert's language to generate the rule. When the variables are increasing and the divisions of variables fuzzy set are overflow, it is very difficult to obtain fuzzy rules only relying on only expert language knowledge.  In the end, the methods, such as gradient descent algorithm, least square algorithm, genetic algorithm, fuzzy clustering and the neural network, etc., were proposed in succession to generate rules from sample datum automatically[1-5]. Unfortunately, these methods are required to study repeatedly or the mechanism of generating rules is too complicated. The WM obtained fuzzy rules from the sample datum has been put forwarded in paper [6], which is simple and practical, and  have already become the classical method of this field now.

In recent years, with the development of computer field and database technology, the data mining has already become a rising research field of gradually. It is a kind of extracting technology of automatic information based on database. It is a  new subject of database research that the data mining in the large-scale relation database. As a part of data mining, the mining of association rules comes to be more concerned by a lot of people in recent years. Paper [7] proposed the thought of mining association rules at first, discussed the mining problem of association rules that including Boolean attribute and applied to the large supermarket. Now people have begun to study the association rules mining which contains quantity attribute again, the algorithm proposed by paper [8] can turn the association rules question of quantity attribute into Boolean attribute through dividing discourse universe of attribute, the shortcoming of this method is mainly harder at the border dividing. Recent years, to solve the problem, it can be soften the border with fuzzy set that defined at discourse universe of attribute. In this way, the association rules question of mining quantity attribute turns to the mining fuzzy association rules question[9,10].

Aiming at a class of multiple-input-single-output fuzzy logic systems, this paper adopts data mining method to generate the fuzzy rule. Comparing this kind of method with WM, the rule base generated has good completeness and robustness, thus improved the precision of the fuzzy model.



II. FUZZY RULES MINING AND MODELING  It has been proposed that the Fuzzy system can approximate the any function of compact sets by any precision, we review the key steps and the place needing improved of fuzzy system that designed by WM in briefly.

Given the m input-output data pairs (sample data):  { }mpyx pp ,,2,1);( ?=                                (1) Where ( )pnppp xxxx ,,, 21 ?=  is the p th input variable of input-output data, py  denotes the corresponding output. The steps of fuzzy system ( )xf designed based on the m  input- output data pairs mentioned above are the following:  Step1: Divide the space of input-output into the fuzzy region.

Step2: Generate a fuzzy rule by an input-output data pair.

Step3: Give intensity to each rule in the step 2.

Step4: Construct the fuzzy rule base.

Step5: Construct the fuzzy logical system based on the  fuzzy rule base.

Proceedings of the 7th World Congress on Intelligent Control and Automation  June 25 - 27, 2008, Chongqing, China    Definition 1: There are all rules distributed in fuzzy sub- space of all combination of fuzzy set, which is defined by input variable, and such a rule base is called the complete one.

The rule base generated by table look-up method is incomplete.

Divide the i th input variable ix into ik  pieces of fuzzy set in step 1, where ni ,,2,1 ?= . Then, the rule quantity generated by the table look-up method, is restrained by two data: m (quantity of input-output data pairs) and ( )ini k1=? (all possible quantity of combination of fuzzy set defined by the input variable). If ( )ini km 1=??  , make rule base generate first incompleteness, sample data so little to cause incompleteness i.e.. In addition, if ( )ini km 1=?? , it may make rule base generate another kind of incompleteness too. That is, some sample data distribute in the same fuzzy sub space (correspondent to the same gird) to generate the contradictory rule, known from step 3, and the rule of greatest intensity is chosen.

Consider two input variables 21, xx , divide the each variable into five fuzzy sets, shown in Fig.1 and Fig.2.

Supposing that samples set  ( ) ( ){ }1010210111211 ;,,,;, yxxyxxS ?=  consist of 10 ideal input-output data pairs, it can be seen from Fig.2. that the membership value of ( )11x  is maximum in fuzzy set 1B , the membership value of ( )12x  is maximum in fuzzy set 1S , and the membership value of ( )1y  is maximum in fuzzy set CE .

The following fuzzy IF-THEN rule can be obtained by the WM:  :1R If 1x  is 1B  and 2x  is 1S   Then y  is CE         Fill CE  in the fuzzy sub space of T fuzzy rule base (cell grid marked), shown as Fig. 1. Analogize with this, the rule generated by other data pair should fill in the each fuzzy sub space respectively. But fuzzy sub space of rule base has 10 cell filled in at most, and other fuzzy sub space is empty. To smaller sample set, it is incomplete that the rule base generated by WM. Certainly, for larger sample set, if the data pairs are not distributed evenly on the fuzzy sub space that all  combination of fuzzy set is defined by input variable, it may generate the incompleteness of rule base too.

Definition 2: When the sample set is interfused by a small amount of bad data pairs, the fuzzy model determined by rule base that is generated by this sample set can still guarantee good performance, call such a rule base the robust.

The rule base generated by the look-up table dose not has a good robustness. In reality, the obtained sample data pairs are often mixed with the bad data pair, If the rule intensity generated by the bad data pairs is greater than good data pairs, bad rule is include in rule base, thus performance of fuzzy model is influence.

For the example in Fig.1, suppose that add a bad data pair ( ) ( ) ( )( )11112111 ,, yxx  into the 10 original data pairs, and suppose ( ) ( ) ( ) ( ) ,, 112    1 xxxx ==  ( ) ( )111 yy ? . Because the  membership value of ( )11y (broken line) in the fuzzy set 1B  is  maximum, the following fuzzy IF-THEN rule is generated by the adding data pair after  :2R If 1x  is 1B  and 2x  is 1S  Then y  is 1B                        in the case of same input point, since ( )1y and ( )11y are different, two contradiction rule are caused. According to the intensity definition of WM in the step 3, the last rule is adopted, and the phenomenon that bad data generate the bad rule appears. Thus, it is not reliable to generate a fuzzy rule by a data pair; the reason which generates this kind of phenomenon lies in it is not enough to generate regular support degree.

The followings are five steps of adopting data mining method to generate the fuzzy rule base. Firstly, the method guarantees that either small sample data or large sample data is complete. Secondly, this method guarantees that even though the sample data has been mixed with bad data, the rule  Fig.1 Division of fuzzy sub space and fuzzy block of prerequisite variable  (a) fuzzy subspace ?  (b) dividing of fuzzy internal of pre-input variable  Fig.2 The dividing of the fuzzy scope that inputs variable and outputs  Fig.2 The dividing of the fuzzy scope that inputs variable and outputs     based generated still can guarantee the performance of fuzzy models. That is, rule based has good robustness.

Step 1: Common relation database changes into fuzzy relation database.

In the common relation database, suppose { }DtttT ,,, 21 ?=  is a common relation database, it denotes  the i th tuple of T, { }121 ,,,, += nn iiiiI ?  denotes attribute set and [ ]kj it  denotes the attribute ki ?s value on the jth tuple.

Given { }nxxxX ,,, 21 ?= , { }yY =  is the sub set of I and ?=?YX , where X and Y  denotes the attributes sets that the premise variables and conclusion variables of multi- input-single-output fuzzy system respectively. To the premise attribute ix , iN fuzzy sets ( )iji NjA ,,2,1 ?=  are defined on every scope [ ]( )niii ,,2,1, ?=?? , and jiA is the complete fuzzy set  on [ ]ii ?? , . Similarly, to the conclusion attribute y , yN fuzzy sets ( )yj NjB ,,2,1 ?=  are defined on [ ]yy ?? , and they are complete fuzzy sets on [ ]yy ?? , , too. Through the above definitions, the fuzzy set of premise variables is { }nNnnNN AAAAAAA ,,,,,,,,, 1212111 21 ????=  and the fuzzy set of conclusion variables is { }yNBBB ,,1 ?= .

Given { }( )ninniiA NinNiAAAS ,,2,1,,,,2,11,,, 12211 ???? === ,  { }( )yjB NjBS ,,2,1 ?==  are the subset of A and B respectively. A common relation database  { }DtttT ,,, 21 ?= changes into fuzzy relation data base { }tDttSFT ??? ,,, 21 ?=  and BA SSS += denotes the fuzzy attribute set.

Step2 calculating the support degree of rules From the data mining point of view, if a piece of rule has  practical meaning, it must have the enough support. It reflects sample tuple?s support to this piece of rule. Now the support is defined as the following:  ( ) ( ) D  yx YXSupp  D  k kBS  n  i  k ii  AS ? ?  = = ? ?  ? ? ?  ? ? =	 1 1)(  ?? (2)  Where ( )kiS xiA?  is the membership of ix ?s i th component in the fuzzy set AS , ix  is premise variable which is in the k th tuple of sample tuple after normalization. ( )kS yB?  is the k th  tuple?s conclusion fuzzy attribute y ?s membership in fuzzy set BS , D  is the whole amount of tuple.

Step3: establishing the complete fuzzy rule base Firstly, the algorithm should guarantee every fuzzy  subspace that consists of premise variable can be ergodiced.

Secondly, which fuzzy set that conclusion variables choose from fuzzy sub space is up to the largest support of rules. The main steps of the algorithm are as following:  { }  end  YXSuppMaxYXRuleFuzzy fSub  AAAS  inNinfor  iNifor iNifor  in n  ii A  n  }  } );(_)(_  ;1_ ;,,,  {);;1(  )2;;12(  ){1;;11(      ?  ?  ?  =  =  ++=  ++=  ++=    Where, 1_ fSub is used to calculate which fuzzy set of conclusion variables is adopted, the main process is as the following:  { } [ ] ( )  return  NEEYXSuppMax end  YXSuppjE  BS  jNjfor fSubprocedure  y  j B  y  );][,],1[(max)(_  } ;  ;  ){;;1( 1_  ?=  =  =  ++=    Step4: Utilize confidence to reduce the rules A fuzzy system is set of ?IF?THEN? rules mapping  from input to output. The more rules there are the better approximate performance it has. But as the input variables and the division of variables fuzzy set increases, the quantity of fuzzy rules are also exponential growths, then there is no doubt to generate rule explosion. The above method generated by mining method is complete. When the quantity of premise variables and division of variables fuzzy set is not too much, it is completely right to adopt these complete rules. But when they are too much, the confidence of rules can be used to reduce the rules.

( )[ ]? ? = =  = D  k  n  i  k iS  x D  YXSuppYXConf i A1 1  )()(  ? (3)  The incompleteness of rule base generated by this reduction is based on the rule base?s completeness. In order that system implement reduces manually the those lower confidence rules, which is different from rule base?s incompleteness that WM generates in essential  Step5: construct fuzzy logic system based on fuzzy rule base.

After constructing fuzzy rule base, monodrom fuzzification, multiplication operation, and weighted average defuzzification are adopted to obtain the following multi- input-single-output fuzzy logical system. Define:     ( )[ ]iInij xji?? ???= 1                  (4) Where AI ? , jiI denotes i th premise variable?s a fuzzy set for jth rule that after rule base reduction ?  denotes the membership on this fuzzy set. Fuzzy set can be denoted as:  ( ) ( )[ ]  ( )[ ]? ?  ?  ?  = ??  = ??  =  =  ?  ? == M  i iIni  M  j iIni  j  M  j  j  M  j  jj  x  xyy xf  j i  j i      ?  ?  ?  ? (5)  Where, iy is the maximum value point of fuzzy set membership function of conclusion variables, M is the amount of rules of fuzzy rule base after reduction. The prove of fuzzy system (5)?s universal approximation properties refers to paper[6].

The rule base generated by data mining method is ergodic to all the fuzzy sub space of premise variable. The result of this ergodic guarantees rule base?s completeness. In addition, a piece of rule generated by data mining method is the result that all sample data elects, while a piece of rule generated by WM is only the result that a data elects. We have reasons to believe that the rules elected by data mining method are more reliable and more believable than the rules elected by the WM.

Even though there are individual bad data in sample datum, the bad datum can be efficient shielded by mass good datum.

The phenomenon that bad datum elects bad rules is restrain to some extent.

. III.  EXPERIMENT STUDY Example 1: Compare rules generated by the WM, data mining method with the fuzzy system formed by equation(5) to approximate the following nonlinear function  )5sin(1.0)3sin(3.0)sin(6.0)( uuuuf ??? ++= Given the scope of the input u  is [ ]1,1?  and it is divided into 9 fuzzy sets, f  is divided into 7 fuzzy sets, membership function adopts Guassian function, the sample datum and rule base are as table 1, 2. The simulation has three cases:  Case1: when the sample set adopts { }11,,2,1 tttT ?= , the rule bases generated by two kinds of method are the same, the fuzzy models generated are the same too. The result of simulation is as Fig.3(a).

Case2: when delete the data record 2t  in sample set and adopts { }11,,3,1 tttT ?= , the rule base generated by WM is not complete while the rule base generated by data mining method is still complete. The result of simulation is as Fig.3(b).

Case3: When add a bad record 12t  to sample set and adopt { }12,11,,2,1 ttttT ?= , in the case of bad data?s disturbing, the phenomenon that bad datum elect bad rules in WM while the rule base generated by mining method avoids this phenomenon. The result of simulation is as Fig.3(c).

Table1 sample datas   Table2 fuzzy rules base      (a) Case1  models output  ?   (b)     Case2 models output   ????????? (c) Case3 models output  Fig.3 the contrast of output of models in three cases  Note: The ergodic premise of the fuzzy model is not high above? which is caused by the division number of the premise variable?s fuzzy set and the number sample. In this simulation example, we pay     attention to the contrasts of two kinds of methods even more, so not paid attention to approaching the precision.

Example 2: Use the rule base generated by data mining method and fuzzy system formed by equation (5) to approximate core functions of scatter correction in pet    l   Fig.4 rebuilding image based on WM method      Fig.5 rebuilding image based on data mining  Where, the client application program is realized by MFC class  library while calculate membership, calculate support, calculate confidence and fuzzy base function adopt ATL class library to realize the in-process component. Mining interface of fuzzy rule includes a set of data construction. Through this set of data construct, client code may call the function that fuzzy rule mining COM object.



