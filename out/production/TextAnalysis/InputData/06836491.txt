Performance Characterization of Phase Gradient Autofocus

Abstract-Phase Gradient Autofocus (PGA) is an effective  algorithm for estimating and removing piston-phase errors  from spotlight-mode synthetic aperture radar (SAR) data. For  target scenes dominated by a point source, the algorithm has  been shown to be optimal in the sense that it approaches the  Cramer-Rao bound for carrier-to-noise ratios (CNRs) as low as  -5 dB. In this paper, we explore PGA's effectiveness against ground-based inverse synthetic aperture LADAR (ISAL)  observations of spacecraft, where the target characteristics and  phase errors are quite different than in the SAR case. At  optical wavelengths, the power spectrum of the piston-phase  errors will be dominated less by platform motion and more by  atmospheric variations. In addition, space objects will have  fewer range-resolution cells across them than would a typical  extended SAR scene. This research characterizes the  performance limitations of PGA for an ISAL system as a  function of CNR and the number of range-resolution cells  across the scene. A high-fidelity wave-optics simulation is used  to generate representative test data for input to the PGA  algorithm. Emphasis is placed on finding the lower limits of  performance for which image reconstruction is possible.

T ABLE OF CONTENTS  1. INTRODUCTION ?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?. 1 2. BACKGROUND .................................................. 2 3. EXPERIMENTAL P ARAMETER SPACE ?????????????? 3  4. RESULTS AND DISCUSSION .............................. 6  5. CONCLUSION ?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?. 8 REFEREN CES ...................................................... 10 BIOGRAPHIES .?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?.?. 11  1. INTRODUCTION  Spotlight-mode Synthetic Aperture Radar (SAR) systems use radio-frequency (RF) illumination and relative movement between the object and observer to synthesize large apertures and produce high-resolution terrain images [1]. As such, SAR system concepts may be applied to laser radar (LADAR) systems; specifically, inverse synthetic aperture LADAR (ISAL) systems for the purpose of imaging geosynchronous Earth orbit (GEO) space objects [2, 3]. The  U.S. Government work not protected by U.S. copyright  benefit of ISAL systems is that they only require meter-class telescopes to obtain high-resolution images of GEO space objects. This is in stark contrast to conventional imaging  systems, which require 10 m apertures or more because of  the large distances involved (around 40 Mm).

Just as large-aperture telescopes have their drawbacks, so do ISAL systems. One must trade the difficulties associated with building and operating a 10 m class telescope for the difficulties associated with actively illuminating a distant object and coherently detecting the return signal. Therefore, it is important to fully understand and characterize the performance limitations of ISAL systems prior to their  construction.

One performance limitation of an ISAL system is piston? phase error, and there are many factors which contribute to this performance limitation. These factors include residual platform motion, local oscillator instabilities, sensor noise, speckle decorrelation, and atmospheric turbulence. With that said, phase gradient autofocus (PGA) is an effective algorithm for estimating and removing these piston-phase errors from ISAL images; however, there are two parameters which must be taken into account when evaluating performance. The first parameter is the number of range? resolution cells, which is dictated by the pulse bandwidth and the range depth of the object. Since GEO space objects have fewer range-resolution cells across them than a typical extended SAR scene, this parameter is an important contributor to PGA performance for ISAL imagery. The second parameter is the Carrier-to-Noise ratio (CNR). This parameter depends, in general, on the number of detected photons. For GEO space objects, ISAL systems operate in a photon-starved regime; thus, this parameter also contributes to PGA performance and should not be overlooked in the  analysis.

This paper uses a high-fidelity wave-optics simulation tool known as SimiSAL [3] to generate representative image data for input to a generic PGA algorithm. Throughout the analysis, emphasis is placed on finding the lower limits of performance for which image reconstruction is possible. In    so doing, this research characterizes the performance limitations of PGA for ISAL imagery as a function of CNR and the number of range-resolution cells across the scene.

Section 2 of this paper reviews the necessary background information, Section 3 provides a description of the experimental parameter space, Section 4 discusses the results, and Section 5 provides a summary of the results with  a brief description of future work.

2. BACKGROUND  Numerous autofocus algorithms exist in the literature to mitigate the effects of piston-phase errors in SAR imagery.

One robust autofocus algorithm is PGA. Originally  introduced in the late 1980's from the SAR research being performed at Sandia National Laboratories [4-7], PGA shares many similarities to the optical image processing algorithms of Labeyrie [8], Knox Thompson [9], and shift and add [10]. It also serves as a standard in most autofocus trade studies since PGA was thoroughly characterized by the mid 1990's [1, 11, 12]. Since then, much effort has gone into optimizing PGA's performance for SAR imagery [13-  24].

To date, little has been published on PGA's performance for  ISAL imagery. Gatt et al. performed a study which looked at the variance of the phase-difference estimator between pulses as a function of CNR [25]. This study was successful  in characterizing PGA's performance at high CNRs. The results showed that for a uniformly illuminated diffuse rectangle object, the phase-difference estimator meets the Cramer-Rao bound (CRE) up to a saturation point. At high CNRs, speckle decorrelation dominates, and the results showed that the estimator variance does not meet the CRE.

With this in mind, the following sub sections provide background information which help in characterizing the performance limitations of PGA for ISAL imagery at low  CNRs.

Piston-Phase Error and Atmospheric Turbulence  When propagating light through a turbulent atmosphere, phase changes occur due to a non-uniform refractive index profile. These atmosphere-induced phase aberrations can efficiently be described by an orthogonal basis set such as Zernike polynomials. Piston, the first Zernike polynomial, is the average of the wavefront phase integrated across a  circular aperture.

Typical non-coherent imaging systems are blind to piston aberrations since the average phase is not measured and does not affect image quality. In contrast, ISAL systems use heterodyne techniques to measure the phase of an optical signal averaged across the aperture. The return signal from a transmitted laser pulse is mixed with a reference pulse to estimate changes in phase over time. As such, atmospheric piston variations result in phase noise which corrupts the desired signal. While aperture-target motion, laser phase drift, and even sensor noise can contribute to unwanted phase variations in the ISAL data, these factors may be overcome by design before they corrupt the measured data.

Atmospheric piston variations, on the other hand, tend to dominate the raw data and can only be overcome by post  processing.

In a well-designed system, the pulse duration is much  shorter than the time scale of the atmospheric variations. All samples along the length of the pulse (the range dimension) encounter the same atmospheric piston change. However, as more and more pulses are concatenated to from a two? dimensional array, the changes in atmospheric piston create a phase variation in the cross-range dimension. This one? dimensional wavefront error acts to blur the reconstructed image along that dimension.

Post processing algorithms known as autofocus blindly  estimate the one-dimensional wavefront error and deconvolve it from the image, thereby removing the blur.

These algorithms take advantage of the fact that each sample in the return pulse (which translates to range bins when range compressed) experiences the same atmospheric piston effects. They assume that the object phase has zero mean and is statistically independent from range bin to range bin.

Therefore, only atmospheric piston-phase errors are common across all range bins. Taking the ensemble average of either the phase or phase differences, improves estimation of the wavefront error. In low CNR conditions, the phase-error estimate for each range bin has a high variance, and more samples are needed for the ensemble average to converge to  the true solution.

Generic Phase-Gradient Auto Focus Algorithm  PGA in its most generic form contains seven algorithmic steps [1, 11]. These steps are displayed in Figure 1 with a flow chart and image examples. Step 1 is to acquire complex image domain data which is blurred by piston? phase error. This data is then input into an iterative correction process. Step 2 is to shift the data. Here, the brightest scatterer in each range line is shifted to a user defined location (as shown, the left-most column of the data set) with wrap around from the edges. Step 3 incoherently sums along the shifted range lines to obtain a one? dimensional range average. An initial window is then determined by finding the 10 dB point from the peak and increasing the width by 50%. Subsequent windows decrease  in width by 20% for each iteration [11].

Step 4 is to take the discrete Fourier transform (DFT) along the cross-range dimension to obtain range-compressed  image domain data, F(m, n), where m refers to the mth range line and n is the nth cross-range column. The phase differences tl$(n) are then estimated in Step 5 by using the following kernel:  tl$(n) = arg{L?=l F(m, n)F*(m, n - 1)}. (1) From Eq. (1), the entire aperture phase error $(n) is estimated by integrating the estimated phase differences  tl$(n), viz.

$(n) = L?=2 b.$(k); $(1) = o. (2) Step 5 continues by computing the root mean square (RMS) phase error and checks to see if it meets a threshold value of  Step 1 Input complex image domain data  Step 2 Shift brightest scatterers  Step 3 Determine and apply window  Step 4 DFT in cross range dimension  Step 5 Estimate phase error  RMS phase error < 0.5 rad Yes  Step 6 Apply phase correction  Step 7 Inverse DFT back to image domain  (a)  <0.5 rad. If yes, the algorithm is done; otherwise, the  algorithm continues.

Blurred image  First  (b)  Third  iteration  Figure 1 - A generic implementation of phase gradient autofocus (PGA). (a) describes the implemented algorithm with a flowchart, whereas (b) provides corresponding image examples.

Step 6 applies the phase correction. Mathematically, this manifests from Eq. (2), so that  Fc(m,n) = F(m,n)exp[-j$(n)], (3)  where Fc(m, n) is the corrected range-compressed image domain data. Step 7 takes the inverse DFT of the corrected range-compressed image domain data to acquire complex image domain data once again. The process is then repeated until the RMS phase error threshold value of <0.5 rad is achieved. In practice, this usually takes less than five iterations [1, 11]. Our implementation was limited to a maximum 100 iterations.

Comparison to the Cramer-Rao Bound  Previous assessments of autofocus performance [1, 25] have compared the observed empirical performance of auto focus algorithms to the CRB, which is a lower bound on the variance of an unbiased estimator. The idea is that if an algorithm can be shown to provide unbiased estimates and to   have variance matching the CRB, then it is optimal in the sense that no other unbiased estimator can have lower variance. However, the utility of these comparisons is limited in the sense that the CRB is target-dependent and the  cited results address the CRB for a target consisting of a single point reflector per range line. This is representative of SAR imagery, but at optical wavelengths the targets are not strongly specular. In this work, we study performance trends as a function of CNR and number of range bins, but  do not report target-specific CRB comparisons.

3. EXPERIMENTAL PARAMETER SPACE  In the following analysis, a high-fidelity wave-optics simulation tool known as SimlSAL was used to generate representative ISAL imagery [3]. SimlSAL uses a modular architecture, so that the wave-optics simulation, detector simulation, and image processing can be done independently of one another. As a result, parameters can be varied in each    module without having to rerun the entire simulation. This is an important step in the analysis due to the high computational requirements involved. SimlSAL was developed exclusively in MATLAB? and uses AOToois [26] and WaveProp [27]. These robust MATLAB? toolboxes were created by the Optical Sciences Company  (tOSC) specifically for simulations involving wave optics.

SimlSAL is executed using the DoD High Performance Computing Modernization Program's (HPCMP) Enterprise Portal. The HPCMP Portal streamlines the use of HPC resources. MA TLAB? code is dragged and dropped to a web browser of choice, where it is uploaded to the Portal and automatically distributed amongst the HPC nodes.

While SimlSAL was not developed to maXimize  parallelization, the Portal does allow multiple realizations or trades to be run simultaneously. With simulated seconds of  run time requiring more than 40 hours of computational time, the Portal is a vital resource.

A simple three-bar object model (shown in Fig. 2) was used to generate images. The target had a single vertical rotation axis with no articulation. Some of the input parameters used are listed in Table 1. With this in mind, a single wave-optics simulation was used for all trades studies considered in this research. The number of range bins and CNR were varied in the detector and image processing modules. This allowed identical atmospheric and target effects to be applied for all test cases, as well as reducing the computational resources  required.

OCSMap  Depth Map  Rotation Map  I I  o (1/srf  1m)  (11m/sec)  Figure 2 - The three-dimensional object model input into SimISAL. These three data maps provide optical cross section (OCS) reflectivity, depth/range, and rotation of  each point in the x-y object plane.

Table 1 - Input parameters used to generate images.

Parameter Value  Laser wavelength 1064 urn  Laser power 2 kW (scaled from 0.004-2)  Pulse repetition frequency 200 Hz  Duty cycle 100%  Wave-optics sample rate 400 Hz  Simulation time 8 s  Aperture diameter 4 m  Object rotation rate 1 fJrad/s  Object OCS 10 m2jsr Object zenith angle 45 degrees  Detector sample rate 100 kHz  Number of detectors 2  Quantum efficiency 0.5  AID bits 8  Carrier-to-Noise Ratio  There are several different metrics used in practice to quantify a signal-to-noise ratio (SNR) for coherent imaging systems [29-31]. In this research, we use CNR which is  defined as the ratio of the signal power Ps to the noise power Pn. It is equivalently defined in terms the number of detected signal photons Ns, so that  (4)  where 1Jd is the detector quantum efficiency and 1Jh is the heterodyne mixing efficiency. In well-designed ISAL systems, the dominate noise source is shot noise from the local oscillator. Shot noise acts like a noise floor which is present in all parts of the image. Depending on the strength of the target signal, the shot noise can swamp an image making it difficult to identify the object from the background. CNR is a legacy metric from the RF community. Loosely speaking, it is a SNR for shot noise limited detection processes. When using CNR, the variations due to speckle are ignored. As such, CNR is not limited to a value of one like the speckle SNR is [32]. This makes CNR a more useful metric when quantifying ISAL  system performance.

Single-pulse, or range-compressed CNR refers to the value computed in the range-compressed domain. For ISAL  systems, the image CNR is typically higher than range? compressed CNR since the image fill factor (ratio of object width to field-of-view) is less than one. In these cases, the range compressed signal density increases when cross-range compressed because the signal bandwidth is only a fraction of the total image bandwidth. This increase in signal density, relative to the noise floor, boosts the final image CNR proportionally. Since autofocus algorithms typically estimate phase errors in the range-compressed domain,    performance will be shown as a function of range?  compressed CNR in the analysis to follow.

For the trade studies conducted in this research, the CNR was varied by scaling the wave-optics return signal power by the laser power values given in Table 1. This was done prior to processing in the detector module of SimISAL. As a result, the detection efficiency remained fixed. Care was taken to adjust the power scaling to maintain the desired CNR as the number of range bins was changed. For each simulation, the theoretical CNR was computed based on the known signal strength and was also measured in the reconstructed images. Measuring the CNR of an image is straight forward for a uniform target, such as the three-bar target used in this research. In so doing, the mean power is  measured over both the target and the background. The background power is then subtracted from the target power  to get signal power, and the ratio of the signal power to the noise power is then calculated to obtain the measured CNR.

Throughout the analysis, the measured CNR matched the  theoretical estimate to within 10% error.

Range-Resolution Cells  Each range bin across the target allows an independent estimate of the cross-range phase error. As the number of range bins increases, the variance of the estimator decreases.

This improves the correction process for autofocus algorithms. Therefore, both the CNR and the number of  (a)  b.t (b)  I b.Bw  I Hof  b.f (c)  range bins should be considered when characterizing PGA's  performance for ISAL imagery.

The idea of range bins may be foreign to most people even if they have image processing backgrounds. To make this concept manifest, consider Fig. 3. After mixing with the local oscillator, the return signal from a single pulse is composed of a D.C. term plus a superposition of crossterms with frequencies which depend on the range at which they were reflected, as shown in Fig. 3a. The spread of  frequencies or object bandwidth t:,.Bw, is determined by the Iinear-frequency-modulated (LFM) chirp rate f3 and the  range depth Z of the target. The total signal shown in Fig. 3b  has a duration M, with sample period at. This total signal can be thought of as a sum of Cosines multiplied by a rectangle function. When the signal is Fourier transformed, the result is delta functions, scaled by the object reflectivity at each observed frequency, which are convolved with a sinc  function due to the finite duration M. For a tilted target with uniform reflectivity, each crossterm has equal amplitude and the result is similar to a rectangle function, as shown in Fig.

3c. Since frequency can be converted to range, the Fourier  transform generates a one-dimensional image.

} time  I  \ frequency / range  b.B = pz w C  8f=-b.t  b.f =-8t  b.Bw #Rb= - of  Figure 3 - Simple example showing the decomposition of a single pulse after mixing with the local oscillator (a), the superposition of all the beat frequencies (b), and the range compressed image (c). All variables are defined above in the  main text.

There are three important quantities to consider in the range? compressed image. First, the total field of view or grid  length is determined by the sample period (it in the time domain. Second, the sample rate should be high enough to  sufficiently resolve the bandwidth b.Bw of the object return, otherwise aliasing will occur. Finally, the frequency  resolution of or grid size in the image domain is determined  by the total length of the pulse M. With this in mind, the number of range resolution cells #Rb comes from the ratio of b.Bw to of, and is effectively the number of resolution elements across the target's range extent. This number can  be changed by either increasing the chirp rate f3, and  therefore the object bandwidth b.Bw, or by increasing the  pulse duration M, and therefore the frequency resolution of.

For this study, the chirp rate was scaled to obtain the desired  number of range bins. This allowed the pulse duration and  number of pulses to remain constant for all cases studied.

4. RESULTS AND DISCUSSION  Two types of piston phase errors were considered in this research, realistic variations simulated using SimlSAL which have been validated against Kolmogorov theory, and the extreme case of white phase noise with random draws for each pulse uniformly distributed in the range (-n, n]. The RMS phase difference between the simulated piston and the PGA solution was used as a metric to measure performance.

While several other metrics were considered including Strehl ratio and image/phase correlations, the RMS phase difference was found to be the most robust in characterizing where PGA fails at low CNR values-the overall goal of this research.

Atmospheric Piston-Phase Error  Figure 4 shows the simulated piston from SimlSAL over a two second period. The black line is the simulated piston, and the blue line is the solution that PGA uses to correct the  blurred image for this particular case. The cyan line is the difference between the two and is used to compute the RMS value. This piston phase was used for all cases considered (except for the white noise cases which will be discussed  below).

Figure 5 shows the RMS phase difference as a function of CNR and the number of range bins. It is the ensemble average of 10 separate realizations each having independent  shot noise. Initial testing showed that this parameter space adequately captured the points at which PGA failed. This can be clearly seen by the difference between the dark blue region in the top right where PGA reduced the RMS down to a few radians, and the multi color region in the lower left, where PGA failed resulting in very large RMS values.

Figure 6 shows slice plots of Fig. 5 for each of the 10 separate range bin values. The sharp drop in RMS as a function of CNR shows that PGA either corrects an image   well down to approximately 1 rad RMS, or it fails and creates huge phase errors of greater than 100 rad RMS.

There is very little transition between the two extremes.

Figure 6 also shows how this point of failure moves to lower CNR values as the number of range bins increases. With 50 range bins PGA works down to CNRs of approximately 0.3.

Many ISAL applications may not have this many range bins, and must compensate by improving the CNR in order to  correct slow-time piston phase errors.

'Q <'I   ..:::.. -2 = o -'"  ? -4  -6 - PGA - Actual - Error  -8?----?------?----?======? o 0.5 1.5 2  Time [ I  Figure 4 - The simulated atmospheric piston-phase error from SimISAL (color available online).

'" = iii 35 <Ii OJ) ;; 30 0::  '-  ? 25 <Ii  ? a 20 ::: Z    5 0.2 0.4 0.6 0.8 Range-Compressed CNR  1.2 1.4 IradJ  Figure 5 - RMS phase error as a function of the number of range bins and range-compressed CNR for the  simulated atmospheric piston-phase error. The number  of range bins is varied over ten values ranging from 5-50 range bins, and the CNR is varied over 24 values ranging  from 0.2 to 2.

102?--------r---------?--------?--------'---------?---------r---------r--------?  - 10 - 15 - 20 - 2 5 - 30 - 35 IIIIIH U II1I 40 111111111111 45 ............ 50  " 'm? ? ..rRijm:::? : ! ' ##'1, '1#1/1111 ? '''II'''tI'"IIIIIIIII1' "1, "'''I,,,",,nll1 1'-  '?IIIIIIIII'rt.fI' "'I'hu,'UIII,U'IUI"III II .. IIIIIIIII'III'IIIIIIIIIIIII .... ,,,,,I"?  10-1 L..:::::===----L ___ ---1.. ____ L-___ -L ___ --L ____ -L-___ ---L ___ --.J o 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6  Range-Compressed CNR  Figure 6 - Slice plots of Fig. 5 showing RMS error versus range-compressed CNR for the simulated atmospheric piston? phase error (color available online).

'" = ? 20 ? OJ) = eo:  ? '=

I. ? .Q 15 8 =  z    0.2 0.5 1 2 5 10 Range-Compressed CNR  Figure 7 - Reconstructed images with the same realization seed of shot noise for the simulated atmospheric piston-phase error. The images are concatenated together as a function of the number of range bins and range-compressed CNR.

White Noise Piston-Phase Error  The same results that were presented above for realistic atmospheric piston-phase errors are also presented below for white-phase noise in Figs. 8-11. Figure 8 shows the extremely high variance of the white-phase noise after it has been unwrapped. While PGA follows it closely, the large variations lead to higher RMS values obtained from the cyan line. Even though the RMS values are higher, the PGA solution is still able to sharpen the reconstructed image.

This behavior is consistent with the results of Wahl et al.

[11]. Figures 9-11 show similar performance as seen above; however, the failure points have been shifted to higher CNRs. This means that PGA requires higher CNR to reconstruct an image when the phase is rapidly changing  from pulse to pulse. In addition, the "knee in the curve" is less distinguished in terms of where PGA fails. It is  conjectured that this "blurring" of the performance limitations is a result of the higher phase differences obtained from the representative data given in Fig. 8. This  point is a topic of future research.

5. CONCLUSION  This paper extends previous efforts in PGA performance analysis by using high-fidelity wave-optics simulation and realistic atmospheric piston variations to characterize how well the algorithm works on ISAL imagery in low CNR environments. White piston phase noise was also considered to help fmd performance limitations under worse-case conditions. A representative ISAL target was used and the number of range bins was varied along with CNR. The RMS phase error of the PGA correction was then computed.

This allowed the performance limitations of PGA to be fully  mapped out over a wide parameter space.

The results showed cutoffs in PGA performance as a function of the number of range bins and the CNR. PGA either improved the image or made it worse by adding significant phase errors. As the number of range bins increased, PGA required less CNR to perform. While this is  not a new concept, we can now use this mapping to design  ISAL systems which use PGA to correct slow-time phase errors. While many SAR or SAL images may have a large number of range bins, ISAL targets may not offer the same benefit. Therefore, precisely understanding how much CNR is needed given a smaller number of range bins is extremely  important to ISAL system design.

Future work will focus on testing several of the PGA optimizations that have been published. Characterizing   performance of two-dimensional autofocus algorithms is also of interest. These are necessary when the piston is not constant during a single pulse. Such is the case for longer pulses or higher frequency phase errors.

30?- ---?----??----r=====?    o 0.5 I Time lsi  - PGA -Actual - Error  1.5 2  Figure 8 - The simulated white noise piston-phase error (color available online).

'" 40 c 70 ? 35 Qi 60 ? ; 30 50 ?  ...

0 25 ... 40 Qi E 20 30 = ;Z 15 20  10 10 5 2 4 6 8 10 12 14 Iradl  Range-Compressed CNR Figure 9 - RMS phase error as a function of the number  of range bins and range-compressed CNR for the  simulated white noise piston-phase error. The number of  range bins is varied over ten values ranging from 5-50 range bins, and the CNR is varied over 24 values ranging  from 2 to 100.

- 5 -10 -15 - 20 -25 - 30 - 35  --...-1 .......... ... 40 ............. 45 "' .. "" .... 50  100?--?------?------?------?------?------?------?------?--------?----? 2 4 6 8 10 12 14 16 18 20  Range-Compressed CNR  Figure 10 - Slice plots of Fig. 9 showing RMS error versus range-compressed CNR for the simulated white noise piston? phase error (color available online).

'" .:: Q:l 20 ? OJ) = e':  " '0

I. ? ,Q 15 E =  z    1 5 10 15 20 30 Range-Compressed CNR  Figure 11 - Reconstructed images with the same realization seed of shot noise for the simulated white noise piston-phase error. The images are concatenated together as a function of the number of range bins and range-compressed CNR.

