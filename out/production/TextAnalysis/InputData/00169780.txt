Set-Valued Multiple-Target Tracking  Wynn Stirling and Jeffrey Thompson

Abstract- The performance of a MTT (multiple target tracking) method should degrade gracefully as the conditions of the collection become less favorable to optimal operation. By stressing the avoidance, rather tlian the explicit minimization, of error, we obtain a decision rule for trajectory-data association that does not require the resolution of all conflicting hypotheses when the database does not contain sufficient informa- tion to do so reliably.



I. INTRODUCTION  Multiple Target Tracking (MTT) is a time-varying joint decision and estimation problem consisting of a rule t,o associate sensor outputs and target vehicle trajecto- rics and an estimator to calculate the trajectories based upon the associated sensor outputs. The solution to this problem requires the extraction from the data of as much iiiformation as possible about the number of targets and the trajectory of each. It is desirable to distinguish reli- ably all targets of interest from background noise, and to associate accurately each target with the available data.

We develop a trajectory-data association decision rule khat is expressed in terms of two probabilities: one govern- ing the informational value of the association hypothesis, and one governing the subjective belief, or credal, prob- ability of the association hypothesis [2]. We also define a criterion of serious possibility, and all trajectory-data associations that are seriously possible are retained; it is tiot necessary to resolve all conflicting hypotheses before processing more data.

We employ an set-valued estimator, rather than the conventional point-valued estimator] to describe the evo- lut,ion of t,he vehicle trajectory. The set-valued estimator is based upon the set-valued Kalman filter [3], which com- prit,es a convex set of trajectories] all with equal claims t,o validity, given the observations. If a trajectory is com-  Manuscript received 29 July, 1991. This work was supported by ESL, Inc., Sunnyvale, CA.

pletely observable, the radius of the convex set decreases to zero as the quantity of data increases, and the set-valued estimate asymptotically becomes point-valued. Under less favorable circumstances, the radius of the set remains fi- nite and may even grow, thus providing a more comprehen- sive characterization of the trajectory than does a single point estimate.

11. EPISTEMIC UTILITY THEORY  For an inquiry under investigation, suppose there are finitely many hypotheses that may be considered. Let U denote this set of possible answers and assume that exactly one element of U is correct, and that all elements of U are consistent with our present state of knowledge. U is said to be an ultimate partition, and a potential answer is the collection of hypotheses remaining after we have rejected all members of a subset of U .  Each element of a poten- tial answer is said to be a serious possibility. A potential answer is degenerate if no elements of U are rejected, and we may not reject all members of U .

Epistemic utility is a probability that is composed of a convex combination of two probabilities] one measuring the importance of acquiring new information, the other measuring the importance of avoiding error. For any g c U ,  we define the utility of accepting g in the interest of avoiding error as 7 ( 9 ; 1 )  = 1 if C = true, and 7 ( g ; l )  = 0 if C = false. In addition to  the cost of error, we also apportion a unit of informational value to each hypoth- esis hi E U by assigning to elements of U non-negative real values such that their sum is unity. If we enumerate U = {hl, h z , . .  . , hn}, and let M ( h j )  2 0 denote the value assigned to h j ,  then C;=lM(hj )  = 1, and for any set g c U ,  we define  M ( s ) =  p @ j )  (1) hjEg  as the informational value of rejecting g. The utility of accepting g in the interest of acquiring new information regardless of its truth-value is, then, C(g) = 1 - M ( g ) .

773 ISSN# 0-7803-0233-8/91$1.0001991 I E E    We may address the conflict that exists between the goals of avoiding error and acquiring information by defin- ing an epistemic utility function for acquiring error-free knowledge (that is, making a decision) as the convex com- bination u ( g ;  e )  = a l ( g ;  e )  + (1 - a ) C ( g ) .  The quantity (Y represents the relative importance attached to avoiding error versus acquiring new information. We must restrict  5 a 5 1 to ensure that no erroneous answer is pre- ferred to any correct answer. Since all utility functions that are related by a positive linear transformation are equivalent, we may simplify this utility function by defin- ing u " ( g ; e )  = i u ( g ; ! )  - *. The resulting utility func- trion for accepting g in the interest of both avoiding error and acquiring new knowledge is  where b = % is the coefficient of boldness. This coeffi- cient is constrained to lie in the interval [0 11. The closer b is to unity, the less caution is exercised that error will be int,roduced (increased boldness in accepting hypotheses); t,he closer b is to zero, the lower the risk of error (decreased 11 o 1 d n ess) .

We must also establish a probabilistic measure of belief for the hypotheses that are available. Credal probability is probability formed on the basis of subjective judgment, represents the likelihood that an option is true, and is i ridependent of any informational value or demand that nriglit, be associated with the option.

For a given ultimate partition U,  let Q ( g )  denote the credal probability assignment to any element g c U .  For g c U ,  the expected utility is  E Q " ~ ( S ; ~  = [1 - bM(g)lQ(g) - bM(g)[l  - Q ( g ) l = Q ( s )  - bM(S) ,  where EQ( . )  is mathematical expectation. This expected ir(,ility represents a tradeoff between the desire to acquire irew knowledge and the desire to avoid error. The choice of /I establishes a threshold at  which the demand for knowl- edge renders the risk of error worthwhile.

We may adopt any set of hypotheses in the Boolean algebra generated by the elements of the ultimate parti- t,ion, U .  This expands our possibilities; we are not con- strained to select only the elementary hypotheses, hi ,  but itlay choose any subset of them. This decision philosophy inlay be summarized as follows: Levi's Rule of Expected Utility [l, page 531: Given n j i i r i le  ultimate partition U ,  an information-determining Ilrohability function M defined over the Boolean algebra oj eleriients of U ,  an expectation-determining probability funclion Q defined over the same algebra, and an index  of boldness b ,  the agent should reject all  and only those elements of hi E U satisfying &(hi) < bM(hi).

111. MULTIPLE TARGET TRACKING  A .  Track Initialization  We assume that each track is characterized by a linear stochastic dynamics model of the form  xjt = Fjt-lxjt-1 + Gjt-1ujt-1, (3) where j  = 1 , 2 , .  . ., '& and ujt-1 - N(0, Qjt-1) (i.e., uit-1 is Gaussian with mean 0 and covariance matrix Qjt-1); there are '& active tracks at time t ('& is unknown). The number of tracks is allowed to vary since tracks may be initiated or terminated at any time. We assume that all tracks lie in the same state space.

In the interest of brevity, we shall restrict attention to the outputs of a single sensor, and assume that this output may be characterized by a linear stochastic model of the form  Z i t  = Hitxjt + Vit ,  i = 1,. . ' S t ,  (4) where st is the number of observations vectors at time t and zit is an Tit-dimensional random vector, and vjt - N(0,  &). Each observation vector, therefore, lies in an rit dimensional space corresponding to the column space of Hit .  We assume that each such space is a subset of the state space (rit 5 n). We do not, however, require all observations to lie in the same dimensional subspace of the state space, and we permit the dimensionality of these column spaces to be time-varying.

Before data are collected, we characterize the target environment with one set-valued track defined by an initial credal matrix KO, an initial centroid state col and a prior covariance matrix IIo. The initial state-vector set is  XOlO = { x - NI:, p o l o )  : c E X0lO} I where  T -1 XOlO = {I: E 3" : (c - q o )  [solo] (c-cop) L 1} 1  Polo = no is a positive-definite matrix, and Solo = Ii'oIi'T.

For sample times t = 1 ,2 ,  . . ., we observe st observations z, = {~~~,...,g,,~}. Let us suppose, at time t ,  that we have ~ ~ - 1  sets of predicted (from time t - 1) random- variables of the form  Xj,t-l = {x - N(.% J$-J c E x:lt-l} , where  X;lt-l = {I: ? ?J2" : (c - ' -1  T j  [stIt-l] (I: - 4ItJ 5 I} 1 ( 5 )     for j = 1,. . ., rt-1.  We shall use the same Ft, Gt, and Qt iriatrices for each track, thus it will not be necessary to ititlex these matrices with their track identifications.

11. The Ultimate Partition  At, each time, t ,  there exist st observation sample vec- t,ors, of the random variables and rt-1 prrtlicted track sets, {x~lt-l}~!~. We wish to make deci- sions regarding the association of each zit with each track set xi , t  - We desire to apply Levi?s decision-making inetliodology to this problem and will, therefore, adopt Iflie strategy of accepting all track/data associations that r;i.nnot be rejected on the basis of Levi?s rule of epistemic 11 1, i l  i t,y.

We must define an ultimate partition for each sample vcct,or, resulting in a set of st ultimate partitions of the forin U,, = {hitl,...,hitTt--llhitTt}, i = l , . . . , s t ,  where  where 0 signifies the hypothesis that none of the track sct,s associate with the observation zit. We shall say that 1,rack set, xi,t-l is associated with observation sample vec- [.or zrt  if we fail to reject the hypothesis hitj. Each ultimate I)ilrt,ition, U Z t ,  has the property that exactly one element ih ~ ~ r i i e ,  alt,hough each is logically possible. According to Lcvi?s theory of expected utility, we may reject only those tiic~ttibcrs of the ultimate partition that are not seriously possible. We do not insist that the decision that one and only one element of Vit be chosen as the association deci- sion.

C. Calculataon of the M-Functaon  ?l?lie M-function is intended to measure the information- value of rejecting an association, rather than the truth- viiltle of an association. A measure of the information viiliie of rejecting the association of a predicted track set  with an observation zit is the distance between sattiple values of the observation and and the track set; i f  t,he distance is small there is little value in rejecting the association (in other words, there is great value in accept- ing it). For g E x:lt-l c ?Rn and zit E ? R r s t ,  we define the  generalized distance between them as  def T 3 * d(c,%t) = (IHitc-LitII = [(Hitc-z) (Hit  -zit)] We desire to normalize this distance to permit its inter- pretation as a probability density function. This normal- ization is accomplished by defining a region of the column space of Hit which we may assume contains all predicted observation values that may be feasibly associated with the given value for zit,  and restricting attention only to this region, termed the seriously possible region for zit, which we shall denote as zit, a convex set centered at zit of the form  zit = { C  E $?** : I<& - zitel 5 epie , .e  = 1, T i t }  , (9) where Rit = diag {pi?,, . . . , P;~,~}. and 0 a given constant.

Since we wish M to be a probability, we require that the distance function, d(g, % t ) ,  be normalized, thereby ad- mitting the interpretation as an information-determining probability density function. We must normalize this func- tion by the seriously possible region; that is, for fixed zit, let  for all whose projection onto the space spanned by the columns of Hit lies in Zit. We shall denote this space by Zi t  = {c E ?Rn : P i g  E Zit} ,  where Pit is the projection operator onto the space spanned by the columns of Hit.

The function mil@) may be viewed as a normalized distance between zit and g E &ft-l, and is a measure of the information gained by rejecting the association of - 2 E x&-1 and zit. Intuitively, the greater the distance between the predicted observation and the actual obser- vat ion, the greater the value in rejecting the hypothesis that the predicted state estimate and the observation are associated. Let B, - be a ball with center a t  E x{,t-l.

The information value of rejecting the association of E, - with zit is  (11) where Pit& is the projection of the ball &- onto the space spanned by the columns of Hit .  The vector Pitg is the projection of g onto the same column space. We empha- size that the informational-value determining probability places all of the probability mass in the column space of Hit.  This result is appropriate, since there is no way of assessing the informational value of rejecting track/data associations by means of components of the state that lie in the subspace orthogonal to the column space of Hit.

For g E and g' E with g # g', let the diameter of the balls l?, and &,, become arbitrarily small.

Then the condition Mit(&,) 2 M;t(&) indicates that the information value of accepting the association of g with L~~ is greater than the value of accepting the association of g' and zit.

D. Calculation of the Q-Functions The credal probability, or Q-function, is the probability that a given track-data association is correct. This prob- ability is a function of the statistical descriptions of the t.arget dynamics and of the observation errors, and is char- acoerized by the conditional distribution of the observation given the track. For each j = 1,  . . . , ~ t - l ,  the set of pre- dicted random vectors is given by  xilt-l = {x N C !  : 3: E x:lt-l} ' For each observation random vector zit we represent the c,orresponding set of filtered random vectors by  .;it = {x : x = x +  W i , [ Z i t  - HitX],  x E X:lt-l} 1 where Wit is the Kalman gain matrix given via the Kalman I i I (,er .

The probability distributions of {x E X$} are cliaracterized by the family of posterior distributions {~+;~,~(<;g);g E xjlt-l} obtained via Bayes rule. We shall restrict consideration to the case where x E X:lt-l and zit are jointly ,normal. Under this hypothesis, the posterior density, pytlt(<;g) is also normal, and it is well known t.liat the mean and variance associated with this condi- t.ional distribution is given by the Kalman filter. For each olwrvat)ion zit  = ziti we calculate the filtered set-valued c'st,iii-iate according to  for J' = 1 , .  . . , ~ t - 1 ,  with W,,, the Kalman gain defined by  lv~jt = p;lt-lHs [ H z t P ~ l t - l H ~  + R,t] . The posterior tlcnsit,ies assume the form  - 1  where we define  The posterior density is  with x a function of 3: given by (17).

The family of densities {piJtlt(g;g), g E pro-  vides a measure of the truth-value of the association of each g E &,-, with the observation zit. We may view this family of densities as credal probability densities, and interpret them as characterizing the belief that the above association is correct.

Let E& be a ball with center at g. The credal prob- ability that the true state lies in &- conditioned on the observational value zit is  For g E x:lt-l and g' E with g # g', the condition Qijt (&; g) > Qijt(&,; 2') indicates that the association of g with zit is more credible, or believable, than the as- sociation of g' and zit.

E.

The association decision problem is to determine whether or not the track x:lt-l is associated with the observation zit. We shall assume a conservative attitude, and say that the entire track set 2C:lt-l is associated with zit if any - 3: E x:lt-l is associated with zit.

The decision rule may be formulated in terms of the inf0rmation:determining probability density, mit (g) (where g E xilt-l), and the family of subjective be- lief? or credal, probability density functions functions, {~;'~,~(<;g),g E -X:lt-l}. We desire to apply Levi's rule of expected utility to this problem.

For g E Xt , t - l ,  let B, be a ball with center at g. Using (11) and (19), Levi's rule of expected utility indicates we may not reject the association of B, and zit if  The Association Likelihood Ratio Test  -  Qi j t (&;g)  - 2 bMit(B,-). (20) Now let the radius of B, - go to zero, and define the function

IV. EXAMPLE  1 e - i ( g  - aT[P;(;]-?< - 2) % J t ( C )  = ( 2 4 %  IP$+  Since the densities are continuous at  E, a necessary condi- tion for (20) to hold for all balls &- is that  sume that angle-of-arrival data are available; further, we assume that the sensor is sufficiently far from the target  I f  (22) holds for any 2: E xilt-l, we may not reject the association of g with zit; consequently, we may not reject tlie association of the track set z:lt-l with zit.

Since  To illustrate the concept of the ALRT methodology, consider the case of tracking targets constrained to planar motion [4]. Let 2: = [x, y, k, ylT denote the kinematic state of a target in some convenient coordinate system (n = 4).

The dynamics equation is  that is, rit 5 2. Let 2: = [x1,x2,x3,z4]T E - [ziti, zitzIT, and suppose Rit = diag{pf,pi}. Then Given the information-value determining probability  density (10) and the credal probability density (23), we ~ ~ e ~ e r i o u s l y  possible region is I nay forrn the Association Likelihood Ratio Test (ALRT):  zit = { [ ] : tcl - Zitli 5 oPl, 1c2 - Z i t 2 i  I ep2 I Let be a predicted track set, and let zit be (1 sniiiple value of the observation vector zit .  W e  shall sciy that x:lt-l and zit are associated with boldness b if qijt(:) >_ bmit(g) for  some 2: E zitng<lt-l. That is, ihere and the information-value determining probability density is  . (25) exists E Zit n such that (x1 - Zit1)Z + ( 2 2  - Zit2)Z  mit (E) = $;i2 s!;L1 J m d c l d c z  1 ( 2 7r)2 I P$l i  e--:(H,12: - f i t ) T ~ ~ , [ P ; ; i , ] - l W i j r ( H . i C  - zit) Each 2: E x{lt-l represents the mean value of a pre-  dicted conditional distribution. For each such g there ex- , (24) ists a filtered conditional density of the form IIHitZ - Lit11 > b  J,,, t ~ ~ i t g  -gitlld< p F t l t ( f ; ~ )  = N { ~ E  + wijt(git - HitE), [I - ~ i t ~ i t I ~ t l t - 1 ) ,  211 which case, &yt obtained via (12) is a filtered track s c l .  If i o  be dissociated, and the set z:it has no  meaning and is discarded.

If survives the ALRT for fit, then the likeli- hood that is associated with zit is greater than the information value gained by rejecting the association. If b = 1, then the decision strategy is maximally bold in tlie sense that as many associations (&lt-l,st) will be re.iccted as possible. As b approaches zero, the decision strategy is maximally cautious, and the likelihood dimin- islies that a correct association (indeed, any association) will  be rejected.

n Sit = 8, then we deem ,zit and  (26) - x E xi,t-l, and evaluating this expression at  f = ;c,  (27r)21 P$ I f qijt(:) =  -g21 - G a l ,  2 2  - ZitZ]W;*[P;;,]-lW,,1 [ ;;:: z :; ] e  (27) The ALRT is: Associate and zit = [ z i t l , ~ i t z ] ~  if, for any g = [xi, xz,23, 241T E Xtp-1, qijt(2:) 2 bmit(E).

Figure l (a)  illustrates a family of three crossing tra- jectories. The tracks move generally from left to right at time increases; the lines correspond to the x and y posi- tion components and the + symbols correspond to noise- corrupted observations. Figure 1 (b) displays the filtered     track sets corresponding to this simulation, with the el- lipses representing the projections of the track sets onto position space. The initial predicted track set Xo1-1 in- cludes the entire field of view, and is not shown. The three large elliptical regions correspond to the the filtered track sets after the first set of observations have been processed.

As time increases, the size of these track sets decreases rapidly; for the first few observations corresponding to Tracks 1 and 3,  however, there are multiple associations, since the tracks are fairly close and the track sets are still fairly large. As more confidence is obtained in the associ- ations, these tracks become uniquely associated, and the elliptical regions decrease rapidly in size, and will asymp- t,otically become point tracks. At sample ten, Tracks 1 and 2 nearly intersect, and both tracks associate with the observations. These multiple associations persist for a few samples, but as the tracks diverge, the associations again become unique. Track 2 is unambiguously associated and estiniatfed, as evidenced by the radius of the track set con- verging to zero, and the set-valued estimates asymptoti- cally become point-valued.

Y

V. CONCLUSION  The use of epistemic utility, combined with set-valued est,iination, makes it possible to design a multiple tar- get, tracking procedure that extracts as much information as possible from a given database without attempting to squeeze more information from the database than it con- ta ins .

