Identity multiassignment in ESM to radar fusion

Abstract - The development ofan algorithmforfusing anESM track to multiple radar tracks is presented. This work is moti- vated by the difficulty ofassociatingESM sensor data with large measurement errors to closely-spaced radar tracks. The algo- rithm presents a novel approach to fusing identity information.

It assigns to multiple radar tracks the identity information con- tent of an ESM track. The identity fusion is performed using the Dempster-Shafer rule of combination. A weight based on the positional likelihood ofassociation is included in thefusion process. Simulations ofa group oftargetsfor which angular dis- tances are similar to the measurement errors ofthe ESM sensor arepresented. Results show that it ispossible to correctly identify a target within the group in a reasonable time interval without having to waitfor the group to completely separate.

Keywords: Data fusion, data association, multiassignment, ESM, radar.

1 Introduction  Active sensors, like radars, and electronic support mea- sures (ESM) are two very important sensor types used in fusion applications. They add complementary information to the tactical picture. Radars provides kinematic informa- tion about a target while ESM provides identity informa- tion and one positional attribute: the target bearing. Fusing the information provided by both sensors has great bene- fits. In general, ESM and radar sensors integration can in- crease the likelihood of target acquisition, improve situation awareness and provide more accurate and complete overall tactical picture.

Fusing the two sensors however is not an easy task. The target bearing is the only common information and ESM bearing measurements are relatively inaccurate when com- pared to radars. In dense environment this becomes a prob- lem as one ESM report may overlap many targets when measurement errors are taken into account. Thus, the main problem facing the fusion system is one of association in a dense and noisy environment. Once an association is made, the only information usually worthwhile of being fused from the ESM sensor is the identity information as fusing positional information would not in most cases de- crease significantly the error on the position of a radar track.

In such an environment, target contention for ESM mea- surement is fierce because more than one target falls into the area of uncertainty of the ESM's bearing. Many algo- rithms exist to handle this contention. The joint probabilis- tic data association [1] is used to track multiple targets by evaluating the measurements-to-track association probabil-  ities and combining them to find the state estimate. The multiple hypothesis (MH) association [1] is a more power- ful, but much more complex algorithm. Whereas standard sequential processing approach makes a hard association decision after each data set is received, the MH algorithm generates and evaluates a number of candidate association hypotheses as more and more data is received. Thus, the ca- pability ofusing later measurements to aid prior correlation is allowed. Another approach is multi-dimensional associ- ation algorithms. These algorithms associate the measure- ments from the last S-I frames (S-dimensional association, denoted S-D) with established tracks by solving a global constrained optimization problem [2]. S-D association has been shown to be a practical and feasible alternative to MH without the limitation of exhaustive enumeration [3].

Kirubarajan et al. propose a multiassignment algorithm for tracking a large number of overlapping targets [3]. They are relaxing the one-to-one constraint imposed in the con- ventional 2-D assignment. Usually, measurements are as- sociated to one and only one target and targets are asso- ciated to one and only one measurement. However, this constraint is reasonable in sparse scenarios where targets are well separated and the sensor resolution is greater than the target separation. It is no longer valid when measure- ments from one target cannot be distinguished from those of another as seen from the sensor. This is precisely the case of bearing-only measurements where the sensor mea- surement errors are large and overlapping often occurs in dense regions. Their algorithm allows more than one mea- surements to be associated to a target and vice-versa. They use an iterated procedure with successive 2-D assignments of decreasing size to solve one-to-many and many-to-one assignment problem.

In this paper we present a novel algorithm for assigning the identity information of one ESM report to many radar tracks and using the Dempster-Shafer theory of evidence to combine weighted pieces of identity information. This mul- tiassignment algorithm has been motivated by the problem of ESM-radar fusion with the following constraints:  * the errors on the bearing measurement of an ESM re- port are large;  * the bearing is the only common attribute between ESM and radar;  * the fused identity has to be stable over a reasonable time interval;  * the ESM-radar fusion has to occur within a reason- able time interval often smaller than target separation times.

The target separation time is defined as the time needed for the angular separation oftwo tracks to become greater than the ESM angular errors. The stability criteria is related to the reliability that a fusion engine must have. Without a correct and stable identity, the system is judged unreliable.

In the following, the term association represent the definitive one-to-one binding between a sensor's data and a fused track. The term assignment is used to represent the distribution of some or all of a sensor's data to more than one fused track, because no association has taken place.

The next section gives a brief overview ofthe Dempster- Shafer theory used here to combine information. The de- scription of the fusion problem follows. Section 4 presents two multiassignment algorithms and results are presented in section 5. Conclusions are drawn in section 6.

2 Dempster-Shafer theory The Dempster-Shafer evidential theory is used here to com- bine information [5] [6] [7]. This theory can be interpreted as a generalization of probability theory where probabili- ties are assigned to sets of event as opposed to mutually exclusive individual events. Unlike the Bayesian theory, it does not require prior probabilities and has the capability of expressing ignorance explicitly. The exhaustive set of mu- tually exclusive events of a particular experiment is termed the frame of discernment 9. The set of all subsets of 9 is called the power set 2e. Let 2i be an element of 2e. The basic probability assignment function r1 assigns a number 7 (Pi) 2- [0, 1] such that  E 7(Pi) 1 (1) 'pice  r1(0) 0 where 0 is the empty set. The quantity q(Pi) is called the mass of 2i and represents the exact belief in the proposition depicted by Pi. Dempster-Shafer theory proposes a rule by which distinct pieces of evidence are combined. Let Pj and Pk be elements of 2? representing propositions from two independent sources of information 11 and 12 with q'i and r/12 their respective basic probability assignment functions.

The rule is called the orthogonal sum  1(P12 1l1 T,l2T11S(Pi) = r@r12 =1 K ll(i 1l2 (Pk) 'P3 nPk ='P.

where K E 11 (2Pj)T>12 (Pk) (3)  Pj nPk =0  is called the conflict. It normalizes to one the total por- tion of belief exactly committed to Pi to compensate for the measure of belief committed to 0.

In the present work, the frame of discernment is de- fined by all NE) possible detectable platform's hypotheses:  = {1,... , XN0, } (4)  A proposition Pi 29 is a disjunction of elements of 9:  2= {i C} =P{Xl,.* *.,7 N0 X ulU 2,...,I ;} (5)  where I is called the ignorance and is defined as the dis- junction of all elements of 9. At time t, sensor I makes an observation and reports its belief as a basic probability assignment function l. The time dependence is written ex- plicitly from now on to emphasize the fact that a particular sensor usually reports over time on an observation with dif- ferent masses. Thus, the identity information is embodied into q1 and in the following is referred as the identity. To prevent any counter-intuitive results in the face of signifi- cant conflict [4], we ask that all sensors provide j1 (1) > 0.

3 Multisensor fusion problem  The ESM sensor sends its internal track data sequentially in time to the fusion engine. An ESM track is denoted by Sn, n = 1, .... N where n is the sensor track number and N is the total number of ESM tracks. The ensemble of ESM tracks is the track list S. Each track is represented by a bear- ing, O, (t), and a basic probability assignment function r1n,t carrying the identity information. The basic probability as- signment function is built from a finite set of emitters seen on a target and from their respective confidence assigned by the sensor. Each reported emitter Si is translated into a proposition Pi C 2e whose element 'Hj of the disjunction represents all platforms carrying emitter Si. Thus, speci- fying the ESM sensor with I e, an ESM track is given by  Sn= {ttn On(t) Tn,t I}- (6)  An ESM track is usually created for each emitter seen on a target. As a consequence, there exists a one-to-many rela- tionship between a target and ESM tracks.

The fusion of an ESM track and a radar track, called a fused track, is denoted by m,n m = 1, . . .,M where m is the fused track number and M is the total number of fused tracks. Each track from the fused track list, 7, is represented by its fused identity information rym and its sufficient statistics which, given that radar positional mea- surements were fused using a standard Kalman filter, are the state estimates xm (t) and the associated covariances orm(t).

Assuming that the only identity information is coming from the ESM sensor I e, we have for a fused track  (7)  The problem of ESM-radar fusion in a dense and noisy environment is exemplified by the typical scenario shown in Fig. 1. Five closely spaced surface targets with different identities are located far away from an observing aircraft carrying the ESM sensor and the radar. At that distance, the l1(-error area of uncertainty of the ESM sensor is covering more than one target.

The simplest, single scan method of associating an ESM track to a fused track is to compute a likelihood of associa- tion based on the bearing of both tracks and to fuse the pair having the highest likelihood. When, however, the above scenario is considered, the ESM track could be associated with any fused tracks that are within the area of uncertainty delimited by the bearing's measurement errors. The associ- ation cannot be optimally determined on a single measure- ment.

TM = ftm . Xm (t) . gm (t) . T,em ,t I    Figure 1: Scenario representing a typical ESM-radar fusion problem in a dense environment. The dot represents the starting point of each platform and the inset is a zoom of the top-left part.

4 Multisensor fusion using multias- signment  4.1 Simple multiassignment Identity multiassignment is defined as the process of assign- ing an identity to more than one fused track. At time t, the identity Tle t ofESM track Sn is to be fused into M' < M tracks Tm such that  fe" (8) Tlm,t = Tm,t1 Tn,t  where  Tln,t = WnmTnTn,t* (9) To make sure that Eq. 1 is satisfied we set the mass of the ignorance to  /1e(1)=1- 1e(i1iZi Pt  Eq. 8 describes the update ofthe identity i fused trackTm -1 > Tm by the inform track ,t. The weight Wnm carries into t process the likelihood that an ESM track to a fused track m.-  The problem then remains to selectM should be assigned the identity rnt an weight Wnm. In order to achieve correct reasonable amount of time, the smallest consistent with the measurement errors C and with the uncertainty associated with position, must be chosen out of all valid' ciation's likelihood is the measure used fi  Assuming a Gaussian distribution foi O?mn the likelihood function corresponding ofESM track Sn with fused track Tm is  1 d2  Anm(t)  'Validation is required to limit the number of and to prevent physically unlikely associations.

with d2m = (On _Onm)Tml (On - Om) (12)  where On and 0m are the bearings of ESM track Sn and fused track Tm and Cm is the residual covariance matrix of Tm. A likelihood is computed each time a new identity is to be fused, hence the time-dependence in Eq. 11. For clarity, however, it is not written explicitly in the following. Fused track Tm should be kept as a candidate assignments if  Anm > Amax -AA (13)  where Amax is the maximum likelihood out of all Anm and AA is chosen to reflect the ESM sensor measurement's er- rors.

The remaining M' fused tracks are to be assigned the identity information ofESM track Sn subject to Wnm. The association having Anm Amax is the most probable one and the following identity assignment should receive the greatest weight. The following formula is used to compute weights:  Wnm =e (A -Anma (14) The previous equation guarantees that the assignment to the most probable association receives a weight of 1 and that all others decreases rapidly toward 0.

In summary, when the identity information Tr,t from ESM track Sn is received, the simple multiassignment is carried out as follows.

1. Eq. 11 is used to compute a likelihood Anm for each valid fused track.

2. Using Eq. 13, M' fused tracks are selected.

3. For each selected track, a weight Wnm is calculated using Eq. 14.

4. The identity qjt is fused into each selected track Tm using Eq. 8-10.

The scheme just described does not address the case of Pi t I. (10) track creation. A fused track should be created from an  ESM track whenever no validated fused track have been information ofthe selected or when the maximum likelihood Amax is smaller iation of the ESM than a threshold A.

the identity fusion This method has the advantage ofbeing simple and rapid Sn really belongs of execution. It improves upon the single assignment case  by giving a stable and correct identity in most scenarios.

/ fused tracks that It has, however, shortcomings. It does not have the abil- d to compute the ity to decide that an identity was incorrectly assigned and identification in a correct the situation by un-fusing this information from a set of fused tracks track. In the case where the ESM sensor reports dependent f the ESM sensor information, Eq. 8 repeatedly fusing this information artifi- each fused track's cially increases the confidence in the resulting identity. Fi- tracks. The asso- nally, it does not prohibit the mass increase of an element of or this selection. 2e coming from the fortuitous and undesirable intersection r bearings 0n and of two or more independent pieces of identity information.

to the association This problem arises when two or more emitters are indepen- 1] dently reported and those emitters by chance are all found  on a detectable platform. The hypothesis 'Hi Ce repre- (11) senting the platform having those emitters will be fused  each time one of those are reported. This has the effect candidate associations of increasing the hypothesis' mass even though the corre-  sponding platform might not be present. The hypothesis 'Hi    resulting from the intersection of independently reported emitters is fortuitous and undesirable because its mass is artificially increased by Eq. 8 repeated fusing of the same information.

4.2 Time-integrated multiassignment The solution to the aforementioned problems is to replace Eq. 8 by another one that does not repeatedly fuse the same identity information. This is achieved by keeping a list of the most recent ESM track's identities that were assigned to a fused track. Whenever an ESM track gets updated, the corresponding identity qnt in each fused track's list is replaced by the new one and each affected fused track's identity Tlm t is recomputed from the contributing identities present in the list at that point in time.

Let Lm be the list of contributing identities qnt that were assigned to track Tm in its lifetime:  Lm = fq1,t q1,t was assigned to m}. (15) At time t + 1, the ESM sensor sends new information t1nt+l This identity replaces the old one rtjn in each  list where it is present. All tracks Tm that had its list Lm changed is updated according to the following  TIM ,t elunm/1nrm t (16) rICL,,  with Wnm given by Eq. 22. This is simply the Dempster- Shafer's rule of combination applied successively to each identities in the list Lm and replaces Eq. 8 in the identity fusion process. The key point to this method is the fused track identity being recreated each time one of its contrib- utor changes. The problem of fortuitous and undesirable intersection of independent pieces of identity information is still present but much decreased in intensity because no information is repeatedly fused into the final identity. Sim- ilarly, the problem of fusing dependent information disap- pears. A fused track is now defined with one more element:  Tm {tm, Xm(t), (7m (t), T'e t, LTm} (17) By integrating over time the positional information given  by a likelihood Anm, it is possible to decide whether an assignment is still valid and to un-fuse the corresponding identity when it is deemed incorrectly assigned. It is a simple matter to un-fuse information just be removing a contributor from the list Lm and computing a new iden- tity Tje t. Dempster-Shafer's rule of combination is used to integrate over time the likelihoods. The set of all as- sociation's likelihoods for a given ESM track is taken as an expert's opinion on the feasibility of each association.

Each likelihood Anm is scaled in the range [0, 1] to produce a mass for the given association.

Let 'e be the frame of discernment defined by all possi- ble association's hypotheses for an ESM track Sn  oe = {X-( ... XXe ,XM} (18)  where M is the total number of fused track Tm and 7H(m is the hypothesis that Sn belongs to Tm. Because an ESM track should belong to one and only one fused track, the dis- junction of elements of 'e has no meaning. Hence, the set  2e9 is identical to Oe and He n He =0, i 7t j. Whenever an ESM track is updated, a basic probability assignment function, noted Pn,t, is built from the association's likeli- hood in the following manner. The likelihoods Anm of all valid tracks are calculated using Eq. 11. A subset T' of those tracks are selected as by the simple multiassignment method using Eq. 13 and their likelihoods are scaled by  1 -Pnt(IT) ZM/ Anm (19)  where Pn,t (I) > 0 is the mass ofthe ignorance and is set to a small number. M' is the number of selected track Tm C T'. The function Pn,t for the assignment ofESM track Sn to a fused track Tm is given by  pn,t() = anAnm Tm T0 TM V T (20)  with He C 296. The previous definition of an ESM track, Eq. 6, is augmented to include the new basic probability assignment function  (21)  The time-integrated positional information given by the be- liefofp,,t is the basis for the weight w,,,, of Eq. 16  (22)n Pn,t (Hm) maxi pn,t (Hie)  This equation guarantees that the assignment correspond- ing to the most probable association receives a weight of 1 and that all others decrease toward 0. The weight calcu- lated here carries into the identity fusion process the belief resulting from the combined likelihood over time that an ESM track really belongs to a fused track.

The time-integrated multiassignment is defined by the two changes described above: the inclusion of a list of con- tributing identities to a fused track and the addition of a basic probability function to an ESM track giving the belief of association to each fused track.

5 Results  The algorithms described above were tested on the scenario shown in Fig. 1. In this example, the aircraft, situated in the bottom right corner, observes five targets all within detec- tion range of both the radar and the ESM sensor. There are four ships and a submarine and they each have one emitter that uniquely identifies them. The bearing errors are 0.0042 radians for the radar and 0.025 radians for the ESM sen- sor. For the ranges involved in this scenario, the area of uncertainty of the 2cr-error of an ESM report centered on the Knox covers all targets.

The frame of discernment 9 is composed of N? = 135 different platforms consisting of ships and aircrafts. The ESM sensor reports its belief on one platform's hypothe- sis 'Hi at a time, hence any proposition Pi C 2? that is a disjunction of elements of 9 has Trjt (Pi) = 0. This situa- tion is equivalent as having a power set composed of simple propositions 2? = {Xl1,. . ., YN,HN, I}. The mass of each  Sn = ftn . On (t), Tl'n, t, Pn, t I -    Grisha (corrE Mirka Knox Krc-Kerch  0 1 00 200 300 400 500 600  Time (s)  Figure 2: Mass of identity propositions as a function of time for the ship having a ground truth of Grisha for the single assignment, simple multiassignment and time-integrated multiassignment.

observation Pi =-'i is set to Tle,t 0.8 with the re- maining belief assigned to the ignorance Tet(I) = 0.2.

Fig. 2 shows all fused identity proposition's mass as a function oftime for the ship having a ground truth of Grisha for the single assignment, the simple multiassignment and the time-integrated multiassignment. The prevailing fused identity proposition at any time is the proposition having the highest mass.

The single assignment algorithm associates an ESM track to the fused track having the highest association like- lihood. The belief of the identity to be fused is unweighted.

This kind of association is arbitrary whenever any ship is within measurement errors of any other one. A particular fused track thus receives multiple conflicting identities each having a belief of 0.8. This gives rise to rapid variations in the identity proposition's masses (top panel of Fig. 2). This behavior is not desirable because the identity is unstable, and thus unreliable, over a short period of time.

The simple multiassignment produces stable, slowly varying masses. The Grisha proposition is prevailing ex- cept for an inversion between 240 and 300 seconds where the Mirka aligns itself with the Grisha as seen from the ob- server. As the alignment occurs, identity propositions from both targets are assigned to both fused tracks in equal num- bers. Eventually, the Mirka and the Grisha start to sepa- rate and the correct identity gets restored. The inversion is unfortunate however, because the knowledge prior to the alignment is lost. The mean mass of the Grisha proposition is 0.75 between 100 and 600 seconds.

The time-integrated multiassignment solves the problem  of the alignment by accumulating, in the form of a rein- forced likelihood, the positional information. The correct identity is prevailing for the whole scenario time. The mean mass of the Grisha proposition between 100 and 600 sec- onds is 0.64. Although it is lower in this case, it is still above 0.5 and no inversion ever occurs. It is interesting that for this particular scenario, where targets are uniquely identified by one emitter number, the fused identity's mass in the case ofthe time-integrated multiassignment is limited to 0.8. It cannot increase over that limit for two reasons: a new identity qnt is replaced instead of fused in the list Lm and the intersection of any two propositions from 29 is the empty set: 'Pi n Pj= 0 for i t j. The former is pre- scribed by the algorithm and the latter is a peculiarity ofthe simulated ESM sensor reporting on only one platform's hy- pothesis at a time. When all elements of Lm are fused, no identity qnt C Lm reinforce each other because each one assign a non-null mass to one proposition only, correspond- ing to a simple hypothesis 'Hi.

The time-integrated multiassignment algorithm shows that it is possible to deduce the correct identity of a target within a closely spaced group for which angular distances are similar to the measurement errors of the ESM sensors.

This is achievable within a reasonable time interval without having to wait for targets to separate completely.

Fig. 3 shows the fused identity proposition's masses as a function of time for the center ship, the Knox. The im- provement is visible for the first two algorithms, but is less clear for the time-integrated multiassignment. There are two inversions occurring in the case of the simple multi-  I -  I II / t- " /1- - 1\ /I - . \1 / -1  gnment    Single:\6:signme-Ft  Mirl orr( EDrch  0 1 00 200 300 400 500 600  Time (s)  Figure 3: Mass of identity propositions as a function of time for the ship having a ground truth of Knox for the single assignment, simple multiassignment and time-integrated multiassignment.

assignment, one between 70 and 170 seconds and the other between 200 and 240 seconds. There is only one inversion for the time-integrated multiassignment finishing at 140 in- stead of 170. There is no other inversion. Although, there is a period of confusion between the Knox and the Typhoon around 400 seconds, this is still better than an inversion.

The downside of the time-integrated algorithm is its lack of confidence in the belief of its identity proposition. From 100 to 600 the mean belief of the correct identity is only 0.55 as opposed to 0.73 for the simple multiassignment.

The Knox, however, is aligned with the Typhoon and they are both difficult to separate. The time-integrated multias- signment is a slow-converging but cautious algorithm.

6 Conclusions Two algorithms for assigning the identity information of one ESM report to many radar tracks were presented. The identity content of an ESM report is multiassigned to a se- lected group of tracks. Using the Dempster-Shafer theory of evidence, it is fused with previously received information using a weight based on the positional likelihood of associ- ation. It is shown that the resulting target identity is stable over a reasonable period of time. It is converging toward the correct identity in scenarios of closely-spaced targets where the angular distance between ships is similar to the angular measurement errors of the ESM sensor. The sim- ple multiassignment quickly provides a correct identity, but has shortcomings regarding stability and in dealing with de- pendent information. The time-integrated multiassignment  is preferred in most cases as it is stable and robust with re- spect to dependent ESM reports.

