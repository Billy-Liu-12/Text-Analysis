

30 C O M P U T E R   P U B L I S H E D  B Y  T H E  I E E E  C O M P U T E R  S O C I E T Y  0 0 1 8 - 9 1 7 2 / 1 7 / $ 3 3 . 0 0  ?  2 0 1 7  I E E E  COVER FEATURE QUALITY-OF-LIFE TECHNOLOGIESCOVER FEATURE QUALITY-OF-LIFE TECHNOLOGIES  Aarti Sathyanarayana, Jaideep Srivastava, and Luis Fernandez-Luque, Qatar Computing Research Institute  Lack of sleep can erode mental and physical well-being,  often exacerbating health problems such as obesity.

Wearable devices that capture and analyze sleep quality  through predictive methodologies can help patients and  medical practitioners make behavioral health decisions  that can lead to better sleep and improved health.

With the increased pace of daily living, sleep has become essential to academic and workplace performance. Sleep depri-vation can result in catastrophic events for those in professions that require high accuracy and safety levels, such as construction crane operators or school bus drivers, and driving in general can be danger- ous with little or no sleep. In the US alone, an estimated 810,000 sleep-related collisions per year result in 1,400 fatalities and cost $16 billion.1 Studies also confirm that lack of sleep worsens a variety of health problems? from obesity, diabetes, and sleep apnea to Alzheimer?s and cancer.2?4 Other studies show that sleeplessness is becoming more widespread.5  In light of these findings, systematic sleep studies have become a high priority. Sleep science is a multi- disciplinary research area, with contributions from endo- crinology, pulmonology, and public health. Increased knowledge of the importance of sleep is fostering the inclusion of sleep education (also known as sleep hygiene) as part of patient education for diseases such as diabetes.3 In addition, healthcare providers are developing appli- cations that act as sleep coaches for cancer patients4 and otherwise healthy people with sleep disorders.6,7 In all these developments, technology is proving to be a crucial element in sleep health?particularly wearable devices.

Wearables are unique in that they spread sleep aware- ness beyond clinicians and researchers to include the  The Science of Sweet Dreams: Predicting Sleep Efficiency from Wearable Device Data    M A R C H  2 0 1 7  31  million users who rely on health appli? cations to track their physical activity and sleep. These users often integrate their physical activity and sleep data in mobile health repositories, such as Apple?s HealthKit?which can subse? quently be integrated into electronic health records (EHRs). Consequently, the study of sleep efficiency is becom? ing a data science problem.

Traditional sleep analysis based on wearables? data is limited in scale and cannot keep pace with the explosion of wearable use for health monitor? ing and analysis.8?11 To address this scale problem, we conducted a study to explore an innovative approach that combines deep learning with an algo? rithm that automates human activ? ity recognition (HAR) to predict sleep quality from wearables? physical activ? ity data.12 Because our approach can scale to the wide deployment of sleep data analytics based on wearables, it can serve as the foundation for tools that noninvasively screen for sleep disorders, diagnose their nature, and identify the lifestyle factors affecting a particular disorder.

We conducted a series of exper? iments to statistically compare our approach with the traditional approach of actigraphy combined with a sleep expert?s annotations?the cur? rent technique for studying sleep and physical activity patterns from a wear? able motion sensor that tracks an indi? vidual?s activities. Relative to this sleep expert, our approach showed up to a twofold improvement in the area under the curve (a statistical predictor of best model). These results are evidence that our method can greatly enhance (and perhaps even revolutionize) applica? tions that assist patients and medical practitioners in making critical behav? ioral health decisions.

SLEEP SCIENCE?S EVOLUTION For centuries, researchers have been exploring the elements of sleep. In Bioelectromagnetics, published in 1791, Luigi Galvani explained how electric currents from neurons passed signals to active muscles in frogs. His work relating electricity to the nervous sys? tem eventually led to Hans Berger?s 1929 report of the first human electro? encephalograms (EEGs) for brain study. A decade later, Alfred L. Loomis published a study describing differ? ent EEG patterns during sleep, which became the basis for defining sleep stages. Gradually, new signals evolved to characterize other sleep aspects, such as rapid eye movement (REM).

Early sleep studies The next three decades saw an explo? sion of sleep knowledge and insights into sleep characteristics, which led to a new era in sleep science and its clinical aspects. In 1960, G.W. Vogel observed that narcolepsy patients have different EEG patterns during sleep as compared to healthy subjects. By the mid?1900s, sleep laboratories began to appear that were dedicated to studying sleep?related disorders such as rest? less legs syndrome, sleep?obstructive apnea, narcolepsy, and insomnia.

These labs resulted in more sys? tematic sleep studies and the evo? lution of polysomnography (PSG), a sleep?study methodology that incor? porates various sensor to capture brain activity, leg movement, oxygen saturation, breathing frequency, and snoring.13 Although it is a major diag? nostic tool that is considered the gold standard for sleep research, PSG is performed only in sleep laboratories in hospitals. During a PSG test, the patient spends at least one night in the  unnatural environment of a sleep lab? oratory monitored by a clinician and attached to multiple sensors. On one hand, PSG is a high?fidelity test; on the other hand, it is challenging to scale, too expensive for many individuals, does not consider physical activity, which is tightly linked to sleep quality, and does not provide insights into the patient?s behaviors in a natural envi? ronment or during daily routines. As a result, PSG cannot keep pace with the growing number of sleep disorders, and large segments of the population still suffer from inadequate sleep.

Actigraphy and first wearables Wearable devices provide the first hope of solving these problems because they can be used to study sleep and physical activity for longer periods and outside the laboratory or hospital. Because a wearable moni? tors the patient?s body continuously, collected signals can be used to deter? mine sleep quality and screen for sleep disorders.

Actigraphy devices, such as the GT3X from ActiGraph (actigraph corp.com/support/activity?monitors /gt3x), are clinical?grade wearables approved for sleep studies that use inertial sensors to collect physical activity and sleep data. As of mid? January 2017, actigraphy was being used in more than 100 clinical trials registered in the US clinical trials database (www.clinicaltrials.gov). In many applications, actigraphy can be a cheaper and simpler alternative to PSG, and actigraphy devices are already advancing sleep science in areas such as obesity, diabetes, can? cer, and mental and public health.

Machine learning applied to actigra? phy data is widely used to study sleep patterns and characteristics.8?11  See www.computer.org/computer-multimedia for ?multimedia content related to this article.

32 C O M P U T E R    W W W . C O M P U T E R . O R G / C O M P U T E R  QUALITY-OF-LIFE TECHNOLOGIES  New wearables, new possibilities Sleep analytics is no longer restricted to researchers and clinicians, as the pervasiveness of health and well- ness applications attests. Millions of people use affordable wearables to track their physical activity and sleep, and companion apps inte- grate tracked data into mobile health repositories, such as Apple?s Health- Kit. These repositories enable inte- gration with other medical devices, such as heart-rate monitors, and even with EHRs. Along with the myriad fitness trackers and smart watches that can monitor sleep are context sensors, such as Aura from Withings (www.withings.com/ca/en/products  /aura/sleep-sensor-accessory), which includes a sensing mat for sleep mon- itoring that integrates with the Nest Internet of Things platform (nest.com) to automatically adjust room tempera- ture for optimal sleep quality.

The Apple Watch has an instru- ment suite to collect data on various bodily functions, including tri-axial movement and heart rate. The watch seamlessly syncs with iOS devices, enabling a variety of applications to use the collected data. With appropri- ate permissions, Apple?s HealthKit API allows queries to the collected data as well as its use in new applications.

Other smart-device manufactur- ers, such as Samsung, have created  wearable platforms based on their respective OSs, and specialized wear- ables companies like Fitbit have devel- oped their own platforms.

COMPUTING CHALLENGES The importance of data for health research has become mainstream in recent years, and sleep science is no exception. The National Institutes of Health (NIH) created the National Sleep Research Resource,14,15 a portal aimed at integrating heterogeneous data sources for clinical sleep research (www.sleepdata.org). The portal, part of the well-known Big Data to Knowl- edge (BD2K) initiative, contains a wide variety of datasets for sleep research.

TABLE 1. Computing areas that can enhance sleep science.

Area Subcategories Potential contribution  Electronics, wireless communication, and embedded systems  Pervasive and ubiquitous computing, wireless sensor networks, the Internet of Things (IoT)  Design/development of sensors and actuators to capture contextual information about sleep, including integration of sensors in a body area network and in the IoT  Biomedical engineering and medical devices Development of novel medical devices to monitor sleep and aid sleep-disorder treatment  Machine learning and AI Machine learning, pattern recognition, real-time analysis and event recognition  New insights into sleep that will help disease and disorder diagnosis, prognosis, and treatment  Data storage and curation Data quality and management (annotation, validation redundancy, and so on)  New techniques for data annotation and for handling duplications  Security to ensure data privacy, including anonymization in clinical studies  Advanced anonymization techniques and security that can prevent the use of biosignals such as an electrocardiogram (ECG)  Data interoperability and semantic integration, data fusion  Techniques that enable semantic interoperability and the subsequent integration of sleep data that is currently in various silos, such as electronic health records (EHRs) and fitness companies  Applications and services Data visualization Novel visualization techniques that can facilitate the understanding of sleep data sources with complex multidimensional and temporal characteristics  User modeling and adaptation of applications for consumers and professionals  Data-driven approaches for developing more personalized applications?for example, recommender systems?that support decision making for patients? (such as sleep coaches) and clinicians (such as clinical decision support systems)  Human factors and human?computer interaction New insights into the role of human factors, such as usability, in adopting complex health technologies to analyze and treat sleep-related disorders, which typically involve multiple stakeholders and a range of patient behaviors    M A R C H  2 0 1 7  33  As consumer health, wellness, and fitness data combines with EHRs, inte- gration is becoming more problematic.

The demand to fuse information from multiple wearable sensors, such as an accelerometer and heart-rate monitor, requires new algorithms. Research is still far from producing fully inte- grated smart analytics for hetero- geneous sleep-related data sources, but as Table 1 shows, computer science can further sleep medicine in multiple ways, particularly in addressing big data analytics, predictive modeling, and activity recognition.

Big data analysis Correlating wearable-sensed human activity with sleep patterns can pro- vide insights to clinicians and indi- viduals for the early diagnosis of sleep problems, which in turn can help identify which behaviors directly influence an individual?s sleep qual- ity. In addition to the analysis of actigraphy data in studying sleep characteristics, the development of  sensors and pervasive computing solutions enable sleep diagnostics in the home.16  As Figure 1 shows, wearables can be clinical or consumer devices. Clinical devices are validated through clini- cal trials in which a ground truth has been established. These devices are used for research studies and clinical evaluation. Consumer devices have popular appeal and target a wider audi- ence. These devices encourage self- monitoring and empower their users to make behavioral changes to improve their fitness and quality of life.

Both device types generate volumes of data in real time and at a high veloc- ity. For example, a GT3X wearable gen- erates 16 Mbytes of data each day for one individual. Analyzing this data to build descriptive and predictive mod- els and provide actionable knowledge for practitioners and users is a big data challenge.

The data consists of features from multiple sensors collected over an extended period. Depending on the  analytical goal and thus model type, data can be presented in either its raw form or with preprocessing. Raw data generally has a small number of features (triaxial accelerometers, for example, have three coordinates, gyro- scopes have three rotational veloci- ties, and so on) collected at thousands or more points in time. The result is a time series of n ? m dimensions, where n is small and m is significantly larger.

Moreover, because the accelerometers or gyroscopes track every movement with equal weight, raw data is noisy.

Deep-learning models can effec- tively handle raw data characteristics, but classical aggregated models (such as linear or logistic regression, support vector machines, and random forest), sequential models (such as sequential pattern mining), and decision trees also require feature construction to assist in data interpretation. HAR summarizes the behavior of individ- uals over the time series into clean interpretable features. Our algorithm, Robust Automated Human Activity  Application  Modeling  Wearable devices  Feature-space construction  Processed data  Raw data  RAHAR Other HAR methods  Human activity recognition (HAR)  Sequential Deep learning  Classical models  Other feature-space manipulation  Consumer  Fitbit  Clinical  ActiGraphApple Watch Jawbone Pebble  Aggregated and cross-sectional  Consumer  Time-aware recommendation system for cognitive behavioral therapy  Clinical  Precision medicine through risk strati?cation for diagnostic screening  FIGURE 1. Proposed flow for capturing and analyzing data from wearables to enhance sleep efficiency. Data from wearables is pro- cessed using algorithms for human activity recognition (HAR), which can be fed to classical models such as aggregated and sequential techniques or to deep-learning models. These models then serve as the foundation for consumer and clinical applications. RAHAR: Robust Automated Human Activity Recognition algorithm.

34 C O M P U T E R    W W W . C O M P U T E R . O R G / C O M P U T E R  QUALITY-OF-LIFE TECHNOLOGIES  Recognition (RAHAR), is a scalable method for extracting knowledge from wearable activity sensors.12  Predictive modeling Predicting sleep quality is import- ant for behavior modification. While an automated version of actigraphy enables interpretation of sleep quality from data collected while the user wore the device to sleep, it would not enable the user to adjust his or her behavior to ensure improved sleep quality. A cognitive behavioral therapy system or application that not only monitors physical activity but also provides rec- ommended behaviors can empower users to improve their quality of life.

Moreover, many users do not like to wear devices while they sleep.

Clinicians looking to screen their patients for sleep disorders need a high-fidelity prediction model (such as a deep-learning model) to provide insight before exacerbation.17 Addi- tionally, using RAHAR in combina- tion with sequential pattern mining could help sleep researchers identify behavioral patterns that lead to good or poor sleep. For users who wear their device regularly, data can be collected for weeks or months, thus allowing for personalized pattern identification and precise sleep treatment.

Human activity recognition Because human movement is a key feature in recognizing activity, many HAR applications construct a feature space from raw triaxial accelerome- ter data by labeling portions of a per- son?s physical-activity time series.

Depending on the application area, the activity labels can be activity type (sitting, walking, jumping, running, and so on) or exertion level (sedentary, light, moderate, vigorous, and so on).

Multiple activity types might require the same exertion level; conversely, the same activity type might occur at different exertion levels.

Categorizing raw accelerometer output in this way abridges the fea- ture space, which removes noise and summarizes output. It also rebalances data dimensions and can thus improve predictive model quality. Activity cat- egories can either be aggregated as percentages over a time segment or be interpreted as an event sequence.

Current HAR methods have been tested primarily on simulated rather than natural behavior, with most methods using data collected from sen- sors attached to an individual in a labo- ratory. The participant is instructed to complete a series of preassigned activi- ties, and the algorithms scan through the raw sensor data, attempting to identify and label these activities.

The algorithms require a high level of supervision, do not generalize well to natural daily behavior, and focus on event type rather than exertion level.

The latter drawback is trouble- some because exertion is of particu- lar interest in sleep science research, which seeks to more fully understand the relationship between physical activity levels and sleep. Researchers have established that physical activ- ity and sleep influence the production of many physiological processes, such as hormone production, and thus the relationship can influence important health aspects, such as metabolism and the immune system. In teenagers, for example, sleep deprivation is high, which can increase obesity and reduce academic performance.

Scalability and expense are also concerns. In sleep studies, a special- ist typically performs HAR on a sin- gle individual with the aid of software  such as ActiLife?a process that is impractical and inefficient for large- scale clinical trials. The Precision Medicine Initiative announced by the Obama administration in 2015 was designed to collect genetic, environ- mental, and behavioral data from more than a million individuals.18 Manu- ally annotating wearable data from a cohort this size would be impractical and subject to human error and bias.

RAHAR: AUTOMATING ACTIVITY RECOGNITION Our motivation for developing RAHAR was to reduce the bottlenecks of ana- lyzing wearable data and automate the process of identifying and label- ing activity periods based on an indi- vidual?s exertion levels. The resulting HAR data segments can then be used to build predictive models.

Figure 2 shows RAHAR?s process for translating raw accelerometer data from actigraphy sensors into output suitable for modeling. Because RAHAR does not require a sleep specialist?s supervision, it can be built into mobile applications for self-monitoring.

Sleep-period annotation RAHAR begins by detecting the sleep period from the HAR time series, which it identifies by scanning for periods of no accelerometer move- ment. A sleep period is 15 continuous minutes of no movement; an awake period is 30 minutes of continuous movement. In our sleep experiments, each dataset contained a continuous time series (that is, we told partici- pants not to remove the device), so we used recorded sleep-period eval- uation as the ground truth for pre- dicting sleep quality. Our evaluation method for predicting sleep quality based on physical activity is based    M A R C H  2 0 1 7  35  on sleep science definitions and gold standards.19  Time-series segmentation RAHAR segments the time series at the endpoints of all sleep periods, so each segment contains a period of awake time, followed by a sleep period.

It then evaluates both the awake and sleep periods to predict sleep quality.

Change-point detection In this phase, RAHAR identifies changes between activity-exertion lev- els within the awake period. To person- alize activity segmentation according to the individual?s unique behavior (as opposed to generalizing over all par- ticipants), RAHAR uses hierarchical divisive estimation,20 in which each change point is the basis for dividing each of the multiple awake periods into subintervals. Each subinterval corre- sponds to a physical exertion level.

Its ability to identify behavior changes specific to an individual makes RAHAR robust to diverse pop- ulations. For example, the raw accel- erometer output of a physically fit 18-year-old woman and an overweight 70-year-old man might be the same, but the physical exertion levels would not be interpreted as equal.

Activity classification RAHAR determines each subinterval?s activity classification by calculating the statistical mode of labels deter- mined by cutpoints21 over each data point in a change-point interval. By automating activity labeling, RAHAR eliminates the need for cumbersome  annotation by sleep experts, enabling the widespread evaluation required in large clinical trials.

Many metrics are suitable for quan- tifying sleep quality, such as sleep duration, the time between falling asleep and waking up; wake after sleep onset (WASO), the time spent awake during the sleep period; and latency, the time between trying to sleep and actually falling asleep. However, sleep efficiency?the ratio of sleep dura- tion minus WASO to sleep duration minus latency?is most the effective sleep-quality benchmark22 because it involves all three metrics.

Output RAHAR output can be used as the feature space for classical models, such as logistic regression, that aim to predict sleep quality when activ- ity data within the sleep period is not available. Many wearable devices (including the Apple Watch) require overnight charging, which precludes the direct tracking of sleep behavior.

Moreover, machine-learning applica- tions require sleep-quality prediction to provide real-time feedback that can change a user?s behavior to opti- mize sleep.

PREDICTIVE SLEEP EXPERIMENTS To evaluate RAHAR, we conducted a series of experiments to assess its use with traditional machine-learning algorithms and to explore the poten- tial of deep learning in sleep-quality prediction. The health and behavioral dataset we used is small enough that  additional runtime for training is negligible. Thus, all our results are in terms of predictive performance.

Our experimental dataset con- sisted of data collected in a one-week observational trial involving 92 male and female adolescents from ages 10 to 17. The trial, conducted by Weill Cornell Medical College in Qatar, employed the GT3X, which uses a tri- axial accelerometer to collect data on physical activity and sleep features from inertial sensors. The dataset was the seven-day vertical-axis time series extracted from the accelerometer.

Generalizing our results from this dataset might be problematic, as sleep quality changes across regions and ages. Although our data had a high ratio of teenagers with poor sleep to those with good sleep, that ratio might be different in other countries.

Usefulness in feature construction In one of our experiments, the goal was to evaluate RAHAR as a tool for constructing features that can be useful for models that attempt to pre- dict sleep quality.12 Table 2 shows the results of RAHAR in predicting sleep quality versus the traditional approach of using a sleep expert plus ActiLife software (SE+AL). We evalu- ated the usefulness of activity label- ing in SE+AL and RAHAR as input to five models: adaptive boosting, ran- dom forest, support vector machines (SVM), and logistic regression. Each model returned a binary classification through a likelihood score for belong- ing to the positive class?the class  Raw data  Sleep-period annotation  Time-series segmentation  Change-point detection  Activity classication  Output suitable  for modeling  FIGURE 2. Steps in the RAHAR algorithm. From wearables? raw sensor data, RAHAR detects periods of low activity and uses a state machine to annotate sleep periods, essentially dividing activity time into segments. It then identifies the point during wakefulness at which an individual changes activity-exertion levels during wakefulness. The last step is to label activities. RAHAR output is suitable for a variety of models, from classical prediction to machine learning.

36 C O M P U T E R    W W W . C O M P U T E R . O R G / C O M P U T E R  QUALITY-OF-LIFE TECHNOLOGIES  that represented good sleep quality.

The threshold was 0.5. Figures 3 and 4 show the curves of false and true posi- tives for SE+AL and RAHAR for each of these models.

Identifying sleep problems Deep learning can be important in sleep science, primarily for first-pass  screening of potential sleep problems, which can be confirmed by alternative analytics and a clinical encounter with a health professional. Deep-learning models have the best predictive power for estimating sleep quality based on an individual?s behavior. These high- fidelity black-box models can inter- pret raw accelerometer data without  RAHAR or any preprocessing, reduc- ing overall workflow. However, these models contain hidden layers and thus are not transparent about the predictive process or any justification for the output.

In our experiment to explore deep learning, we used the feature- construction experiment dataset and applied deep- learning methods.23 To train our model to decrease overfitting, we randomly partitioned the dataset: 70 percent for training and 15 percent each for testing and validation.

Table 3 shows results from feeding raw accelerometer data using logis- tic regression as a baseline into four deep-learning models: multilevel per- ceptron, convolutional neural net- work, simple recurrent neural network (RNN), and long short-term memory (LSTM) RNN. We also included a time- batched version of LSTM to read the input time series in batches rather than individual epochs. This allows the model to incorporate long-time dependencies in the data without a vanishing gradient.23  When the model must be explain- able, standard analytic models are more suitable for analysis than deep- learning models. These algorithms can predict the expected sleep quality of individuals based on their physi- cal activity and provide insight into the contributing factors. This insight  TABLE 2. Results for two statistical methods when using a sleep expert plus ActiLife software (SE+AL) and the Robust Automated Human Activity Recognition  (RAHAR) algorithm as input for models that predict sleep efficiency.

Model  AUC?ROC* F1 score Sensitivity Specificity  SE+AL RAHAR SE+AL RAHAR SE+AL RAHAR SE+AL RAHAR  Adaptive boosting 0.7489 0.8132 0.5574 0.6885 0.5484 0.5526 0.7759 0.9333  Random forest 0.8115 0.8746 0.6885 0.7500 0.6774 0.6316 0.8448 0.9333  Support vector machines  0.7497 0.7895 0.3721 0.7077 0.2581 0.6053 0.9310 0.8667  Logistic regression  0.5884 0.8649 ? 0.6875 ? 0.5789 ? 0.8667  *AUC?ROC: area under the curve?receiver operating characteristic (measure of best model). Dashes in metrics for logistic regression denote cases in which results produced uniform classification predictions.

False positive rate  1.0  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0 0.2 0.4 0.6 0.8 1.0  Tr ue  p os  iti ve  ra te  Adaptive boosting Logistic regression Random forest Support vector machines Random prediction  FIGURE 3. ROC curves for predicting sleep efficiency using a sleep expert plus ActiLife soft- ware (SE+AL), which represents the traditional method of gauging sleep quality. Although this method is accurate, it is hard to scale to large clinical trials or mass deployment.

M A R C H  2 0 1 7  37  can be leveraged to make recommen- dations for behavioral modification with the goal of improving quality of life. In diagnostic screening, however, explanation is not as critical as classi- fication accuracy, which makes deep learning an excellent screening tool to identify sleep behaviors.

The expanding field of sleep science is a multidisciplinary research area focused on under- standing sleep in human health. As sleep science progresses, we can start to understand the link between sleep and many health conditions such as obesity and cancer. In many ways, these advancements have been rely- ing on the process of engineering and computer science as increasing amounts of data is being captured from new technologies.

Our analysis, which involved col- laborating with practicing sleep sci- entists in a clinical setting, ensured that our results were realistic and that they could significantly impact healthcare practices. Future research will be required to integrate our work in systems for helping professionals and patients with decision making, including algorithmic performance, human factors and usability, devel- opment of pervasive and persuasive applications for behavioral change, and generalization of our models in other populations.

