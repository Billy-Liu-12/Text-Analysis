Multiresolution motion estimation and compensation  for video coding

Abstract? Recently, the quantity of data has known a big evolution especially with the emergence of many video applications over networks such as the videophone and the videoconferencing, and multimedia devices such as the high- definition TV and the personal digital assistants. So, it was crucial to reduce the quantity of data stored or transmitted by compressing it spatially and temporally. Hence, motion estimation and compensation are employed in video coding systems to remove temporal redundancy while keeping a high visual quality. They are the most important parts of the video coding process since they require the most computational power and the biggest consumption in resources and bandwidth.

Therefore, many techniques have been developed to estimate motion between successive frames. In this paper, we will present our motion estimation and compensation method applied on the discrete wavelet transform coefficients and based on the block matching algorithm which is the simplest, the most efficient and the most popular technique. Additional techniques are introduced to accelerate the estimation process and improve the prediction quality.

Keywords-component; Discrete Wavelet Transform; motion estimation; multiresolution domain; video coding.



I. INTRODUCTION The development of new applications and the spread of  Internet all over the world have produced a big quantity of data that must be stored and transmitted. With the increasing capacity of the storage media, the data storage problem was resolved but it remains the transmission problem especially with the limited channel bandwidth.

Therefore, a need for efficient ways for signals encoding made signal compression central to digital communications.

That is why, motion estimation and compensation (ME/MC) is introduced as a solution to reduce the quantity of data by eliminating the temporal redundancy between adjacent frames in an image sequence. Motion estimation process serves to predict motion between two successive frames and produce the motion vectors (MVs) which are the displacements between these two frames. So, instead of transmitting two frames, we will send only one frame which is the reference frame, the motion vectors and the residue which is the difference between the current frame and the reconstructed frame by motion compensation. The combination of the motion estimation and motion compensation is a key part of the video coding.

There are many methods to achieve ME/MC. They can be divided on two such as the statistical methods, the differentials methods as an indirect methods (applied to features) and the optical flow, and the block based method as a direct ones (applied to pixels). Block matching algorithm (BMA) [1] is an effective and popular technique for block based motion estimation. It has been widely adopted in various video coding standards and highly desirable since it maintain an acceptable prediction errors.

Conventional video coding system applies ME in spatial domain directly on frame without transformation. After that, they follow it by a discrete cosine transform (DCT). However, giving the promising performances of the multiresolution analysis especially the discrete wavelet transform (DWT) which provides a multiresolution expression of the signal with localization in both space and frequency, many methods have been developed to construct a wavelet based video coding system [2] and the DWT was integrated in new coding standards such as JPEG2000, MPEG-4, and H.264.

For this, we have developed a block based ME/MC method in the wavelet domain. Our method exploits the benefits of DWT and the hierarchical relationship between its subbands (quadtree) to drive ME/MC on wavelet coefficients, especially in the low frequency subband where we find the most significant visual information. This method is consolidated by several techniques to ameliorate the results. With this method, we have achieved good results in terms of prediction quality, compression performance and computational complexity.

This paper is organized as follows: in Sec. II, we present the motion estimation principle and techniques focusing on the wavelet domain. Sec. III describes the proposed method. In Sec. IV, we will introduce supplementary techniques which are used to improve our method. In Sec. V, we evaluate our method comparing to some conventional methods. This will prove that our method outperforms conventional method in many terms. Finally, Sec. VI summarizes the key findings and suggests future research possibilities.



II. MOTION ESTIMATION AND COMPENSATION ME/MC are the fundamental parts of video coding systems  and form the core of many video processing applications.

Motion estimation eliminates temporal redundancy from video by exploiting the temporal correlation between successive frames, so that reduces the amount of data to be transmitted or  Manuscript received June 14, 2010; revised August 10, 2010.

Corresponding author: N. BEN AOUN (najib.benaoun@ieee.org).

___________________________________     ICSP2010 Proceedings      stored while maintaining sufficient data quality. However, ME extract temporal motion information from video sequences, while motion compensation uses this motion information for efficient interframe coding.

Motion estimation predicts motion between two successive frames to generate a motion vectors (MVs) which represent the change between them. Consequently, these motion vectors and the prediction error are transmitted instead of the frame itself. With this process, the encoder will have sufficient information to faithfully reproduce the frame sequence.

Block-based motion estimation is most used method because of their simplicity and performances, which made it the standard approach in the video coding systems. The procedure of BMA is to divide the frames into a block of N?N pixels, to match every block of the current frame (CF) with his most similar block inside a research window in the reference frame (RF) and to generate the motion vector. Consequently, for this method, the most important parameters here are the size of the block N and the size of the search window P.

However, the block matching is based on minimizing a criterion like the Mean Absolute Error (MAD) or the Mean Square Error (MSE) which is the most common block distortion measure for matching two blocks and it provide more accurate block matching. The MV will be applicable to every pixels of the same block which reduce the computational requirement.

To identify the best corresponding block, the simplest way is to evaluate every block in the reference frame (exhaustive search, ES). But, although this method find generally the appropriate block, it consumes a high computations time.

Hence, others fast searching strategies [3] have been developed where search is done in a particular order. There are the Three Step Search (TSS), the Simple and Efficient Search (SES), the Four Step Search (4SS), the Adaptive Rood Pattern Search (ARPS) and the Diamond Search (DS) which has proved to be the best searching strategies coming close to the ES results. So, the DS was improved in many variant such as the Cross DS (CDS), the Small CDS (SCDS) and the New CDS (NCDS).

In conventional coding systems such as H.261 and MPEG- 1/2, BMA is conducted directly on frame which need a large computing power. That is why many studies have been made and proved that is better to transform the frame before executing the ME techniques. However, with the development of new video coding standards, wavelets have received an important interest since it has shown good and effective results. The main idea behind wavelet is to generate a space- frequency representation focusing only on the spatial frequencies that are most significant to the human eye. This wavelet decomposition is a reversible procedure which is performed by successive approximations of the initial information (original frame). This process, will improve the coding efficiency since the wavelet coefficients are much correlated and this representation reduce the blocking effects especially in the edges.

Exploiting the hierarchical relationship between the wavelet coefficients of the different subbands in different levels, different hierarchical ME methods were developed which are adapted to the wavelet transformation. The hierarchical relationship means that every wavelet coefficients has four descendants in the lower level of the DWT. So, there are two main ME categories of schemes for DWT based: forward and backward schemes.

The forward approach consists on conducting the ME in the DWT details subbands of the low level and using it to determine the motion in the higher level subbands (coarse-to- fine). Researchers like F.G. Meyer, A. Averbuch and R.R.

Coifman [4] have followed the forward scheme to propose a ME method with a new pyramid structure. Recent researchers [5], [6] have developed a backward scheme (coarse-to-fine) where they estimated the motion in the finest DWT resolution (higher level) and then progressively refined the ME by incorporating the finer level. This scheme has proved its superiority over the forward scheme.

The effectiveness of the BMA and the suitability of the DWT in the video coding, has conducted us to develop a block based motion estimation method in the wavelet domain.

OUR PROPOSED METHOD The proposed method makes use of the wavelet properties  to apply the motion estimation directly in the wavelet coefficients. By adopting the fine-to-coarse motion estimation strategy, we have provided a better estimation since the approximation contains the most visual information. The motion vectors of the approximation are directly calculated, and then the motion vectors of the details subbands are deducted using hierarchical relationship that exists between the DWT subbands as shown in Fig.1. Working with a 3 level DWT, we compute the m tio v e details subbands  o n ectors of th following this formula:  ???? ? ??	???? ??? ? ? ????        (1) With i={1, 2, 3}, j={1, 2, 3, 4}, Vi,j(x,y) is the motion  vector for the subband ?j? at the  level ?i? and  ?i,j is the refinement factor (equal to 0 if ?i? is equal to 3).

Moreover, by predicting the motion only in the approximation which has a small size compared to the original frame, not only the computation requirement is highly reduced and the compression ratio is increasing, but also our method maintains a good prediction quality.

Figure 1. DWT subbands motion vectors representation     The BMA is an efficient method for motion estimation which encourages us to use it in our multiresolution based method. Unfortunately, despite their encouraging proprieties and their promising results, the BMA and DWT suffer from some problems. For this, a several improvement techniques have been implemented to surmount these problems and make our method more robust giving best results.

IMPROVEMENT TECHNIQUES The proposed method outperforms the conventional motion  estimation methods, but still having some problems. That is what we drive us to develop some additional techniques to overcome these problems. These techniques are to detect the motion zone to limit the estimation operation to it; to add a sub-pixel precision to the motion vector computing; to shift the frame to better predict the motion; to overlap the frame blocks to correct the motion vector by their neighboring vectors and finally, to refine the prediction by changing the block size and re-predicting the block which are falsely predicted. In this section we will describe these techniques as well as the causes that conduct us to implement them.

A. Temporal Segmentation To accelerate the ME process, we have reduced the motion  estimation area with a Background subtraction technique [7] to detect the zone which contains the movements. This detection is based on a temporal segmentation which allows us to predict motion only on a limited area.  This technique will reduce the computations of the ME process since it assume that the motion vectors of the blocks that are out of the detected area are null. This gain is increased if the movement is concentrated in a very limited area.

B. Sub-pixel precision Block based motion estimation assume that every block  have an integer displacement which is, in reality, not true.

Therefore, to improve the motion estimation and to increase the accuracy of the prediction, we have moved to sub-pixel precision by developing a sub-pixel technique with a bilinear interpolation process. This is done by interposing a line between each two lines and a column between each two columns of the image. Then, ME is applied to the new image.

With this technique, a motion vector can point in a half or quarter of pixel position or even more. In this case, a block that has a real location at a fraction of pixels will be better predicted. The sub-pixel accuracy can not only increase the accuracy of motion vectors (augmenting the PSNR of the reconstructed image by more than 2dB) and reduce errors, but also filter the image to eliminate noise and rapid changes. That is true that this technique causes a doubling of image size, but it also allow a quick search by minimizing the path to find the corresponding block. For all this, in block based ME methods, sub-pixel technique is becoming crucial.

C. Shifting technique The DWT has many advantages of multiresolution domain,  which has made this space-frequency transformation very useful for the ME. However, the shift-variant property of the DWT caused by the decimation process has made the ME/MC less inefficient in the wavelet domain. Otherwise, there is a big difference between the DWT of an image and the DWT of the same image shifted by one pixel. This property is often seen on the edges of the image, but less important in the low- pass frequencies, which reinforce our choice to conduct ME in the approximation of the DWT.

To overcome the shift-variant property of the DWT, a shifting technique is used which increase the prediction quality [6]. Before applying ME, we shift the frame in spatial domain by one pixel in all directions. Then, the shifted frames are transformed to the wavelet domain for motion estimation more precise and more real. After calculating a motion vector for the block in every direction, we generate the final motion vector which is the mean of all calculated vectors. This technique has increased the estimation results by smoothing the predicted vectors and reducing the aliasing effect.

D. Overlapping block matching technique Supplementary technique for improving the motion  estimation is to overlap the neighboring block to smooth the motions vectors in a way to have a more real prediction. So, each motion vector will be the average of itself and the direct neighboring motion vectors.

This overlapped block matching technique will surmount the false prediction especially the discontinuity at the edges which gives the high frequencies in the estimated image. This is done since the technique is somewhat averaging the possible candidates for each pixel. Hence, this technique will make the visual quality more clear and net.

E. Refinement techniques The basic idea in the BMA is to divide the frame into  blocks of a fixed size N?N. This means that all the pixel of the same block has the same displacement. But, this is not true in most cases, since there may be different movements in the same block. So, we have divided the blocks which are poorly predicted and re-estimate the motion on them. This will fix the blocks size relatively to the movements and we will use variable block sizes [8]. This technique is very powerful since it corrects the motion vectors by a hierarchical procedure based on modifying the block sizes. It provides a good estimation and tries to minimize the error by taking into account the intra-block movements.

Another refinement technique is also carried out for our method, which is to move the estimation to a lower level (larger resolution) of the DWT. This process is not performed for all blocks, but it runs only on poorly predicted blocks. The refinements will re-estimate the motion of the blocks that has an error greater than certain threshold. This technique has given a more accurate estimation prediction quality. We have     proved that the second refinement technique has better results, which have encouraged us to use it in our method.

Our method gives a good visual estimate that resembles to the estimate in the spatial domain.

All these techniques have united to improve our methods which make it fast, efficient and accurate. In addition, we can even exploit the human visual system and remove the small variations not recognized by the human eye between the two frames. The motion vectors and the prediction error are encoded after transformed by DWT using the Embedded Zerotree wavelet algorithm (EZW) which is an algorithm that exploit the wavelet structure for an efficient coding.

EXPERIMENTAL RESULTS In our block based method, we have fixed the DS as a block  searching strategy and the MSE as a block matching criterion since it gives better compression performance while not sacrificing image quality. We have also fixed the size of the window to 7 and the size of the block to 2 since we work in the approximation in the third level of the DWT. Furthermore, we have integrated all the techniques mentioned previously with a quarter of pixel precision.

Figure 2. The 129th frame of ?foreman? and the 17th frame of ?Tennis? sequences. (a) The original image. The estimated image: (b) in the DCT  domain, (c) in the DWT domain, (d) with our method.

CONCLUSION Whatever the motion estimation algorithm considered, a  large computing power is needed. That is why many studies have been made to improve and simplify the algorithms. This paper proposes a multiresolution motion estimation and compensation method based on block matching applying in the wavelet coefficients. We will reinforce our method, in the future works with others techniques, such as the spatial segmentation, to identify the moving objects.

Our method has proved its performance and robustness for several video benchmarks used to test the ME/MC methods such as the "Tennis", "Foreman", "Susie," "Claire" sequences and even the "Football" sequence which contains large movements. The reached results showed large performance in terms of quality of reconstructed frame as shown in Table I(we have used the PSNR as a criterion to compare the original frame to the reconstructed frame after estimation) and also in terms of compression ratio. All this, amounts to the accuracy of the estimation and the corrections made for the motion vectors.

