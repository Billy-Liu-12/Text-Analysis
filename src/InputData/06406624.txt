A Statistical Associative Classifier with Automatic Estimation of Parameters on Computer Aided Diagnosis

Abstract?In this paper, we proposed a classifier based on statistical association rules that avoids the discretization step and automatically estimates the input thresholds. The algorithm automatically selects the most significant features to produce rules. These rules are simple, including the selected features, a single interval in the antecedent of the rule and a label class in the consequent, and getting at most twice the number of rules features. To evaluate our method, we compare it with traditional classifiers as C4.5 and Adaboost, in the task of classifying benign or malign masses of mammograms, using two different real datasets. The proposed method achieve the best results regarding accuracy, sensitivity and sensibility.

Keywords-associative classifier; statistical association rules; computer-aided diagnosis; breast cancer

I. INTRODUCTION  Breast cancer ranks as second cause of cancer death in women (after lung cancer) [1]. In order to reduce the death rate of breast cancer, early detection of breast cancer is very important. Mammography is currently the most effective imaging modality for breast cancer screening. However, 10%-30% of breast cancers are missed at mammography and, in some cases, radiologists cannot detect tumors despite their experience. In the application of mammography to the diagnosis of breast cancer, computer-aided detection (CAD) technologies play a very important role and many CAD systems have been developed. By adopting image enhancement technologies and pattern recognition, computer aided breast detection systems can assist radiologists to find the abnormal regions in the breast easily and effectively [2].

Computer-aided methods using association rules could assist medical decision making and improve the accuracy of detecting lesions and malformations. Traditional association rule algorithms adopt an iterative method to discover fre- quent itemsets (a set of disjoint attribute values contained in a training object), which requires very large calculations and a complicated transaction process [3]. Further, most of these approaches that work with continuous values, require the discretization of continuous data before applying association rule mining. However the discretization process causes loss of information in the mining process. Other challenges of associative classifiers are the huge number of class associa-  tion rules generated and theses methods usually require the user to provide thresholds to select itemsets, which can be a difficult task because thresholds are empirically set and the user have to test many parameters until get reasonable results, including a good balance among the parameters.

Aimed at overcoming these challenges, we propose in this paper a new classifier based on statistical association rules called MinSAR classifier (Mining Statistical Association Rules) to perform breast cancer detection in mammograms.

The MinSAR algorithm mines the rules not requiring a discretization step neither input thresholds, as most of the other association rules methods do. Besides, the number of produced rules by MinSAR is at most twice the number of features. A voting classifier decides which class best represents an image based on the statistical association rules mined by the MinSAR algorithm. The experiments comparing MinSAR with traditional classifiers show that the proposed method reaches high values of accuracy, sensitivity and specificity. Moreover, MinSAR builds a learning model that is easy to understand, making the user aware of why an image was assigned to a given class, and the proposed method has a low computation cost (linear on the number of the dataset items) when compared to other classifiers.



II. BACKGROUND AND RELATED WORKS  Some of the most used classifiers in the literature are the C4.5, 1R, Naive Bayesian and Adaboost. The C4.5 is a classifier that builds a decision tree in the training phase, using the concept of information entropy [4]. The 1R [5] is a classifier based on rules that classify an object/image on the basis of a single attribute (they are 1-level decision trees), involving discrete attributes. Naive Bayesian classifiers are statistical classifiers which are based on the Bayes theorem to predict the class labels, assuming that the effect of an attribute value on a given class is independent of the values of the other attributes [4]. Adaboost basically takes multiple random samples from the data and builds a classification model for each sample. The final classification is the class assigned most often by the models [4].

Recently, associative classification methods have grasped high attention. In general, associative classification consists   DOI 10.1109/ICMLA.2012.103    DOI 10.1109/ICMLA.2012.103    DOI 10.1109/ICMLA.2012.103     of two steps: (1) generating association rules and (2) building a classifier. The rule generation phase is a hard step that requires a large amount of computation. A rich ruleset is constructed after applying a suitable rule pruning and rule ranking strategies. The ruleset that is generated from the training dataset is used to build a model, which is used to predict test cases present in the test dataset [6].

Many associative classifiers have been proposed in the literature, employing the traditional association rule mining and some variation in the first phase of the associative classification process. However, most works in literature has the disadvantage of: requiring the discretization of continuous data before applying the association rule mining; requiring the user to provide thresholds; and generating many candidate itemsets. Recent researches have been deal- ing to minimize these problems. For instance, a statistical approach for associative classification has been employed in [6] to reduce the number of candidates itemsets. In [7] it is presented a suitability study of discretization methods for associative classifiers. However, these approaches still present all the steps of disadvantages afore cited.

Previous works of applying association rules to classify mammograms were also developed showing promising re- sults, where the focus was the development of associative classifiers based on traditional association rules [8][9]. In [10], an algorithm based on statistical association rules called StARMiner? was proposed to classify mammograms, avoiding the step of data discretization and the generation of candidates of itemsets. However, it still has parameters to tune to generate the itemsets, requiring an experienced user to set the proper values for acceptable results.

In this work, we propose to employ statistical association rules avoiding the discretization step, the generation of candidate itemsets and not requiring input thresholds.



III. THE PROPOSED METHOD: MINSAR CLASSIFIER  We propose a framework to perform the MinSAR classifier, which is a statistical associative classifier that employs statis- tical association rules to suggest diagnosis of medical images as a second opinion to the radiologists. Two algorithms were developed to support the method: (i) Mining Statistical Association Rules (MinSAR), which mines rules selecting the features that best represent the images; and (ii) voting classifier, which is a classifier based on ?counting votes? and uses the rules mined by MinSAR to classify images.

The pipeline of the framework is presented in Fig. 1. Ini- tially, the training phase is performed to build the classifier as follows. In the image representation step, features are extracted from the images and placed in the corresponding feature vectors. After that, the feature vectors are the entry for the MinSAR algorithm, which selects the most mean- ingful features and produces the statistical association rules.

In the test phase, the feature vectors from the test images are extracted and submitted to the voting classifier, which  MinSARPre?  MinSAR Classifier  Training? I  Feature extraction  Feature vector b l lProcessing  TRAINING Statistical Association Rules  Images extraction  f2[0.1935,?0.6035]?>class1 f11[0 1595 0 5696]?>class2  Label class  Voting Classifier  f11[0.1595,?0.5696] >class2  Pre? P i  A?Test Image  Feature extraction  Feature vector L b l l  ?Second Opinion?TEST  ProcessingImage extraction Label class Output?? a?class  Figure 1. The framework of MinSAR classifier  uses the statistical association rules produced by the Min- SAR to suggest a diagnosis class for the test image. We discuss the two algorithms (MinSAR and voting classifier) of the MinSAR classifier in the following subsections.

A. The MinSAR Algorithm  MinSAR is a supervised classification model whose goal is to find statistical association rules over the feature vectors extracted from images, providing the attributes that best discriminate images into categorical classes. It returns rules relating feature intervals and image classes.

Formally, let us consider xj an image class and fi an image feature (attribute). Let Vmin and Vmax be the limit values of an interval, where Vmin < Vmax. A rule mined by the MinSAR algorithm has the form fi[Vmin, Vmax]? xj .

To perform the association rule mining, the dataset under analysis is scanned just once. MinSAR computes the mean and the standard deviation for each feature and the Z value for the hypotheses test. Further, two restrictions of interest must be satisfied: (i) the feature fi must have a behavior in images from class xj different from its behavior in images from the other classes; (ii) the feature fi must present a uniform behavior in every image from class xj .

To formalize these restrictions, let T be the image dataset, xj an image class, Txj ? T the subset of image class xj , and fi the ith feature of the feature vector. Let ?fi(Txj ) and ?fi(Txj ) be, respectively, the mean and the standard deviation of feature fi in images from class xj ; ?fi(T?Txj ) and ?fi(T ?Txj ) correspond to, respectively, the mean and the standard deviation of feature fi values of the images that are not from class xj .

A rule fi[Vmin, Vmax] ? xj is computed by the algo- rithm, only if the rule satisfies the thresholds: ??min, ?max and ?min, where ??min is the minimum allowed difference between the average of the feature fi in the images from class xj and the remaining images in the dataset; ?max is the maximum standard deviation of fi values allowed in the class xj ; ?min is the minimum confidence to reject the hypothesis H0. The ??min and the ?max thresholds are automatically computed as follows. For each class, mfi = min(||?fi(Txj ) ? ?fi(T ? Txj )| ? |?fi(Txj ) ? ?fi(Txj )| ? |?fi(T ? Txj )? ?fi(T ? Txj )): ??min = min(mfi) + (max(mfi)?min(mfi))/8 (1)     ?max = ?min ?max(?fi(Txj )) (2) The only threshold value given in the input is the minimum confidence, which usually is greater than 90%. The hypoth- esis H0 states that the mean of fi values inside and outside the class xj are statistically equal:  H0 : ?fi(Txj ) = ?fi(T ? Txj ), (3) and the Z value is computed as:  Zi,j = [?fi(Txj )??fi(T ?Txj )]/[(?fi(Txj )/ ? |Tx|)]. (4)  The values of Vmin and Vmax are computed as Vmin = ?fi??max and Vmax = ?fi+?max. The MinSAR algorithm is presented as follows.

Input: Database T : feature vectors {xj , f1, f2,...,fn}; ?min Output: Mined rules  1: Scan database T; 2: for each class xj do 3: for each feature fi do 4: Compute ?fi(Txj ),?fi(T ?Txj ),?fi(Txj ),?fi(T ?  Txj ) and Z value (eq.4); 5: end for 6: Compute ??min (eq.1) and ?max (eq.2); 7: for each feature fi do 8: if (?fi(Txj ) ? ?fi(T ? Txj )) ? ??min AND  ?fi(Txj ) ? ?max AND (Zij < Z1 OR Zij > Z2) then  9: Write fi [?fi ? ?max, ?fi + ?max]? xj ; 10: end if 11: end for 12: if any rule is found then 13: Choose the feature fi which Z value is the biggest 14: Write fi [?fi ? ?max, ?fi + ?max]? xj ; 15: end if 16: end for  The MinSAR algorithm has the interesting property that the number of rules mined by a class xj is at most twice the total number k of image features. Besides, MinSAR finds rules relating class and the feature intervals where a particular behavior has occurred and has no parameters to tune (except the minimum confidence). The complexity of this algorithm is ?(ckN), where N is the number of instances of the dataset, k is the number of features and c is the number of classes.

B. The Voting Classifier  We developed a classifier that uses the mined rules by MinSAR. The main idea is counting ?votes?. For each class, we count the number of rules that are satisfied. This counting is normalized by the number of rules of the class. The output is the class that obtain more votes. We can observe that the computational cost of MinSAR classifier is low, since the MinSAR is linear on the number of images (dataset items) and the voting classifier is linear on the number of rules.



IV. EXPERIMENTS  Some experiments were performed to validate the Min- SAR classifier using image contents in the task of suggesting diagnosis for regions of interest (ROIs) of mammograms.

The first image database consists of 250 regions of interested (ROIs) taken from mammograms selected from the Digital Database for Screening Mammography dataset1.

This dataset is composed of 151 malign and 99 benign mass images. We proposed a feature extraction method for the image representation step. Initially, we segmented the images and selected the main region of interest (the mass) using an improved version of EM/MPM (Expectation- Maximization/Minimization of Posterior Marginals) algo- rithm proposed in [11]. After, we build a quite compact feature vector, computing eleven features based on the shape of the mass: area, convex area, eccentricity, Euler number, extent, filled area, major axis length, minor axis length, orientation, perimeter and solidity.

The second dataset consists of 569 feature vectors ob- tained from the UCI Machine Learning Repository2, and the classes are distributed in 357 benign and 212 malign masses from mammograms. The image features describe characteristics of the cell nuclei present in the image. Thirty features were computed from breast masses as follows. For each of the three cell nucleus, the following ten features were computed: area, compactness, concave points, concavity, fractal dimension, mean of distances from center to points on the perimeter, perimeter, smoothness, standard deviation of gray-scale values and symmetry.

To evaluate the efficacy of the MinSAR classifier, we compare it with well known classifiers: C4.5, 1-R, Naive bayes and Adaboost. We performed 10-fold cross-validation and to compare the classification results, we compute mea- sures of error rate, accuracy, sensitivity and specificity.

An optimal prediction can achieve 100% sensitivity and 100% specificity. In our experiments, we considered values between 0 and 1.



V. RESULTS AND DISCUSSION  Analyzing the results of Table I using the first dataset with 250 images, we can notice that the MinSAR classifier presented the highest values of accuracy and sensitivity in the 10-cross validation approach, and also resulted in the highest value of specificity together with the 1R classifier.

We get an improvement of accuracy up to 4.8%, 8.2%, 9.4% and 9.4% comparing MinSAR with Adaboost, C4.5, 1R and Naive Bayes performances, respectively. Besides the accuracy values, we can also analyze the number of rules produced by the algorithms and the number of features selected to produce the rules in order to compare the computational cost of the voting-classification step. The  1http://marathon.csee.usf.edu/Mammography/Database.html 2http://www.ics.uci.edu/m?learn/MLRepository.html     Table I RESULTS FROM DATASET 1 - 250 IMAGES  Classifiers Error Accuracy Sensitivity Specificity MinSAR classifier 0.2080 0.7920 0.8767 0.6731  C4.5 0.2680 0.7320 0.8150 0.6150 1R 0.2760 0.7240 0.7603 0.6731  Naive Bayes 0.2760 0.7240 0.8650 0.6230 Adaboost 0.2440 0.7560 0.8420 0.6350  Table II RESULTS FROM DATASET 2 - 569 IMAGES.

Classifiers Error Accuracy Sensitivity Specificity MinSAR classifier 0.0457 0.9543 0.9720 0.9245  C4.5 0.0668 0.9332 0.9290 0.9360 1R 0.1072 0.8928 0.8490 0.9190  Naive Bayes 0.0703 0.9297 0.8960 0.9500 AdaBoost 0.0527 0.9473 0.9150 0.9660  MinSAR classifier mined just 5 rules through the MinSAR algorithm, where 3 are relating to the benign class and 2 to the malign one, and selected 3 features: major axis length, convex area and perimeter. The 1R algorithm mined 8 rules, 4 rules for each class, selecting just the major axis length feature. Finally, the rules produced by the C4.5 were if Perimeter ? 0.1570 then is benign, else is malign.

Analyzing the performance of the algorithms using the second database, with 569 images, we can see in Table II that MinSAR classifier leaded to the highest values of accuracy and sensitivity. MinSAR, C4.5 and 1R produced 46, 13 and 4 rules, respectively and selected 24, 10 and 1 features, respectively. Although MinSAR classifier produced the highest number of rules, it is important to highlight that the rules generated are simple to understand, and each one has just one interval and a label class, whereas the rules of C4.5 are more complex, having to visit the subtrees to get the rule and having to check many intervals until it achieves a leaf node. If we consider each interval as a rule, as in the MinSAR algorithm, C4.5 has the equivalent to 25 rules.

Analyzing the results, we can observe that the error rate of C4.5 is greater than 5% and the error rate of MinSAR classifier is lower than 5%. Therefore, we can infer that despite C4.5 has produced fewer rules, it did not consider all relevant features to categorize the images.

Considering the results from both datasets, we can observe that the MinSAR classifier achieved better results than the other classifiers. Then, we can infer from the results that MinSAR provides a fairly good generalization.



VI. CONCLUSION  The MinSAR classifier is a new method that employs statistical association rules to support computer-aided diag- nosis. This approach does not demand a discretization step and does not require the user to provide thresholds. The method achieved the highest values of accuracy, when com- pared with other well-known classifiers. Further, MinSAR  classifier is more sensitive than specific, what is desirable in the medical domain, since it is more accurate to spot the true positives. Thus, MinSAR classifier contributed to minimize the drawbacks of using association rules employing the statistical approach, producing a compact set of rules that presents a strong power of generalization in the test phase.

Moreover, the produced rules allow the comprehension of the learning process, making the system more reliable to be used by the radiologists.

