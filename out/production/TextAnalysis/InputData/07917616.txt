Integration of Smart Home Technologies for District Heating Control in Pervasive Smart Grids

Abstract?Pervasive technologies permeating our immediate surroundings provide a wide variety of low-cost means of sensing and actuating in our environment. This paper presents an approach for leveraging insights onto the lifestyle and routines of the users in order to control heating in a smart home through the use of individual climate zones, while ensuring system efficiency at a grid-level scale. Organizing smart living spaces into controllable individual climate zones allows us to exert a more fine-grained level of control. Thus, the system can benefit from a higher degree of freedom to adjust the heat demand according to the system objectives. Whereas district heating planing is only concerned with balancing heat demand among buildings, we extend the reach of these systems inside the home through the use of pervasive sensing and actuation. That is to say, we bridge the gap between traditional district heating systems and pervasive technologies in the home designed to maintain the thermal comfort of the user, in order to increase efficiency. The objective is to automate heating based on the user?s preferences and behavioral patterns. The control scheme proposed applies a learning algorithm to take advantage of the sensing data inside the home in combination with an optimization procedure designed to trade-off the discomfort undertaken by the user and heating supply costs. We report on preliminary simulation results showing the effectiveness of our approach and describe the setup of our forthcoming field study.



I. INTRODUCTION  The energy systems worldwide face fundamental transitions in relation to the change from centralized fossil-based pro- duction to a more distributed architecture based on renewable energy sources. This transition will require more intelligent control systems capable of handling the complexity involved in a more distributed and open energy system. To optimize the operational behavior, the control systems are required to increasingly handle the entire supply chain as a whole where production, distribution and consumption are tied together from an information technical perspective.

In relation to this, pervasive technologies are changing the landscape of today?s living spaces, such as smart homes or smart office buildings. They provide a way to tap into the daily routines of their users, in a effort to deliver timely adaptations of the environment that match the user?s preferences while at the same time maintaining an overall good quality of service for the system at large. One such important topic that we explore here is the integration of pervasive technologies in managing district heating systems. In short, we augment  traditional district heating systems with an informational and control layer inside the home, designed to monitor, predict and control heating output for indoor living spaces at the level of individual climate zones.

The majority of work in district heating control has been focused on proposing procedures aimed at balancing the heating output between different buildings in the network according to the district network operator?s (DNO) objectives (e.g. [1; 2; 3]). The DNO is mainly concerned with reliability of supply, such that demand is met without interruptions. This becomes particularly problematic once a significant portion of the supply is ensured using renewable energy generators, given the unpredictability and intermittency of this type of energy sources [4; 5]. Heating control, as described in this paper, has to do with determining the energy amount intended for each consumer in the system at each point in time over a certain time horizon. Note that, there are different levels of aggregation for which the consumption can be prescribed.

Generally, the DNO can act on the supply provided to entire neighborhoods by controlling an area feeder, while some solutions enable the DNO to confine control to substations handling only a handful of buildings [6].

Now, there has been a wide variety of pervasive technologies that have already been deployed to indoor living spaces focus- ing on the user?s comfort in relation to heating systems. For instance, so-called smart thermostat solutions try to infer and take into account the user?s preferences to automatically adapt the indoor climate [7; 8]. However, there is a missing link between the planning generated by the DNO at the substation level and the way in which the user affects the demand by making different settings inside the home. Clearly, the lack of providing this information to the DNO brings about a level of inefficiency in terms of planing.

In this work we look to bridge the gap between the DNO and the user, such that the control actions of the DNO are aligned with the preferences and the behavioral patterns of the user. Specifically, we organize indoor living spaces into controllable individual climate zones by deploying monitoring sensors (temperature, humidity, light and PIR) to capture information from each individual zone, as well as wifi-enabled valves to control radiator output. This is meant to tie together the DNO and the user both from an informational and technical  The First International Workshop on Pervasive Smart Living Spaces 2017     perspective, such that we can control the heating output according to the current state and preference of the user. We hereafter refer to such systems as Pervasive Smart Grids.

The reminder of the paper is organized as follows. In Section II we outline the basics of Pervasive Smart Grids.

Section III presents the activity detection approach for moni- toring space usage. In Section IV we introduce a scheduling algorithm for balancing heat load among consumers. Section V presents preliminary results from simulation and draws future research directions. Section VI concludes the paper and outlines the setup of our forthcoming field study in co- production with industry partners.



II. PERVASIVE SMART GRIDS  In our acceptation, individual climate zones represent the building blocks of Pervasive Smart Grids. By individual climate zone we denote a space with homogeneous climate conditions that are being continuously monitored with sensing equipment, while at the same time certain settings can be remotely enacted onto this space. For the sake of clarity, it is perhaps easiest to conceive these zones as mapped to rooms in an apartment, such that we do not provide the same climate conditions even in the absence of occupancy. This means that we can have different temperature settings in different rooms based on the routines of the user of that space in order to save cost, without incurring user discomfort. For instance, we can imagine a scenario depicted in Fig. 1 where we differentiate between the temperature set-points in the living-room and the bedroom for different times of the day. Assuming that activity during the day takes place in the living-room, we can keep the bedroom at a lower temperature set-point, while during the sleeping hours, we apply the reverse. However, that is not to say that other configurations cannot be envisioned (such as having different zones in an open office environment), the only limitation being the level of control that can be exerted onto the heating system. For our scenario we consider wifi- enabled radiator valves that allows us to control in each zone the heating input for those respective radiators.



III. HMM-BASED ACTIVITY RECOGNITION  In the following we are going to describe the procedure according to which we infer the user?s activities in an indoor setting. The goal is to have a versatile mechanism that can account for different types of sensor data, such that we are not limiting ourselves to a particular sensing infrastructure. It is important to be able to utilize sensors that may have already been installed (e.g. in smart office spaces) and incorporate this data into the computation. Also, in terms of ease of usage it is preferred that the mechanism acts in an unsupervised manner, which absolves us from constructing training sets for the prediction model that include ground truth information, which may be difficult to obtain. Lastly, it is important to point out that it is out of scope for this scenarios to determine a wide class of activities. Here, we are merely interested to distinguish between three types of activities that will be associated to different temperature set-points, respectively, inferring that the  Fig. 1. Example of different individual climate zone corresponding to rooms in an apartment  user is present/home, away or asleep. It this way we also want to avoid the common pitfalls of todays so-called smart thermostats that try to learn complex user habits, but fail to do so and instead cause frustration and may determine the user to eventually abandon the technology [9]. In order to make use of low-cost hardware we limit this study to the following sensors: temperature, humidity, light and PIR, although more advanced ones could also be accounted by the model (smart camera, CO2 senors, acoustic sensors, smartphone movements, etc.), as we describe hereafter.

A. Sensor Selection Step  First, we apply an information-theoretic technique in order to assess which sensors are more significant in relation to the task at hand, namely, to distinguish the three above-mentioned types of activities. This phase is especially important when dealing with limited datasets, in which case we should aim to have a reduced number of features for training the predictive model. In information theory terms, entropy represents the measure of the inherent uncertainty of a random variable. That is, high entropy will correspond to high uncertainty, while low entropy is associated to low uncertainty. Entropy is given by the following formula:  H(y) = ? n? i=1  p(yi)log2p(yi) (1)  where y represents a random variable, yi is a possible outcome of this random variable and p(yi) is the probability of an outcome yi. Based on this, we use the notion of information gain to determine the reduction in the uncertainty of a variable y given the value of of another variable x:  IG(x, y) = H(y)?H(y|x) (2)  where H(y|x) is the conditional entropy of y given x. Finally, the relative information gain [10] which ranks the importance of a particular sensor is defined as:  The First International Workshop on Pervasive Smart Living Spaces 2017    Fig. 2. 3-state HMM corresponding to the monitored activities  RIG(x, y) = IG(y, x)  H(y) ? 100% (3)  where the activity type is denoted by y and the sensor data is given by x. In this manner we can determine the relevance of each available sensor for detecting activities. After ranking the available sensors, the three most important ones will be used for further input to the predictive model.

B. Activity Recognition Step  Hidden Markov Models (HMMs) represent a statistical method for modeling generative time-series, which can be explained by an underlying process generating an observable sequence [11]. HMMs are particularly useful in order to capture the temporal dynamics of the problem and have been successfully applied to many domains [12]. In fact, this represents one argument for choosing HMMs over other classification techniques, due to the fact that HMMs explicitly captures temporal correlations in the data for consecutive time steps. Moreover, for our given scenario, we have an underly- ing stochastic process which accounts for the succession of activities and which is not directly observable, but can be estimated from another stochastic process, which represents the observations reported by the sensors. As described in the previous section, we are using here the highest ranking sensors identified during the sensor selection step. Formally, given a number of possible states and a number of distinct observation symbols per state, a HMM is characterized as follows:  ? = (?,A,B) (4)  where ? is the initial state distribution, A is a state transition matrix between two successive observations and B is the observation symbol probability distribution. Clearly, the set of possible states corresponds here to the set of activities under investigation: S = {Home,Away, Sleep}. A graphical representation of matrix A is depicted in Fig. 2, where a state- transition probability is associated to each edge.

Now, first, in the model training phase we employ the well- known Baum-Welch algorithm ([11]) in order to tune the model parameters ? = (?,A,B) given an available dataset.

Second, given an observation sequence Y = {y1, y2, . . . , yt} and the resulting model ? = (?,A,B), we apply the Viterbi algorithm ([13]), which is an efficient approach to infer the corresponding optimal maximum likelihood state sequence {s1, s2, . . . , st}. Thus, we can detect the activities by casting the activity recognition problem into an HMM decoding one.

Note that here, the y values stand for vectors of sensor data measured from the environment at each time step.



IV. SCHEDULING ALGORITHM  We are now in the position to address the problem of scheduling heating at the level of each individual climate zone. In our particular scenario we will consider the schedul- ing problem for a smart building, achieved using remotely controlled radiator valves as actuators. We consider in the following a discrete planning horizon with time steps t ? T with fixed duration ?t. In this paper, we start from the as- sumption that the DNO provides a target energy consumption, capping the amount of energy made available for consumption at each time slot t. The factors that need to be considered in this regard, although out of scope for this work, have to do primarily with the cost that the DNO is prepared to incur for supplying the heating demand, as well as the forecasted energy output that can be harnessed from intermittent renewable resources.

A. Climate Zones  In more detail, we denote a set of climate zones Z , where we characterize each climate zone zi ? Z using the utility function ?i : R ? [0, 1], representing the perceived comfort experienced by the user with respect to a number of parameters describing the preferred climate conditions of that respective zone. The utility is expressed by the following formula:  ?(?,?) =  1 + ?|?? ?|? (5)  where ? is the actual temperature and ? represents the pre- ferred temperature. As shown in Figure 3, the utility function is bell-shaped, while the mean is given by ?. In other words, the utility reaches maximum when the actual temperature and the desired one coincide, and then it decreases proportionally to the difference increase between the two. Parameters ? and ? are used for adjusting the slope of the utility function, allowing to specify different profiles according to which the utility is influenced by deviations from the desired temperature ?. For instance, it can be the case that utility decreases abruptly when temperatures deviations exceed a certain range (denoting high penalty for deviations), or alternatively that the transition to low utility values is more smooth. Note that, deviations, both in terms of increases and decreases from the desired temperature are equally penalized.

Defining the utility function in this manner provides the user or system designer with a customizable way of describing the characteristics of each climate zone. Moreover, the system acquires a degree of flexibility, allowing it to accommodate different requirements coming from the DNO, while at the  The First International Workshop on Pervasive Smart Living Spaces 2017    Fig. 3. Utility function, where the desired temperature ? = 21?C  same time taking into account the user preferences. Finally, it is important to point out that the user needs to specify ? for each recognizable activity si ? S in the system.

B. Leximin-optimal allocation  The DNO sets an upper limit to the amount of energy available for each time slot for all the designated climate zones on aggregate, P (t) with t ? T . The goal is then to find an allocation policy ? that specifies energy consumption xi(t) for each climate zone zi ? Z given a time horizon T under investigation. More formally, determine the vector [x1(t), x2(t), . . . , x|Z|(t)]  T subject to the following constraint:? i?Z  xi(t) ? P (t), ?t ? T (6)  such that we maximize the social welfare of the system.

Now, there are different approaches to express social welfare using a common utility scale as described in Section IV-A.

Since in our scenario, climate zones are competing for a scarce resource (i.e. energy), we are essentially interested in finding an allocation policy that balances two contradictory requirements that we impose on our system, that is efficiency and fairness.

We express efficiency in the classical utilitarian approach, according to which the best solution is that which maximizes the sum of individual utilities:  ?util = argmax ? i?Z  ?i (7)  However, this approach can lead to significant differences be- tween the utility levels, making it an non-equitable allocation.

In terms of fairness, the egalitarian approach advocates for an equal utility distribution, which clearly can have a negative impact on the overall utility of the system. We use here the standard deviation as a notion of fairness as follows:  ?egal = argmin  ?  |Z| ? i?Z  (?i ? ??) (8)  where ?? denotes the average utility in the system.

Algorithm 1: Scheduling Algorithm Data: ?i for each zi ? Z , P (t) with t ? T , ? Result: Heat load vector [x1(t), x2(t), . . . , x|Z|(t)]T  build up a training set T S det. sensor set J with highest IG in T S learn a HMM model ? = (?,A,B) from T S(J) U ?? ?; for each t ? T do  predict activity ai(t) for each zone zi based on ? update ?i(t) with ? according to ai(t) U = U ? [?1(t), . . . , ?|Z|(t)]  end for j = 1 to |U| do  ??j ? Max ?j subject to ?k = ??k,?k < j and Eq. 6 where ?j denotes the lowest jth utility in U  end Return heat load vector X? = ?(U?)  In this work, we are interested in an allocation policy that can provide a way in which we can satisfy both of our requirements in terms of efficiency and fairness, that are working in contradiction. To this end, the leximin policy provides an approach to overcome this drawback. The leximin policy is the lexicographic preorder over ordered utility vectors [14]. Importantly, in terms of efficiency, the leximin order satisfies Pareto-efficiency, while in terms of fairness it satisfies the Pigou-Dalton property. The former states that given a utility vector, none of the individual utilities can be strictly increased without decreasing of another utility value. The latter states that sum-preserving transfers of utility takes place when this will result in narrowing the gap between individual utilities.

Formally, let ??a and ?? b denote vectors of the same length  Nn. We denote vectors ??a and ?? b sorted in ascending order  as ??a ?, ?? b ? respectively. Let ?leximin denote the relation  of the leximin policy. Then, ??a ?leximin ?? b if and only if  ?i ? [0, n? 1] such that ?j ? [1, i] a?j = b ? j and a  ? i+1 < b  ? i+1,  meaning that vector ?? b dominates ??a in the leximin ordering.

The ??a ?leximin ?? b notation is used if and only if ??a ? =  ?? b ?.

Also, ??a ?leximin ?? b for ??a ?leximin  ?? b or ??a ?leximin  ?? b .

In our scenario, given an aggregate target consumption, we need to allocate consumption to each individual climate zone, according to the leximin policy. Suppose that ? represents the set of utility vectors that satisfy Eq. 6, namely that the aggregate consumption for all climate zones does not exceed the target value P . Then, the utility vector ??a ? ? is leximin- optimal in ? if and only if ?  ?? b ? ?:  ?? b ?leximin ??a .

Intuitively, the leximin order first reduces the worst complaint among all the objectives. Under these conditions, then it maximizes the second lowest utility, and so on.

C. Putting it all together  Recall that control actions are passed to the heating infras- tructure as commands to radiator valves. In particular, we use  The First International Workshop on Pervasive Smart Living Spaces 2017    Fig. 4. Impact of different levels of flexibility regarding a) efficiency and b) fairness  thermostatically controlled valves that can attain and maintain a certain specified temperature. This brings about the issue of relating consumption to actual temperature values reported by sensors from the environment. For this purpose, we have chosen the thermal ? model1 introduced in [15] due to its ease of implementation and good level of accuracy. In short, the actual temperature ?(t) at time-slot t can be determined based on the temperature at the previous time-slot and the heat load supplied x(t):  ?(t) = ?(x(t), ?(t? 1)) (9)  The scheduling algorithm that implements the leximin policy is outlined in Table 1. The required input consists of the utility functions ?i corresponding to each individual climate zone, the desired temperature ? for every recognizable activity, the target consumption P (t) for a given time horizon t ? T and the thermal model ?. In addition, we assume that the HMM-based prediction model is provided with the set of available sensors in the environment, as well as a training set for batch processing. Once the prediction model is generated, the real-time stream of sensor data is used to determine the forecasted activity schedule for time horizon T . These activity patterns and preferences for each individual climate zone in- duce their respective flexibility domain (i.e. the set of possible temperature values and associated utilities). We further apply the thermal model in order to transpose temperatures into heat load values. Finally, the leximin optimal solution is determined subject to the maximum overall consumption constraint.

An important aspect is the fact that the control actions per- formed at every time-slot, expressed in terms of supplied heat load, depend on the climate conditions detected at the previous time-slots. Thus, for generating a solution, the algorithm needs to account for all of these dependencies at once. For this reason we introduce the following operator:  1The thermal model requires solving a system of differential equations. For further details we refer the reader to [15].

[x0, . . . , xm]? [x?0, . . . , x?n] = [x??0 , . . . , x??m+n+1] (10)  where each value of the resulting vector x?? is a distinct value of the initial vectors x and x?. In this manner, we use the ? operator to denote the aggregation of objective values for time horizon T .



V. EXPERIMENTAL ANALYSIS In this section we provide a preliminary evaluation of our  leximin-based allocation policy for district heating control.

Throughout the evaluation we consider the following exper- imental set-up, making a number of simplifying assumptions.

The scenario is focused on the scheduling problem of in- dividual climate zone control in a smart building with 7 apartments, each one organized into 3 climate zones corre- sponding to different rooms in the apartment. The three types of activities recognizable to the system (home, away, sleep) are simulated with a uniform distribution. The planning horizon T = {1, 2, 3} provides a scheduling solution for the next three time-slots. The target energy consumption is scaled down to 75% with respect to the necessary amount needed to fully satisfying all user requirements. Parameters ? and ? based on which we define the utility functions for each climate zone are uniformly drawn from the interval [10?4, 10?3] and [1, 10] respectively. The thermal model parameters, which reflect the characteristics of the building are set to the following values: T1=600 and T2=2686.41, according to [15].

The objective of the analysis conducted here is to evaluate the performance of the leximin policy against the requirements identified in Section IV-B, namely fairness and efficiency of the allocation. In Figure 4(a) we plot the relative performance of leximin against the utilitarian (?util) and egalitarian (?egal) solutions. The uppermost curve is of course the utilitarian solution, which has its sole objective efficiency maximization.

The policies are evaluated for different levels of flexibility, in terms of deviations from a desired temperature. It is interesting  The First International Workshop on Pervasive Smart Living Spaces 2017    to remark that both the leximin and egalitarian solutions converge to the optimal utilitarian solution, when a high level of flexibility is allowed. However, in general terms, a 10?C deviation would not be acceptable in a residential setting, in which case, the leximin solution guarantees a superior utility. Figure 4(b) provides an evaluation based on the metric introduces in Eq. 8, also used to compute the egalitarian policy.

Thus, here we are interested in a fair allocation of the heat supply in the sense of minimizing the standard deviation of the allocation. Notably, the leximin solution performs just as well as the egalitarian policy regardless of the level of flexibility.

At the same time, the utilitarian policy can attain the optimal allocation only in case of a high level of flexibility. From this analysis we can conclude that the leximin policy is clearly the preferable choice, as it provides a a good trade-off between efficiency and fairness, especially for instances where only minor deviations from a desired user setting are acceptable.

As future work we plan to evaluate how the algorithm scales both in terms of the number of controlled climate zones, as well as the number of time-slots scheduled in advance.

We hypothesize that for large-scale settings, determining the optimal leximin solution is no longer computationally feasible, due tot the highly combinatorial nature of the problem. Thus, approximation algorithms need to be developed that are close to the optimal and can scale to hundreds or even thousands of climate zones controlled simultaneously.



VI. CONCLUSIONS In this paper we put forward the notion of Pervasive Smart  Grids as a means for performing coordinated district heating control, by leveraging sensing infrastructure in the home and actuators for enforcing certain conditions at the level of individual climate zones. First, we propose a mechanism for determining activity patterns in the home environment based on exploiting a heterogeneous mix of data sources. Second, we introduce a scheduling algorithm used to determine how the available heat supply is distributed to each individual climate zone under consideration. We demonstrate how our leximin-based allocation policy is able to balance efficiency and fairness, while complying with schedules prescribed by the DNO at an aggregate level.

In further studies, we plan to evaluate our approach in a real- world setting, by deploying IoT sensor equipment and wi-fi enabled radiator valves in two residential properties connected to the district heating network in Karlshamn in co-production with industry partners. The goal of this field study is to grasp a better understanding of the extent to which participants are at ease with delegating heating control to an automatic process. Also, it would be interesting to assess what are the most appropriate way for participants to interact with the system, such that it conveys an enjoyable and seamless user experience. Moreover, it is important to determine the level of flexibility that would be considered acceptable.

