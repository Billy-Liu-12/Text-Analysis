A Novel Pipeline Method for the Preprocessing of Mass  Spectrometry Proteomics Data

Abstract- Mass spectrometry based methodologies allow us to analyze complex mixtures of proteins from biological samples in order to identify important proteomic patterns and discover novel disease biomarkers. However proteomics data are high-dimensional and complex and need to undergo a number of preprocessing steps so that they can be further analyzed. This procedure involves various steps that interact in complex ways and is an open research area, as it has been shown that it has a big effect on the final results. In this work we propose a novel pipeline method for the preprocessing of MS-based data. Our proposed strategy addresses some of the major problems when dealing with proteomics data, like miscalibration, noise and redundancy. Our method exploits the advantages of using the mean spectrum, ensuring at the same time higher sensitivity. In order to illustrate the utility of our proposed method we experimented on data coming from samples of patients with bladder cancer or benign disease. The results were quite encouraging, as 31 statistically important peaks were identified, some of which are not detected by existing methods.



I. INIRODUCTION  T he rapid developments in mass spe?trometry ?M?) ?d the introduction of new expenmental 10ntzatlOn  methods, like matrix-assisted laser desorption ionization  (MALDI) and surface-enhanced laser desorption ionization  (SELDI), has made it possible to study protein expression  levels in complex mixtures of proteins from various  biological samples, like serum [1] plasma [2] and urine [3].

The data generated from these technologies can be used to  identify proteomic patterns that can successfully separate  states (e.g. normal versus disease) and possibly discover  novel disease biomarkers. Those patterns have high  diagnostic significance, as they can be used for early  diagnosis, prognosis, monitoring disease progression or  therapeutic response [4]. This strategy has already been used  in various types of cancer, like ovarian [1] [5], breast [2] and  prostate cancer [6], giving interesting results.

However, the complex nature of proteomics data makes  their analysis a challenging task, as the initial raw data are  very difficult to handle. More specifically, the data retrieved  after an MS experiment contain hundreds of samples (i.e.

mass spectra), and in each sample correspond tens of  Manuscript received June 2010 Maria Anna v. Rapsomaniki (rapsoman@ceid.upatras.gr), Konstantinos  A. Theofilatos (theofilk@ceid.upatras.gr), Spiridon D. Likothanassis (likothan@ceid.upatras.gr), Athanasios K. Tsakalidis (tsak@?i.gr? and Seferina P. Mavroudi (mavroudi@ceid.upatras.gr) from Umverslty of Patras, Greece. Panagiotis G. Zerefos (pzerefos@bioacademy.gr) from Biomedical Research Foundation, Academy of Athens, Athens, Greece   thousands of features. In addition to this high dimensionality  - small sample size problem, each spectrunI contains a great  amount of noise and artifacts, mostly due to the high  sensitivity of the instrunIent, sample contamination and  electrical noise. Another common problem is the  miscalibration of the spectra that makes the data impossible  to compare. For all those reasons, it is more than obvious  that in order to extract knowledge about the true underlying  biological differences in the proteome, various preprocessing  steps need to be applied.

The main goal of preprocessing is to come up with a  matrix of important features (i.e. peaks) and their  corresponding intensity values, which can be further  analyzed using a variety of computational methods. To  achieve this, one must first remove noise, artifacts and  systematic bias without loss of information and then detect  and quantify a set of peaks. Preprocessing involves various  steps that are highly interrelated and it has been shown that  if those steps are not applied carefully, it will be difficult to  extract meaningful conclusions about the underlying disease  [7]. For each step, a number of methods have been proposed  making the decision about the best combination of methods  a very challenging task. Furthermore, it is difficult to  evaluate the performance of each method and come up with  a standard strategy, as for each dataset a different set of  methods appear to be more effective.

This paper proposes a new method for the preprocessing  of proteomics data that deals with the problematic  characteristics of the data and exploits the advantages of  various existing methods. More specifically, our proposed  strategy focuses on three main problems: correcting the  miscalibration of the mass spectra, detecting the peaks in a  sensitive yet robust manner and extracting the true intensity  values that correspond in each peak. For the peak fmding  step, we used a method based on the mean spectrunI  approach, where we first fmd the peaks per category, then  apply certain criteria to ensure their reproducibility and then  combine them in a single peak list. Instead of working with  peak locations, we propose the use of peak intervals, to  ensure that the small shifts present in the data do not  interfere with the fmal results. Our proposed pipeline was  applied in a MALDI MS dataset, obtained by the Proteomics  Research Unit of the Biomedical Research Foundation,  concerning patients with bladder cancer (high or low grade)  and benign bladder disease. After the preprocessing, a  classification step was applied, which achieved extremely    high performance. Furthermore, 31 statistically important  peaks were identified, some of which are not detected by  existing methods.

Our method is programmed in MATLAB R2007b. All source codes are available upon request.



II. BACKGROUND  Before proceeding in the next section that describes our  proposed pipeline method, we first briefly review the  separate steps usually involved in MS data preprocessing.

The first preprocessing step is usually denoising, where one  tries to get rid of noise without loss of information. Usual  approaches involve variations of the Wavelet Transform,  and because of its time-shift invariance, the Undecimated  Discrete Wavelet Transform (UDWT) [8] is becoming the  standard choice in this task.

The next preprocessing step is usually baseline  correction, where the aim is to remove from the signal the  exponential baseline curve that is present because of the co?  ionization of the matrix molecules. Various methods are  available, that are mainly based on iteratively fitting a curve  to the local minima of the signal [9].

The existence of systematic error is another common  characteristic that makes the comparison of different spectra  problematic. Global normalization of intensity values helps  get rid of the experimental variations and is usually  performed according to the Total Ion Current (TIC), which  describes the total amount of protein present in the sample.

The peak finding and peak quantification steps are  crucial in dimension reduction, as from a spectrum of tens of  thousands of mlz points we end up with a single matrix  consisting of some hundreds of peak locations and their  corresponding intensity values (matrix of protein expression  levels). The aim is to detect peak positions as local maxima  and find corresponding intensity values, based on a peak's  height or area, for every spectrum.

Finally, miscalibration and measurement errors cause the  peaks to appear in slightly different mlz locations and thus  peak alignment is used to correct those minor shifts.

Commonly used algorithms try to fmd a common set of mlz  values that represent all the samples, so that the same peaks  appear at identical mlz locations. In some of them each  signal is shifted and scaled, so that the maximum alignment  among spectra is achieved, while in others the peaks are  clustered so that the ones that represent the same protein  belong to the same bin. The latter category is often referred  as peak matching and a common approach includes the use  of hierarchical clustering [10].

There are two main approaches available concerning the  fmal two steps: the first one proposes to detect and quantify  peaks in individual spectra, which gives n peak lists (where  n the number of samples) that need to be matched afterwards  [11]. This method is very sensitive, as it detects all peaks,  but requires the application of peak matching. Common  problems are that the results are often redundant, as even the  insignificant or random peaks are detected, and that the same  peak is sometimes detected twice, because of mistakes in the  peak matching step. The second approach suggests peak  detection using the mean spectrum and then peak  quantification by finding the corresponding intensities in  individual spectra [4]. This method is becoming increasingly  popular, as there is no need to match peaks afterwards and  also the peaks detected are statistically important. However,  a common problem with this approach is that quite often  small peaks that may be of biological importance disappear  in the mean. It has also been shown that if the spectra are  misaligned, the peaks are not detected correctly [12].



III. METHODOLOGY  Dataset: Our proposed method was tested on a MALDI  dataset, composed of urine samples that were collected from  approximately 200 patients with Bladder Cancer (High or  Low Grade) or benign bladder disease. The samples were  run through the spectrometer during 9 days, giving 9 subsets (batches) of mass spectra. For each batch, a set of control  samples were also provided. Each sample was run 5 times, giving 5 replicates. The preprocessing of this dataset was  very challenging because apart from the aforementioned  problems we had to deal with some additional ones. More  specifically, the calibration of the samples was not done  systematically, which resulted in incomparable spectra.

Furthermore, as most urine sample spectra, the spectra were  significantly contaminated and contained a great amount of  irrelevant peaks [13]. All those reasons necessitated the  application of extra preprocessing steps.

Proposed Pipeline Method: Our proposed method is  organized in two main steps: fmding the optimal peak list  that describes all samples and accurately quantifying the  peaks in all spectra. For the first step, we used the strategy  shown in Fig. 1. First, we applied a replicate selection step  by computing the pairwise Euclidean distances between each  replicate and their mean and then selecting the one with the  minimum distance, as we considered it to be the most  representative. In that way we obtain a more manageable  sample size without loss of information, as all 5 replicates  actually refer to the same sample. We also applied a  resampling step, in order to homogenize the mlz vectors and  be able to compare different samples under the same  reference. To achieve that, each signal was decimated into a  more manageable mlz vector and at the same time an  antialias filter was applied, so that high-frequency noise is  prevented from folding into lower frequencies.

One of the biggest problems we had to correct was the  miscalibration, which caused the presence of shifts in the  spectra, in some cases bigger than 100 mlz units. For that  reason we used an iterative process that involved first the  alignment of the control (reference) samples, then the  correction of the shifts (linear transformation) in individual  spectra using the control alignment and fmally the global  alignment using a vector of reference peaks.

In order to fmd the most appropriate peak list, we propose  a strategy based on the idea of using the mean spectrum for    peak detection. As mentioned, this method results in a peak  list with statistically important peaks, as random peaks that  appear only in individual samples are usually not detected.

However, there is no way to tell if a small yet persistent  peak, present in the majority of the samples of one category  and thus a possible biomarker, is detected or is disappeared  in the mean. On the other hand it is possible that sometimes  random peaks with high intensity values "survive" in the  mean.

For all those reasons, we used the mean spectrum per  category in order to combine the robustness of peak fmding  through the mean spectrum with higher sensitivity. We also  applied a SNR cutoff criterion, discarding the peaks that their  Signal-to-Noise Ratio (SNR) was under a certain threshold.

We introduced a consistency criterion, counting the times  each peak was detected and discarding the ones with a  frequency lower than 35%. Finally, a peak matching  algorithm was used in order to combine the separate peak  lists into a final one.

Fig. I: Pipeline method for peak detection  In order to quantify the peaks in individual spectra, we  used the method shown in Fig. 2. More precisely, first we  denoised the spectra using the UDWT. Then, we computed  the baseline in multiple shifted windows and regressed it  using a shape-preserving piecewise cubic interpolation.

Finally, we normalized the intensity values by standardizing  the Area under Curve (AUC) to the group median. Since  small shifts still appear in the spectra, we used peak  intervals of fixed width, centered at each peak's position,  and searched for the maximum intensity value inside each  interval. In that way we ensure that the minor shifts do not  cause mistakes in peak quantification.

Fig. 2: Peak quantification  The fmal matrix of peak expression levels was further  analyzed using an approach (Fig. 3) that involved a simple  filtering feature extraction method (two-way t-test) followed  by a Support Vector Machine (SVM) classifier with a  quadratic kernel function [14]. The details of this analysis  are beyond the aim of this paper but are available upon  request.

Feature Selection and SVM learning  Fig. 3: Final Analysis

IV. RESULTS  We applied our proposed method in the dataset described  earlier in order to detect and quantify the peaks. In Table I we provide the results in the peak finding step for each  category, before and after the application of the cutoff  criteria. As we can see, each step reduces significantly the  dimensionality of the problem. The application of the peak  matching algorithm combined these 3 peak lists in a vector  of 456 peak bins, which are the features that will be further  used in the analysis.

TABLE I NUMBER OF PEAKS DETECTED PER CATEGORY  initial set after SNR cutoff after Consistency cutoff  Benign    Low Grade    High Grade    The feature extraction and classification process was  repeated 100 times, to ensure reproducibility of the results,  and each time the classifier was built using a different  feature set. The average values of the evaluation  performance measures for our method are provided in Table  II.

TABLE II  CLASSIFICA nON PERFORMANCE  Accuracy Sensitivity Specificity  0.9903 0.9887 0.9911    In order to compare our results with existing methods, we  also performed peak finding using the overall mean  spectrum [4], which gave us a matrix of 484 peaks and  corresponding intensities. The feature extraction step failed  to identify statistically important features among those 484  peaks.

A further investigation of the results revealed that using  our method a certain subset of 31 features is selected in  every run of the feature selection algorithm. This indicates  that those features have high discriminatory power and thus  could be possible biomarkers. We also observed that the  mean spectrum method failed to identify 7 of those features.

In Fig. 3 we show one of these features, which as we can see  is far more abundant in cancer (both low and high grade)  than benign samples.

Mean Bening Spectrum 10000 r----,----,-----,----,----,-----,---?  -? ? 5000 c:  o t------   >-  U) 5000 c: c:   3625 3630 3635 3640 3645 3650 3655 m/z  Mean Cancer Spectra? Low and High Grade  3625 3630 3635 3640 3645 3650 3655 m/z  Fig. 4: Peak at mlz location 3641.3

V. FUTURE WORK  In this paper we proposed a novel pipeline method for the  preprocessing of MS-based proteomics data, which deals  with the demanding characteristics of this type of  bioinformatics data. Our future considerations involve the  development of a web-based tool, which will implement the  basic steps of our method. In addition, because of the large  number of steps and parameters involved in preprocessing,  our tool will propose optimal combinations of steps and  optimal parameter values according to the dataset each time  provided, and in that way will ease the preprocessing job for  the unfamiliar user.

