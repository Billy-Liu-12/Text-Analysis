A 3-D Gabor Phase-Based Coding and Matching Framework for Hyperspectral Imagery Classification

Abstract?As manual labeling is very difficult and time- consuming, the labeled samples used to train a supervised classifier are generally limited, which become one of the biggest challenge for hyperspectral imagery classification. In order to tackle this issue, a recent trend is to exploit the structure infor- mation of materials, as which reflects the region homogeneity in the spatial domain and offers an invaluable complement to the spectral information. In this respect, 3-D Gabor wavelets have been introduced to extract joint spectral-spatial features for hyperspectral images. One the one hand, the features extracted by 3-D Gabor wavelets lead to very good performance for clas- sification. On the other hand, its drawbacks, i.e., big number of features and high computational cost, limit its applicabil- ity. In this paper, a 3-D Gabor-wavelet-based phase coding and Hamming distance-based matching (3DGPC-HDM) framework is developed for hyperspectral imagery classification. The pro- posed method, instead of taking into account the large volume of Gabor magnitude features, exploits the Gabor phase fea- tures with certain orientations (i.e., the direction parallel to the spectral axis), which are then encoded by a simple quadrant bit coding scheme. After that, a normalized Hamming distance matching (HDM) method is adopted to determine the similarity of two samples, and the nearest neighbor classifier is routinely uti- lized for pixelwise recognition. Finally, experiments on three real hyperspectral data sets show that the proposed 3DGPC-HDM leads to very good performance. Comparisons with the state- of-the-art methods in the literature, in terms of both classifier complexity and generalization ability from very small training sets, are also included.

Index Terms?Gabor wavelets, hyperspectral imagery classifi- cation, phase coding.

Manuscript received January 8, 2017; accepted March 9, 2017. This work was supported in part by the National Natural Science Foundation of China under Grant 61671307 and Grant 61672357, in part by the Guangdong Special Support Program of Top-Notch Young Professionals under Grant 2015TQ01X238, and in part by the Shenzhen Scientific Research and Development Funding Program under Grant JCYJ20160422093647889, Grant SGLH20150206152559032, and Grant JCYJ20160422144110140. This paper was recommended by Associate Editor X. Li. (Corresponding author: Linlin Shen.)  S. Jia and L. Shen are with the Shenzhen Key Laboratory of Spatial Information Smart Sensing and Services, Shenzhen University, Shenzhen 518060, China, and also with the Computer Vision Research Institute, College of Computer Science and Software Engineering, Shenzhen University, Shenzhen 518060, China (e-mail: senjia@szu.edu.cn; llshen@szu.edu.cn).

J. Zhu and Q. Li are with the Shenzhen Key Laboratory of Spatial Information Smart Sensing and Services, Shenzhen University, Shenzhen 518060, China (e-mail: liqq@szu.edu.cn).

Color versions of one or more of the figures in this paper are available online at http://ieeexplore.ieee.org.



I. INTRODUCTION  W ITH the fast development of hyperspectral remote sen-sor technology, hundreds of spectral bands over the same surface area (i.e., hyperspectral imagery) can be acquired at the same time, which has greatly increased the possibility of precisely discriminating the various land materials [1], [2].

In the last decade, hyperspectral imagery classification has been extensively studied [3], in which the biggest challenge is the huge discrepancy between the large number of spectral features and the scarcity of training samples (due to the diffi- culty and expense of manual labeling), leading to the so-called Hughes phenomenon [4]. Consequentially, how to exploit the rich information to effectively tackle the small sample size (3S) problem is an important issue and has received much attention in hyperspectral imagery analysis [5].

In order to deal with the 3S problem, one possibility is to perform dimensionality reduction, such that to decrease the number of spectral bands. On the one hand, feature extrac- tion methods, such as principal component analysis [6]?[8], independent component analysis [9], etc., by transforming the original hyperspectral data into a low-dimensional space via some mapping techniques, are widely used in the commu- nity. On the other hand, feature (or band) selection meth- ods, such as supervised [10], [11], unsupervised [12]?[14], semisupervised [15], etc., which directly picked out the most representative bands from the original data are also an impor- tant direction. Dimension reduction, eventually alleviating the Hughes phenomenon, however, sacrifices its potential for clas- sification as it discarded part of the data information [16].

Alternatively, spatial structure information of surface materi- als, reflecting the fact that spatial adjacent pixels are from the same class with a high degree of probability, is invaluable and can be utilized together with the spectral features to increase the classification performance [17].

According to the integration manner of spectral and spatial features, the spectral-spatial classification approaches can be roughly categorized into two main groups: 1) combination- based and 2) fusion-based. On the one hand, for the combination-based methods, the first trend is that the con- textual information, i.e., the spatially consistent regions, is generally extracted via some spatial filters [18]?[20], including the morphological operators [21]?[24], entropy [25], low- rank representation [26], hypergraph structure [27], etc. The obtained spatial features can then be combined with the spec- tral features to form the final feature representation for the classification task. Moreover, spatial regularization is also used  See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.

mailto:senjia@szu.edu.cn mailto:llshen@szu.edu.cn mailto:liqq@szu.edu.cn http://ieeexplore.ieee.org http://www.ieee.org/publications_standards/publications/rights/index.html   This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.

to refine the classification maps [28], such as Markov random fields (MRFs) [29]?[35] and hyperspectral image segmenta- tion [36], [37]. At this point, it should be noted that, those methods have strong limitation to fully exploit the potential in the hyperspectral data as they manage the spectral and spatial information in separate frame. However, it is known that hyperspectral data are with 3-D structures by nature.

Furthermore, the parameters involved in those methods are crucial, as they are generally sensitive and difficult to be tuned [38], which in end limits the classifier to reach the optimal performance [39].

On the other hand, concerning the fusion-based methods, several 3-D structure oriented data transformation tools have been developed. Specifically, in [40], a 3-D discrete wavelet transform has been proposed, which is carried out by a series of 1D-DWT along the 3-D (two spatial axes and one wave- length axis) in sequence. After the hyperspectral data cube is decomposed, the obtained subcubes are directly concate- nated to form the feature vector. Although these features have been shown to be more discriminative than the original spec- tral signatures, the intrinsic spectral-spatial structures of the hyperspectral cube has not been fully exploited due to the cascaded nature of this method. In [41], a 3-D scattering wavelet transform [42]?[44] has been introduced to extract spatial-spectral features, in which a scattering feature of each pixel is computed by a cascade of wavelet decompositions at different scales and orientations, and then a weighted averag- ing step is taken in local area to reduce feature variability.

Finally, 271 subcubes are extracted, while each subcube is of the same size as the original cube. The high dimension of the features obtained by this method can be then decreased via dimensionality reduction techniques. However, the high computational cost and large storage requirement has severely limited its applicability, especially for hyperspectral data with large spatial coverage.

More recently, Gabor wavelet methods become active for hyperspectral image classification, as the Gabor wavelet can achieve optimal joint time/frequency and space/frequency res- olutions [45], which can directly tackle the 3-D nature of hyperspectral data. In [46], a 3-D Gabor wavelet transform has been presented for hyperspectral classification. Specifically, a set of 3-D complex Gabor wavelet filters with multiple frequencies and orientations has been predefined, which are convolved with the original hyperspectral image data to extract joint spatial-spectral features. The magnitude of the response at each pixel is then used for feature representation. A fea- ture selection process has been further developed to reduce the redundancy among the obtained high-dimensional fea- tures [47]?[49]. However, it is very difficult to perform feature selection, while the 3S issue makes the problem more critical. Moreover, the aforementioned methods, both combination-based and fusion-based ones, focus on the fea- tures. In order to obtain the classification result, a classifier, such as K-nearest neighbors (KNN) [50], [51], support vec- tor machines (SVMs) [52], sparse representation-based clas- sification (SRC) [53], should be employed to accomplish the hyperspectral classification. Due to the nature of these  classifiers, it is often time consuming to achieve satisfactory classification performance. For example, the kernel SVM is known to be very effective, and at the same time very com- putational heavy. Therefore, it is more desirable to extract high discriminative dimensionality-reduced features and build an effective classification procedure for hyperspectral imagery.

In this paper, a 3-D Gabor-wavelet-based phase coding and Hamming distance-based matching (3DGPC-HDM) frame- work is developed for hyperspectral image classification. First of all, four Gabor filters, where the features are coded via 2-bit binary, with the same size of the original image, under different scales and the same orientation, are conducted for the subsequent analysis while the rest features are excluded, as we observe that the Gabor phase features extracted by Gabor fil- ters with particular orientations, i.e., the direction parallel to the spectral axis, contain more discriminative information than the other ones. Since only four subcubes are retained, it can greatly increase the efficiency of the feature extraction pro- cedure (in contrast, all the Gabor magnitude features should be acquired and stored in advance to carry out the feature selection and fusion process). Then, a normalized Hamming distance is adopted to determine the similarity of two samples, which is simply computed by bit XOR operators. Finally the nearest neighbor classifier is used for recognition. For illus- trative purpose, Fig. 1 presents the schematic diagram of the proposed strategy. Here the widely used Indian Pines hyper- spectral image data is used for exhibition, and the size (both spectral and spatial dimensions) of every Gabor phase cube and binary coding feature cube is the same as the original hyperspectral imagery.

The main contribution of this paper lies in the following four aspects.

1) First of all, we propose to extract Gabor phase features with particular orientations (i.e., parallel to the spectral axis). The desired features, which are more discrimina- tive than the other ones, lead to significant classification performance. This is considered to be one of the most important advantages of the proposed 3DGPC-HDM over other Gabor magnitude-based techniques.

2) Furthermore, the efficiency of 3DGPC-HDM is particu- larly advantageous due to the two-bit binary coding of the discriminative low-dimensional phase features and the XOR-based Hamming distance measure. Besides, it has been proved that HDM method is particularly effective and efficient to measure the similarity between samples containing binary values (i.e., either 0 or 1), which is just the case of the encoded Gabor phase fea- tures. Thus the Gabor phase encoding and HDM benefit from each other and should be jointly applied on the hyperspectral data to accomplish the classification task.

3) Another contribution of this paper is that the extraction and encoding procedure of phase features is unsuper- vised, that is, the phase features are directly obtained from the raw hyperspectral images and do not need any training process, so the efficiency of our 3DGPC-HDM is further improved.

This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.

JIA et al.: 3DGPC MATCHING FRAMEWORK FOR HYPERSPECTRAL IMAGERY CLASSIFICATION 3  Fig. 1. System block diagram of the proposed 3DGPC-HDM framework for hyperspectral image classification.

4) Finally, our 3DGPC-HDM is parameter free, i.e., all the necessary parameters have been properly predefined and kept the same for different hyperspectral image data sets, which is another distinct advantage of the proposed 3DGPC-HDM approach.

All these observations suggest that more attention should be paid to traditionally abandoned Gabor phase features. To our best knowledge, this is the first utilization of Gabor phase cod- ing in hyperspectral image representation and classification.

The rest of this paper is organized as follows. In Section II, we introduce the basic notations and briefly describe the related works. Sections III and IV, respectively, present the proposed 3DGPC and HDM approaches. Afterward, the exper- imental results on real hyperspectral remote sensing data are reported in Section V. The validity of choosing the Gabor phase features with certain orientation for the following cod- ing and classification is also experimentally verified. Finally, the conclusions are given in Section VI.



II. RELATED WORKS  Before presenting the mathematical formulations, we first introduce the notations. Let R ? RX?Y?B denote the hyper- spectral image cube and axy ? RB be the reflectance spectral signature at spatial location (x, y) in the X ? Y imaged scene, and B represents the number of spectral bands. Suppose there are P significant materials existing in the scene, denote by Ap = [ap,1, ap,2, . . . , ap,np ] ? RB?np the training set of the pth class, np is the number of samples in Ap and each column ap,j( j = 1, 2, . . . , np) is a B-dimensional spectral signature.

Moreover, let A = [A1, A2, . . . , AP] ? RB?n be the con- catenation of the n training samples from all classes, where n = n1 + n2 + ? ? ? + nP.

A. 3-D Gabor Wavelets  In general, Gabor transform is defined as a modulation of a gaussian function by a sinusoidal signal, which could achieve the optimal time and frequency resolution for joint time-frequency analysis [45]. The Gabor elementary function was then extended to the 2-D counterpart by Granlund [54], which has been widely applied to extract features for tex- ture classification [55], face recognition [56], [57], optical  Fig. 2. 3-D frequency domain.

Fig. 3. Gabor filter with orientation (0, 0, 1) viewed from three directions.

character recognition [58], etc. Furthermore, in order to cap- ture the important information about local signal changes in joint spatial-spectral correlations (such as medical MRI brain images, hyperspectral images), the Gabor filters have been generalized to 3-D [59], [60]. Specifically, as displayed in Fig. 2, ? and ? here, respectively, represents the angles of frequency vector f with w-axis and u ? v plane in the fre- quency domain (u, v, w), and a 3-D Gabor wavelet filter at position (x, y, b) (where x and y are the sampled spatial vari- ables and b is the sampled spectral variable) can be defined as follows:  ?f ,?,? (x, y, b) = 1 (2?)2/3? 3  exp( j2?(xu + yv + bw))  ? exp (  ?x 2 + y2 + b2  2? 2  )  u = f sin ? cos ?, v = f sin ? sin ?, w = f cos ? (1)  where f is the central frequency of the sinusoidal wave, and ? is the width of the Gaussian envelope in the spectral-spatial domain. Fig. 3 displays a 3-D Gabor filter with orientation (0, 0, 1) as viewed from three directions.

In order to sufficiently characterize the surface materials, a set of I ? J ?K Gabor wavelets with multiple frequencies and    This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.

orientations is required and designed as [46]  ?fi,?j,?k(x, y, b), fi = fmax 2i  , ?j = j? J  , ?k = k? K  (2)  where fi, (?j, ?k), respectively, represents the amplitude and orientations of central frequency, and fmax is the highest ampli- tude of frequency. Eventually, the wavelet filters are denoted as {?i,j,k, i = 0, . . . , I?1; j = 0, . . . , J?1; k = 0, . . . , K?1}.

B. Gabor Feature Extraction for Hyperspectral Data  Concerning hyperspectral data, due to the spatial regular- ity and spectral similarity of surface materials, it is more desirable to extract joint spectral-spatial features for classi- fication, which is just the inner product of signal with the wavelet set. Specifically, for a certain Gabor wavelet ?i,j,k with central frequency fi and orientation ?j, ?k, the coefficient Gi,j,k(x, y, b) = (R ? ?i,j,k)(x, y, b) represents the local sig- nal change information around location (x, y, b), where ? is the convolution operation. Since Gabor wavelet ?i,j,k is com- plex, the convolution coefficient at (x, y, b) can be described by magnitude Mi,j,k(x, y, b) and phase Pi,j,k(x, y, b)  Mi,j,k(x, y, b) = ?  Re ( Gi,j,k(x, y, b)  )2 + Im(Gi,j,k(x, y, b))2 (3)  Pi,j,k(x, y, b) = arg tan Im ( Gi,j,k(x, y, b)  ) Re  ( Gi,j,k(x, y, b)  ) (4) where Im and Re operations get the imaginary and real parts of the complex coefficient, respectively. In practice, in order to extract adequate spectral-spatial-associated informa- tion from the hyperspectral data cube, fmax is set as 0.5 and I = J = K = 4. More precisely, the frequency f takes the values of [0.5, 0.25, 0.125, 0.0625], while the orienta- tion parameters ? and ? vary in steps of 45?, and take the values [0, 45?, 90?, 135?]. It can be easily derived from (1) that the frequency vector f points to the w direction when ? = 0, regardless of the ? value, resulting in 52 wavelets {?l, l = 1, . . . , 52} in total.

Due to the sensitivity of phase information to the vary- ing positions, the magnitude of the convolution result Mi,j,k(x, y, b) is normally retained, and the phase information Pi,j,k(x, y, b) is directly discarded [61], [62]. As hyperspectral data usually contain hundreds of spectral bands, the computa- tional cost and storage load of the Gabor magnitude features are generally very high for relative median and large scale image set. More severely, the large amount of Gabor mag- nitude features leads to huge redundancy, which brings big challenge for most classification methods. A possible way is to perform dimensionality reduction to extract the discrimi- native Gabor features from the whole magnitude feature set; however, it is very difficult to obtain the most discrimina- tive set and useful information are possible to be discarded.

Therefore, we need to develop more powerful techniques to fully exploit the rich information in the features, where the Gabor phase information provides an alternative way to study the hyperspectral classification task [63]?[66].



III. 3-D GABOR-WAVELET-BASED PHASE CODING  A. Gabor Phase With Particular Orientation  According to the definition of Gabor magnitude and phase, i.e., (3) and (4), it can be found that Gabor magnitude com- putes the distance between the origin point and the complex convolving result, while Gabor phase represents the angle between the real part and the imaginary part. For adjacent pix- els in the spatial domain, their magnitudes are similar while the phase features can have large variation, meaning that the stability of Gabor magnitude is significantly higher than that of Gabor phase. Hence, the orientation variation of Gabor fil- ters can have a critical impact on the discriminative ability of the extracted Gabor phase features [67], [68].

In this paper, we have observed that the Gabor phase fea- tures with the direction parallel to the spectral axis, that is, the Gabor filter with orientation (0, 0, 1) (as shown in Fig. 3), con- tain more discriminative information than the others. This is expected since the Gabor filters that are parallel to the spectral axis is in accordance with the data structure of hyperspectral imagery, as displayed in Fig. 1. In contrast, when the orien- tation of the Gabor filters is arranged at some angle (or even perpendicular) to the spectral axis, the discriminative power of the phase responses in the convolved data cube can be affected substantially due to the instability of phase and incompatibil- ity between the Gabor filter and hyperspectral data. Therefore, only one Gabor filter in each scale is applied for feature extrac- tion of Gabor phase. In addition, four different scales have been conducted to fully exploit the strong capacity of Gabor filters for multiscale problems. Therefore, we result in four feature cubes for the subsequent analysis. As aforementioned, the phase features obtained by other Gabor filters are excluded.

The features of the designed subcubes from the Gabor filter can significantly improve the efficiency of the feature extrac- tion procedure as the number of features are much smaller than that of the full number. At the same time, it can signif- icantly increase the classification performance as it avoids to deal with the redundancy in the other features. Fig. 4 shows the Gabor phase images of the tenth band in the Indian Pines data set with 13 orientations in a single scale, from which it can be clearly observed that the Gabor phase image with orientation (0, 0, 1) [Fig. 4(b)] contains more specific infor- mation than the images extracted by the Gabor filters with other orientations [69], [70].

B. Feature Coding  Due to the sensitivity of Gabor phase features to position variation, it is unrealistic to directly utilize the Gabor phase information for feature matching. As a result, only Gabor magnitude has been used for representation and recognition tasks in most of the previous works. However, Gabor phase is also important for feature representation. In this paper, in order to increase the stability and discriminative ability of Gabor phase features, quadrant bit coding (QBC) [71] is applied on the Gabor phase feature set, which encodes phase information according to the quadrant that it belongs to. Concretely, each pixel in the resultant Gabor feature cube    This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.

JIA et al.: 3DGPC MATCHING FRAMEWORK FOR HYPERSPECTRAL IMAGERY CLASSIFICATION 5  Fig. 4. Gabor phase images of the tenth band in the Indian Pines data set with 13 orientations in a single scale. (a) Tenth band in the Indian Pines data set. (b) Gabor phase image with orientation (0, 0, 1). (c)?(n) Gabor phase images with the other orientations.

Fig. 5. QBC of Gabor phase.

Gi,2,2(x, y, b), i = 0, . . . , I ? 1 [it is worth to point out that the Gabor filters with orientation (0, 0, 1) actually correspond to the circumstance that both parameters ? and ? in (2) are ?/2, that is, j and k are equal to 2] has been encoded into two bits, (FRei (x, y, b), F  Im i (x, y, b)), by the following rules:  FRei (x, y, b) = {  1 if Pi,2,2(x, y, b) ? {I, IV} 0 if Pi,2,2(x, y, b) ? {II, III} (5)  FImi (x, y, b) = {  1 if Pi,2,2(x, y, b) ? {I, II} 0 if Pi,2,2(x, y, b) ? {III, IV}. (6)  Fig. 5 represents the QBC scheme of Gabor phase feature in the polar coordinate system. From Fig. 5 and (5) and (6), it can be easily observed that the QBC method assigns two bits for each pixel based on the quadrant that the Gabor phase lies. That is, the coding values should be the same (either 0 or 1) within every 90? ((0?, 90?], (90?, 180?], (180?, 270?],  Fig. 6. QBC of the tenth band image in the Indian Pines data set with four different scales. The first figure in each subfigure is the real part, while the second one is the imaginary part.

(270?, 360?]). Hence the Gabor phase features are simplified and quantified by the QBC procedure. Furthermore, in order to compute the QBC values more directly, the encoding methods given in (5) and (6) can be reformulated as follows [62]:  FRei (x, y, b) = {  1 if Re ( Gi,2,2(x, y, b)  ) > 0  0 otherwise (7)  FImi (x, y, b) = {  1 if Im ( Gi,2,2(x, y, b)  ) > 0  0 otherwise (8)  where Re(Gi,2,2(x, y, b)) and Im(Gi,2,2(x, y, b)) are, respec- tively, the real and imaginary parts of the Gabor convolution result. Through transforming the Gabor phase (the range is 0 to 2?) into binary code (0 or 1) by the QBC strategy, it not only increases the stability of Gabor phase features, but also accel- erates the following feature matching procedure, eventually improving the efficiency of the proposed classification frame- work. Fig. 6 displays the QBC figures of the 10th band image in the Indian Pines data set with four different scales. It can be clearly observed that the QBC procedure has improved the sta- bility of the Gabor phase greatly [compared with Fig. 4(b)], and the obtained QBC features can be directly utilized for classification.



IV. HAMMING DISTANCE-BASED MATCHING AND CLASSIFICATION  A. Hamming Distance-Based Matching  After the Gabor phase features of hyperspectral imagery has been encoded by the QBC strategy (as aforementioned, four scales are considered), eight binary feature cubes, FRei and FImi , i = 0, . . . , 3, have been obtained. For any test sam- ple t with spatial position (xtt, ytt), we adopt the normalized Hamming distance in [71] to measure the material similarity for pixelwise classification. Concretely, assuming the spatial axes of any training sample s in the training set A are (xtr, ytr), the normalized Hamming distance between the test sample t and the training sample s is computed by  D0 = ?3  i=0 ?B  b=1 ( bitRei + bitImi  ) 8 ? B (9)    This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.

Algorithm 1 3DGPC-HDM for Hyperspectral Imagery Classification  1: INPUT: raw HSI data R, I = 3, training set A ? RB?n (with n samples) and test set T ? RB?m (with m samples) from P classes, the labels of the training set L ? R1?n;  2: OUTPUT: Identity C for all test samples; 3: BEGIN 4: for i = 0 to I do 5: Gi,2,2 = R ? ?i,2,2; 6: FRei = Re(Gi,2,2) > 0; 7: FImi = Im(Gi,2,2) > 0; 8: end for 9: for j = 1 to m do  10: D = zeros(1, n); 11: for k = 1 to n do 12: Using equation (9) to compute the Hamming dis-  tance between the jth test sample and the kth training sample, and the result D0 is stored in D(k);  13: end for 14: Cj = L(arg min D); 15: end for 16: END  bitRei = FRei (xtt, ytt, b) ? FRei (xtr, ytr, b) bitImi = FImi (xtt, ytt, b) ? FImi (xtr, ytr, b) (10)  where ? is the bit XOR operator, i.e., the result is equal to zero if and only if the two bits, Fi(xtt, ytt, b) and Fi(xtr, ytr, b), are equal to each other. Otherwise, the result is equal to 1.

The smaller the Hamming distance, the more similar between the test sample and the training sample. At last, the near- est neighbor classifier is commonly used for recognition. The proposed 3DGPC-HDM framework for hyperspectral imagery classification is outlined in Algorithm 1.

B. More Analysis of 3DGPC-HDM  To summarize, the proposed 3DGPC-HDM has the follow- ing advantages. First, 3DGPC is encoded from the Gabor phase features with certain orientation and multiple scales.

It is well known that Gabor wavelets can achieve optimal joint time/frequency and space/frequency resolutions for sig- nal processing, while 3DGPC also has these merits. Therefore, the proposed 3DGPC approach has encoded large amount of discriminative information and provided important feature description for pixelwise classification.

Second, different from Gabor magnitude features that all the 52 extracted Gabor cubes should be extracted and used to decide which features to be kept for classification, our 3DGPC only takes into account the Gabor cubes with particular ori- entation, i.e., the direction parallel to the spectral axis. This is considered to be one of the most significant advantages of our 3DGPC over the Gabor magnitude-based techniques, as it sig- nificantly simplifies the computational complexity by reducing most of the number of features by the Gabor magnitude fea- tures. At the same time we empirically find out that it can greatly improve the classification performance.

Naturally, the Gabor phase encoding and HDM can benefit from each other and should be jointly applied on hyperspec- tral data to carry out the classification task. Specifically, the encoded Gabor phase features have provided sufficient dis- criminative information for HDM strategy, while the latter is an effective tool to utilize the encoded features.

Third, it can be evidently seen from Algorithm 1 that the extraction and encoding of Gabor phase information is totally unsupervised since the features are directly derived from the raw hyperspectral images, thus the proposed 3DGPC- HDM can be easily generalized to hyperspectral imagery with different data distribution.

Finally, the computation of 3DGPC-HDM is computa- tionally efficient. Specifically, the computation cost mainly includes two parts. One part is the extraction and encoding of Gabor phase information. By adopting the fast Fourier transform to accomplish the Gabor filtering, the convolutional complexity of each Gabor filter is O(3XYB log  ? XYB) [72].

Since only four Gabor phase feature cubes were used, the calculation time and storage requirement has been greatly decreased, compared to Gabor magnitude-based methods.

Alternatively, the feature coding procedure can be completed by bit shift, whose complexity is O(8XYB). The other part is consumed for calculating the Hamming distance between each test sample and all training samples by bit XOR operators, that is approximately O(nB). Furthermore, from Algorithm 1, it can be observed that the extraction and encoding procedure of Gabor phase features can be carried out only once, while the HDM processes will run m times with different training set to classify all test samples. It can be also found from Algorithm 1 that all parameters included in 3DGPC-HDM have been well set and kept the same for different hyperspectral imagery, which is another distinct advantage of the proposed approach.



V. EXPERIMENTAL RESULTS  In this section, experiments have been carried out on three real hyperspectral images to validate the superiority of the proposed 3DGPC-HDM method. The classification results are compared visually and quantitatively with seven methods, i.e., three 3-D Gabor magnitude-based methods and four state-of-the-art spectral-spatial-integrated classi- fication techniques, including generalized composite ker- nel (GCK) machines [73], subspace multinomial logistic regression classifier with MRFs-based multilevel logistic prior (MLRsubMLL) [74], multiple feature (extracted from lin- ear and nonlinear transformations) learning-based classifica- tion (MFL) [75], [76], and local binary patterns-based extreme learning machine (LBP-ELM) [77]. As depicted in [46], after all Gabor magnitude feature cubes have been extracted, a feature selection and fusion process is applied to reduce the redundancy among the large number of Gabor features.

Further, three representative multiclass classifiers, including KNN, SVM with radial basis function (RBF) kernel, and SRC, are, respectively, used to finish the classification, which are abbreviated as FM-KNN, FM-RBFSVM, and FM-SRC, respectively [fused magnitude (FM)]. In the experiments, for    This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.

JIA et al.: 3DGPC MATCHING FRAMEWORK FOR HYPERSPECTRAL IMAGERY CLASSIFICATION 7  Fig. 7. Ground-truth map of the Indian Pines data set (16 land cover classes).

KNN, the number of neighbors was set to be 3. Concerning SVM, the one-against-all scheme was used for multiclass classification and its parameters are estimated by P-fold cross validation. We recall that P is the number of classes.

Concretely, after evenly separating all the training samples into P groups, only one group is utilized for validation and all other groups are used for training. The process is repeated P times for each value of the SVM parameters, and the parameters with the highest average score are thus chosen to perform the evaluation of test set. Besides, for SRC method, the Homotopy method is used to recover the sparse signals [78], and the regu- larization parameter ? is empirically set as 10?2. Considering the other four compared techniques, the parameters are set the same as their original papers. As far as the 3S problem is mainly concerned in this paper, the performance of eight com- pared methods is evaluated with different sample sizes: fixed number/percentage of the provided labeled samples is ran- domly picked out from each class to constitute the training set, and the remaining samples are then used for evaluation. Each experiment is repeated ten times with different training sets to make the comparison fair, and both mean accuracies and stan- dard deviation are reported. Concerning the evaluation metrics, overall accuracy (OA) and kappa coefficient (?) are adopted to quantify the classification performance. Specifically, OA is computed by dividing the sum of the correctly classified sam- ples by the total number of test samples, while ? is calculated by accounting for all elements in the confusion matrix [79].

Clearly, higher values of the two metrics correspond to better classification performance.

A. Indian Pines Data Set  The first data set is the commonly used Indian Pines hyper- spectral data acquired by the AVIRIS instrument over the agricultural area of Northwestern Indiana in 1992, which has a spatial dimension of 145 ? 145 and 224 spectral bands.

The spatial resolution of the data is low (20 m per pixel).

Due to atmospheric absorption, four zero bands and 35 lower signal-to-noise ratio bands are discarded, and 185 channels are preserved. The ground truth data, as show in Fig. 7, con- tains 10 366 labeled pixels and 16 ground-truth classes, most of which are different types of crops (see Table I).

In order to verify the validity of choosing only four Gabor phase feature cubes for the subsequent encoding and matching procedure, Fig. 8(a)?(c) shows the results of KNN, RBFSVM and SRC on each Gabor magnitude feature cube, while Fig. 8(d) shows the results of HDM on the encoded feature of each Gabor phase cube, respectively. Here four situations are considered, that is, fixed number samples, 3, 5, 10, and 15,  Fig. 8. Indian Pines data: OA versus 52 Gabor feature cubes using differ- ent number of training samples per class. (a) KNN on the Gabor magnitude feature. (b) RBFSVM on the Gabor magnitude feature. (c) SRC on Gabor magnitude feature. (d) HDM on the encoded Gabor phase feature. The dotted lines with different colors represent the OA of the corresponding training size on all 52 Gabor magnitude cubes (the first three figures) and all 52 encoded Gabor phase cubes (the last figure).

TABLE I LAND COVER CLASSES WITH NUMBER OF  SAMPLES FOR THE INDIAN PINES DATA  of the labeled samples were, respectively, selected from each class to form the training sets. Meanwhile, the results on all Gabor magnitude features and encoded phase cubes with dif- ferent sizes of training sets are shown as the dotted lines with different colors. From Fig. 8, it can be clearly observed that the accuracy difference between the four Gabor features with orientation (0, 0, 1), i.e., numbered 8, 21, 34, and 47, and the rest ones are more distinct in Fig. 8(d) than the other three figures. That is to say, the performance of HDM on the four encoded feature cubes of Gabor phase is significantly higher than the other ones. Moreover, the results on all encoded Gabor phase cubes are much lower than those on all Gabor magnitude    This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.

Fig. 9. Indian Pines data. (a) OA. (b) ? as functions of the number of labeled samples per class.

Fig. 10. Indian Pines data. (a) OA. (b) ? as functions of the percentage of labeled samples per class.

cubes. This is mainly due to the fact that the stability of Gabor magnitude features is considerably higher than that of Gabor phase, and less informative Gabor phase feature cubes (i.e., those obtained with orientations not parallel to the spectral axis) can severely deteriorate the classification performance.

Therefore, the orientations of Gabor filters can have a crucial impact on the representability of the Gabor phase features, as displayed in Fig. 8(d), and it would be desirable and prac- ticable to choose the four Gabor phase feature cubes with orientation (0, 0, 1) for encoding, rather than taking all the 52 Gabor phase feature cubes into consideration.

Alternatively, with respect to the eight compared techniques, the classification accuracy (OA) and ? coefficient measure as functions of the number of training samples per class (3, 4, . . . , 15) is displayed in Fig. 9. Besides, the experi- ments with different percentage of labeled samples per class (3%, 4%, . . . , 10%) as training samples are also carried out, as illustrated in Fig. 10. From the two figures we can see, it is rational that the classification performance improves with the increase of training size. The results of GCK, MLRsubMLL, and MFL are lower than the other five methods. Besides, the performance of three Gabor magnitude-based methods (FM-KNN, FM-RBFSVM, and FM-SRC) and LBP-ELM are comparable, while our 3DGPC-HDM provides the best results, demonstrating the effectiveness of the proposed approach. In particular, when the training size is extremely small (such as three samples per class), the differences between the algo- rithms are apparent. It is worth to mention that since the feature fusion procedure of Gabor magnitude is carried out on the training set, the most discriminative feature set may not be picked out due to the limited training samples, and  TABLE II INDIAN PINES DATA: CLASSIFICATION PERFORMANCE USING THE  EIGHT METHODS ON THE TEST SET WITH THREE LABELED SAMPLES PER CLASS AS TRAINING SET  (a)  (c) (d) (e) (f)  (g) (h) (i) (j)  (b)  Fig. 11. Indian Pines data. (a) Training set (three labeled samples per class). (b) Test set (the rest labeled samples). Classification maps obtained by (c) GCK, (d) MLRsubMLL, (e) MFL, (f) FM-KNN, (g) FM-RBFSVM, (h) FM-SRC, (i) LBP-ELM, and ( j) 3DGPC-HDM (the percentage in the brackets is the corresponding accuracy).

the classification accuracy can be decreased. Contrarily, only four typical Gabor phase feature cubes have been taken into account in 3DGPC-HDM, thus the feature fusion procedure is not necessary.

Concerning the case that the training size is only three labeled samples per class, the classification accuracy for each class, the OA and ? coefficient using various techniques are shown in Table II. From the table, it can be seen that, in most cases, the results yielded by our 3DGPC-HDM are better than those obtained by other methods. Fig. 11 illustrates the training    This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.

JIA et al.: 3DGPC MATCHING FRAMEWORK FOR HYPERSPECTRAL IMAGERY CLASSIFICATION 9  Fig. 12. Ground-truth map of the Pavia University data set (nine land cover classes).

TABLE III LAND COVER CLASSES WITH NUMBER OF SAMPLES  FOR THE PAVIA UNIVERSITY DATA  (a) (b)  Fig. 13. Pavia University data. (a) OA. (b) ? as functions of the number of labeled samples per class.

set, test set and classification maps of the eight techniques in a single experiment. It can be visually observed that the map of 3DGPC-HDM [Fig. 11( j)] is in better accordance with the real map [Fig. 11(b)] than the others.

B. Pavia University Data Set  The second airborne data set was acquired by the ROSIS-03 sensor over the university of Pavia, Italy. It contains 115 spectral bands. After 12 noisy bands are omitted, 103 chan- nels are kept for processing. The spatial size is 610 ? 340 and the spatial resolution is much higher than that of the Indian Pines data, which is 1.3 m per pixel. The Pavia University data has 42 776 labeled samples in total, and nine classes of materials are considered. The detailed information about the Pavia University data is presented in Fig. 12 and Table III.

Fig. 13 displays the OA and ? coefficient as functions of the training size for the samples per class (3, 4, . . . , 20). Likewise,  (a) (b)  Fig. 14. Pavia University data. (a) OA. (b) ? as functions of the percentage of labeled samples per class.

TABLE IV PAVIA UNIVERSITY DATA: CLASSIFICATION PERFORMANCE  USING THE EIGHT METHODS ON THE TEST SET WITH THREE LABELED SAMPLES PER CLASS AS TRAINING SET  the results of using different percentage of labeled samples per class (3%, 4%, . . . , 10%) to form the training set are given in Fig. 14. It can be observed that the classification accuracies improve as the number of the training samples increases, and the results obtained by our 3DGPC-HDM are more accurate than those of the other seven compared methods. This is in accordance with the previous experiments, where it can be observed that 3DGPC-HDM is a better alternative than the other seven methods.

When the training set only contains three labeled samples of each class, the detailed classification results with various approaches are listed in Table IV. Similarly, it can be found that most of the accuracies achieved by 3DGPC-HDM are higher than the other seven methods. Due to the limitation of page length, the classification maps of the eight techniques are omitted.

C. Salinas Data Set  Third, the hyperspectral data collected by AVIRIS sensor over Salinas Valley, California is considered. The spatial cov- erage is 512?217 and the spatial resolution is 3.7 m per pixel.

After removing 20 water absorption bands from original 224 spectral bands, 204 bands are reserved. The Salinas data is composed of 54 129 labeled pixels and 16 land-cover classes.

Detailed information about Salinas data set can be found in Fig. 15 and Table V.

As before, the classification results using different features and classifiers are given in Fig. 16 (the results with different    This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.

Fig. 15. Ground-truth map of the Salinas data set (16 land cover classes).

TABLE V LAND COVER CLASSES WITH NUMBER OF  SAMPLES FOR THE SALINAS DATA  (a) (b)  Fig. 16. Salinas data. (a) OA. (b) ? as functions of the number of labeled samples per class.

percentage of labeled samples per class as training samples are not given due to the limitation of page length). Since the spatial distribution of surface materials is very regular (as shown in Fig. 15), the classification performance of all eight techniques is higher than the two hyperspectral data sets aforementioned. Similarly, the accuracies of the eight meth- ods with three labeled samples per class as training set are summarized in Table VI, from which it can be seen that the OA and ? value of our 3DGPC-HDM are 84.21% and 0.825, respectively, while the rest methods are, respectively, 79.79% and 0.777 (GCK), 82.28% and 0.805 (MLRsubMLL), 77.30% and 0.749 (MFL), 68.60% and 0.655 (FM-KNN), 72.23% and 0.694 (FM-RBFSVM), 64.56% and 0.614 (FM-SRC), and 78.56% and 0.763 (LBP-ELM), verifying the superiority of the proposed 3DGPC-HDM classification framework.

TABLE VI SALINAS DATA: CLASSIFICATION PERFORMANCE USING THE EIGHT METHODS ON THE TEST SET WITH THREE LABELED  SAMPLES PER CLASS AS TRAINING SET  (a) (b)  (c)  Fig. 17. Time as functions of the number of labeled samples per class for the three data sets. (a) Indian Pines. (b) Pavia University. (c) Salinas.

At last, the computational time (in second) of the eight tech- niques on the three hyperspectral data sets is compared, as depicted in Fig. 17. Concretely, the computation time was recorded by a workstation with 16-core AMD processor of 3.10 GHz and 64 GB RAM, and the results are average of ten experiments. It can be observed from Fig. 17 that the com- putational cost of FM-RBFSVM and FM-SRC rises rapidly with the increase of training size due to the high complexity of the two classifiers, i.e., RBFSVM and SRC. Meanwhile, although the KNN classifier is much faster than RBFSVM and SRC, the calculation time of FM-KNN is dominated by the feature fusion procedure, thus the computational burden is still high. Alternatively, the computational time of GCK    This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.

JIA et al.: 3DGPC MATCHING FRAMEWORK FOR HYPERSPECTRAL IMAGERY CLASSIFICATION 11  and MFL is decided by the morphological feature extraction, while that of LBP-ELM is determined by the LBP feature extraction, so the computational cost is almost not affected by the variation of training sample size. Furthermore, since only four Gabor phase feature cubes have been used, and the feature coding and matching procedures have been achieved by simple bit computation, the computational time of our 3DGPC-HDM is much lower than three Gabor magnitude-based methods and comparable to the other four state-of-the-art techniques, demonstrating that 3DGPC-HDM approach is practical for large-scale hyperspectral imagery classification.



VI. CONCLUSION  In this paper, we have proposed a 3DGPC-HDM frame- work for hyperspectral imagery classification. In contrast with previous methods, which generally consider the Gabor mag- nitude features for classification, our 3DGPC-HDM approach utilizes the Gabor phase features instead. On the one hand, the Gabor phase features obtained with the direction parallel to the spectral axis contain more discriminative information than those with other orientations, which could significantly improve the classification performance. On the other hand, the coding and matching process introduced is very efficient and effective.

We have demonstrated the superiority of our 3DGPC-HDM approach on three real hyperspectral images. Comparison with a number of alternatives, i.e., GCK, MLRsubMLL, MFL, FM-KNN, FM-RBFSVM, FM-SRC, and LBP-ELM, are also included. The experimental results consistently show that 3DGPC-HDM exhibits very good performance. Since Gabor phase is a valuable feature, more extensive and systematic research, such as feature coding and matching procedures, will be investigated in future work.

