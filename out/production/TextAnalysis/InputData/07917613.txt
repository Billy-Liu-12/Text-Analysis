Data Analysis of Transit Systems Using low-cost IoT Technology

Abstract?The rapid increase of modern wireless technology opens the door for several new applications using the Internet of Things (IoT) technology. In an educational environment, students depend on the transit bus system for their daily routine and there is a high demand of people to be served by buses around university campuses in the United States of America. Often times, the members of university communities find themselves waiting for a significant amount of time for a bus to arrive at the bus station. Universities have numerous bus stops as well as routes on which riders can use for travel. Several of these bus stops are covered by WiFi capabilities, and usually students are checking their smart phones while waiting for bus arrival. In order to monitor the quality of transit buses and passengers? services, we design, develop, and demonstrate a low cost IoT system that detects the majority of the riders on the bus system at each station. In this paper, the IoT devices collect, analyze and archive transit and passenger data (e.g., waiting times) to Cloud Storage from each bus station. The goal is to improve the passenger?s experience by refining the current infrastructure in place, focusing on better planning and increasing bus ridership through better scheduling. By collecting such data (e.g., waiting times), the performance of the bus system can be further analyzed and suggest changes to a route in order to achieve a more efficient and sustainable urban transportation system.



I. INTRODUCTION  With the rapid technological advancements of sensors, wire- less sensors have become the main technology for IoT [1].

Wireless sensors are composed of a large number of sensors that are physically small, communicate wirelessly to a Cloud Storage, and are deployed without a network topology [2], [3]. The deployment environments of the IoT devices could be over a small or large geographical area in locations that are either public or hostile. Typically, the environments require little human interaction and devices go unattended for months or even years.

According to the United States Department of Transporta- tion, Intelligent Transportation Systems (ITS) is one of the key aspects of improving transportation safety and mobility.

In addition, ITS enhances American productivity through the integration of advanced sensing and communications technolo- gies into the transportation infrastructure and in smart vehicles.

With the new era of wireless communication, ITS uses these technologies to advance its applications [4].

Intelligent Transportation Systems (ITS) improves planning, design and management. Topics range from communications,  computers, decision systems, sensors, simulation, signal pro- cess, quality assurance and more [5]. ITS uses mostly legacy technologies such as inductive loop detectors, magnetometers, video detection systems (e.g., cameras), acoustic tracking systems and microwave radar sensors in conjunction with probe vehicles and other means to estimate traffic parameters [6].

According to the United States Department of Transporta- tion, there were 5.3 million crashes and 2.22 million injuries in 2011 alone. These numbers accounted for over 32, 000 fatalities. In 2010, the cost of congestion in urban areas was around $101 billion. Furthermore, the total amount of wasted fuel topped 1.9 billion gallons. One of the main goals of intelligent transportation systems is to keep people safe by sharing information that can prevent potential crashes, keep traffic movement and decrease the negative environmental impact of the transportation sector on the society. Using IoT, ITS systems can collect and analyze important data about bus riders, then put in place an infrastructure to minimize cost and waiting times while also maximizing safety and efficiency.

The transit bus system has become an integral part of students, faculty and staff traveling around campus in many countries. Riders find themselves waiting for a significant amount of time for a bus to arrive at their stop. The goal of this paper is to calculate the waiting time of passengers at each bus station. We will assess the infrastructure of current bus operations using a low-cost WiFi technology system.

We collect data using a self-contained package with wireless capabilities. This data is sent to a Cloud Storage that keeps the necessary information for further analysis. The idea is to mon- itor and record users waiting times at each bus stop throughout the university campuses. Five field implementation tests were conducted at James Madison University, Virginia, USA. Upon detection, passengers? waiting times are recorded and sent to a Cloud Storage. By collecting data (e.g., passenger waiting times), the performance of the bus system can be analyzed in order to suggest options to achieve a more sustainable urban transportation system.

This research aims to effectively improve the current transit bus operations at James Madison University by using low- cost WiFi and/or Bluetooth technology to collect data (e.g., waiting times) [7]. The feasibility of this research relied on finding an accurate but cost-effective solution to collect and  First International Workshop on Mobile and Pervasive Internet of Things'17     store this data. Our hardware equipment consists of a low- cost Raspberry Pi that scans for nearby devices via WiFi and calculates the waiting times of each device that was in the proximity of the Raspberry Pi. The desired conclusion of this project is to have a Raspberry Pi located at the bus stops (or even in the buses itself) throughout James Madison University (JMU) and University of Virginia (UVA), which can constantly be scanning for data over the course of an entire day, 7 days a week (24/7). The transit agencies would then be able to use this data from various bus stations to determine the busiest stations, the stations where people wait the longest for a bus, and trends such as times of day where stops tend to get congested. Using all of this valuable information the transportation departments at both universities are able to make more informed decisions when determining optimal bus routes throughout the campus.

The rest of this paper is organized as follows. Section II describes an overview on related research done recently, and shows its scope and focus. Section III presents the design, and module details of the system, followed by results evaluation in section IV that explains the calculation of the waiting time for each passenger in a specific bus station. Finally, section V concludes the paper, and sheds light on future directions.



II. RELATED WORK  Recently, several researchers have been looking to make more sustainable urban transportation system, by embedding intelligent transportation and communication to the traditional transportation system. For example, Bluetooth technology has been widely adopted in transportation applications [8], [9], [10]. Travel times were directly measured by matching Blue- tooth MAC addresses obtained from Bluetooth readers placed at two locations along a highway [9]. Many metropolitan areas including Northern Virginia now display travel times on freeways using this technology. Furthermore, the Bluetooth technology was used to obtain sample origin destination demand to improve the estimation of time-dependent origin- destination matrices for better transportation modeling [8].

These applications clearly demonstrated that the Bluetooth technology can help improve transportation operations and management. Recently, WiFi technology has gained attention among researchers because it could obtain more samples than Bluetooth technology. In fact, WiFi readers installed inside buses were used to estimate origin-destination of bus passengers [11]. It is noted that their preliminary research required some efforts to screen the MAC addresses data to make origin destination data, indicating that a formal data reduction procedure should be in place [11].

As noted, Dunlap et al. [11] estimated passenger origin and destination (OD) information for transit lines using sensors, installed on four buses to collect Bluetooth, WiFi and GPS location data for a week period. They focused mainly on the time the bus takes to reach from an origin to a destination without automated details about how to count the number of passengers in each bus station. Oransiriku et al. studied how to improve the quality of service in a public transportation  systems using a WiFi network activity of mobile devices [12].

Nishide et al. [13] introduced a position estimation method based on the relative positions of users in line, using mobile terminals and a position management server. The study fo- cused on the Received Signal Strength Indicator (RSSI) values collected from Bluetooth communication devices. Oransiriku et al. measured the bus passenger load by collecting data using WiFi signals [14].

Real-time sensing gains its efficiency from the evolution of sensing capabilities through smartphones, smart vehicles, and Internet of Things (IoT). Smartphone usage was doubled from 2010 to 2014, and expected to double again in 2018 [15].

Smartphones loaded with sensors, and above all available with commuters all the time can be easily utilized in the real-time sensing. Smart vehicles (e.g., Tesla) with all their sensing, and communication capabilities (e.g. Bluetooth) are not far from the market, in 2013 they showed 48% sales increase in California [16], [17].

Bluetooth shows up as an efficient communication protocol that is available in all smart devices. A Bluetooth device can quickly locate others in the vicinity within 3 msec [17]. It is also a low power consumer saving the smart devices? scarce battery power. Moreover, it is estimated to be available in 90% of the vehicles by 2016 [18], [17]. In our work, we investigated both Bluetooth and WiFi sensing to assess the performance of current bus operations, however, we had some difficulties with the Bluetooth especially with large numbers of devices.

Kostakos at al [19] used Bluetooth for the data collection of the end-to-end passenger time using a bus system, however, with huge number of passengers (entering and leaving the bus more frequently: such as in an educational environment), Bluetooth is harder to detect or collect. Furthermore, in this paper, WiFi gave us more accurate data than Bluetooth due to issues of compatibilities with various platforms.



III. SYSTEM DESIGN  This project included several components that were used to scan and analyze the Bluetooth and WiFi data. We used Raspberry Pi 3 Model B equipped with a micro SD card, a 5V/2A portable battery, and a wireless adapter as shown in figure 1.

A. Smart Node  In this work, we created a self contained smart node that scans, parses and sends data to a Cloud Storage. The smart node consists of the following components:  1) Raspberry Pi 2 (on March 2016, we upgraded to Rasp- berry Pi 3) Model B: A compact computational device that can reliably process with low power consumption.

2) WiFi Adapter: The Wireless adapter card was used as a scanning interface by configuring it in monitor mode.

3) 5V/2A Portable Battery: A source of power, soon to be replaced with a solar panel.

4) Range of Coverage: each node covers a range around 7m radius around the smart node, WiFi can range between 5 and 75m [20], [21].

First International Workshop on Mobile and Pervasive Internet of Things'17    Fig. 1. Smart Nodes ready to be deployed at James Madison University  We located each smart node at a fixed location in the bus stations. It is noted that node can be located on the bus itself and use the advantage of Vehicle-to-Infrastructure communication as described later in the future work.

B. Software and Node Setup:  Raspbian Jessie Lite Operating System, used by our smart node, fits our battery and memory constraints while still providing a method for scanning for WiFi MAC (media access control) addresses. By using monitor mode on the wireless adapter, the smart node is capable of sniffing wireless network traffic in the surrounding area of the bus station (with radius of 7m) [20]. Without breaking the privacy of any of our passengers, we use TShark [22], a network protocol analyzer chosen to capture these packets of data including the arrival time, MAC address of device, strength of the WiFi signal, etc.

from various WiFi-enabled devices. The packets of data have useful information that then can be parsed. Once the parsing was completed, it would be exported into a data file, then sent to a Cloud Storage as shown in figure 2.

Data sent to the Cloud Storage consists of time stamps, MAC addresses, and RSSI(s). Using the minimum and maximum waiting times for a specific device in a bus station, we could determine the duration of the waiting time. These MAC addresses data are further filtered by re-matching them with the MAC addresses obtained at the next bus stop to eliminate false positives as discussed later.



IV. RESULTS AND ANALYSIS  After installing smart nodes at two bus stations across James Madison University Campus in Virginia, USA as shown in figure 3, we were able to conduct the following experiments:  A. Experiment 1: Validation at a Single Bus Station:  A smart node was configured for scanning WiFi MAC addresses at a single bus station on the James Madison University campus (Physics/Chemistry stop). This experiment ran for 30 minutes with the purpose to confirm that the scanned data can be validated. The focus was primarily to validate that the Raspberry Pi device was successfully able to scan for  Fig. 2. The network architecture of smart nodes installed at each bus station  Fig. 3. Smart nodes located in the Campus of James Madison University  WiFi signals in the area and store the data. The experiment was successful in finding nearby WiFi signals and the data was saved locally on the smart node. Later, the data was parsed keeping only three fields from the saved files MAC address (MACs), arrival time (Tarr), and strength of signal (RSSI). The parsed results were further analyzed to determine how many devices were found, the number of unique MAC addresses, and the time each device was found as sample (see Table I). A check for our own MAC addresses has been conducted successfully.

Validation was, in part, done by checking the existence of our own MAC addresses. Two specific mobile devices were present all the time of the experiment while two other devices left and came back at the end of the experiment which matches our collected data. In table I MAC addresses were anonymized by replacing the last four digits with ?x??s for privacy concerns.

B. Experiment 2: Emergency Situation test:  The second experiment was conducted during an emergency evacuation, (that happened while preparing for experiment 3), at the ISAT/CS Building at James Madison University. Once  First International Workshop on Mobile and Pervasive Internet of Things'17    TABLE I SAMPLE OF DATA COLLECTED - EXPERIMENT 1  Arrival Time Tarr UTC RSSI Signal MAC Address Feb 26, 2016 02:21:37.352192000 -87 dBm d8:b1:90:5f:xx:xx Feb 26, 2016 02:21:37.376555000 -87 dBm d8:b1:90:5f:xx:xx Feb 26, 2016 02:21:37.410952000 -81 dBm 50:87:89:e2:xx:xx Feb 26, 2016 02:21:37.412705000 -84 dBm ce:f9:20:7f:xx:xx Feb 26, 2016 02:21:37.423344000 -61 dBm c0:ce:cd:ea:xx:xx Feb 26, 2016 02:21:37.441935000 -60 dBm c0:ce:cd:ea:xx:xx Feb 26, 2016 02:21:37.456730000 -82 dBm 50:87:89:c3:xx:xx Feb 26, 2016 02:21:37.457165000 -85 dBm d8:b1:90:5f:xx:xx Feb 26, 2016 02:21:37.481016000 -87 dBm d8:b1:90:5f:xx:xx Feb 26, 2016 02:21:37.505711000 -85 dBm d8:b1:90:5f:xx:xx Feb 26, 2016 02:21:37.524915000 -59 dBm 78:4b:87:bd:xx:xx  the smart node was placed in the designated evacuation area that was crowded with students, visitors, staff and faculty, the scan started for a period of 15 minutes. During this experiment, the ?all-clear? was given by public safety and the crowd began flowing back into the building out of the range of our device.This experiment validated that the smart node can accurately determine the number of devices around it even with a huge number of devices at any given time.

As shown in figure 4, the smart node was able to pick up a high quantity of devices at the start of the experiment, around 900 WiFi signals, then decrease in quantity as students were allowed to leave the evacuation area and move back into the building. The trend for the amount of devices found does follow the expected outcome. The large peak at the end of the experiment were due to the arrival of two buses full with students after public safety opened the road again.

Fig. 4. Experiment 2 (Emergency Situation): Number of Devices Vs Time  C. Experiment 3: Data Validation over Two Bus Stations:  In experiment 3, two smart nodes were located at two adja- cent bus stations: known as JMU-ISAT and JMU-Phys/Chem.

The bus stations are in-line which means a bus would not pass one station without passing the other station. Both smart nodes were started simultaneously. Then, test cases of individuals ride back and forth between these two bus stops for 30 minutes. By having a device with known MAC addresses (i.e., our personal smart phones); we were able to validate our system by searching the generated output files to find our MAC addresses and compare the times that the devices were found by each smart node.

(a) Bus Station: JMU-ISAT  (b) Bus Station: JMU-Phys/Chem Fig. 5. Data Collected at Two Bus Stations.

Figure 5-a shows the number of devices found per minute by the smart node located at the JMU-ISAT bus stop. The graph appears to show that there is noise in the data, which is caused by false positives such as students walking passed by the stop, cars driving by, and WiFi signals coming from inside the building. However, we can see trends such as each one of the high peaks caused by a bus arriving to one of the stations.

Figure 5-b shows the results from smart node located at the JMU-Phys/Chem bus stop. The Phys/Chem bus stop is located close to the entrance of a building that has a large amount of student traffic passing by the bus stop but not actually waiting for a bus which was reflected by the figure 5-b. The peaks are still visible for when the bus arrives at the stop and the peaks occur at similar times in both graphs (with a 2-3 minute gap).

False negatives can also occur, where is the case of students who do not have a cell phone or turned the WiFi off. With the large number of students riding the bus at each station, an approximated estimate can be accepted in this case.

D. Experiment 4: Longer Period of time with Two Bus Sta- tions:  In this experiment, we located the two smart nodes at the JMU-Festival and JMU-ISAT bus stops from 8 AM to 2 : 30 PM (6 12 hours). James Madison University Public Safety Office was informed of the experiment so nobody would  First International Workshop on Mobile and Pervasive Internet of Things'17    mistake the package as a threat. This experiment validated that the battery could power the smart node over a long period of time (less than 25% of the battery life was used) and that the smart node could save a large amount of data. For future work, we plan to power the smart unit using a solar powered battery [23].

Both smart nodes were successfully able to run for 612 hours and stored all the collected data during the experiment. Figure 6-a and 6-b show a trend of traffic pattern where early in the morning, there is low traffic around the bus stations, as the day progresses the number of devices found by the smart nodes increases. At 8 A.M. there are less people on the campus and students only wait for buses to go to class, but as the day goes on more people arrive to campus and the number of students waiting at the bus stops increases. Also, by looking at the frequency and height of the peaks, we can predict how often buses arrive (matches the bus schedule given by JMU on the Spring semester) at the stop and which buses are the most crowded.

(a) Bus Station: JMU-ISAT  (b) Bus Station: JMU-Phys/Chem Fig. 6. Data Collected at Two Bus Stations For Longer Time period.

E. Experiment 5: Cloud Storage:  In this experiment, our two smart nodes were connected to the Internet as to be able to send the data directly to a Cloud Storage rather than storing it locally. The smart nodes were connected to the cellular network via two hotspots. Through  this connection, the smart nodes have access to the Internet, which allowed it to send the parsed data to an Amazon Web Services S3 Cloud Storage. The experiment was successful and moved us to the next stage of our research. For future work, we plan to connect to the WiFi of the university every period of time, upload the data, then return back to the monitoring mode.

F. Experiment 6: Waiting Time Calculation:  In this experiment, we were able to calculate each pas- senger?s (unique device) waiting time, by calculating the difference between the maximum (the last time the device was seen at a specific bus station) and minimum times (the first time the device was seen at the same bus station) and matched at the next bus stop. We assume that each passenger has only one device, which is a normal assumption in this case. Table II shows a sample of the data collected in two bus stations ISAT and Festival, where all MAC addresses are anonymized.

We left one MAC address without anonymization to show an example of a match, where that specific passenger was waiting at Festival bus stop for 3 minutes then at ISAT for 10 seconds; our conclusion is that the student with this MAC address was heading from festival building to the ISAT building using the bus, the student was detected couple of times while leaving the ISAT bus station.

TABLE II SAMPLE OF WAITING TIME IN TWO BUS STATIONS  Festival ISAT Device Waiting Time Device Waiting Time  00:56:cd:00:2a:xx 01:23 00:56:cd:03:0d:xx 00:00 00:9a:cd:5c:2d:89 03:00 00:56:cd:db:b8:xx 00:00 00:cd:fe:7a:56:xx 01:43 00:9a:cd:5c:2d:89 00:10 00:cd:fe:9d:ee:xx 00:04 00:9a:cd:64:ab:xx 01:05 82:42:a4:9f:eb:xx 06:00 02:ee:19:a0:da:xx 07:50 4e:0f:5f:be:be:xx 07:00 14:3e:bf:f6:7c:xx 05:32 a4:5e:60:49:bf:xx 07:00 16:4c:a8:15:10:xx 03:12  Figure 7-a shows the frequency of waiting time in the Festival Bus station while figure 7-b shows the number of matches passengers in each bus station. It appears that the number of matches of unique MAC address is around 10% of the total number of unique addresses captured in each station. There are couple of reasons for this, we summarize it as following:  1) Less than 10% of students who take the bus at the Festival bus station, will leave the bus at the ISAT bus station;  2) Smart nodes are able to capture other types of devices beside smart phones, such as access point (known as routers) MAC addresses;  3) Most of the students are heading to further places, and we conclude that the number of students who left the bus are most probably heading to lunch at the Festival building.

First International Workshop on Mobile and Pervasive Internet of Things'17    (a) Bus Station: JMU-Festival  (b) Total Unique devices (Passengers) Vs (Devices matched in the two stations)  Fig. 7. Calculation of Waiting Time Vs Number of Unique Devices (Passen- gers).



V. CONCLUSIONS AND FUTURE DIRECTIONS  In this work, we proposed scanning for the MAC addresses using IoT devices to estimate the waiting time of passengers at a specific bus station. First, we presented data collection and filtering for several experiments. Then, we showed how to match a specific passenger in two different bus stations.

We were able to send the data to a Cloud Storage. Finally, we used this real data to draw the waiting time in two different bus stations. Future goals are studying power consumption, scalability of the system around the university, handling bus stations with special cases, smart sensing - installing a smart node inside the bus to detect false positives and false negatives (someone passing by and not using the bus or undetected users).

