2010 International Conforence On Computer Design And Appliations (ICCDA 2010)

Abstract:In order to effectively reduces the false negative rate  and false positive rate in attack recognition. This literature  integrate fuzzy association rules to design and implement an  abnormal network intrusion detection system.This system not  only satisfies the requirements for attack recognition  perfectly,but also recognizes the anomaly-based attacks and  the misuse-based attacks simultaneously.Furthermore,it  reduces the false negative rate.

Keywords: fuz7,Y theory; denial of service fuZ7,Y logic; fuZ7,Y  association rules;

I. INTRODUCTION  Network Intrusion Detection System is commonly  classified into host-based intrusion detection system (HIDS)  [I] and network intrusion detection system (NIDS) [2]. Of  course, there are some intrusion detection systems which are  a combination of both, generally referred to as hybrid  intrusion detection System (HIDS). HIDS protects  individual host while NIDS protects the whole network.

And both of them have their advantages and disadvantages.

In this paper, fuzzy association rules are introduced to  design a real-time network intrusion detection system.

Different from [3], it takes a long time to collect packets of  information before making off-line analysis. However, [3]  has its disadvantages. On one hand, the system does not  meet the needs of real-time detection and real-time  processing, which are required in an invasion system. On  the other hand, short-term attack is likely to be diluted  during a long-period flow of packet information and cannot  be detected since it is unable to meet the minimum support.

In addition, because different types of attacks usually  require specific detection methods to achieve excellent  results, the text also differs from [3] in the selection of  signature and the application of fuzzy function. In this paper,  denial-of-service attack serves as an experimental subject.



II. Dos AND DDOS  The so-called DoS(Denial of Service), refers to an    attack that utilizes limited network resources (such as  Memory, Processor and Bandwidth, etc), as well as  loopholes in the design and application of partial network  system software, or other related communication protocol to  make the attacked websites unable to process requests  through substantial and intensive packet transmission. In  this way, many users who try to get normal access to those  websites will be rejected; or the attempt to identifY  loopholes the program has failed to handle will crash the  system so that it will be out of service. DDoS (Distributed  Denial of Service) uses the same method as common denial  of service attacks but there are more triggered attackers.



III. THE ALGORITHM OF Fuzzy ASSOCIATION RULES  We will give an introduction of how to compute the  similar degree among association rules, fuzzy association  rules and rules, which are basic knowledge related to this  paper. Then, specific examples will be given to explain how  to apply the knowledge to the design of network intrusion  detection system ..

A. The Algorithm of Association Rules  Association rules [4] are defined as follows: suppose  1= {ip i2, i3 ,jm } is the set of all items, database D the  set of all transaction record T and T a subset of any item  from I. A set X S;;; I is called itemset, the number of items  which contained is regarded as the length of it. If its length is  k, then it is claimed as k-itemset. If a transaction record  supports an itemset X, it must contain all items of X, X S;;; T,  written as support(X).

The representation form of association rules is X => Y,X,  Y S;;; I and X n y =0. Association rules depend on two  parameters (support and confidence) to judge whether they  are meaningful or not. Support refers to the percentage of X  U Y transaction records in database, written as support (X  U Y), while confidence defines the credibility of such  association rules, that is, the chances that Y will appear when  condition X occurs, written as support (X U Y) 1 support (X).

For valid association rules, their degree of support and  confidence must be equal to or higher than the threshold  level set by the user, which is also the minimum support and  confidence. In general, the widely used algorithm in  association rules is Apriroi algorithm [4]. Apriori algorithm  for mining association rules is divided into two parts:    Phase I: search database and find out frequent itemset or  large item set.

Phase2: use frequent itemset or large itemset to extract all  association rules, whose confidence is lower than the  minimum.

B. The Algorithm of Fuzzy Association Rules  Support (X) in Apriroi algorithm is an item of itemset X  and is calculated according to its record counts in database D.

When used in intrusion detection, each item will appear in  every record, and have a quantization value. Their difference  between them can be learned from record description by  checking database D. Suppose I = (A, B, C, D, E) and there  978-1-4244-7164-5/$26.00  2010 IEEE VI-129 Volume 1  2010 International Conforence On Computer Design And Appliations (ICCDA 2010)  are five records in database D.(a) in table I describes records  in traditional Data Mining and (b) in table I in the network  Intrusion Detection. The first record in (b) in table I indicates  statistical network traffic in certain unit time. And there are  25 packets with signature A, 53 with signature B, 9 with  signature C, 21 with signature D and 12 with signature E.

The network information flow in next unit time will be  described by the second record, and so on. Unit time can be  determined by network traffic but we must take into account  the processing time to ensure the instantaneity. However, the  traditional Apriori algorithm doesn't apply to quantitative  database. In the field of data detection, many solutions on the  problem of item quantification have been proposed. In this  paper, fuzzy Logic is adopted to mine such quantitative  database and the association rules mined is called Fuzzy  Association Rules.

For quantitative data, one of the most straightforward  ways is to grade value for each item clearly. In item A, we  set value below 20 is Low, value between 21 ? 60 Medium,  value above 61 High; In item B, we set value below 100 Low,  value between 101 ? 300 Medium, value above 301 High,  and so is with C, D, E. The database in (b) in tableI and  table! is described as follows:  A=Medium, B=Low, C=x, D=x, E=x  A=Low, B=Low, C=x, D=x, E=x  A=Low, B=High, C=x, D=x, E=x  A=High, B=Low, C=x, D=x, E=x  A=Medium, B=Medium, C=x, D=x, E=x    TABLE!. FOR DATA MINING  # Record  I A,B,D  2 B,C,E  3 A,C  4 D,E  5 B,D,E  TABLE II. FOR NETWORK INTRUSION DETECTION  # Record  I A-25,B-53,C-9,D-21,E-12  2 A-I,B-35,C-7,D-31,E-7  3 A=6,B=345,C=91,D=41,E=32  4 A-61,B-85,C-15,D-22,E-33  5 A-31,B-277,C-34,D-81  With x E (Low, Medium, High), the traditional Apriroi  algorithm is more applicable, but there is a Sharp Boundary  Problem in such a clear manner of grading. In (a) Of table I,  for example, the occurrence counts of A = Medium can only  be calculated by accumulating records in the database, such  as A = 21, A = 22, ... , A = 60. Although there are a great deal  of such records as A = 18, 19 or 61, 62, they contribute little  to the counts of A = Medium. Obviously, it is possible that  the association rules mined though this method will fail to  describe the real situation. Let' suppose the interval of A =  Medium extends to 19 on the left or 61 on the right, then the  association rules mined may be completely different.

To solve Sharp Boundary Problem, the concept of Fuzzy  Logic is introduced in [6]. In accordance with Fuzzy Logic,  each item is renamed Fuzzy Variable and each category  Fuzzy Sets, such as Low, Medium and High. The difference  lies in the fact that Fuzzy Sets (Low, Medium and High) is  no longer clearly graded, but individually described by a  continuous function, which is called Membership Function,  such as (b) of table I. Therefore, with record item y E (A, B,  C, D, E), it may also belong to more than one Fuzzy Set, but  usually must be accompanied by y being part of weighted  values(grade) of each set. Taking (b) of table I for example,  there is one record A = 20, B = ... , which belongs to A =  Low (0.5), A = Medium (0.95) and A = High (0). The value  in parentheses is 20 and that is the weighted value when  respectively incorporated into Membership Function (A.

Low, A. Medium and A. High). In [6], Significance and    Certainty are introduced to replace the degree of support and  confidence in traditional Apriori algorithm.

record Low Medium  (a)  (b)  High  A  Figure I. Adopting the Difference between Discrete Split  and Fuzzy Logic  Here we regard <F,S> as an itemset, where F is the  sequence of signature(or item), S the counterpart of F in  Fuzzy Set, J; the ith signature and FS,O the corresponding  M b h F . . h '  (1 < i < I I h I h em ers Ip unctIOn III t e Itemset - - , IS t e engt  of item set). For example, if A = Low, B = High and C = Low,  then F = (A, B, C), S = (Low, High, Low), .t;,.J,.J'represents  A, B, C and FS, 0, FS2 ,FS, o represents A. Low ( ), B. High 0,  and C. Low 0 respectively. The item set with a length of I  may be represented by Sig(Fs), which can be formally defined  as follows:  L CFS,(vlaueof[,)  Sig(F.S) recorde.DI..,'\ IDI (1)  As long as Sig(Fs)? mini _significan:e, it is a large-item.

When all large-item of different lengths are found out, Fuzzy  Association Rules will be generated, with all Certainty ?

Vl-130 Volume 1   mini-certainty. The calculation of Certainty can be defined  like this: suppose <F, S> is the large-item that produces  Fuzzy Association Rules, and it is the presupposed itemset of  such rules( conditional narration), then certainty of Fuzzy  Association Rules can be defined as follows:  Sig(FS) Cer.. =--(F.s ).(F.S) Sig.. (F S )  I  L n FSi(vlaue cl item Ii)  record e D i=l  k  L n FS j (vlalle cl item Ij)  record e D j=l (2)  I is the length of <F, S> and k is the length of <F I ,  S I >. The Certainty of each rule can be calculated by Sig(FS) /  Sig(FS). All the rules with certainty :::: mini-certainty will be  kept and the rest removed.

C. Computation of Similar Degree  Let's first introduce the computation of similar degree  between two fuzzy association rules and later between two  sets of fuzzy association rules. Suppose rl and r2 are two  fuzzy association rules, sl and c1 represent Significance and  Certainty of rI, and s2 and c2 represent Significance and  Certainty of r2. Then the similar degree between s rI and r2  is calculated as:  I? 1??? sim(rl r2)" ?I-c? ?1-s21 , max(o, I-max(---, ..r.:.....:::L f r 1 "r2 II13X{c I, e2) max(s? s2)  (3)  The so-called r 1 =r2 indicates that it is the same between  antecedent and consequent of two conditional narrations. In  other words, different rules can't be compared and their  similar degree is zero; only similar degree of the same rules  can be computed by the above formula As to two sets of  fuzzy association rules, suppose their similar degree are sO  and sl respectively, the computation for will be like:  S '1 . "(SO SI)  Score Score Iml arlt>'. , =--x--  I SOl I SII  Score = Lsim(rO,rl)  Where ???:f?

ISil represents the number of rules, i=O,1 (4)

IV. SYSTEM FLOW  Although [3] are based on fuzzy association rules to  study intrusion detection, they do not apply this method to  real-time detection system. In other words, it takes them a  long time to collect packet information before making omine  analysis of whether such packet flow is abnormal or not.

However, it is unable to make instantaneous response though  this method. What's worse, if the attack time is very short,  the number with attacking signature will fail to reach  minimum support and be ignored in such long-time packet  flow. In addition, it doesn't mention in [3] how signature is  produced. Through carrying out 150 automatically collected  Dos attacks, checking possible signatures and sorting them  according to the value of Information Gain, signatures in this  paper refer to the first twelve ones with high Gain value,  under the premise of considering a system with  instantaneous ability. Last, based on identifYing the source  address and fixing communication port, this system can  dynamically alter the filtering rules of the firewall (Linux' s    iptable).

Since this system regards fuzzy association rules detected  by packet flow information as its basis for judgment and  packet flow may affect setup of certain parameters, it is  suggested that the simulating tests and the actual tests should  be in the same position of the whole network topology to  receive better detection results. When doing simulating tests,  we collect packets in a specific position of network topology  for three hours and make sure if there are DoSIDDoS attacks  before simulating set of fuzzy association rules for  comparison. The concrete steps are as follows: gathering  packet traffic statistics once per unit time(2 seconds),  calculating twelve required signature values and forming the  fi d f 5400 . I '  r 0 :!> i :!> 5399    h Irst recor 0 III tota , wrItten as ' ( I IS t e  serial number of record). In the end, we need only 3 records.

Then we try to average the total sum of records with the  same remainder when 3 is divided by the serial number and  the three averaged records will better display the state of  network traffic in a certain period. Last, the three records is  used to figure out a set of fuzzy association rules for  matching. Particularly,network traffic condition differs  greatly in different period. In order to get better detection  results and reduce false positive rate, fuzzy association rules  for individual matching is required in the experiments,  aiming at different periods, such as morning, noon, afternoon,  evening and night.

In practical tests, a record is also formed by twelve  signature values of packet traffic statistics gathered once per  unit time (2 seconds). After a set of fuzzy association rules is  worked out by three accumulated records, we compute the  similar degree between it and the rules produced in  experimental periods. If the similar degree is lower than  threshold, it is decided that there are attacks. Once attacks  occur, this system cannot automatically update the firewall to  block connection unless source of such attacks have been  traced.

Network attacks vary a lot. A complete intrusion  detection system is usually constituted by a number of  detection modules, each of which is responsible for detecting  certain type of attacks. On the other hand, given to  considerations of instantaneity, more than one detection  module will be more convenient for parallel processing. Any    intelligent judgment depends upon the selection of signature,  but different signatures are required to effectively detect  different types of attacks. This system mainly aims at  DoSIDDoS. Based on Information Gain values, the selected  12 signatures are arrayed in descending order as follows:  O. number of different payload length  1. number of different source IP address  2. number of different destination IP address  3. number of different TCP source port  4. number of different TCP destination port  5. number of different UDP source port  VI-Bl Volume 1   6. number of different UDP destination port  7. number of TCP protocol  8. number of UDP protocol  9. number of ICMP protocol  10. number of SYN flags

II. number of ACK flags  ?omiscuo --+ __ --.I  us Mode) +'  ? capture &  feature statistics ) +'  rvfining Fuzzy+'  Association Rules+'  Normal network behavior+'  No+'  Abnormal+'  ?

behavior+'  Cal culate the  value of grades+'  Figure 2. System Flow chart  Each signature has three Fuzzy Sets: Low, Medium and High.

Membership Function in use is taken from Default Function  of MATLAB Fuzzy Tool Box (as follows), of which a, b,  and c can be adjusted into constants. Figure. 3 is the instance  of Membership Function. Constants of a and c in Low are  0.3 and 30; constants of a, b and c in Medium IS, 2, 50;  constants of a and c in High -0.3 and 80.

Low: f ( x ) = I/ (I+exp( a ( x - c) ) )  Medium: f (  x )  = I I ( I + 1 ( x  - c) I a I" 2b )    High: f ( x ) = I/ (I+exp( -a ( x - c) ) )  In experiments, we adjust the coefficient so that the  signature attains more significance by making Information  Gain value higher and Overlay Memory wider. However,  since not all signature statistics applies to the same Fuzzy  Membership Function, many testing experiments are  required to fine-tune each Membership Function to  appropriate values and grade of individual Membership  Function must be calculated in each signature. There are 12  signatures in one record and each signature have to calculate  its grades in three different Membership Function. In other  words, every record has 36 items, such as ill.low, ill.medium,  ill.high, . . .  , fll.low,fll.medium, fll.high,so it may mine  numerous rules in 3 records.

gmde  .,  .?

Figure 3.

Feature  value  Low, Medium, and High in Membership Function

V. THE ANAL YSIS O F  EXPERIMENTAL RESULTS  The setup of system parameters differs as its operating  environment changes, because we need to take into account  in experiments which period is more accurate. Namely, the  morning detection rules is best used for network intrusion  detection merely in the morning as sometimes great changes  takes place in network traffic condition in different periods  of a day. This experiment is based on two buildings of  students' dormitory and performed in the night. Of the ISO  collected DoS attacking software, 100 is used in experiments  to search the above-mentioned 12 signatures (higher  Information Gain) and the rest 50 serves as testing subjects.

In order to test the detection results of this system, we have  selected three types of attacking (i.e. SYN Flood, Ping of  Death and Smurf) to do experiments. In the experiment, we  set 2seconds as an unit time and perform mining (a judgment)  once every three unit time, so a unit in the horizontal axis of  Figure.5 and Figure. 4 represents 6 seconds. During the  experiment, Fuzzy Association Rules is produced by a long  period accumulating of packets, averaging three records and  incorporating them into algorithms of fuzzy association rules.

Through long-time collecting and averaging, normal  conditions can be better reflected, but it have to take us more  time to identitY whether these packets contain DoS attacks.

The bar graph value in Figure. 4 indicates the similar  degree between fuzzy association rules and detection rules of  real-time packet information. If the similar degree is lower  than 0.1(10%), it is regarded as attacks. (a) of Figure. 4shows  the experimental results when the school uses DoS  Smurf(lGMPNUKE VI_O) at night. At the first two time  points, we perform normal network behavior, but at the later  stage of the third time point, we start attacking procedures  and keep attacking, from which it is found that the rules  detected during following time points carry low similar  degree with fuzzy association rules. The detection results in  (b) and (c) of Figure.4 show Ping of Death attacks  (TosserV2.1). In (b) of Figure. 4, Tosser attacks are suffered  continuously at time points of 6, 7, 8 and 9 and it is obvious  that they are different from normal network behavior.

(d) in Figure. 4shows the situation we detect the school  by SYN Flooderv3.0 when they are attacked by SYN Flood.

VI-132 Volume I   From (d) of Figure. 4, it is observed that attacks occur at time  points of 1, 4, 6, 7, 10, 11 and 12.

Since DoS features massive packets in a moment, we use  multiple computers at the same time to download through  FTP large amounts of data to verifY if our system will make  false positives. In Figure. 5, although it indicates clear  decline after the second time intervals, there is still some  :t_  0.8 0.7 0.6 0.5 0.4 0.3 0.2  ,...

o  ?iiii  0.8 0.7 0.6 0.5 0.4 0.3 0.2  li +---.--,.--.-----,r--{ 0.6 '..    /  1 2 3 4 5 6 7 8 9"'"  (a)Smart (b)Ping of Death(school)  ?l i?.llor; 0.9 0.8 ?????????? 0.8 0.7 0.7 0.6 8:?

g? ?3aa .. ti?j??ti" t 0.3 0.3 0.2 . 0.2 0li +--,-_,.---.----,_-{ o. . If If If If  If If If If If / ...

1 2 3 4 5 6 7 8 9 101112""  (c) Ping of Death(dormitory) (d)SYN flood(school)  Figure 4. (a)-(e) Different Types of Attacks    way from 10%, the threshold. Finally, we execute the 50  attacking procedures thoroughly and their similar degrees are  shown in Figure. 6. In Figure. 6, each value is the average of  ten times, once each day, ten days in total. With every  similar degree lower than 10%, it suggests that the twelve  signatures selected by sorting Information Gain values and  the selecting mode of coefficients in Membership Function  can immediately detect DoslDDoS attacks in the design of  our real-time network intrusion detection system.

Last, we emphasize that measurement of similar degree is  greatly affected by network traffic. If network packet  information changes frequently, then the measured value will  fluctuate in a larger section. Besides, the similar degree is  also influenced by density or duration of the attacking.

1 _--------  0.9 ========  0.8 EfiI'IIlO.'-  0.' ________ _  "0.5 ---------  0.4 -------  lto.3 -------  0.2 ---------  o.?

3 4 5 6 "'" 14 'wum?unnnMD?u.g  Figure 5. Mass Transmission Figure 6. The Computed Value of  of Normal FTP and Similar Similar Degree in Different Dos  Degree Measured in Different Places Attacks

VI. THE CONCLUSION AND FUTURE RESEARCH  This paper mainly contributes to the design of a real-time  network intrusion detection system based on Fuzzy  Association Rules. Though we take only three units of time  to detect information traffic, there are 36 actual items in each  record and three records can detect out many rules since 12  signatures are adopted in each record and each signature  value can be incorporated into three fuzzy Membership  Functions. By comparing similar degree with experimental  rules, if they are lower than 0.1(10%), the system will regard  them as attacking events. According to experimental results,  it is found that our system can make correct judgment and  won't cause false positives towards massive FTP packets in a  moment after appropriate adjustment of system parameters.

In the following few days, our work should focus on    improving the efficiency of detecting procedures, including  cutting unit time from the present two seconds to one second;  redefining the calculating mode of similar degree; adjusting  the coefficients of fuzzy function by Genetic Algorithm;  attempting to detect based on Incremental transaction  database instead of three transaction records. In the detection  of incremental transaction database, we expect only one  more accurate detection is performed in each unit time  because both the present and the past information of the  record will be detected.

