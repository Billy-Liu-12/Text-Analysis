Two Satellites Positioning Algorithm Based on

Abstract?Assisted Global Positioning System (AGPS)  structure is used and Marquardt algorithm with additional  earth ellipsoid equation is put forward in order to position and  improve the positioning accuracy when only two satellites are  captured intermittently in weak signal condition for global  positioning system (GPS). AGPS provides auxiliary positioning  data through General Packet Radio Service (GPRS) network.

Positioning can be achieved when two satellites signals are  captured twice between a short time. The big errors caused in  solving the singular equation groups with Gauss-Newton  algorithm can be remove by using Marquardt algorithm. In  this algorithm, growth factor is used and adaptively adjusts the  step according to the change of objective function. Compared  to Gauss-Newton algorithm, the mean positioning bias  decreases from about 500m to about 120m and there is less  than 1.5 times computation increasing in Marquardt algorithm.

Keywords- navigation principle; assisted Global positioning  system; positioning algorithm; positioning accuracy;  computation

I. INTRODUCTION  In 1994, The Federal Aviation Agency (FAA) declared Global positioning system (GPS) ready for aviation use. It can provide positioning, velocity and timing service for arbitrary multi-user in Ref. [1] and was successfully applied in many subjects, such as navigation, meteorological monitoring, lithosphere monitoring, resources survey, geodynamics and agriculture in Ref. [2]. Its application is continuously enlarging along the endless improvement of the system and the perfection of software and hardware.

To get the location, traditional positioning algorithm needs to observe four or more satellites' signals in Ref. [3] and Ref. [4]. The data information needs to be received besides satellite synchronous signal. This causes that time to first fix (TTFF) is long which is more than 2~3 minutes and the location can?t be solved if satellite signal can?t be captured continuously so that the full satellite data to position can?t be achieved in this period. Currently, mobile station (MS) is no-full-sky view in many circumstances and location can?t be solved with measured satellites. The phenomenon to capture two satellites in short time often appears. This causes 1) the full data information to calculate  satellite location isn?t obtained, 2) two equations are constituted with measured data and MS? three dimensional coordinates can?t be solved. Reference [4] researched that at least one satellite signal was captured so that the clock bias was same in two measurements, otherwise it is impossible to position.

This paper researched two satellite positioning algorithm when MS only captured two satellites? signal in short time.

The positioning structure was chosen according to that circumstance. Then the solving equation group was constituted with earth ellipsoid equation according to two satellite signal synchronized and MS location was solved with Marquardt algorithm. Finally, the positioning result was analyzed.



II. AGPS SYSTEM  Continuous positioning and tracking can be realized when the received satellites is enough in current positioning system. New positioning structure process, which is called the AGPS structure proposed, are designed to guarantee the positioning function and to overcome the above-mentioned problems, such as continuously receiving and long TTFF, as shown in Figure 1. Satellites signals are captured by both serving mobile location center (SMLC) and Mobile Station (MS). Information transmits through wireless network in the system so that no new communication environment is needed to constitute. Data communication is transmitted by using general packet radio service (GPRS) between SMLC and MS. The auxiliary data is packed and transmitted on secure user plane location (SUPL) and radio resource location protocol (RRLP) in Ref. [5] and Ref. [6]. SMLC provides the auxiliary data which could speed up the capture of satellites signals and the corresponding ephemeris data for AGPS positioning. In a single location, the position request is sent from the receiver to the main control server in order to speed up the capture of satellites signals and to reduce the positioning time, so that a-few-minutes? waiting-time is no longer needed. In a continuous location of weak signal condition where satellites signals can?t be received continuously, the receiver could receive the ephemeris data from SMLC instead of the satellites to achieve positioning.

2. RRLP(Measure Position Request)  3. RRLP(Protocol Error)  4. PPLP(Measure Position Response)  4. RRLP(Measure Position Reponse)  SMLC MS  1. Assistance Data Delivery Procedure  Figure 1. Position measurement procedure  The satellite signal should be very weak when only two satellites? signal is received in MS location. AGPS system aids to capture satellite signal and to provide auxiliary data to quicken the speed of capture. Satellite signal is captured by MS only in two moments of a certain time lag and MS needn?t receive ephemeris. This can realize positioning.



III. MARQUARDT POSITIONING ALGORITHM  Two equations could be set out according to satellite  coordinate ( , , )i i iS S Sx y ziS  calculated by satellite ephemeris  and MS coordinate ( , , )x y zR . Two measures and earth  ellipse equation constitute five equations    2 2 2  5 2 2 2  ( ) || || ( 1,2)  ( ) || || ( 3,4)  ( ) 1 ( ) ( ) ( )  i  i  i  i  f t r i  f t r i  x y z f  a h a h b h  i  i  X S R  X S R  X  i Where  i i i i  svr Q t I P ,  is the pseudo-  range to the ith satellite, ,  and  respectively clock  bias in MS and in satellite,  iQ  1t 2t i  SVt i iI P  respectively the bias  in ionosphere and troposphere, h  the height of MS. There  are five unknowns 1 2( , , , , ) Tx y z tX t  in the approximation  above, the three components of MS location ( , , )x y zR  and  the ranges , derived from MS clock bias. 1t 2t  The objective function could be derived from above formula    ( ) ( )i i  F fX X  The location was solved traditionally with Gauss-Newton [7]. However, Marquardt algorithm [8] was adopted in this research.

The steps of positioning algorithm are as following.

1. The initial location (1) (1) (1) (1) (1) (1)  1 2, , , ,x y z t tX  is  base station (BS) coordinate 0 0 0( , , )x y zR  and clock  bias is zero. The initial parameter is ,  increasing factor  1 0  1 and permissible error 0 .

Calculate , in which (1)(F X ) 1 1k .

2. Set / , then calculate  ( ) ( ) ( )  1 5( ( ), , ( )) k k kf fLf X X T  ( ) ( ) ( ) ( ) ( )  1 1 1 1 1  1 2  ( ) ( ) ( ) ( ) ( )  5 5 5 5 5  1 2  ( ) ( ) ( ) ( ) ( )  ( ) ( ) ( ) ( ) ( )  k k k k k  k k k k k  f f f f f  x y z t t  f f f f f  x y z t t  M k  X X X X X   A  X X X X X   3. Solve equation  ( ) ( )( )T kk k k T k  A A I d A f  Obtain the direction , let ( )k  d  ( 1) ( ) ( )k k X X d  k  )4. Calculate . If  then  go to step 6, otherwise to step 5.

( 1)( )kF X ( 1) ( )( ) (k kF FX X  5. If ( )T k  kA f , then stop calculating and achieve  solution ( 1)k  X X . Otherwise, set   and go  to step 3.

6. If ( )T k  kA f , then  stop calculating and achieve  solution ( 1)k  X X . Otherwise, set 1k k  and go to step 2.

The parameter values in the solving were 1 0.1  10 0.1.



IV. POSITIONING ALGORITHM PERFORMANCE  A. Theory analysis  The direction  was solved with formula ( )kd (7) in Gauss-  Newton,     ( ) ( )T k T  k k k  kA A d A f  Two equations have strong relativity which are obtained from same satellite in a short period when location is solved with two satellites, so that this makes equation group ill [9].

The bias of ionosphere, troposphere and satellite clock bias  will cause the small bias of kf . The bias of ephemeris will  do the small bias of kA [10]. This will cause large error in ill  equation group. So Marquardt algorithm shown in formula (8) was adopted.

( ) ( )( )T kk k k k T kA A I d A f  k  is a positive real number.  is Gauss-Newton  direction when  and inverse  ( )k d  0k 1( )Tk k kA A I  depends on k I  so that  closes to the steepest descent  direction of  in point  ( )k d  ( )F X kX  when k  is sufficiently  large. When , the direction  determined by  formula  (0, )k ( )k  d  (8) is between Gauss-Newton direction and steepest  descent. Therefore, k  value is too small not to ensure  to be descent direction and  ( )k d  k is too large to slow  convergence speed. The choice of k  will consider both  descent direction and convergence speed. In this research,  fluctuant k  method is adopted in step 2 and step 5 in which  the change of k  depends on the descent of  until ( )( kF X )  ( )T k  kA f .

B. Positioning accuracy analysis  The positioning device is designed independently and innovatively with SIM508 chip of SiRF company. The auxiliary data is provided by SiRF company. The average value of positioning result with NovAtel high performance receiver is 39.959103? latitude, 116.352853? longitude and 56.23 m height. They are taken as the reference value of real location. According to the real height, eleven height values were chosen which is respectively -44m, 16, 36, 46, 51, 56, 61, 66, 76, 96 and 156m. These heights are about 0m, 5, 10, 20, 40, 100m from the real height. The bias statistics tables of 300 positioning results are list in TABLE I.  and TABLE

II. in which respectively adopted Gauss-Newton algorithm and Marquardt and the interval is 2 min in two measures.

It is concluded from TABLE I.  and TABLE II. that the positioning accuracy with Marquardt algorithm has large increase compared with that with Gauss-Newton. When initial height is close to real height, the positioning bias decreased to about 120m from about 500m and positioning bias cut-off 90% decreased to about 300m from about 1300m.

Because the positioning statistics result with height above real height is basically the same with height below the height, the mean bias of time interval measured as 2min, 4,6,8min  are list in Figure 2. and Figure 3. only when heights are respectively 56m, 76, 96 and 156m.

TABLE I. BIAS STATISTICS TABLE WITH GAUSS-NEWTON ALGORITH/M  H/m 90% 80% 70% 60% 50% mean  -44            1305.26  1274.25  1279.76  1301.80  1304.35  1308.10  1314.19  1318.35  1326.59  1334.00  1394.83  841.46  827.43  799.28  798.31  802.88  805.94  804.12  810.82  822.34  840.15  941.79  566.96  568.89  583.48  576.50  569.78  580.64  591.48  590.13  591.21  601.51  643.06  460.11  405.30  394.51  398.42  393.33  399.55  397.07  399.19  398.70  405.01  414.26  326.79  298.37  299.47  288.30  283.60  288.28  280.21  280.16  276.11  276.84  309.28  539.46  502.20  495.78  494.31  493.95  493.84  494.04  494.58  496.01  500.36  529.42  TABLE II. BIAS STATISTICS TABLE WITH MARQUARDT ALGORITHM/M  H/m 90% 80% 70% 60% 50% mean  -44            302.19  228.61  214.88  222.47  223.53  186.54  202.11  224.62  224.51  238.51  242.25  250.95  190.94  175.10  177.60  178.53  160.57  178.01  178.61  178.08  193.97  195.83  210.62  162.81  146.58  150.45  152.91  146.59  155.75  153.48  154.29  161.60  164.25  172.38  140.52  130.49  131.99  133.77  123.30  131.09  134.09  133.30  138.75  138.64  142.42  121.82  112.82  115.11  114.20  108.34  113.84  113.57  112.52  117.57  118.28  157.11  126.76  119.00  118.91  119.25  110.79  116.90  118.91  119.00  128.31  128.58  As are shown in Figure 2. and Figure 3. , measured time interval is shorter and the improvement of positioning accuracy is larger. When the interval is 2min, two previous equations constituted by two satellites have large relativity to behind two equations by the same two satellites so this causes equation group ill. In this circumstance, the validity of solving ill equation group with Marquardt algorithm had shown in which positioning accuracy had large improvement.

2 4 6 8    height: 56m  m ea  n bi  as /m Gauss-Newton  Marquardt  2 4 6 8    height: 76m  interval time min  m ea  n/ m  Gauss-Newton Marquardt  Figure 2. The positioning mean bias of different measurement interval  when height as 56m and 76m  2 4 6 8    height: 96m  m e  a n  b ia  s/ m Gauss-Newton  Marquardt  2 4 6 8    height: 156m  interval time/min  m e  an b  ia s/  m Gauss-Newton Marquardt  Figure 3. The positioning mean bias of different measurement interval  when height as 96m and 156m  C. Algorithm computation analysis  Compared Marquardt algorithm with Gauss-Newton one,  the calculating process of variable factor k  and the additive  process in formula (5) were introduced. However, this calculation is very little in all solution so that it is negligible.

Therefore the computation depended on the iterative times of algorithm chosen. The mean iterative times were shown in TABLE III. when the time interval of two measures was 2min and the height was chosen as different value.

As can be seen from TABLE III. , the computation of Gauss-Newton algorithm is same and the computation of Marquardt algorithm is little different which increases less than 1.5 times in contrast with Gauss-Newton algorithm.

TABLE III. THE MEAN ITERATIVE TIMES OF POSITIONING ALGORITHM  algorithm 56m 76m 96m 156m  Gauss-Newton  Marquardt  computation ratio  2.000  2.783  1.392  2.000  2.877  1.439  2.000  2.690  1.345  2.000  2.810  1.405

V. CONCLUSION  We can see from positioning result and analysis that the positioning result with Marquardt algorithm is far more accurate than with Gauss-Newton algorithm when two measurements are processed in short time and only two satellites can be measured in every measurement. The largest mean positioning bias is about 120m. It is difficult that receiver directly receives data transmitted by satellites when two satellites are observed every time and the satellites? signal is very weak in no-full-sky view. In this circumstances, AGPS positioning method is adopted in which auxiliary data can be achieved from server and enhance receiver capturing ability to satellite signal to quicken capturing speed. Link earth ellipse equation to constitute equation group and solve location with Marquardt algorithm. This improves positioning accuracy at large extent. The positioning accuracy could meet the function to inquiry service based location so that improve GPS positioning function.

