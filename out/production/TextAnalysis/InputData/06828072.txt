

One-Stop:  A Novel Hybrid Model for Intrusion Detection System  Bilal Maqbool Beigh Department of Computer Science  University of Kashmir Srinagar, India  bilal.beigh@gmail.com    Abstract-Organizations are paying huge amount only for the sake of securing their confidential data from attackers or intruders. But the hackers are Big Bosses and are very sharp enough to crack the security of the organization. Therefore before they made security breach, let us hunt down them and make the alert for organization, so that they can save their confidential data. For the above mentioned purpose, Intrusion detection system came into existence. But the current systems are not capable enough to detect all the attacks coming towards them. In order to fix the problem of detecting novel attacks and reducing number of false alarm, here in this paper, we have proposed a hybrid model for intrusion detection system, which have enhanced quality of detecting the unknown attack via anomaly based detection and also have module which will try to reduce the number of false alarm generated by the system.

Keywords -Intrusion, detection, integrity, confidentiality, availability, information, attack, mitigate.



I.  INTRODUCTION As we know that the current world?s maximum transactions  are done in digital format thus increases the digital data after every nano second. Thus make an opportunity for attacker to attack more and more on that data. According to a well removed agency of security namely CERT, the number of attacks that happens on the digital data triples in number every year thus makes it very difficult of any organization or individual to detect all these attacks [1][2]. In view of the above reason, it now became a prime job for researchers to maintain the data?s confidentially, integrity and availability in every aspect whether the information/ data is critical to an organization or not. Every organization has critical data eg.

Policies, new upcoming schemes, record of ammunition, military data, national security etc and having enemy at the gates which wants their data. Thus needs a mechanism to protect the confidentiality, integrity and availability of valuable data. The mechanism which provides these characteristics is known as intrusion Detection system. Up   to this stage of research, intrusion detection system can be classified mainly in two categories as: [3][4]  1. Anomaly Based Intrusion Detection 2. Mis-Use Based Intrusion Detection.

The attack mechanisms defined above  if run independently will detect only certain types of attacks i.e rule based will only detect known attacks while as anomaly will check  from  behaviour weather attack exists or not.  Thus are not fully efficient to detect all kind of attacks. Also these systems will make false alarm [23]. In order to mitigate the above mentioned problems, we have proposed a hybrid model which combines the implementation of both the techniques plus some additional features which will boost the detection (positive true) of the attacks made to a system / Network. We have given the name of call this system as One-stop i.e. which detects all the attacks under single roof. Therefore involves hybrid approach to filter the streams for intrusion detection. This paper consists of five sections. Section I is the introduction to the current topic as well as problems, section II will elaborate the architecture of both the techniques i.e anomaly and rule based intrusion detection system. Section III will discuss the proposed hybrid architecture in detail with working of each part and Section IV  will provides some merits of One-Stop and finally last section will enlighten the core theme of One- Stop and its future insight.



II. ANOMALY BASED INTRUSION DETECTION TECHNIQUE Attackers are very smart, genius people. They often program such kind of vulnerabilities whose signature will not be available easily. They know how to beat the IDS by crafting new exploits, thus it became very much important to block or detect these attacks. [3][1] The mechanism known as Anomaly detection can be used for this purpose. Anomaly based detection technique uses profile matching mechanism i.e normal behaviour and abnormal behaviour. Anything that is deviated from baseline of ?NORMAL? will be treated as anomaly. Normal behaviour can be feeded into the system based on offline learning and research and the online learning while processing the network traffic. This technique consists of two phases Training phase and testing phase. In training phase the normal traffic profile are defined while as in testing phase the learned profiles are applied to new data.

A. Architecture of Anomaly Based Intrusion Detection System   The architecture of anomaly based detection is based on three important steps:  1. Pre-processing.

2. Profiling 3. Detection.

Among the important steps if 1 and 2 have some done something wrong it will affect detection process. Example, if the data is pre-processed wrongly, accordingly its profiling will get affected. so need to be very careful while transformation.

The General architecture of Anomaly based intrusion detection system is give as below:      Fig. 1:  Architecture of Anomaly based intrusion detection  In the architecture depicted above, there are certain blocks which consist of many sub-blocks inside. We will discuss the functionality of each block in detail present in general architecture of the Anomaly based detection techniques. The functionality of blocks is as:  Read Data: It read the raw data/ packets coming towards the network or from TCP dump provided by DARPA (1998 or 1999). The main aim of this module is to capture the raw data in some pattern which will be uniform. I.e the string should start with tcp/ip or udp etc.

Decode: The aim of this block is to decode the incoming packet or data into the standard format on which detection can be made possible. The decoding is very important, because if a normal is decoded wrongly, it may lead to generate a false alarm. Thus it became very much important for developer to take care of decoding module while programming the same.[5][6]  Pre-Processing: After converting the input raw data into some format, the next phase is to organize the data achieved from decoding phase into some structured format or pattern. Once the data is formatted in strict structure defined, it may be further broken down into classification which will totally depend up one schema used. Also in this phase, the data is concatenated and assembled in a pre-defined detection template [8][9].

Detection Engine: Up to this level, all is set to detect the anomaly. Here in this phase, the string or structure that we achieved from previous  phase will be matched with the pre-defined profile using some matching algorithm. If the string deviates from the base-line drawn for normal behaviour stored in the trained profile database, then string is said to anomaly or if it doesn?t deviate, the traffic may be treated as normal.

B.  Drawbacks of Using Anomaly-Based Detection Alone   Since every anomaly may not be intrusion, for the same reasons, the security professionals need some additional resources to crosscheck the attack/ intrusion is genuine or not.

The main issues while using anomaly based intrusion detection system are as [24] :  ? As we know that Anomaly-based IDS are generating large number of false alarms [25].

? Due to abstraction used in profiling the intrusion generated may not contain enough information for developers or security professionals to develop the counter measures for the same in well-defined time [25].

? It takes longer time to analyze the normal behaviors of an activity than rule based detection system [25].



III. SIGNITURE BASED INTRUSION DETECTION TECHNIQUE   This technique is based on pre-defined set of rules. These rules are made by looking on some specific patterns which they got from incoming packets or command sequences. The attacks which are known and whose signatures are in the database can only detect the attacks coming towards the network or system.

Thus there is no such mechanism available which can detect the novel attacks coming towards the network or system.[7]   A. Architecture of Signiture Based Intrusion Detection system  The general architecture of Signature based intrusion detection system is as under:                     Fig. 2:  Signature Based Intrusion Detection System  Read Data  Read Data and Preprocess  Detection Engine Profile Database  Alarm  If matched  Read data  Decoding and Preprocessing  Detection Engine  Alert  Signature Database  If found      The Architecture depicted in figure II has same processing up to detection phase, but in detection instead of using detecting anomaly, we use the pattern matching mechanism. If the pattern matches in the signature data base, then it is an intrusion if not matched, then it is not intrusion.[11][12].



IV. PROPOSED HYBRID MODEL As we discussed in our last section that there are certain drawbacks in both the detection techniques, i.e huge number of false alarms, detection of only known attacks etc. In order to deal/ mitigate/solve the above mentioned problems, we have proposed a hybrid model called One-Stop, which combines the properties of both anomaly detection techniques and signature based plus have been added with some more blocks which will result in reduction of false alarm generated by anomaly detection methods and add new rules to the signature detection method. The Architecture of proposed model is show in figure III.  The proposed model consists of many modules and we have elaborated all the modules except Known anomaly database and Rule Generation module. Here in this section, we will elaborate only the new sections attached to the model.

Known Anomaly Database: This is a simple database table having all the parameters as columns which are used for profile matching, here whenever we know the incoming string / data is not an anomaly, but the system returns it as an anomaly, we will have to manually insert the detected string in current database in pre-defined format.

TABLE I:  FORMAT FOR KNOWN ANOMALY DATABASE  IP Source  IP Dest  Protocol Msg content port Anomaly type     Rule Generation Module: This is very important module of our proposed model because it helps us in reducing false alarm. The working of this module is as : if the anomaly based detection technique detects the data as anomaly and signature based does not  detect it as intrusion  also if anomaly is not present in the known anomaly database then said anomaly string is fragmented in a format after that arranged and concatenated in a pre-defined format for rules and do transformation if needed. Finally stored the new rules  in the rule database of the signature based detection technique, so that next time when such anomaly occurs, it will be detected at very first step.

TABLE II: RULE GENERATION FORMAT  IP Source  IP Dest  Protocol Msg content port Rule ID      A. Working One-Stop is a novel hybrid model which not only detects the novel attacks but keep on updating the rules of the for signature based technique. The working algorithm of One- Stop hybrid model is as under: ALGORITHM ( ONE-STOP INTRUSION DETECTION) Step 1:  Input Raw Data for  i. Anomaly Based Detection System.

ii. Signature Based Detection System.

Step 2: Decode and Pre-processing for i. Anomaly Based Detection System.

ii. Signature Based Detection System.

Step 3: Detection in Both Phases i. If( Anomaly AND Intrusion) Then  ?Generate Alarm? ii. Elseif (Anomaly AND Not Intrusion) then If (Anomaly in Anomaly Known Database) then ?Normal Traffic? Else Make entry in the table for new signature Generation.

?Generate Alarm? END IF END IF ELSE ?Normal Traffic?  END IF  The necessary working of the model goes like the algorithm mentioned above. Let us discuss it fully. First both the techniques i.e anomaly and signature based will decode and pre-processor the raw data packet, then the formatted data will be given to detection engine which will use databases for the purpose of detecting intrusion or anomaly. IF both techniques triggered alarm for intrusion, then general alarm will be activated. IF anomaly based Detection alerts anomaly and signature based detection method does not detect the intrusion, we will go for the another checking before declaring it as an anomaly and alert alarm. We will check whether the current Anomaly matches with some known Anomaly saved in our Known Anomaly Database (i.e false alarm ?the data which has been detected as anomaly but are not intrusion?), if found then it is not an anomaly but if not found in database, then the current string is passed to rule generation module which generates new rules for the current anomaly for signature based intrusion detection system. Also an Alert Alarm will get generated. This step will help us to solve the problem of false alarm and also novel intrusion will be detected. Also if both the both the detection mechanisms do not detect the anomaly or intrusion, then No alert will be generated i.e ?Normal Traffic?.



V. IMPLEMENTATION OF ONESTOP The hybrid model One-stop has been developed keeping in view the number of false alarm. The model is fully implemented in java. The data preprocessing is done by JCap     unit which pre-process the data and format the incoming stream or the dump into the format, by which the other modules will understand it easily. This step is important, because if the pre-processing of data is done wrongly, we will not get the desired format which will be later used for the comparison purpose.

The function used for detecting the anomaly is named as anomaly detection. The glimpses of the functions are as under:  public class anomaly { public static final String HOST = "127.0.0.1"; public static final int PORT = 9199;                                              public static final String NAME = "anom_kddcup"; public void execute() throws Exception {  //  Connect to Server AnomalyClient client = new AnomalyClient(HOST, PORT, 5);  //  Prepare learning data Datum datum = null; TupleStringFloat result = null; Try { BufferedReader br = new BufferedReader(new FileReader(FILE_PATH + TEXT_NAME));                                              Not Detected   Not Detected  Normal  System / Network  Input Stream  Detected  Alarm  Detected  If Not found in Anomaly DB  Detected Not Detected  Check for Known Anomaly  Rule Generator Known  Anomaly  If Found in anomaly DB  Add rules to Database  Normal Alarm  Decoding & pre-processing  Anomaly Based  Detection Engine Anomaly  Database  Decoding & pre-processing  Detection Engine Signature  Database  Signature Based  Fig 3: An Architecture of One-stop Hybrid Model     List  strL = new ArrayList (); List  doubleL = new ArrayList(); String myline = ""; // read the data row by row until the last one while ((myline = br.readLine()) != null)  { strL.clear(); doubleL.clear(); // split the data items in each row String[] strAry = line.split(","); // main method starts from here public static void main(String[] args) throws Exception { new anomaly.execute(); System.exit(0) } The functions of the signature based module are as under:  Public class sigids { Boolean check_intrusion( ) throws Exception { //check for known intrusion using existing signatures } } The new module which has been added in the system is ultimately responsible for the output i.e, wheather the data stream is an attack or not. Some functions of this module are as:  Boolean check_for_intrusion( Boolean anomaly , Boolean signature) { If ( anomaly==1 && signature ==1) Alert( );  Else if ( anomaly ==1 && signature==0) { //open connection with known anomaly database //if found then no alert will be generated // Else if not found then generate alarm and also invoke the rule generation function }

VI. EVALUATION OF ONE-STOP As lot of research has been done on intrusion detection, which takes different datasets into consideration i.e  1998, 1999, 2000 etc.  Thus most of the evaluation in intrusion detection systems is based on the data and results received after implementation.

The main problem behind releasing data stems is the very much sever concern i.e Privacy concern. In order to reduce the impact of this problem Lincoln Laboratory (LL), under sponsorship of DARPA, created the IDEVAL datasets that serves as an evaluation benchmark [15].The main motive behind introducing 1998 DARPA intrusion detection system was to develop and distribute a dataset for the purpose of  evaluation of intrusion. The famous 1998 DARPA intrusion detection system data set was generated and recorded on a network which simulated an operational network connected to the Internet. Which uses automatically generated traffic generated by more than 22 or more networks and include the attackson these, like dns, finger, ftp, http, ident, ping, pop, smtp, snmp, telnet, time [16].

The section describes the experimental setup and data set used. In this paper, we use KDD 99 data set for experiment evaluation. The mentioned dataset is very large and consists of many components. The components are as under [17]: KDD Cup 1999; KDDcup.data_10_percent; KDD.newtestdata.unlabled_10_percent_unlabled; and corrected.

The structured views of component used from data set are as under:  TABLE III: Structured Analysis Of Dataset    Among the above mentioned components, we have  used KDD.data_10_percent component as training dataset and Corrected as testing dataset. The training data consists of 494020 records. Out of the 494020, 97280 records are labeled as normal records. In testing dataset, total numbers of records are 311029 among which 60593 are normal. Since there are four (4)  categories of attacks records available in data set viz DOS, U2R, probes and R2L. The brief description of all the attack mentioned are as under: [12][13][14].

Denial of Services:  is the attack in which the attacker kept the memory very much busy. The main aim of keeping memory busy is to deny the authorized user to get access to machine. Different types of DOS attacks are used in the test beds [17] [18].

User to Root Attack: is the type of attack in which the nonlegitimate user at the first time gains access to any normal users account by any common method like password sniffing etc. Then this un-legitimate user try to gain the access of the root director/ parent directory through known or unknown vulnerabilities [18] [19].

Remote to Local attack:  is the type of attack in which the attacker gain access over the packet over the network instead of machine and then configures the attack for the system. These  Data Set  Norma l  DOS U2R Probe R2L Total  K D  D .d  at a_  _p  e rc  en t                  Te st  d at  a   (c or  re ct  e d)                     attacks are usually carried out on not well configures      (Mis- configured) systems. [20][21].

Probes:  is not actually considered as an attack. Instead it is a program which automatically scans the entire network and collects all the desire information about all the vulnerabilities in that particular network for which the program is scanning [21].



VII. RESULTS AND DISCUSSION The paper shows incremental approaches in accordance to the percentage of decrease false alarm and increase in detection rate. Here in this paper we have repeated our experiment five times but the results came similar after three iteration .Also we will observe the change in the results because as discussed in our proposed architecture, after every anomaly identified by the anomaly detection engine and not found in both databases i.e Known anomaly and Signiture database, then it will add a new rule to Signiture database and next time it will be directly detected as intrusion. We will show the enhancement as under:  A. Iteration 1 In iteration first which is the start of the experiment, we have default signatures in the database and also the known anomaly in known anomaly database are limited , thus our results are very low in detection and have higher rate of false alarm . We have compared our results with the SNORT results, because SNORT is very efficient open source tool for detecting intrusion detection. As per the results, in first go, SNORT out- performers our model in both the cases I.e detection rate and false alarm as shown in table and figures below:   TABLE IV: DETECTION RATE Type Detection Rate SNORT 98.6  One-stop 96.4        Fig. 4: Detection Rate As per the results, SNORT detects at the rate of 98.6 % while as our proposed model detects at the rate of 96.2.Also in  generating false alarm rate SNORT shows better results than One-Stop.

TABLE V: FALSE ALARM Type Percentage of False Alarm SNORT 1.33 One-stop 3.24                 FIGURE 5:   FALSE ALARM   B. Iteration 2 In iteration second, there is drastic change in the results as we have inserted known anomalies in the database , also for anomalies signatures have been added in previous iteration, which means that detection rate will increase marginally. As per the results acquired from the experiment done, we can see that there is increase in the detection rate of our model which is 98.5 approximately equal to the SNORT. The results for detection ( In percentage form) is shown in table below.

TABLE VI: DETECTION RATE   Type Detection Rate SNORT 98.6 One-stop 98.5                     Fig. 6: Detection Rate   95.5   96.5   97.5   98.5   Snort Onestop  Series1  snort  onestop  98.45  98.5  98.55  98.6  98.65  Snort Onestop  iteration 2  detection rate     Also as per the results, there is decrease in the rate of false alarm generation. The results of false alarm generation for second iteration are as shown in table below:   TABLE VII: FALSE ALARM   Type Percentage of False Alarm SNORT 1.33 One-stop 1.22                 Fig. 7:False Alarm  C. Iteration 3: As per the third iteration, the detection rate of the one-stop is much better than SNORT. The results of the third iteration are shown as under in table VIII:   TABLE VIII: DETECTION RATE Type Detection Rate SNORT 98.6 One-stop 99.2                     Fig. 8:  Detection Rate   Also there is great decrease in the false alarm rate, which is important as far as intrusion detection systems are concerned.

The figures of false alarm generation at third iteration are as given in table below:   TABLE IX: FALSE ALARM  Type Percentage of False Alarm SNORT 1.33 One-stop 0.99       Fig. 9:  False Alarm  After third iteration the results came same for other iterations too. i.e detection rate = 99.2% and false alarm rate =0.99%.



VIII. CONCLUSION The current research if focused on mitigating false alarm and design of a new hybrid model which will adopt both the techniques. In this paper, we have proposed a new hybrid model which combines both the modules i.e anomaly and signature based also we have added few more modules which will check for false alarm and will add new rules to the signature database automatically thus we can say, it is a model which will detects novel intrusion made on the system and is reducing the number of false alarm. In future, we will try to implement the model for intrusion preventions also. We will also try to build the model using machine learning also.

