The Systematic Errors in the Random Coincidence  Estimation Using a Delayed Window

Abstract ? With the advance of new technology, PET systems nowadays have much higher sensitivities than before with the adoption of faster scintillators, faster electronics, larger solid angle detectors and full 3D data collection mode. All of these lead to the increasing of the random coincidences that will affect the image quality. Accurate random correction is important for the quantitative imaging in PET applications. Delayed window method is widely used for random coincidences estimation.

However, this method is not mathematically accurate. The difference between the delayed window randoms and the prompt window randoms can be significant under certain conditions. We studied the details of these differences using Monte Carlo simulations since this is the only way to separate the real random events from the true and scattered events. Three phantoms are used in the study, including the NEMA1994 20-cm long phantom, NEMA2001 70-cm long phantom and a 10-cm long, 1-cm diameter small cylinder phantom. The PET system used in this study is a 12-module LYSO camera with 20-cm axial FOV and 54-cm ring diameter to simulate a brain PET system. Two policies for the multiple events handling are used: reject-all- multiples, and take-all-goods. Random rates and NECR as the function of activities from prompt window and delayed window are obtained. The simulation results show that 1) The take-all- goods policy will underestimate the randoms rate and the reject- all-multiples will overestimate the randoms, which results overestimation of NECR for take-all-goods policy and underestimation of NECR for reject-all-multiples policy; 2) The discrepancy is more significant for smaller phantom than bigger phantom. This study demonstrates the intrinsic discrepancy for random coincidence estimation by the delayed window method.

When the phantom is relatively small compare to the FOV dimension of the PET system, the discrepancy is big enough to produce non-negligible errors.



I. INTRODUCTION More and more PET cameras are using faster scintillator such as LSO or LYSO crystal instead of the slow material of BGO.

They also employ the faster electronics and larger area detectors and collect data in full 3D mode. All of these new advances helped to increase the sensitivity of the PET cameras, thus introduced higher single event rates and then lead to higher random coincidences. In order to get good quantitative reconstruction results, the random coincidences should be correctly subtracted from the collected data. Since we cannot tell whether an individual coincidence event is a random event or not, we have to use other methods for the estimation of the randoms. The most popular method for random estimation is the delayed window method, which is widely used in the PET systems. However, is this method really able to provide the  correct estimation on the real random rate? In this study, we are trying to find the answer for this question.



II. THEORY For a PET system with a single gamma ray source instead of a positron source, such as the 137Cs isotope, the real random coincidence rate can be estimated by the equation below:  2ij i jR S S?? ? ?  (1) where Si and Sj are the singles rates of two detectors i and j, and 2? is the coincidence window. In this case, all the single events are independent or non-correlated events.

When a positron source is used, the single events from each detector have two possibilities: 1) the other gamma photon that came from the same positron-electron annihilation is escaped from the system without been detected; or 2) the other gamma photon is also detected by another detector. Here we use the symbols of Si0 and Cij representing these two types of single rates in case 1 and 2 respectively. Therefore, the single rates for PET system detectors can be expressed as:  0 0,  i i ij j j ijS S C S S C? ? ? ?  (2) here Si0 and Sj0 are the rates for non-correlated events and Cij is the rate of the correlated events or coincidence. With equation (1) and (2), the random rate from the prompt window with the positron source is:  ? ? ? ? ?  0 0  0 0 0 0  4 events2 events 3 events    2 [ ( ) ]  ij i j  i ij j ij  i j ij i j ij  R S S  S C S C  S S C S S C  ?  ?  ?  ? ? ?  ? ? ? ? ?  ? ? ? ? ? ? ????? ???????  (3)  There are three terms on the right side of the equation (3). The first term is the random coincidence from two non-correlated singles; the second term is the random coincidence with one correlated pair and one non-correlated single event; the third term has two true coincidence pairs. If there are more than two events within the coincidence window, we call those coincidences as Multiple.

Each PET system has its own policy about how to handle the Multiples. The two most simple and popular policies are: 1) reject all coincidence events if it is a Multiple; or 2) record all valid pairs if those pairs fulfill other criteria such as the energy thresholds or the geometry limitation etc. With policy 1, the second and the third terms in equation (3) will be rejected, thus the random rate will be:  ? ?0 02reject all multiples i jR S S?? ? ? ? ?  (4)  2009 IEEE Nuclear Science Symposium Conference Record M13-339       and with policy 2, we can get one random coincidence from each Multiple in the second term in equation (3), and two random coincidences from the third term in that equation, if we reject the coincidences of two singles coming from the same detector. Therefore, the random rate in this case is:  0 0 0 02 ( ) 2take all goods i j ij i j ijR S S C S S C?? ? ? ? ? ? ? ? ? ?? ?  (5)  When the delayed window method is used to estimate the random rate, the single events from different detector channels have different delay, therefore the correlated single events in Cij cannot fall into the coincidence window, and the random rate with the delayed window is:  ?  0 0 0 0  2 events2 events 2 events  2 [ ( ) ]delayed window i j ij i j ijR S S C S S C?? ? ? ? ? ? ? ?????? ??????? (6)  where all three items on the right side of the equation are the two-events coincidences.

Obviously the coincidence rate obtained from delay- window method in equation (6) is different from the real random rates from the prompt window in equation (5) and (4).

There are systematic errors for the delayed window estimation.

The estimation is always smaller than the real one if the Take- All-Goods policy is used and is greater if the Reject-All- Multiples policy is used. This systematic error is less significant and can be ignored only if the true coincidence rate Cij is much smaller compared to the single rates Si.

(when , )  delayed window take all goods  reject all multiples ij i j  R R R C S S  ? ? ?  ? ?  ? ? ?  (7)  The discussions above are based on two detector channels only. In a real PET system, there are many channels in the coincidence sorter, so there are also Multiples involving three or more modules/channels. The estimation of the randoms in a whole PET system might be more complicated than the simple discussions here. However, the systematic error in the delayed window estimation still exists.

In PET data processing, the estimated randoms are subtracted from the prompt window rate to reduce the noise from randoms and to increase the SNR for the images. NECR is the main index in review of the performance of a PET system. Therefore the biased estimation on the randoms will substantially affect the accuracy of the NECR.

/promt delayed window  TrueNECR True Scattered Random ?  ? ? ?  (8)

III. METHOD In reality, the randoms from the prompt window are always mixed with the true and scattered coincidences; which cannot be distinguished from each other. In order to find out the true random rate from the prompt window to compare with the delayed window, we use Monte Carlo simulation to generate the raw data. Since we can always record all the reaction histories of each photon, we can tell whether two singles are coming from the same particle or not so we can distinguish the randoms from true coincidences.

A. Date generation The raw data is generated by the Monte Carlo simulation  software GATE [1] and processed by ROOT [2], the true coincidences, scattered coincidences, random coincidences from prompt window, and the random coincidences from delayed window are sorted from the simulation output.

B. PET system specifications The PET system in this study is a 12-module LSO PET  camera with 540-mm ring diameter and 200-mm axial FOV for brain scan. The length of the detector is 18 mm. There are two 30-mm thick lead shielding on both sides of the detector ring. The energy cut window is 340 to 750 keV, and the coincidence window (2?) is 6 ns. Two policies for Multiples are implemented in the coincidence sorted: take-all-goods and reject-all-multiples. No deadtime or bandwidth limit is simulated for the coincidence sorter.

C. Phantoms Three cylinder phantoms with different diameter and  length filled with uniform distributed 18F activity are simulated: 1) NEMA1994, D=20 cm, L=20 cm; 2) NEMA2001, D=20 cm, L=70 cm; 3) small cylinder, D=1 cm, L=10 cm.



IV. RESULTS AND DISCUSSION Fig. 1 is the random coincidence rates as the activities with the NEMA2001 phantom. From the curves in the plot, we can see that all random rates are not equal and the relationship between them is take all goods delayed window reject all multiplesR R R? ? ? ? ?  , which is in accordance with the equation (5) to (6).

The corresponded NECR results in each case are shown in Fig. 2, where we can see that with take-all-goods policy the random rate is underestimated therefore the NECR is overestimated; and on the contrary, with reject-all-multiples policy the random rate is overestimated and then the NECR is underestimated.

Fig. 3 and Fig. 4 show the similar NECR curves with two other phantoms. More over, the differences between the curves become greater when the phantoms become smaller. In  0 1 2 3 4 5 6 7 8 9 10 0.0  200.0k  400.0k  600.0k  800.0k  1.0M  NEMA2001 phantom  R an  do m  (c ps  )  Activity (mCi)  with reject-all-multiples from prompt window from delayed window  with take-all-goods from prompt window from delayed window   Fig. 1  The random rates with the NEMA2001 phantom and different coincidence policies and windows.

order to compare the differences, we calculated the ratios of the random rates from prompt window to the delayed window, and the average ratios of all cases are shown in Table I. The numbers are calculated using the data from 3 mCi to 10 mCi.

The data from low activities are excluded to avoid the errors  from the poor statistics. From Table I, we can see that when the phantom size becomes bigger, the difference between the delayed window random estimation and the prompt window random becomes smaller, no matter what kind coincidence policy is used. This conclusion can explained by the fact that for a bigger phantom, the singles rate will be relatively higher compared to the true coincidence rate, which according to equation (7), the systematic error will be less significant and the three random rates will become closer.

TABLE I  AVERAGE RATIOS OF THE PROMPT RANDOM RATES TO  DELAYED RANDOM RATES  Small Cylinder Phantom NEMA1994  Phantom NEMA2001  Phantom  Reject-all-multiples 0.56?0.01 0.86?0.02 0.88?0.03  Take-all-goods 1.40?0.07 1.26?0.07 1.12?0.05   Though the simulation in this study is done with the  geometry of a brain PET; however, the conclusion can be applied to any PET system including the human-body PET or small animal PET system. For those small animal PET camera with very high sensitivity (~10%), the ratio of the true coincidence Cij to the single rates Si is very high, therefore the error of the random estimation by delayed window will be more serious.



V. CONCLUSION Using delayed window method for random coincidences estimation in PET imaging has the systematic error. The multiple event policy of the coincidence sorter also has significant effect on the random rate correction. With take-all- goods policy, the random rate will be underestimated and results in overestimating NECR; while with reject-all- multiples policy, the random rate will be overestimated and results in underestimating NECR. The smaller the phantom is, the greater the error will be. This problem is less serious for human whole-body PET system but more serious for large acceptance angle, high sensitivity system such as the small animal PET or brain PET cameras.

