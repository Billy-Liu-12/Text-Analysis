FUZZY TRELLIS VECTOR QUANTIZATION OF IMAGES

ABSTRACT  This paper introduces a new codebook search algorithni for trellis vect,or quantization systems (TVQ). The tlevcl- opmerit of the iiew algorithm is based on the symbol-IVlAP c:hanncl decoding algorithni, which is modified for data  corri- prc:ssion to deliver soft tlistort.iori-relatecl reliability infor- mation. Following a rat,e-tlistortioii theoretic approach, the soft information is iiscd to derive a codehook search algo- rithm that is capable of solving the problems associat,etl with the LBG algoritliin. ?l?he derived algorithm is fuzzy in the sense that it follows a. soft associa.tion rule, howrvcr, i t .

is tlcterrriinistic in 611c descent towards the global tiiiniriiiiin distortion point,, Altliougli t.he derivation is genrral, t ti(, algoritlirn is test.cd using gray-scale irnagrs, which pinvide ii nonco~ivex sqiiarc-rrror disbortion surface. As shown in thc sirrnilation sect.ion, tlie ricw algorithm providcs l o w c ~ energy codebooks (- 0.8 tlB gain), while being significantly less scnsit.ive to  initial codebooks using short traiiiiilg irringe scqiiences.

I .  INTRODUCTION  It lias becri sliowri t.hat trcllis waveform coding pt~ovitlrs tiear theorct ical limit distort.ion-rate performance [ I ] ,  (121. A t,rellis vector quarit.iztrt.ion (?L?VQ) system is characterizcd by  tc rtiid~irie (FSM) dccotlcr ancl i i  trcllis scarch P I I - coding algorit,lnn. The chatniel outpiit, scqiierice is fctl inlo thc FSM dec:otler, wliich produces the corresponding iiitlcx of a reproduction cotlcwortl. The FSM decotlcr is ~isctl to constriict the associated eiicotling trrllis, whose 1)ranclics are colored by blit: reproduction codewords. The encoding process irivolves a search algorit hrri t,liat delivers the propcr cliaiincl inpiit scqiienccT, which represrnts thc branc:h ill- dices of the miniinurn distortion path iii the trellis. The aut,liors ir i  [.3] tlescrilx an efficicrit approach for ?rVQ sys- tern design rising an LRG-t)asetl algorit.lirn to seixrch for an optirnal miniinurn tlist,ortiori part.it,iori. However, the LEG algorithm is ex trwiely sensit,ive to the initialixatioii pliasc, which corit,rols the descent. to a locally optimal cotifigiira- tion. Conscqiiently, it is very likely that the rionconvex tlistort.ion surface, which is :wsociat,cd with irnagcs, tricks a poorly iriitialiaetl LI<G algorit,hrn into selt,ling at  a locally optiirial soliit,iori. The limitations of Ilie LBG-algorithrn callctl for other global codehoolc scarch techriiqnes, such as deterrriiriistic anricaling 141.

0-7803-6293-4/00/$10.00 02000 IEEE. 1883  yorigacogesi te .uot t,;Lwa.ca  One of t,he algorithms used with TVQ is the Viterbi al- gorithm. The function of tlit! Vitrrlji algorithm in searching for t,he minirnuni distortion path is analogoiis to its func- tion in delivering tlie most ~)rObiLble transmitted sequence in channel dccotling. In anticipation of producing an 1111- correlated arid uniforrnly dist~ri1)iitetl sequerice of symbols; i. e., a reduridancy free secinerice, the Viterhi algorithm is applied wit11 TVQ (VTVQ) considering indcpericlcnt and ident,ically dis1,ribiited trellis l~rarich indiccs. Coriseq~ietitly, given a source ontput scqiicric:e of vectors, using ari algo- rithrri that produces a scqucrice of rniriinium distortion syrn- bols is cquivalcnt, to using tl ic: Vitcrbi nlgorithm, which pro- tliices the miriirnurn tlist.ortiori scclueric:e. Bascd 011 this fact, wc introdiiccd in [5] arid [GI it iicw TVQ search algorithrn, wliicli represented bhe ?ni~tnral diiill? to syiiibol-bIAP trel- lis clianirel clecodiiig. The ncw scarch algoritlirri in (51 and [6] is I~asctl on t,he ciirly HC.IR aIgorit,hm introdiiced for channel tlecodirig in [7]. ? 1 ? 1 1 ~ ~  algorithm performs tlecision- dclayetl procrssirig i ~ r i t l  delivers for each time instant a set of reliability (soft) valiies t.liat :ire usc:d to decitle on tlic rriinirniirn clistor-t,ion source rticodcr oii t ,pt  synibol. Since the algorit,hm tlt:livers soft, inlorrnat.ion, in the form of tran- sition protxibilitics, this c~rirotliiig approach is cwllerl ?soft t r e  11 is vec: t,or qu an t, i x at, i 01 i ? (  In this paper, we c~xt,t:nd STVQ by using the rcliabil- ity information, wliic:h is i i  protliict of this conipressiori ap- j)rOiidi, to  provide a robnst I?uzzy, yet, tlet,crrriiriist,ic:, procc- tliire for tlit: design of trcllis conil)rcssion systems [SI. The fiizxy dcsigri approadi alleviates t,he problcrris associated with thc 1,lK; ix1goritJriri whcri appIir(1 t,o TVQ codebook design. ?l?hc: dcriviition o f  the iicw f u m y  t.rellis search algo- rit.1iin is coric:c~ptually t)asc:d oil  tlic tlrve1oprric:rit of the ra te distortion t,heory, and is similar to tlet,cmniiiistic arinralirig for data cliistc:ring, in particular vector qna,ritization. We will show t,hloitgli several sirrii11;ition c~xarriy)lcs iisirig gray i rnages t.lritt t,he iiew fiixzy design approach prodnces lower distort,iori c:orriigiirations, while being sigriific:arit,ly less scn- silive to initial coclcbooks.

2. THE STVQ ALGORITHM  In this sectiori we briefly t1tsc:ribc the soft cornpiwsion algo- rithm (S?rVQ), which is tlcrivctl in [G,  51 I)ased on titi anal- ogy drawn bctwecm a sonrce and a corriiriiinica1,ion chari- nel. Consider iisirig n labelctl-transitioir trtrllis associa.t,ed with a FSM-clc:cotler of constmitit Ierigth v and k-hit in-    piits. Accordingly, the TVQ is characterizcd by a trel- lis that has M = 2 k ( v - 1 )  states, and 2k branches stern- rning out of each state. The branches are colored or la- h i e d  by the indices that address a reproduct,ion codebook  Consider t,liat the outpiit vector of a stationary discrctc- time source at, time 72. is tlenot,ecl by Y,, = [ g n l ,  yTL2, . . . , y n ~ ] .

?l?he derivation of the STVC) algorithrn is based on tlie fact t1ia.t we may consider the TVQ proce.

output of the channel defined by [G,  51  c = {CO, c 2 ,  ..., Cl<-,}, where IC = 2 ? .

p(YnI:cll, 9,) = cxp{-$(Yn, ~ l s , ) }  (1)  where q is a Lagrange multiplier, and d(Y,, z,lsn) is the distortion between the source outpiit vector Y, and the codeword associated with state sn and branch index zn.

lien, givcn a source outpnt sequence Y?, we choose an c,ncotler output symbol according to  ( 2 )  r >  zn = argrnaxpr {x, = i l ~ ; Y > %EA  The forwartl-backward procedure described in [7] is iiscd to  solvc for the set of probabilities P r  {zlL = ilYIN}, i = 0,1, .  . . , I - 1 and I = 2 k .  We proceed by defining the joint probability variable  A R ( ~ )  = ~r {zTL = i ,  .srL = 7 r ~ ,  Y;?> ( 3 ) where srL = Tri is t,he encoder st3t.e a t  time n.. It follows that  It is shown in [ S ,  51 that thc joint probability variable de- fined in Eq. (3) can he writtrn ?IS  Aa(m) = &(in)  . P k ( 7 n )  (5) whcre  It can be shown that the forward variable is evaluated using I - 1  1-0  where Si(7) i )  is the state at which we arrive if we go back- wards from state s, = m along the branch z7%-1 = j .  Be- sides t hat,  yk(7n) = exp{-qd(Y,,, z, = ils, = m)} (8) On the ot.her hand, we can easily show t,hat the recur-  sion of t,he hacltwartl variable is givcn by 1 - 1  ,8:L-,(7h) c/~a(?~:(7il)),?~(s;(?ii)) 7). = N , N - l , .  . . ,:!

%--O  (?3) whcre S ; ( h )  is thc state at. which we arrivc if we go for- wi~rd from st,atc sn-1 = 61 along the branch ~ : , ~ - l  = j. The implementation approach arid the impact of the Lagrange multiplier 77, used in Eq. ( 8 ) ,  on the algorit.hrn?s perfor- mance is discussed in [5, 61.

3. FUZZY SOFT TRELLIS VECTOR QUANTIZATION  In this section we use the development of the rate distor- t,iori theory to cxtend the STVQ algorithm to provide an efficient and robust, fuzzy and detcrministic trellis codebook search approach. We will demonstrate in this section that t,hc developed approach is capable of descending to lower distortion points while being highly insensitive to the ini- tialization of Llie search process. In [ 8 ] ,  theorem 6.3.3 in particular, Blahut parameterizes the rate distortion func- tion R ( D )  in an equality, rather than an inequality, using a Lagrange multiplier n. In that theorem, the author shows that the optimal conditional distribution that achieves the rninimiim valiie of R ( D )  is [8]  with an average distortion D  where j and 1 arc used t,o index the input and reproduction alphabcts, respectively. Ql l J  is the conditional probability function between 1 and j ,  and Q;,j is the distribution that achieves the point on the n ( D )  curve. Besides that, d,l is the distortion between symbols 1 and j ,  p j  is the input distribution, while ql is the output distribution.

Theorem 6.3.3 in [8] is significant in the sense that it ciilminated into the famous Blahut?s algorithm, which com- putes certain number of points on the rate distortion curve parameterized by the corresponding values of the Lagrange multiplicr K .  For a particular value of n E] - m, 01, Blahut?s algorithm iteratively finds the best distribution of the re- production alphabets q, which along with Q L l j  defined in Rq. (10) achieves a point on the rate distortion curve. In ot.her words, Blahlit algorithm characterizes the distribu- tion of the optimal reproduction alphabets (41) as well as the transition probabilities ( Q J ) ,  which control the encod- ing rule, for a given value of n.

We derrionst.rated in the previous section that the deriva- lion of the STVQ algorithm is based on the association distribution given by Eq. ( 1 )  and parameterized by the La- grange multiplier ?. This distribution is clearly identical to the conditional distribution Ql l J  shown in Eq. (lo), which leads to an optirnal rate-distortion point parameterized by K .  The two distributions are different in their consideration of the distribution of the output alphabet (41). While it is the goal to search for an optimal output alphabet distribu- tion (a) in tlie development of the rate-distortion theory, practical compression systems, and the STVQ algorithm in particular, adopt a uniform distribution to describe the reproduction alphabets. This consideration reduces the de- grecs of frecdoni in practical systems, and allows for the exact computation of the output alphabets.

The other point of interest is t,he similarity between the parameters q and n, where 7 in Eq. (8) is equiva- lent to  - K  in Eq. (10). It is more perceptive to interpret the independent Lagrange multiplier K as the slope of the tangent a t  the corresponding point on the rate-distort ion     curve. Accordingly, as K i -m we approach thr low- distortion high-ratc point,s of the R ( D )  curv(!, while K + 0 corresponds to the flat high-distortion low-rilte points of l.hc sanie (:iirve. linlilte I3lahut algorithni, which firids i i rate-distortion point given the intlepentlent parameter IC, the TVQ problem irivolvrs encoding given a prespccified compression rate value. Thcrefore, the critical issuc with the STVQ algorit.hm is t,o find the opt.imal 7 given a con- pression rate arid an anticipated average distortion value.

Experirnent.al results showed tha t  t,he values of 7 control the conipiitational rate-distortion curve just like the valiies of IF. contxol the theoretical rate-distortion curve [6].

Now, consider the general problem of data clustering.

Irrcspective of whether cliistming is rrgiilar or performed over a trellis, the systrrn design criterion is to niinimize the average distortion  j r  sirice we are priictic:ally iritercstecl i n  tleliveririg a liartl (IC- cision, thc c:ondit,ional distribrii,ion ?r[lj is defined as  j E SI q, = { b: Othc~rwise ( 1 3 )  wlierc .Sl rcl)rrserits the It,h rncotfiiig set. I~\irtlicrniorr, sirice wc do riot iisuidly have access t,o the source tlist,ribii- t.ion p J ,  s td i a s t i c  iLvcwging in Eq. (12) is usually rrplaicetl by t,inie averaging. IJnlikc tlic distortion m a s u r e  tlcfincd in Eq. ( 1  I ) ,  which iiicludcs tlie soft coritlitional encoding rule (QIl3) ,  the practic:iil ineixsitre of E(1. (12) is based o n  n Iiard association rule ( T L I , ) .

In ortlcr to fit, i.hc noi.ion of STVQ, wc: rcclefiiit: i.he dis- tribittion q, ~ L S  follows  Eq. (12) with Eq. (14), we propose minimizing the follow- ing distortion rneasurc in the process of searching for the optimal codebook  = -L 1 & ( 1 )  d ( K ,  Cl) (16) 7L 1-0  NT  where NT is the length of the training sequence. It follows t,hat to minimize the distortion given by Eq. (16) we set t8he gradient, of D with respect to {Cl} to zero, which for the squared error distortion produces the centroid update equations  According to Eq. (17), a source output vector Y,, con- tributes a $,(j)-weight of its value to the update of each reproduction cocleword C, . Clearly this update equation provides the deterrniriistic relaxation sought for to help the LBG algorithm firids i.he global minimum configuration.

Eq. (17) with the STVQ algorithm defines a new fuzzy search process we refer to as fuzzy-STVQ or FSTVQ. The search process with i.lie FSTVQ algorithm is identical to that. of the LBG algorithm with t,hc exception of using Eq.

( I  7) and the proper 7-schethile instead of hard clustering.

1 he process starts with relatively sniall values ol  7 that cor- r(:spond to very fuzzy association. The I(:vel of randoniness is reduced each time we iricrcrrient 11 towards the optimal T I * .  It is worth rriciitioning that an update equation, similar t,o the onc shown by Eq. (17), is derived in [9] following a DA approach for the special ca.sc of a labeled-state trel- lis coding system. In t,liat brief paper, the authors use a forward-backward algorit,hni to solve for a set of probabil- it,ics similar to &1 (1) in association with a dynamic pro- gramming algoritlirri to search for the rriiriimurri distortion path  r 1  wii.11 A t , ( ~ n )  tIefirird iii b;q. ( 3 ) .  we show in [e] t,hat for n p;~ticuliir cornpression rat.(: and expcctctl ilvt'rage distor- tion thr r r  is a propcr viihie TI*  in 1Sq. ( 8 ) ,  h l o w  which tlic S'rVC)-cotlelxwk search process wii.li the, I,nG iilgorithin corivcrgcs 1 o higher i~vcrage distortion valucs. 'Ihcreforr, (:onsidering that we arc tlc ndirig on tfic corriput.atiorial tiistori ion rate curve from high distortion valucs (small 7 1 ) t o  t.hc tlistort,ioii corresponding to t.he opcrat,iorial rat.e (at T T ' ) ,  wc' can pcrforni some sort of detcrmiriistic relaxation 1)y rriinirriixing a soft avc~ i~gc  distortioii while iticrcniciitirig i.tie value of 7 lrorn sinall va1ric.s 1.0 q* ,  This intuitivc~ly sug-  using t,lic, soft informai.ion , T / J , ~  ( I ) ,  which is dclivered by the S'IVQ algorithm and defined in Eq. (Is), in place of the hard ixssociat,ion rule I T , ~ ( / I Y ~ )  of fSq. (14). Accord- ingly, instead of iriinimiaing the average dist,ortion given by  4. PERFORMANCE EVALUATION  'rllis srctiori shows the advantage of the FSTVQ algorithm iii (,lie area of irriage conipression. The new algorithm is c:oiripared with the I,BG idgorithm using both STVQ and Viterbi-based 'I'VQ (V'.L'VL)). It is worth meiitionirig that hoth S'VVQ ar id  V-TVQ exhibit similar prrforrriance when applied to different sources [6, 51. Several caSes are con- sidered with different trellis stnictrires with a compression ratc of 0.0625 bit,/pixol (bpp). To show the advantage of FSTVQ, wc use a rclativcly short training sequence of 2 irnages with i ~ i i  cxtcrnal tcst image [lo]. The training set consist,s of 256 x 256 gray images represented by &bit pixels.

The test irnagc, on thc ot,her hand, is the 512 x 512 gray- scalc L e m a  image. The search for the optimal codebook is iritlcl,critlc~iitly repeatcd for 15 times, each time with a tliffci~ent initial codebook choscii uniforinly a t  random from  Compression a t  0.0625 bpp is achieved using a trellis with k = 1 and 4 x 4 image blocks producing a vector tiirrierisiori L = 16. The performance measure is the peak signal to noise ratio (PSNR) defined as  (0 2553.

I885    Table 1: The rate 0.0625 bpp PSNR coding performance in dB for the Lenna image using 2 training images  + + + + I , +  + + , ,  Kenneth Rose. ?Deterministic annealing for clust,er- * ing, compression, classification, regression, arid related E W h ? O  A @  optimization problems?. Proceedings of t h e  IEEE, 111 x , d a  ?l?ariq IIaddad and Abbas Yonga~oghi. L?El~zzy soft - i ~-1-  86(11):2210-2239, Nov. 1998. 0  where Yp is the highest intensity value used to represent a pixel, and E { d ( Y , Y ) }  is the MSE between the original and the reconstructed image. The results shown in Figs. 1 and 2 clearly emphasize the advantage of FSTVQ in pro- viding lower energy configurations while being significantly less sensitive to the initialization process. The sensitivity to initial codebooks becomes more pronounced as the com- plexity of the trellis structure increases, as shown in Fig. 2.

Nonetheless, the fluctuation in performance occiirs within smaller range at higher levels of PSNR as compared to the LBG-based algorithms. The lowest distortion codebooks for each value of v, which represent the best-case scenarios amongst the 15 trials, are used to  encode the Lenna im- age. The PSNR results arc shown in Table 1, wlierc we demonstrate the advantage of using FSTVQ for the tlif- ferent constraint lengths. Nonetheless, the performance of the codebooks generated by the LBG algorithm would have been even worse had we considered higher clistortion cori- figurations. For example the highest distortion codebooks from Fig. l(b) arc those associated with initial codebooks 7.

3 and 3 for FSTVQ, VTVQ and STVQ, respectively. How- ever, the lowest distortion codebooks for VTVQ arid STVQ in Fig. l (b)  are those associated witah initial codcboolts 1 2   5, respectively.

5. REFERENCES  [7] L. R.. Bahl, .J. Cocke, F. .Jelinek, and .J. Raviv. ?Op- timal decoding of linear codes for minimizing symbol error rate?. TEEE T7niisaclions on I n f o r m a t i o n  The- ory, IT-20(2):284--287, Mar. 1974.

[8] R. E. Blahut. I?rin,ciples and practice of infov?ion tlieonj. Addison-Wesley, Massachusetts, 1987.

[9] D. Miller, K.  Rose, arid P. C h u .  ?Determillistic annealing for trellis qiiantixater and HMM design us- ing Haiim-Welch rc~-estiiriation? . In ICASSP?94, pages V261--V264, Adelaide, Australia, April 1994.

[lo] P. Westerink, D. Bockce, J. Biernontl, and ,J. Woods.

?Subband coding of image using vector quantization?.

I E E E  Transac t ions  071 ,  Cornm~~nications, 36(6):713-- 719, .June 1988.

19 8  19.6 -1  4 6 8 10 Initial codebook number  D  I  I  _I   0 0  0 x P U  6 8 10 lnnial codebook number  Figure 1: The ratc 0.0625 bpp PSNR coding performance in (dH) using 2 training images: (a) v = 3 ,  (h)  v = 4.

