Modeling Interactions in Continuum Traffic 1,2Hua Wang? 2Tianlu Mao? 2Zhaoqi Wang?

ABSTRACT It is a big challenge to generate the traffic scenarios with frequent lane changes in flow-based continuum traffic simulations. In this paper, we present a novel macroscopic method, named interactable cooperative driving lattice hydrodynamic model (Interactable CDL- H model). We describe traffic flow along lanes and flow interactions between lanes in a uniformly continuum frame. We further consid- er various constraints for a detailed lane-changing simulation. The model owns the efficiency of traditional macroscopic traffic models and can describe lane-changing behaviors effectively. It physical- ly describes where/when/how traffic flow goes into (out) of a lane, which make it possible to simulate and display lane-changing be- haviors in large-scale virtual environments. The validity and effi- ciency of the interactable CDLH model are demonstrated by com- paring simulation results with real traffic data and one-dimensional CDLH model.

Index Terms: I.3.5 [Computer Graphics]: Computational Ge- ometry and Object Modeling?Physically based modeling; K.7.m [Simulation, Modeling, and Visualization]: Types of Simulation? Animation  1 INTRODUCTION AND MOTIVATION There is a growing need to blend realistic traffic simulations into virtual reality applications, such as games, virtual tours, et ceter- a. There are two significant traffic characteristics that have to be taken into account in such applications: large scale and high com- plexity. The large scale refers to the huge number of vehicles. The high complexity refers to various complex traffic scenarios. Some of these scenarios are formed by road structures, such as on / off- ramps, crossings and changes in the number of lanes. Others are formed by some dynamic factors, such as man-made traffic control-  ?e-mail: wanghua@ict.ac.cn ?e-mail:ltm@ict.ac.cn ?e-mail:zqwang@ict.ac.cn  s and accidents. These segments are named road inhomogeneities in the transportation research. There are frequent flow interaction- s between neighboring lanes near road inhomogeneities. In real road networks, the length of these various road inhomogeneities ac- counts for a large proportion of the total road length. Therefore, it is impossible to get a realistic large-scale traffic simulation without handling flow interactions.

Macroscopic (or continuum) models are suitable for large-scale traffic simulations because of their high efficiency. However, they simplify flow interactions between lanes, which limit their usage in virtual reality applications. Sewall et al. adopted the Aw-Rascle and Zhang macroscopic flow model to simulate traffic networks and handle flow interactions by adding a lane-changing model [4, 3].

The method is efficient for large-scale traffic simulations. Howev- er, it doesn?t give descriptions about whether and when there are flow interactions between neighboring lanes in detail, which make it impossible to generate lane-changing behaviors.

In order to support realistic large-scale traffic simulations with various complex scenarios, we introduce the Interactable CDLH model based on one dimensional (1D) CDLH model [1]. The Inter- actable CDLH model is a partly two dimensional (2D) continuum model with a set of lane-changing constraints. In the model, traffic flow along lanes and its interactions between lanes are described uniformly in a 2D space. We creatively convert the constraints into a single problem which acts as a switch dominating the direction of flow (moving forward or changing its lane). Our model could answer where and when flow interactions occur and how flow goes into / out of a lane.

2 MODEL DESCRIPTION Traffic flow is lane-based but not a 1D fluid. Especially near road inhomogeneities, moving forward along lanes is often disrupted and lots of lane changes occur. In order to describe flow interactions, we extend the CDLH model [1] from the 1D frame to a 2D Frenet Frame (the longitudinal direction and the lateral direction of road lane curves are x-axis and y-axis, respectively):????t? +?(??) = 0? j,m(t+?t)? j,m(t+?t)=?0V ( n?  l=1 ?l? jfront l,mfront l(t),?0)  (1)   IEEE Virtual Reality 2014 29 March - 2 April, Minneapolis, Minnesota, USA    Where ? (?(x,y, t)) is the density of traffic, ? (?(x,y, t)) is the ve- locity. ? j,m(t) and ? j,m(t) represent the local density and the local velocity of the quadrilateral lattice ( j,m) on the 2D multi-lane plane at time t, respectively. ?t is the delay time. ?0 is the average density of the current segment. The function V is the optimal velocity and described by the following formula:  V ( n ?  l=1 ?l? jfront l,mfront l(t),?0) =  vmax 2 [tanh(  ?0 ?  n ?  l=1 ?l ? jfront l ,mfront l (t)  ?20 ? 1?c )+tanh(  ?c )]  Where ( jfront l,mfront l) is the lth lattice at the front of ( j,m) along its flow direction at t. n is the number of lattices we should consider at the front of ( j,m) along its flow direction. ?l is the weighting function of ( jfront l,mfront l). It?s a constant and determined by n.

?c is the inverse of the safety distance, and vmax is the maximum traffic velocity for the current segment.

We use a finite difference method to solve our model by dis- cretizing traffic flow to some certain directions (along lanes, chang- ing to the left / right neighboring lanes). Then firstly, we determine the direction of flow. We take into account of various lane-changing constraints, such as particles? kinematic and dynamic constraints, local flow densities, road structures and so on. For a given lat- tice near road inhomogeneities, if it satisfies all lane-changing con- straints to the right / left front direction, its flow will go into the right/left neighboring lane. Otherwise, the flow direction remains unchanged. Secondly, we update the value of traffic flow velocities and densities and determine durations of flow interactions accord- ing the finite difference equations.

In order to simplify solving processes, we estimate whether the lattice satisfies all these constraints by solving whether there is a satisfied lane-changing trajectory for the particle that has a lane- changing request in the lattice. This also facilitates the further vi- sual display, because the calculated lane-changing trajectories are physically reasonable.

3 EXPERIMENTAL RESULTS We implement our model for traffic simulations with various chal- lenging scenarios such as traffic jams, on- and off-ramps, road in- teractions etc (Figure 1). We next give the similarity comparisons with real traffic data and the computational efficiency of our model.

3.1 Similarity We simulate the traffic of Highway 101 from X = 420m to X = 620m in 15 minutes. Our initial and boundary conditions of the simulations are from the NGSIM [2]. We calculate the flux ev- ery 15s among 1000s from our simulation results and compare the time-series data with the NGSIM data using LCSS algorithm. The similarity between the NGSIM data and our simulation results, as well as the similarity of the model described by Sewall et al. [3], are shown in Table 1.

3.2 Computational efficiency We use the road networks with the length of 150km. There are 65 road inhomogeneity segments in the traffic networks, accounting for about 20% of the total length. Figure 2 shows the relationship between total compute time and the number of vehicles. What can be seen in Figure 2 is that both the compute time of the 1D CDLH model and that of our model are nearly independent of the number of vehicles.

4 CONCLUSION There are mainly two advantages over previous virtual traffic meth- ods. Firstly, we describe traffic flow along lanes and flow interac- tions between lanes in a uniform continuum frame and blend lane- changing constraints considering the particularity of traffic flow.

Table 1: Similarity of the flux sequence for successive detection points along the Highway 101. The ?average? row shows the aver- age similarities of the sample points for each technology. The closer that the similarity value is to 1, the more realistic that the simulation result is.

Figure 2: The compute time as a function of the number of vehicles.

As a result, flow interactions could be described in detail in a macroscopic method. We also get realistic lane-changing trajecto- ries when blending the constraints, so that lane-changing process- es could be directly displayed to enhance the effect of large-scale virtual traffic. Secondly, we creatively integrate the lane-changing constraints and contribute an efficient algorithm to solve the model.

The compute time of our model owns the same order as that of the 1D CDLH model, which makes our model efficient for a large-scale traffic simulation.

There are also some limitations. A few collisions between par- ticles may be unavoidable in lane-changing processes because the lane-changing trajectories we calculate are a kind of forecast of next several time steps. We will further improve it by more accurate ways.

ACKNOWLEDGEMENTS This work is supported and funded by the National Natural Sci- ence Foundation of China (Grant No. 61173053, 61100086, 61272322), the National Key Technology R&D Program (Grant No. 2013467058, 2012BAH39B01, 2013AA013902). We would like to thank the reviewers for their constructive comments and sug- gestions.

